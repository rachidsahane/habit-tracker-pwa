(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function t(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=t(s);fetch(s.href,a)}})();function H0(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Np={exports:{}},tu={},Dp={exports:{}},Ne={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var v_;function ZS(){if(v_)return Ne;v_=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),_=Symbol.iterator;function x(j){return j===null||typeof j!="object"?null:(j=_&&j[_]||j["@@iterator"],typeof j=="function"?j:null)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},D=Object.assign,U={};function L(j,Y,_e){this.props=j,this.context=Y,this.refs=U,this.updater=_e||S}L.prototype.isReactComponent={},L.prototype.setState=function(j,Y){if(typeof j!="object"&&typeof j!="function"&&j!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,j,Y,"setState")},L.prototype.forceUpdate=function(j){this.updater.enqueueForceUpdate(this,j,"forceUpdate")};function K(){}K.prototype=L.prototype;function X(j,Y,_e){this.props=j,this.context=Y,this.refs=U,this.updater=_e||S}var q=X.prototype=new K;q.constructor=X,D(q,L.prototype),q.isPureReactComponent=!0;var ne=Array.isArray,ue=Object.prototype.hasOwnProperty,ce={current:null},C={key:!0,ref:!0,__self:!0,__source:!0};function k(j,Y,_e){var Re,Pe={},Le=null,Be=null;if(Y!=null)for(Re in Y.ref!==void 0&&(Be=Y.ref),Y.key!==void 0&&(Le=""+Y.key),Y)ue.call(Y,Re)&&!C.hasOwnProperty(Re)&&(Pe[Re]=Y[Re]);var ze=arguments.length-2;if(ze===1)Pe.children=_e;else if(1<ze){for(var Ye=Array(ze),Ct=0;Ct<ze;Ct++)Ye[Ct]=arguments[Ct+2];Pe.children=Ye}if(j&&j.defaultProps)for(Re in ze=j.defaultProps,ze)Pe[Re]===void 0&&(Pe[Re]=ze[Re]);return{$$typeof:n,type:j,key:Le,ref:Be,props:Pe,_owner:ce.current}}function R(j,Y){return{$$typeof:n,type:j.type,key:Y,ref:j.ref,props:j.props,_owner:j._owner}}function P(j){return typeof j=="object"&&j!==null&&j.$$typeof===n}function V(j){var Y={"=":"=0",":":"=2"};return"$"+j.replace(/[=:]/g,function(_e){return Y[_e]})}var M=/\/+/g;function A(j,Y){return typeof j=="object"&&j!==null&&j.key!=null?V(""+j.key):Y.toString(36)}function Ae(j,Y,_e,Re,Pe){var Le=typeof j;(Le==="undefined"||Le==="boolean")&&(j=null);var Be=!1;if(j===null)Be=!0;else switch(Le){case"string":case"number":Be=!0;break;case"object":switch(j.$$typeof){case n:case e:Be=!0}}if(Be)return Be=j,Pe=Pe(Be),j=Re===""?"."+A(Be,0):Re,ne(Pe)?(_e="",j!=null&&(_e=j.replace(M,"$&/")+"/"),Ae(Pe,Y,_e,"",function(Ct){return Ct})):Pe!=null&&(P(Pe)&&(Pe=R(Pe,_e+(!Pe.key||Be&&Be.key===Pe.key?"":(""+Pe.key).replace(M,"$&/")+"/")+j)),Y.push(Pe)),1;if(Be=0,Re=Re===""?".":Re+":",ne(j))for(var ze=0;ze<j.length;ze++){Le=j[ze];var Ye=Re+A(Le,ze);Be+=Ae(Le,Y,_e,Ye,Pe)}else if(Ye=x(j),typeof Ye=="function")for(j=Ye.call(j),ze=0;!(Le=j.next()).done;)Le=Le.value,Ye=Re+A(Le,ze++),Be+=Ae(Le,Y,_e,Ye,Pe);else if(Le==="object")throw Y=String(j),Error("Objects are not valid as a React child (found: "+(Y==="[object Object]"?"object with keys {"+Object.keys(j).join(", ")+"}":Y)+"). If you meant to render a collection of children, use an array instead.");return Be}function Xe(j,Y,_e){if(j==null)return j;var Re=[],Pe=0;return Ae(j,Re,"","",function(Le){return Y.call(_e,Le,Pe++)}),Re}function ie(j){if(j._status===-1){var Y=j._result;Y=Y(),Y.then(function(_e){(j._status===0||j._status===-1)&&(j._status=1,j._result=_e)},function(_e){(j._status===0||j._status===-1)&&(j._status=2,j._result=_e)}),j._status===-1&&(j._status=0,j._result=Y)}if(j._status===1)return j._result.default;throw j._result}var Ke={current:null},ae={transition:null},Ee={ReactCurrentDispatcher:Ke,ReactCurrentBatchConfig:ae,ReactCurrentOwner:ce};function he(){throw Error("act(...) is not supported in production builds of React.")}return Ne.Children={map:Xe,forEach:function(j,Y,_e){Xe(j,function(){Y.apply(this,arguments)},_e)},count:function(j){var Y=0;return Xe(j,function(){Y++}),Y},toArray:function(j){return Xe(j,function(Y){return Y})||[]},only:function(j){if(!P(j))throw Error("React.Children.only expected to receive a single React element child.");return j}},Ne.Component=L,Ne.Fragment=t,Ne.Profiler=s,Ne.PureComponent=X,Ne.StrictMode=r,Ne.Suspense=f,Ne.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ee,Ne.act=he,Ne.cloneElement=function(j,Y,_e){if(j==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+j+".");var Re=D({},j.props),Pe=j.key,Le=j.ref,Be=j._owner;if(Y!=null){if(Y.ref!==void 0&&(Le=Y.ref,Be=ce.current),Y.key!==void 0&&(Pe=""+Y.key),j.type&&j.type.defaultProps)var ze=j.type.defaultProps;for(Ye in Y)ue.call(Y,Ye)&&!C.hasOwnProperty(Ye)&&(Re[Ye]=Y[Ye]===void 0&&ze!==void 0?ze[Ye]:Y[Ye])}var Ye=arguments.length-2;if(Ye===1)Re.children=_e;else if(1<Ye){ze=Array(Ye);for(var Ct=0;Ct<Ye;Ct++)ze[Ct]=arguments[Ct+2];Re.children=ze}return{$$typeof:n,type:j.type,key:Pe,ref:Le,props:Re,_owner:Be}},Ne.createContext=function(j){return j={$$typeof:l,_currentValue:j,_currentValue2:j,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},j.Provider={$$typeof:a,_context:j},j.Consumer=j},Ne.createElement=k,Ne.createFactory=function(j){var Y=k.bind(null,j);return Y.type=j,Y},Ne.createRef=function(){return{current:null}},Ne.forwardRef=function(j){return{$$typeof:d,render:j}},Ne.isValidElement=P,Ne.lazy=function(j){return{$$typeof:v,_payload:{_status:-1,_result:j},_init:ie}},Ne.memo=function(j,Y){return{$$typeof:m,type:j,compare:Y===void 0?null:Y}},Ne.startTransition=function(j){var Y=ae.transition;ae.transition={};try{j()}finally{ae.transition=Y}},Ne.unstable_act=he,Ne.useCallback=function(j,Y){return Ke.current.useCallback(j,Y)},Ne.useContext=function(j){return Ke.current.useContext(j)},Ne.useDebugValue=function(){},Ne.useDeferredValue=function(j){return Ke.current.useDeferredValue(j)},Ne.useEffect=function(j,Y){return Ke.current.useEffect(j,Y)},Ne.useId=function(){return Ke.current.useId()},Ne.useImperativeHandle=function(j,Y,_e){return Ke.current.useImperativeHandle(j,Y,_e)},Ne.useInsertionEffect=function(j,Y){return Ke.current.useInsertionEffect(j,Y)},Ne.useLayoutEffect=function(j,Y){return Ke.current.useLayoutEffect(j,Y)},Ne.useMemo=function(j,Y){return Ke.current.useMemo(j,Y)},Ne.useReducer=function(j,Y,_e){return Ke.current.useReducer(j,Y,_e)},Ne.useRef=function(j){return Ke.current.useRef(j)},Ne.useState=function(j){return Ke.current.useState(j)},Ne.useSyncExternalStore=function(j,Y,_e){return Ke.current.useSyncExternalStore(j,Y,_e)},Ne.useTransition=function(){return Ke.current.useTransition()},Ne.version="18.3.1",Ne}var __;function jm(){return __||(__=1,Dp.exports=ZS()),Dp.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var w_;function ek(){if(w_)return tu;w_=1;var n=jm(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function l(d,f,m){var v,_={},x=null,S=null;m!==void 0&&(x=""+m),f.key!==void 0&&(x=""+f.key),f.ref!==void 0&&(S=f.ref);for(v in f)r.call(f,v)&&!a.hasOwnProperty(v)&&(_[v]=f[v]);if(d&&d.defaultProps)for(v in f=d.defaultProps,f)_[v]===void 0&&(_[v]=f[v]);return{$$typeof:e,type:d,key:x,ref:S,props:_,_owner:s.current}}return tu.Fragment=t,tu.jsx=l,tu.jsxs=l,tu}var E_;function tk(){return E_||(E_=1,Np.exports=ek()),Np.exports}var E=tk(),F=jm();const Sa=H0(F);var _d={},Vp={exports:{}},hn={},Op={exports:{}},Lp={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var I_;function nk(){return I_||(I_=1,(function(n){function e(ae,Ee){var he=ae.length;ae.push(Ee);e:for(;0<he;){var j=he-1>>>1,Y=ae[j];if(0<s(Y,Ee))ae[j]=Ee,ae[he]=Y,he=j;else break e}}function t(ae){return ae.length===0?null:ae[0]}function r(ae){if(ae.length===0)return null;var Ee=ae[0],he=ae.pop();if(he!==Ee){ae[0]=he;e:for(var j=0,Y=ae.length,_e=Y>>>1;j<_e;){var Re=2*(j+1)-1,Pe=ae[Re],Le=Re+1,Be=ae[Le];if(0>s(Pe,he))Le<Y&&0>s(Be,Pe)?(ae[j]=Be,ae[Le]=he,j=Le):(ae[j]=Pe,ae[Re]=he,j=Re);else if(Le<Y&&0>s(Be,he))ae[j]=Be,ae[Le]=he,j=Le;else break e}}return Ee}function s(ae,Ee){var he=ae.sortIndex-Ee.sortIndex;return he!==0?he:ae.id-Ee.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var l=Date,d=l.now();n.unstable_now=function(){return l.now()-d}}var f=[],m=[],v=1,_=null,x=3,S=!1,D=!1,U=!1,L=typeof setTimeout=="function"?setTimeout:null,K=typeof clearTimeout=="function"?clearTimeout:null,X=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function q(ae){for(var Ee=t(m);Ee!==null;){if(Ee.callback===null)r(m);else if(Ee.startTime<=ae)r(m),Ee.sortIndex=Ee.expirationTime,e(f,Ee);else break;Ee=t(m)}}function ne(ae){if(U=!1,q(ae),!D)if(t(f)!==null)D=!0,ie(ue);else{var Ee=t(m);Ee!==null&&Ke(ne,Ee.startTime-ae)}}function ue(ae,Ee){D=!1,U&&(U=!1,K(k),k=-1),S=!0;var he=x;try{for(q(Ee),_=t(f);_!==null&&(!(_.expirationTime>Ee)||ae&&!V());){var j=_.callback;if(typeof j=="function"){_.callback=null,x=_.priorityLevel;var Y=j(_.expirationTime<=Ee);Ee=n.unstable_now(),typeof Y=="function"?_.callback=Y:_===t(f)&&r(f),q(Ee)}else r(f);_=t(f)}if(_!==null)var _e=!0;else{var Re=t(m);Re!==null&&Ke(ne,Re.startTime-Ee),_e=!1}return _e}finally{_=null,x=he,S=!1}}var ce=!1,C=null,k=-1,R=5,P=-1;function V(){return!(n.unstable_now()-P<R)}function M(){if(C!==null){var ae=n.unstable_now();P=ae;var Ee=!0;try{Ee=C(!0,ae)}finally{Ee?A():(ce=!1,C=null)}}else ce=!1}var A;if(typeof X=="function")A=function(){X(M)};else if(typeof MessageChannel<"u"){var Ae=new MessageChannel,Xe=Ae.port2;Ae.port1.onmessage=M,A=function(){Xe.postMessage(null)}}else A=function(){L(M,0)};function ie(ae){C=ae,ce||(ce=!0,A())}function Ke(ae,Ee){k=L(function(){ae(n.unstable_now())},Ee)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ae){ae.callback=null},n.unstable_continueExecution=function(){D||S||(D=!0,ie(ue))},n.unstable_forceFrameRate=function(ae){0>ae||125<ae?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<ae?Math.floor(1e3/ae):5},n.unstable_getCurrentPriorityLevel=function(){return x},n.unstable_getFirstCallbackNode=function(){return t(f)},n.unstable_next=function(ae){switch(x){case 1:case 2:case 3:var Ee=3;break;default:Ee=x}var he=x;x=Ee;try{return ae()}finally{x=he}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(ae,Ee){switch(ae){case 1:case 2:case 3:case 4:case 5:break;default:ae=3}var he=x;x=ae;try{return Ee()}finally{x=he}},n.unstable_scheduleCallback=function(ae,Ee,he){var j=n.unstable_now();switch(typeof he=="object"&&he!==null?(he=he.delay,he=typeof he=="number"&&0<he?j+he:j):he=j,ae){case 1:var Y=-1;break;case 2:Y=250;break;case 5:Y=1073741823;break;case 4:Y=1e4;break;default:Y=5e3}return Y=he+Y,ae={id:v++,callback:Ee,priorityLevel:ae,startTime:he,expirationTime:Y,sortIndex:-1},he>j?(ae.sortIndex=he,e(m,ae),t(f)===null&&ae===t(m)&&(U?(K(k),k=-1):U=!0,Ke(ne,he-j))):(ae.sortIndex=Y,e(f,ae),D||S||(D=!0,ie(ue))),ae},n.unstable_shouldYield=V,n.unstable_wrapCallback=function(ae){var Ee=x;return function(){var he=x;x=Ee;try{return ae.apply(this,arguments)}finally{x=he}}}})(Lp)),Lp}var x_;function rk(){return x_||(x_=1,Op.exports=nk()),Op.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var T_;function ik(){if(T_)return hn;T_=1;var n=jm(),e=rk();function t(i){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+i,u=1;u<arguments.length;u++)o+="&args[]="+encodeURIComponent(arguments[u]);return"Minified React error #"+i+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,s={};function a(i,o){l(i,o),l(i+"Capture",o)}function l(i,o){for(s[i]=o,i=0;i<o.length;i++)r.add(o[i])}var d=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),f=Object.prototype.hasOwnProperty,m=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,v={},_={};function x(i){return f.call(_,i)?!0:f.call(v,i)?!1:m.test(i)?_[i]=!0:(v[i]=!0,!1)}function S(i,o,u,h){if(u!==null&&u.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return h?!1:u!==null?!u.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function D(i,o,u,h){if(o===null||typeof o>"u"||S(i,o,u,h))return!0;if(h)return!1;if(u!==null)switch(u.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function U(i,o,u,h,p,y,I){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=h,this.attributeNamespace=p,this.mustUseProperty=u,this.propertyName=i,this.type=o,this.sanitizeURL=y,this.removeEmptyString=I}var L={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){L[i]=new U(i,0,!1,i,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var o=i[0];L[o]=new U(o,1,!1,i[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(i){L[i]=new U(i,2,!1,i.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){L[i]=new U(i,2,!1,i,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){L[i]=new U(i,3,!1,i.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(i){L[i]=new U(i,3,!0,i,null,!1,!1)}),["capture","download"].forEach(function(i){L[i]=new U(i,4,!1,i,null,!1,!1)}),["cols","rows","size","span"].forEach(function(i){L[i]=new U(i,6,!1,i,null,!1,!1)}),["rowSpan","start"].forEach(function(i){L[i]=new U(i,5,!1,i.toLowerCase(),null,!1,!1)});var K=/[\-:]([a-z])/g;function X(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var o=i.replace(K,X);L[o]=new U(o,1,!1,i,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var o=i.replace(K,X);L[o]=new U(o,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(i){var o=i.replace(K,X);L[o]=new U(o,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(i){L[i]=new U(i,1,!1,i.toLowerCase(),null,!1,!1)}),L.xlinkHref=new U("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(i){L[i]=new U(i,1,!1,i.toLowerCase(),null,!0,!0)});function q(i,o,u,h){var p=L.hasOwnProperty(o)?L[o]:null;(p!==null?p.type!==0:h||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(D(o,u,p,h)&&(u=null),h||p===null?x(o)&&(u===null?i.removeAttribute(o):i.setAttribute(o,""+u)):p.mustUseProperty?i[p.propertyName]=u===null?p.type===3?!1:"":u:(o=p.attributeName,h=p.attributeNamespace,u===null?i.removeAttribute(o):(p=p.type,u=p===3||p===4&&u===!0?"":""+u,h?i.setAttributeNS(h,o,u):i.setAttribute(o,u))))}var ne=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ue=Symbol.for("react.element"),ce=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),R=Symbol.for("react.profiler"),P=Symbol.for("react.provider"),V=Symbol.for("react.context"),M=Symbol.for("react.forward_ref"),A=Symbol.for("react.suspense"),Ae=Symbol.for("react.suspense_list"),Xe=Symbol.for("react.memo"),ie=Symbol.for("react.lazy"),Ke=Symbol.for("react.offscreen"),ae=Symbol.iterator;function Ee(i){return i===null||typeof i!="object"?null:(i=ae&&i[ae]||i["@@iterator"],typeof i=="function"?i:null)}var he=Object.assign,j;function Y(i){if(j===void 0)try{throw Error()}catch(u){var o=u.stack.trim().match(/\n( *(at )?)/);j=o&&o[1]||""}return`
`+j+i}var _e=!1;function Re(i,o){if(!i||_e)return"";_e=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(W){var h=W}Reflect.construct(i,[],o)}else{try{o.call()}catch(W){h=W}i.call(o.prototype)}else{try{throw Error()}catch(W){h=W}i()}}catch(W){if(W&&h&&typeof W.stack=="string"){for(var p=W.stack.split(`
`),y=h.stack.split(`
`),I=p.length-1,b=y.length-1;1<=I&&0<=b&&p[I]!==y[b];)b--;for(;1<=I&&0<=b;I--,b--)if(p[I]!==y[b]){if(I!==1||b!==1)do if(I--,b--,0>b||p[I]!==y[b]){var N=`
`+p[I].replace(" at new "," at ");return i.displayName&&N.includes("<anonymous>")&&(N=N.replace("<anonymous>",i.displayName)),N}while(1<=I&&0<=b);break}}}finally{_e=!1,Error.prepareStackTrace=u}return(i=i?i.displayName||i.name:"")?Y(i):""}function Pe(i){switch(i.tag){case 5:return Y(i.type);case 16:return Y("Lazy");case 13:return Y("Suspense");case 19:return Y("SuspenseList");case 0:case 2:case 15:return i=Re(i.type,!1),i;case 11:return i=Re(i.type.render,!1),i;case 1:return i=Re(i.type,!0),i;default:return""}}function Le(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case C:return"Fragment";case ce:return"Portal";case R:return"Profiler";case k:return"StrictMode";case A:return"Suspense";case Ae:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case V:return(i.displayName||"Context")+".Consumer";case P:return(i._context.displayName||"Context")+".Provider";case M:var o=i.render;return i=i.displayName,i||(i=o.displayName||o.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case Xe:return o=i.displayName||null,o!==null?o:Le(i.type)||"Memo";case ie:o=i._payload,i=i._init;try{return Le(i(o))}catch{}}return null}function Be(i){var o=i.type;switch(i.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=o.render,i=i.displayName||i.name||"",o.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Le(o);case 8:return o===k?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function ze(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Ye(i){var o=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function Ct(i){var o=Ye(i)?"checked":"value",u=Object.getOwnPropertyDescriptor(i.constructor.prototype,o),h=""+i[o];if(!i.hasOwnProperty(o)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var p=u.get,y=u.set;return Object.defineProperty(i,o,{configurable:!0,get:function(){return p.call(this)},set:function(I){h=""+I,y.call(this,I)}}),Object.defineProperty(i,o,{enumerable:u.enumerable}),{getValue:function(){return h},setValue:function(I){h=""+I},stopTracking:function(){i._valueTracker=null,delete i[o]}}}}function Fr(i){i._valueTracker||(i._valueTracker=Ct(i))}function Io(i){if(!i)return!1;var o=i._valueTracker;if(!o)return!0;var u=o.getValue(),h="";return i&&(h=Ye(i)?i.checked?"true":"false":i.value),i=h,i!==u?(o.setValue(i),!0):!1}function vi(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function ps(i,o){var u=o.checked;return he({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:u??i._wrapperState.initialChecked})}function xo(i,o){var u=o.defaultValue==null?"":o.defaultValue,h=o.checked!=null?o.checked:o.defaultChecked;u=ze(o.value!=null?o.value:u),i._wrapperState={initialChecked:h,initialValue:u,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function al(i,o){o=o.checked,o!=null&&q(i,"checked",o,!1)}function ll(i,o){al(i,o);var u=ze(o.value),h=o.type;if(u!=null)h==="number"?(u===0&&i.value===""||i.value!=u)&&(i.value=""+u):i.value!==""+u&&(i.value=""+u);else if(h==="submit"||h==="reset"){i.removeAttribute("value");return}o.hasOwnProperty("value")?To(i,o.type,u):o.hasOwnProperty("defaultValue")&&To(i,o.type,ze(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(i.defaultChecked=!!o.defaultChecked)}function ic(i,o,u){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var h=o.type;if(!(h!=="submit"&&h!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+i._wrapperState.initialValue,u||o===i.value||(i.value=o),i.defaultValue=o}u=i.name,u!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,u!==""&&(i.name=u)}function To(i,o,u){(o!=="number"||vi(i.ownerDocument)!==i)&&(u==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+u&&(i.defaultValue=""+u))}var Ur=Array.isArray;function Br(i,o,u,h){if(i=i.options,o){o={};for(var p=0;p<u.length;p++)o["$"+u[p]]=!0;for(u=0;u<i.length;u++)p=o.hasOwnProperty("$"+i[u].value),i[u].selected!==p&&(i[u].selected=p),p&&h&&(i[u].defaultSelected=!0)}else{for(u=""+ze(u),o=null,p=0;p<i.length;p++){if(i[p].value===u){i[p].selected=!0,h&&(i[p].defaultSelected=!0);return}o!==null||i[p].disabled||(o=i[p])}o!==null&&(o.selected=!0)}}function ul(i,o){if(o.dangerouslySetInnerHTML!=null)throw Error(t(91));return he({},o,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function So(i,o){var u=o.value;if(u==null){if(u=o.children,o=o.defaultValue,u!=null){if(o!=null)throw Error(t(92));if(Ur(u)){if(1<u.length)throw Error(t(93));u=u[0]}o=u}o==null&&(o=""),u=o}i._wrapperState={initialValue:ze(u)}}function ko(i,o){var u=ze(o.value),h=ze(o.defaultValue);u!=null&&(u=""+u,u!==i.value&&(i.value=u),o.defaultValue==null&&i.defaultValue!==u&&(i.defaultValue=u)),h!=null&&(i.defaultValue=""+h)}function cl(i){var o=i.textContent;o===i._wrapperState.initialValue&&o!==""&&o!==null&&(i.value=o)}function xt(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Tt(i,o){return i==null||i==="http://www.w3.org/1999/xhtml"?xt(o):i==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var zr,dl=(function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,u,h,p){MSApp.execUnsafeLocalFunction(function(){return i(o,u,h,p)})}:i})(function(i,o){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=o;else{for(zr=zr||document.createElement("div"),zr.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=zr.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;o.firstChild;)i.appendChild(o.firstChild)}});function _i(i,o){if(o){var u=i.firstChild;if(u&&u===i.lastChild&&u.nodeType===3){u.nodeValue=o;return}}i.textContent=o}var ms={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},gs=["Webkit","ms","Moz","O"];Object.keys(ms).forEach(function(i){gs.forEach(function(o){o=o+i.charAt(0).toUpperCase()+i.substring(1),ms[o]=ms[i]})});function hl(i,o,u){return o==null||typeof o=="boolean"||o===""?"":u||typeof o!="number"||o===0||ms.hasOwnProperty(i)&&ms[i]?(""+o).trim():o+"px"}function fl(i,o){i=i.style;for(var u in o)if(o.hasOwnProperty(u)){var h=u.indexOf("--")===0,p=hl(u,o[u],h);u==="float"&&(u="cssFloat"),h?i.setProperty(u,p):i[u]=p}}var pl=he({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ml(i,o){if(o){if(pl[i]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(t(137,i));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(t(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(t(61))}if(o.style!=null&&typeof o.style!="object")throw Error(t(62))}}function gl(i,o){if(i.indexOf("-")===-1)return typeof o.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ys=null;function bo(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Ao=null,bn=null,pr=null;function Ro(i){if(i=Ul(i)){if(typeof Ao!="function")throw Error(t(280));var o=i.stateNode;o&&(o=Vc(o),Ao(i.stateNode,i.type,o))}}function mr(i){bn?pr?pr.push(i):pr=[i]:bn=i}function yl(){if(bn){var i=bn,o=pr;if(pr=bn=null,Ro(i),o)for(i=0;i<o.length;i++)Ro(o[i])}}function vs(i,o){return i(o)}function vl(){}var $r=!1;function _l(i,o,u){if($r)return i(o,u);$r=!0;try{return vs(i,o,u)}finally{$r=!1,(bn!==null||pr!==null)&&(vl(),yl())}}function pt(i,o){var u=i.stateNode;if(u===null)return null;var h=Vc(u);if(h===null)return null;u=h[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(i=i.type,h=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!h;break e;default:i=!1}if(i)return null;if(u&&typeof u!="function")throw Error(t(231,o,typeof u));return u}var Co=!1;if(d)try{var qn={};Object.defineProperty(qn,"passive",{get:function(){Co=!0}}),window.addEventListener("test",qn,qn),window.removeEventListener("test",qn,qn)}catch{Co=!1}function _s(i,o,u,h,p,y,I,b,N){var W=Array.prototype.slice.call(arguments,3);try{o.apply(u,W)}catch(Z){this.onError(Z)}}var ws=!1,Po=null,Hn=!1,wl=null,of={onError:function(i){ws=!0,Po=i}};function No(i,o,u,h,p,y,I,b,N){ws=!1,Po=null,_s.apply(of,arguments)}function sc(i,o,u,h,p,y,I,b,N){if(No.apply(this,arguments),ws){if(ws){var W=Po;ws=!1,Po=null}else throw Error(t(198));Hn||(Hn=!0,wl=W)}}function Wn(i){var o=i,u=i;if(i.alternate)for(;o.return;)o=o.return;else{i=o;do o=i,(o.flags&4098)!==0&&(u=o.return),i=o.return;while(i)}return o.tag===3?u:null}function Es(i){if(i.tag===13){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function Gn(i){if(Wn(i)!==i)throw Error(t(188))}function oc(i){var o=i.alternate;if(!o){if(o=Wn(i),o===null)throw Error(t(188));return o!==i?null:i}for(var u=i,h=o;;){var p=u.return;if(p===null)break;var y=p.alternate;if(y===null){if(h=p.return,h!==null){u=h;continue}break}if(p.child===y.child){for(y=p.child;y;){if(y===u)return Gn(p),i;if(y===h)return Gn(p),o;y=y.sibling}throw Error(t(188))}if(u.return!==h.return)u=p,h=y;else{for(var I=!1,b=p.child;b;){if(b===u){I=!0,u=p,h=y;break}if(b===h){I=!0,h=p,u=y;break}b=b.sibling}if(!I){for(b=y.child;b;){if(b===u){I=!0,u=y,h=p;break}if(b===h){I=!0,h=y,u=p;break}b=b.sibling}if(!I)throw Error(t(189))}}if(u.alternate!==h)throw Error(t(190))}if(u.tag!==3)throw Error(t(188));return u.stateNode.current===u?i:o}function El(i){return i=oc(i),i!==null?Do(i):null}function Do(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var o=Do(i);if(o!==null)return o;i=i.sibling}return null}var Vo=e.unstable_scheduleCallback,Il=e.unstable_cancelCallback,ac=e.unstable_shouldYield,af=e.unstable_requestPaint,Je=e.unstable_now,lc=e.unstable_getCurrentPriorityLevel,Is=e.unstable_ImmediatePriority,wi=e.unstable_UserBlockingPriority,An=e.unstable_NormalPriority,xl=e.unstable_LowPriority,uc=e.unstable_IdlePriority,xs=null,mn=null;function cc(i){if(mn&&typeof mn.onCommitFiberRoot=="function")try{mn.onCommitFiberRoot(xs,i,void 0,(i.current.flags&128)===128)}catch{}}var Yt=Math.clz32?Math.clz32:hc,Tl=Math.log,dc=Math.LN2;function hc(i){return i>>>=0,i===0?32:31-(Tl(i)/dc|0)|0}var Oo=64,Lo=4194304;function Ei(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function Ts(i,o){var u=i.pendingLanes;if(u===0)return 0;var h=0,p=i.suspendedLanes,y=i.pingedLanes,I=u&268435455;if(I!==0){var b=I&~p;b!==0?h=Ei(b):(y&=I,y!==0&&(h=Ei(y)))}else I=u&~p,I!==0?h=Ei(I):y!==0&&(h=Ei(y));if(h===0)return 0;if(o!==0&&o!==h&&(o&p)===0&&(p=h&-h,y=o&-o,p>=y||p===16&&(y&4194240)!==0))return o;if((h&4)!==0&&(h|=u&16),o=i.entangledLanes,o!==0)for(i=i.entanglements,o&=h;0<o;)u=31-Yt(o),p=1<<u,h|=i[u],o&=~p;return h}function lf(i,o){switch(i){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function qr(i,o){for(var u=i.suspendedLanes,h=i.pingedLanes,p=i.expirationTimes,y=i.pendingLanes;0<y;){var I=31-Yt(y),b=1<<I,N=p[I];N===-1?((b&u)===0||(b&h)!==0)&&(p[I]=lf(b,o)):N<=o&&(i.expiredLanes|=b),y&=~b}}function gn(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function Ss(){var i=Oo;return Oo<<=1,(Oo&4194240)===0&&(Oo=64),i}function Ii(i){for(var o=[],u=0;31>u;u++)o.push(i);return o}function xi(i,o,u){i.pendingLanes|=o,o!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,o=31-Yt(o),i[o]=u}function Qe(i,o){var u=i.pendingLanes&~o;i.pendingLanes=o,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=o,i.mutableReadLanes&=o,i.entangledLanes&=o,o=i.entanglements;var h=i.eventTimes;for(i=i.expirationTimes;0<u;){var p=31-Yt(u),y=1<<p;o[p]=0,h[p]=-1,i[p]=-1,u&=~y}}function Ti(i,o){var u=i.entangledLanes|=o;for(i=i.entanglements;u;){var h=31-Yt(u),p=1<<h;p&o|i[h]&o&&(i[h]|=o),u&=~p}}var Oe=0;function Si(i){return i&=-i,1<i?4<i?(i&268435455)!==0?16:536870912:4:1}var fc,Mo,pc,mc,gc,Sl=!1,gr=[],Lt=null,Kn=null,Qn=null,ki=new Map,Rn=new Map,yr=[],uf="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function yc(i,o){switch(i){case"focusin":case"focusout":Lt=null;break;case"dragenter":case"dragleave":Kn=null;break;case"mouseover":case"mouseout":Qn=null;break;case"pointerover":case"pointerout":ki.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rn.delete(o.pointerId)}}function sn(i,o,u,h,p,y){return i===null||i.nativeEvent!==y?(i={blockedOn:o,domEventName:u,eventSystemFlags:h,nativeEvent:y,targetContainers:[p]},o!==null&&(o=Ul(o),o!==null&&Mo(o)),i):(i.eventSystemFlags|=h,o=i.targetContainers,p!==null&&o.indexOf(p)===-1&&o.push(p),i)}function cf(i,o,u,h,p){switch(o){case"focusin":return Lt=sn(Lt,i,o,u,h,p),!0;case"dragenter":return Kn=sn(Kn,i,o,u,h,p),!0;case"mouseover":return Qn=sn(Qn,i,o,u,h,p),!0;case"pointerover":var y=p.pointerId;return ki.set(y,sn(ki.get(y)||null,i,o,u,h,p)),!0;case"gotpointercapture":return y=p.pointerId,Rn.set(y,sn(Rn.get(y)||null,i,o,u,h,p)),!0}return!1}function vc(i){var o=Cs(i.target);if(o!==null){var u=Wn(o);if(u!==null){if(o=u.tag,o===13){if(o=Es(u),o!==null){i.blockedOn=o,gc(i.priority,function(){pc(u)});return}}else if(o===3&&u.stateNode.current.memoizedState.isDehydrated){i.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Hr(i){if(i.blockedOn!==null)return!1;for(var o=i.targetContainers;0<o.length;){var u=jo(i.domEventName,i.eventSystemFlags,o[0],i.nativeEvent);if(u===null){u=i.nativeEvent;var h=new u.constructor(u.type,u);ys=h,u.target.dispatchEvent(h),ys=null}else return o=Ul(u),o!==null&&Mo(o),i.blockedOn=u,!1;o.shift()}return!0}function ks(i,o,u){Hr(i)&&u.delete(o)}function _c(){Sl=!1,Lt!==null&&Hr(Lt)&&(Lt=null),Kn!==null&&Hr(Kn)&&(Kn=null),Qn!==null&&Hr(Qn)&&(Qn=null),ki.forEach(ks),Rn.forEach(ks)}function Xn(i,o){i.blockedOn===o&&(i.blockedOn=null,Sl||(Sl=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,_c)))}function Yn(i){function o(p){return Xn(p,i)}if(0<gr.length){Xn(gr[0],i);for(var u=1;u<gr.length;u++){var h=gr[u];h.blockedOn===i&&(h.blockedOn=null)}}for(Lt!==null&&Xn(Lt,i),Kn!==null&&Xn(Kn,i),Qn!==null&&Xn(Qn,i),ki.forEach(o),Rn.forEach(o),u=0;u<yr.length;u++)h=yr[u],h.blockedOn===i&&(h.blockedOn=null);for(;0<yr.length&&(u=yr[0],u.blockedOn===null);)vc(u),u.blockedOn===null&&yr.shift()}var Wr=ne.ReactCurrentBatchConfig,bi=!0;function nt(i,o,u,h){var p=Oe,y=Wr.transition;Wr.transition=null;try{Oe=1,kl(i,o,u,h)}finally{Oe=p,Wr.transition=y}}function df(i,o,u,h){var p=Oe,y=Wr.transition;Wr.transition=null;try{Oe=4,kl(i,o,u,h)}finally{Oe=p,Wr.transition=y}}function kl(i,o,u,h){if(bi){var p=jo(i,o,u,h);if(p===null)If(i,o,h,bs,u),yc(i,h);else if(cf(p,i,o,u,h))h.stopPropagation();else if(yc(i,h),o&4&&-1<uf.indexOf(i)){for(;p!==null;){var y=Ul(p);if(y!==null&&fc(y),y=jo(i,o,u,h),y===null&&If(i,o,h,bs,u),y===p)break;p=y}p!==null&&h.stopPropagation()}else If(i,o,h,null,u)}}var bs=null;function jo(i,o,u,h){if(bs=null,i=bo(h),i=Cs(i),i!==null)if(o=Wn(i),o===null)i=null;else if(u=o.tag,u===13){if(i=Es(o),i!==null)return i;i=null}else if(u===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;i=null}else o!==i&&(i=null);return bs=i,null}function bl(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(lc()){case Is:return 1;case wi:return 4;case An:case xl:return 16;case uc:return 536870912;default:return 16}default:return 16}}var yn=null,Fo=null,on=null;function Al(){if(on)return on;var i,o=Fo,u=o.length,h,p="value"in yn?yn.value:yn.textContent,y=p.length;for(i=0;i<u&&o[i]===p[i];i++);var I=u-i;for(h=1;h<=I&&o[u-h]===p[y-h];h++);return on=p.slice(i,1<h?1-h:void 0)}function Uo(i){var o=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&o===13&&(i=13)):i=o,i===10&&(i=13),32<=i||i===13?i:0}function vr(){return!0}function Rl(){return!1}function Mt(i){function o(u,h,p,y,I){this._reactName=u,this._targetInst=p,this.type=h,this.nativeEvent=y,this.target=I,this.currentTarget=null;for(var b in i)i.hasOwnProperty(b)&&(u=i[b],this[b]=u?u(y):y[b]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?vr:Rl,this.isPropagationStopped=Rl,this}return he(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=vr)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=vr)},persist:function(){},isPersistent:vr}),o}var Jn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Bo=Mt(Jn),_r=he({},Jn,{view:0,detail:0}),hf=Mt(_r),zo,Gr,Ai,As=he({},_r,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:wr,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Ai&&(Ai&&i.type==="mousemove"?(zo=i.screenX-Ai.screenX,Gr=i.screenY-Ai.screenY):Gr=zo=0,Ai=i),zo)},movementY:function(i){return"movementY"in i?i.movementY:Gr}}),$o=Mt(As),Cl=he({},As,{dataTransfer:0}),wc=Mt(Cl),qo=he({},_r,{relatedTarget:0}),Ho=Mt(qo),Ec=he({},Jn,{animationName:0,elapsedTime:0,pseudoElement:0}),Kr=Mt(Ec),Ic=he({},Jn,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),xc=Mt(Ic),Tc=he({},Jn,{data:0}),Pl=Mt(Tc),Wo={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Jt={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Sc={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function kc(i){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(i):(i=Sc[i])?!!o[i]:!1}function wr(){return kc}var c=he({},_r,{key:function(i){if(i.key){var o=Wo[i.key]||i.key;if(o!=="Unidentified")return o}return i.type==="keypress"?(i=Uo(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?Jt[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:wr,charCode:function(i){return i.type==="keypress"?Uo(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Uo(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),g=Mt(c),w=he({},As,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),T=Mt(w),B=he({},_r,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:wr}),G=Mt(B),oe=he({},Jn,{propertyName:0,elapsedTime:0,pseudoElement:0}),qe=Mt(oe),St=he({},As,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Me=Mt(St),Pt=[9,13,27,32],gt=d&&"CompositionEvent"in window,Cn=null;d&&"documentMode"in document&&(Cn=document.documentMode);var vn=d&&"TextEvent"in window&&!Cn,Rs=d&&(!gt||Cn&&8<Cn&&11>=Cn),Go=" ",hy=!1;function fy(i,o){switch(i){case"keyup":return Pt.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function py(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Ko=!1;function XT(i,o){switch(i){case"compositionend":return py(o);case"keypress":return o.which!==32?null:(hy=!0,Go);case"textInput":return i=o.data,i===Go&&hy?null:i;default:return null}}function YT(i,o){if(Ko)return i==="compositionend"||!gt&&fy(i,o)?(i=Al(),on=Fo=yn=null,Ko=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Rs&&o.locale!=="ko"?null:o.data;default:return null}}var JT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function my(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o==="input"?!!JT[i.type]:o==="textarea"}function gy(i,o,u,h){mr(h),o=Pc(o,"onChange"),0<o.length&&(u=new Bo("onChange","change",null,u,h),i.push({event:u,listeners:o}))}var Nl=null,Dl=null;function ZT(i){Vy(i,0)}function bc(i){var o=Zo(i);if(Io(o))return i}function eS(i,o){if(i==="change")return o}var yy=!1;if(d){var ff;if(d){var pf="oninput"in document;if(!pf){var vy=document.createElement("div");vy.setAttribute("oninput","return;"),pf=typeof vy.oninput=="function"}ff=pf}else ff=!1;yy=ff&&(!document.documentMode||9<document.documentMode)}function _y(){Nl&&(Nl.detachEvent("onpropertychange",wy),Dl=Nl=null)}function wy(i){if(i.propertyName==="value"&&bc(Dl)){var o=[];gy(o,Dl,i,bo(i)),_l(ZT,o)}}function tS(i,o,u){i==="focusin"?(_y(),Nl=o,Dl=u,Nl.attachEvent("onpropertychange",wy)):i==="focusout"&&_y()}function nS(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return bc(Dl)}function rS(i,o){if(i==="click")return bc(o)}function iS(i,o){if(i==="input"||i==="change")return bc(o)}function sS(i,o){return i===o&&(i!==0||1/i===1/o)||i!==i&&o!==o}var Zn=typeof Object.is=="function"?Object.is:sS;function Vl(i,o){if(Zn(i,o))return!0;if(typeof i!="object"||i===null||typeof o!="object"||o===null)return!1;var u=Object.keys(i),h=Object.keys(o);if(u.length!==h.length)return!1;for(h=0;h<u.length;h++){var p=u[h];if(!f.call(o,p)||!Zn(i[p],o[p]))return!1}return!0}function Ey(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Iy(i,o){var u=Ey(i);i=0;for(var h;u;){if(u.nodeType===3){if(h=i+u.textContent.length,i<=o&&h>=o)return{node:u,offset:o-i};i=h}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=Ey(u)}}function xy(i,o){return i&&o?i===o?!0:i&&i.nodeType===3?!1:o&&o.nodeType===3?xy(i,o.parentNode):"contains"in i?i.contains(o):i.compareDocumentPosition?!!(i.compareDocumentPosition(o)&16):!1:!1}function Ty(){for(var i=window,o=vi();o instanceof i.HTMLIFrameElement;){try{var u=typeof o.contentWindow.location.href=="string"}catch{u=!1}if(u)i=o.contentWindow;else break;o=vi(i.document)}return o}function mf(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o&&(o==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||o==="textarea"||i.contentEditable==="true")}function oS(i){var o=Ty(),u=i.focusedElem,h=i.selectionRange;if(o!==u&&u&&u.ownerDocument&&xy(u.ownerDocument.documentElement,u)){if(h!==null&&mf(u)){if(o=h.start,i=h.end,i===void 0&&(i=o),"selectionStart"in u)u.selectionStart=o,u.selectionEnd=Math.min(i,u.value.length);else if(i=(o=u.ownerDocument||document)&&o.defaultView||window,i.getSelection){i=i.getSelection();var p=u.textContent.length,y=Math.min(h.start,p);h=h.end===void 0?y:Math.min(h.end,p),!i.extend&&y>h&&(p=h,h=y,y=p),p=Iy(u,y);var I=Iy(u,h);p&&I&&(i.rangeCount!==1||i.anchorNode!==p.node||i.anchorOffset!==p.offset||i.focusNode!==I.node||i.focusOffset!==I.offset)&&(o=o.createRange(),o.setStart(p.node,p.offset),i.removeAllRanges(),y>h?(i.addRange(o),i.extend(I.node,I.offset)):(o.setEnd(I.node,I.offset),i.addRange(o)))}}for(o=[],i=u;i=i.parentNode;)i.nodeType===1&&o.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof u.focus=="function"&&u.focus(),u=0;u<o.length;u++)i=o[u],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var aS=d&&"documentMode"in document&&11>=document.documentMode,Qo=null,gf=null,Ol=null,yf=!1;function Sy(i,o,u){var h=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;yf||Qo==null||Qo!==vi(h)||(h=Qo,"selectionStart"in h&&mf(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),Ol&&Vl(Ol,h)||(Ol=h,h=Pc(gf,"onSelect"),0<h.length&&(o=new Bo("onSelect","select",null,o,u),i.push({event:o,listeners:h}),o.target=Qo)))}function Ac(i,o){var u={};return u[i.toLowerCase()]=o.toLowerCase(),u["Webkit"+i]="webkit"+o,u["Moz"+i]="moz"+o,u}var Xo={animationend:Ac("Animation","AnimationEnd"),animationiteration:Ac("Animation","AnimationIteration"),animationstart:Ac("Animation","AnimationStart"),transitionend:Ac("Transition","TransitionEnd")},vf={},ky={};d&&(ky=document.createElement("div").style,"AnimationEvent"in window||(delete Xo.animationend.animation,delete Xo.animationiteration.animation,delete Xo.animationstart.animation),"TransitionEvent"in window||delete Xo.transitionend.transition);function Rc(i){if(vf[i])return vf[i];if(!Xo[i])return i;var o=Xo[i],u;for(u in o)if(o.hasOwnProperty(u)&&u in ky)return vf[i]=o[u];return i}var by=Rc("animationend"),Ay=Rc("animationiteration"),Ry=Rc("animationstart"),Cy=Rc("transitionend"),Py=new Map,Ny="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ri(i,o){Py.set(i,o),a(o,[i])}for(var _f=0;_f<Ny.length;_f++){var wf=Ny[_f],lS=wf.toLowerCase(),uS=wf[0].toUpperCase()+wf.slice(1);Ri(lS,"on"+uS)}Ri(by,"onAnimationEnd"),Ri(Ay,"onAnimationIteration"),Ri(Ry,"onAnimationStart"),Ri("dblclick","onDoubleClick"),Ri("focusin","onFocus"),Ri("focusout","onBlur"),Ri(Cy,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ll="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),cS=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ll));function Dy(i,o,u){var h=i.type||"unknown-event";i.currentTarget=u,sc(h,o,void 0,i),i.currentTarget=null}function Vy(i,o){o=(o&4)!==0;for(var u=0;u<i.length;u++){var h=i[u],p=h.event;h=h.listeners;e:{var y=void 0;if(o)for(var I=h.length-1;0<=I;I--){var b=h[I],N=b.instance,W=b.currentTarget;if(b=b.listener,N!==y&&p.isPropagationStopped())break e;Dy(p,b,W),y=N}else for(I=0;I<h.length;I++){if(b=h[I],N=b.instance,W=b.currentTarget,b=b.listener,N!==y&&p.isPropagationStopped())break e;Dy(p,b,W),y=N}}}if(Hn)throw i=wl,Hn=!1,wl=null,i}function et(i,o){var u=o[Af];u===void 0&&(u=o[Af]=new Set);var h=i+"__bubble";u.has(h)||(Oy(o,i,2,!1),u.add(h))}function Ef(i,o,u){var h=0;o&&(h|=4),Oy(u,i,h,o)}var Cc="_reactListening"+Math.random().toString(36).slice(2);function Ml(i){if(!i[Cc]){i[Cc]=!0,r.forEach(function(u){u!=="selectionchange"&&(cS.has(u)||Ef(u,!1,i),Ef(u,!0,i))});var o=i.nodeType===9?i:i.ownerDocument;o===null||o[Cc]||(o[Cc]=!0,Ef("selectionchange",!1,o))}}function Oy(i,o,u,h){switch(bl(o)){case 1:var p=nt;break;case 4:p=df;break;default:p=kl}u=p.bind(null,o,u,i),p=void 0,!Co||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(p=!0),h?p!==void 0?i.addEventListener(o,u,{capture:!0,passive:p}):i.addEventListener(o,u,!0):p!==void 0?i.addEventListener(o,u,{passive:p}):i.addEventListener(o,u,!1)}function If(i,o,u,h,p){var y=h;if((o&1)===0&&(o&2)===0&&h!==null)e:for(;;){if(h===null)return;var I=h.tag;if(I===3||I===4){var b=h.stateNode.containerInfo;if(b===p||b.nodeType===8&&b.parentNode===p)break;if(I===4)for(I=h.return;I!==null;){var N=I.tag;if((N===3||N===4)&&(N=I.stateNode.containerInfo,N===p||N.nodeType===8&&N.parentNode===p))return;I=I.return}for(;b!==null;){if(I=Cs(b),I===null)return;if(N=I.tag,N===5||N===6){h=y=I;continue e}b=b.parentNode}}h=h.return}_l(function(){var W=y,Z=bo(u),ee=[];e:{var J=Py.get(i);if(J!==void 0){var de=Bo,pe=i;switch(i){case"keypress":if(Uo(u)===0)break e;case"keydown":case"keyup":de=g;break;case"focusin":pe="focus",de=Ho;break;case"focusout":pe="blur",de=Ho;break;case"beforeblur":case"afterblur":de=Ho;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":de=$o;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":de=wc;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":de=G;break;case by:case Ay:case Ry:de=Kr;break;case Cy:de=qe;break;case"scroll":de=hf;break;case"wheel":de=Me;break;case"copy":case"cut":case"paste":de=xc;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":de=T}var ge=(o&4)!==0,mt=!ge&&i==="scroll",$=ge?J!==null?J+"Capture":null:J;ge=[];for(var O=W,H;O!==null;){H=O;var re=H.stateNode;if(H.tag===5&&re!==null&&(H=re,$!==null&&(re=pt(O,$),re!=null&&ge.push(jl(O,re,H)))),mt)break;O=O.return}0<ge.length&&(J=new de(J,pe,null,u,Z),ee.push({event:J,listeners:ge}))}}if((o&7)===0){e:{if(J=i==="mouseover"||i==="pointerover",de=i==="mouseout"||i==="pointerout",J&&u!==ys&&(pe=u.relatedTarget||u.fromElement)&&(Cs(pe)||pe[Qr]))break e;if((de||J)&&(J=Z.window===Z?Z:(J=Z.ownerDocument)?J.defaultView||J.parentWindow:window,de?(pe=u.relatedTarget||u.toElement,de=W,pe=pe?Cs(pe):null,pe!==null&&(mt=Wn(pe),pe!==mt||pe.tag!==5&&pe.tag!==6)&&(pe=null)):(de=null,pe=W),de!==pe)){if(ge=$o,re="onMouseLeave",$="onMouseEnter",O="mouse",(i==="pointerout"||i==="pointerover")&&(ge=T,re="onPointerLeave",$="onPointerEnter",O="pointer"),mt=de==null?J:Zo(de),H=pe==null?J:Zo(pe),J=new ge(re,O+"leave",de,u,Z),J.target=mt,J.relatedTarget=H,re=null,Cs(Z)===W&&(ge=new ge($,O+"enter",pe,u,Z),ge.target=H,ge.relatedTarget=mt,re=ge),mt=re,de&&pe)t:{for(ge=de,$=pe,O=0,H=ge;H;H=Yo(H))O++;for(H=0,re=$;re;re=Yo(re))H++;for(;0<O-H;)ge=Yo(ge),O--;for(;0<H-O;)$=Yo($),H--;for(;O--;){if(ge===$||$!==null&&ge===$.alternate)break t;ge=Yo(ge),$=Yo($)}ge=null}else ge=null;de!==null&&Ly(ee,J,de,ge,!1),pe!==null&&mt!==null&&Ly(ee,mt,pe,ge,!0)}}e:{if(J=W?Zo(W):window,de=J.nodeName&&J.nodeName.toLowerCase(),de==="select"||de==="input"&&J.type==="file")var ye=eS;else if(my(J))if(yy)ye=iS;else{ye=nS;var Ie=tS}else(de=J.nodeName)&&de.toLowerCase()==="input"&&(J.type==="checkbox"||J.type==="radio")&&(ye=rS);if(ye&&(ye=ye(i,W))){gy(ee,ye,u,Z);break e}Ie&&Ie(i,J,W),i==="focusout"&&(Ie=J._wrapperState)&&Ie.controlled&&J.type==="number"&&To(J,"number",J.value)}switch(Ie=W?Zo(W):window,i){case"focusin":(my(Ie)||Ie.contentEditable==="true")&&(Qo=Ie,gf=W,Ol=null);break;case"focusout":Ol=gf=Qo=null;break;case"mousedown":yf=!0;break;case"contextmenu":case"mouseup":case"dragend":yf=!1,Sy(ee,u,Z);break;case"selectionchange":if(aS)break;case"keydown":case"keyup":Sy(ee,u,Z)}var xe;if(gt)e:{switch(i){case"compositionstart":var Se="onCompositionStart";break e;case"compositionend":Se="onCompositionEnd";break e;case"compositionupdate":Se="onCompositionUpdate";break e}Se=void 0}else Ko?fy(i,u)&&(Se="onCompositionEnd"):i==="keydown"&&u.keyCode===229&&(Se="onCompositionStart");Se&&(Rs&&u.locale!=="ko"&&(Ko||Se!=="onCompositionStart"?Se==="onCompositionEnd"&&Ko&&(xe=Al()):(yn=Z,Fo="value"in yn?yn.value:yn.textContent,Ko=!0)),Ie=Pc(W,Se),0<Ie.length&&(Se=new Pl(Se,i,null,u,Z),ee.push({event:Se,listeners:Ie}),xe?Se.data=xe:(xe=py(u),xe!==null&&(Se.data=xe)))),(xe=vn?XT(i,u):YT(i,u))&&(W=Pc(W,"onBeforeInput"),0<W.length&&(Z=new Pl("onBeforeInput","beforeinput",null,u,Z),ee.push({event:Z,listeners:W}),Z.data=xe))}Vy(ee,o)})}function jl(i,o,u){return{instance:i,listener:o,currentTarget:u}}function Pc(i,o){for(var u=o+"Capture",h=[];i!==null;){var p=i,y=p.stateNode;p.tag===5&&y!==null&&(p=y,y=pt(i,u),y!=null&&h.unshift(jl(i,y,p)),y=pt(i,o),y!=null&&h.push(jl(i,y,p))),i=i.return}return h}function Yo(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function Ly(i,o,u,h,p){for(var y=o._reactName,I=[];u!==null&&u!==h;){var b=u,N=b.alternate,W=b.stateNode;if(N!==null&&N===h)break;b.tag===5&&W!==null&&(b=W,p?(N=pt(u,y),N!=null&&I.unshift(jl(u,N,b))):p||(N=pt(u,y),N!=null&&I.push(jl(u,N,b)))),u=u.return}I.length!==0&&i.push({event:o,listeners:I})}var dS=/\r\n?/g,hS=/\u0000|\uFFFD/g;function My(i){return(typeof i=="string"?i:""+i).replace(dS,`
`).replace(hS,"")}function Nc(i,o,u){if(o=My(o),My(i)!==o&&u)throw Error(t(425))}function Dc(){}var xf=null,Tf=null;function Sf(i,o){return i==="textarea"||i==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var kf=typeof setTimeout=="function"?setTimeout:void 0,fS=typeof clearTimeout=="function"?clearTimeout:void 0,jy=typeof Promise=="function"?Promise:void 0,pS=typeof queueMicrotask=="function"?queueMicrotask:typeof jy<"u"?function(i){return jy.resolve(null).then(i).catch(mS)}:kf;function mS(i){setTimeout(function(){throw i})}function bf(i,o){var u=o,h=0;do{var p=u.nextSibling;if(i.removeChild(u),p&&p.nodeType===8)if(u=p.data,u==="/$"){if(h===0){i.removeChild(p),Yn(o);return}h--}else u!=="$"&&u!=="$?"&&u!=="$!"||h++;u=p}while(u);Yn(o)}function Ci(i){for(;i!=null;i=i.nextSibling){var o=i.nodeType;if(o===1||o===3)break;if(o===8){if(o=i.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return i}function Fy(i){i=i.previousSibling;for(var o=0;i;){if(i.nodeType===8){var u=i.data;if(u==="$"||u==="$!"||u==="$?"){if(o===0)return i;o--}else u==="/$"&&o++}i=i.previousSibling}return null}var Jo=Math.random().toString(36).slice(2),Er="__reactFiber$"+Jo,Fl="__reactProps$"+Jo,Qr="__reactContainer$"+Jo,Af="__reactEvents$"+Jo,gS="__reactListeners$"+Jo,yS="__reactHandles$"+Jo;function Cs(i){var o=i[Er];if(o)return o;for(var u=i.parentNode;u;){if(o=u[Qr]||u[Er]){if(u=o.alternate,o.child!==null||u!==null&&u.child!==null)for(i=Fy(i);i!==null;){if(u=i[Er])return u;i=Fy(i)}return o}i=u,u=i.parentNode}return null}function Ul(i){return i=i[Er]||i[Qr],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function Zo(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(t(33))}function Vc(i){return i[Fl]||null}var Rf=[],ea=-1;function Pi(i){return{current:i}}function tt(i){0>ea||(i.current=Rf[ea],Rf[ea]=null,ea--)}function Ze(i,o){ea++,Rf[ea]=i.current,i.current=o}var Ni={},zt=Pi(Ni),an=Pi(!1),Ps=Ni;function ta(i,o){var u=i.type.contextTypes;if(!u)return Ni;var h=i.stateNode;if(h&&h.__reactInternalMemoizedUnmaskedChildContext===o)return h.__reactInternalMemoizedMaskedChildContext;var p={},y;for(y in u)p[y]=o[y];return h&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=o,i.__reactInternalMemoizedMaskedChildContext=p),p}function ln(i){return i=i.childContextTypes,i!=null}function Oc(){tt(an),tt(zt)}function Uy(i,o,u){if(zt.current!==Ni)throw Error(t(168));Ze(zt,o),Ze(an,u)}function By(i,o,u){var h=i.stateNode;if(o=o.childContextTypes,typeof h.getChildContext!="function")return u;h=h.getChildContext();for(var p in h)if(!(p in o))throw Error(t(108,Be(i)||"Unknown",p));return he({},u,h)}function Lc(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||Ni,Ps=zt.current,Ze(zt,i),Ze(an,an.current),!0}function zy(i,o,u){var h=i.stateNode;if(!h)throw Error(t(169));u?(i=By(i,o,Ps),h.__reactInternalMemoizedMergedChildContext=i,tt(an),tt(zt),Ze(zt,i)):tt(an),Ze(an,u)}var Xr=null,Mc=!1,Cf=!1;function $y(i){Xr===null?Xr=[i]:Xr.push(i)}function vS(i){Mc=!0,$y(i)}function Di(){if(!Cf&&Xr!==null){Cf=!0;var i=0,o=Oe;try{var u=Xr;for(Oe=1;i<u.length;i++){var h=u[i];do h=h(!0);while(h!==null)}Xr=null,Mc=!1}catch(p){throw Xr!==null&&(Xr=Xr.slice(i+1)),Vo(Is,Di),p}finally{Oe=o,Cf=!1}}return null}var na=[],ra=0,jc=null,Fc=0,Pn=[],Nn=0,Ns=null,Yr=1,Jr="";function Ds(i,o){na[ra++]=Fc,na[ra++]=jc,jc=i,Fc=o}function qy(i,o,u){Pn[Nn++]=Yr,Pn[Nn++]=Jr,Pn[Nn++]=Ns,Ns=i;var h=Yr;i=Jr;var p=32-Yt(h)-1;h&=~(1<<p),u+=1;var y=32-Yt(o)+p;if(30<y){var I=p-p%5;y=(h&(1<<I)-1).toString(32),h>>=I,p-=I,Yr=1<<32-Yt(o)+p|u<<p|h,Jr=y+i}else Yr=1<<y|u<<p|h,Jr=i}function Pf(i){i.return!==null&&(Ds(i,1),qy(i,1,0))}function Nf(i){for(;i===jc;)jc=na[--ra],na[ra]=null,Fc=na[--ra],na[ra]=null;for(;i===Ns;)Ns=Pn[--Nn],Pn[Nn]=null,Jr=Pn[--Nn],Pn[Nn]=null,Yr=Pn[--Nn],Pn[Nn]=null}var _n=null,wn=null,rt=!1,er=null;function Hy(i,o){var u=Ln(5,null,null,0);u.elementType="DELETED",u.stateNode=o,u.return=i,o=i.deletions,o===null?(i.deletions=[u],i.flags|=16):o.push(u)}function Wy(i,o){switch(i.tag){case 5:var u=i.type;return o=o.nodeType!==1||u.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(i.stateNode=o,_n=i,wn=Ci(o.firstChild),!0):!1;case 6:return o=i.pendingProps===""||o.nodeType!==3?null:o,o!==null?(i.stateNode=o,_n=i,wn=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(u=Ns!==null?{id:Yr,overflow:Jr}:null,i.memoizedState={dehydrated:o,treeContext:u,retryLane:1073741824},u=Ln(18,null,null,0),u.stateNode=o,u.return=i,i.child=u,_n=i,wn=null,!0):!1;default:return!1}}function Df(i){return(i.mode&1)!==0&&(i.flags&128)===0}function Vf(i){if(rt){var o=wn;if(o){var u=o;if(!Wy(i,o)){if(Df(i))throw Error(t(418));o=Ci(u.nextSibling);var h=_n;o&&Wy(i,o)?Hy(h,u):(i.flags=i.flags&-4097|2,rt=!1,_n=i)}}else{if(Df(i))throw Error(t(418));i.flags=i.flags&-4097|2,rt=!1,_n=i}}}function Gy(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;_n=i}function Uc(i){if(i!==_n)return!1;if(!rt)return Gy(i),rt=!0,!1;var o;if((o=i.tag!==3)&&!(o=i.tag!==5)&&(o=i.type,o=o!=="head"&&o!=="body"&&!Sf(i.type,i.memoizedProps)),o&&(o=wn)){if(Df(i))throw Ky(),Error(t(418));for(;o;)Hy(i,o),o=Ci(o.nextSibling)}if(Gy(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(t(317));e:{for(i=i.nextSibling,o=0;i;){if(i.nodeType===8){var u=i.data;if(u==="/$"){if(o===0){wn=Ci(i.nextSibling);break e}o--}else u!=="$"&&u!=="$!"&&u!=="$?"||o++}i=i.nextSibling}wn=null}}else wn=_n?Ci(i.stateNode.nextSibling):null;return!0}function Ky(){for(var i=wn;i;)i=Ci(i.nextSibling)}function ia(){wn=_n=null,rt=!1}function Of(i){er===null?er=[i]:er.push(i)}var _S=ne.ReactCurrentBatchConfig;function Bl(i,o,u){if(i=u.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(u._owner){if(u=u._owner,u){if(u.tag!==1)throw Error(t(309));var h=u.stateNode}if(!h)throw Error(t(147,i));var p=h,y=""+i;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===y?o.ref:(o=function(I){var b=p.refs;I===null?delete b[y]:b[y]=I},o._stringRef=y,o)}if(typeof i!="string")throw Error(t(284));if(!u._owner)throw Error(t(290,i))}return i}function Bc(i,o){throw i=Object.prototype.toString.call(o),Error(t(31,i==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":i))}function Qy(i){var o=i._init;return o(i._payload)}function Xy(i){function o($,O){if(i){var H=$.deletions;H===null?($.deletions=[O],$.flags|=16):H.push(O)}}function u($,O){if(!i)return null;for(;O!==null;)o($,O),O=O.sibling;return null}function h($,O){for($=new Map;O!==null;)O.key!==null?$.set(O.key,O):$.set(O.index,O),O=O.sibling;return $}function p($,O){return $=Bi($,O),$.index=0,$.sibling=null,$}function y($,O,H){return $.index=H,i?(H=$.alternate,H!==null?(H=H.index,H<O?($.flags|=2,O):H):($.flags|=2,O)):($.flags|=1048576,O)}function I($){return i&&$.alternate===null&&($.flags|=2),$}function b($,O,H,re){return O===null||O.tag!==6?(O=kp(H,$.mode,re),O.return=$,O):(O=p(O,H),O.return=$,O)}function N($,O,H,re){var ye=H.type;return ye===C?Z($,O,H.props.children,re,H.key):O!==null&&(O.elementType===ye||typeof ye=="object"&&ye!==null&&ye.$$typeof===ie&&Qy(ye)===O.type)?(re=p(O,H.props),re.ref=Bl($,O,H),re.return=$,re):(re=dd(H.type,H.key,H.props,null,$.mode,re),re.ref=Bl($,O,H),re.return=$,re)}function W($,O,H,re){return O===null||O.tag!==4||O.stateNode.containerInfo!==H.containerInfo||O.stateNode.implementation!==H.implementation?(O=bp(H,$.mode,re),O.return=$,O):(O=p(O,H.children||[]),O.return=$,O)}function Z($,O,H,re,ye){return O===null||O.tag!==7?(O=Bs(H,$.mode,re,ye),O.return=$,O):(O=p(O,H),O.return=$,O)}function ee($,O,H){if(typeof O=="string"&&O!==""||typeof O=="number")return O=kp(""+O,$.mode,H),O.return=$,O;if(typeof O=="object"&&O!==null){switch(O.$$typeof){case ue:return H=dd(O.type,O.key,O.props,null,$.mode,H),H.ref=Bl($,null,O),H.return=$,H;case ce:return O=bp(O,$.mode,H),O.return=$,O;case ie:var re=O._init;return ee($,re(O._payload),H)}if(Ur(O)||Ee(O))return O=Bs(O,$.mode,H,null),O.return=$,O;Bc($,O)}return null}function J($,O,H,re){var ye=O!==null?O.key:null;if(typeof H=="string"&&H!==""||typeof H=="number")return ye!==null?null:b($,O,""+H,re);if(typeof H=="object"&&H!==null){switch(H.$$typeof){case ue:return H.key===ye?N($,O,H,re):null;case ce:return H.key===ye?W($,O,H,re):null;case ie:return ye=H._init,J($,O,ye(H._payload),re)}if(Ur(H)||Ee(H))return ye!==null?null:Z($,O,H,re,null);Bc($,H)}return null}function de($,O,H,re,ye){if(typeof re=="string"&&re!==""||typeof re=="number")return $=$.get(H)||null,b(O,$,""+re,ye);if(typeof re=="object"&&re!==null){switch(re.$$typeof){case ue:return $=$.get(re.key===null?H:re.key)||null,N(O,$,re,ye);case ce:return $=$.get(re.key===null?H:re.key)||null,W(O,$,re,ye);case ie:var Ie=re._init;return de($,O,H,Ie(re._payload),ye)}if(Ur(re)||Ee(re))return $=$.get(H)||null,Z(O,$,re,ye,null);Bc(O,re)}return null}function pe($,O,H,re){for(var ye=null,Ie=null,xe=O,Se=O=0,Vt=null;xe!==null&&Se<H.length;Se++){xe.index>Se?(Vt=xe,xe=null):Vt=xe.sibling;var Ue=J($,xe,H[Se],re);if(Ue===null){xe===null&&(xe=Vt);break}i&&xe&&Ue.alternate===null&&o($,xe),O=y(Ue,O,Se),Ie===null?ye=Ue:Ie.sibling=Ue,Ie=Ue,xe=Vt}if(Se===H.length)return u($,xe),rt&&Ds($,Se),ye;if(xe===null){for(;Se<H.length;Se++)xe=ee($,H[Se],re),xe!==null&&(O=y(xe,O,Se),Ie===null?ye=xe:Ie.sibling=xe,Ie=xe);return rt&&Ds($,Se),ye}for(xe=h($,xe);Se<H.length;Se++)Vt=de(xe,$,Se,H[Se],re),Vt!==null&&(i&&Vt.alternate!==null&&xe.delete(Vt.key===null?Se:Vt.key),O=y(Vt,O,Se),Ie===null?ye=Vt:Ie.sibling=Vt,Ie=Vt);return i&&xe.forEach(function(zi){return o($,zi)}),rt&&Ds($,Se),ye}function ge($,O,H,re){var ye=Ee(H);if(typeof ye!="function")throw Error(t(150));if(H=ye.call(H),H==null)throw Error(t(151));for(var Ie=ye=null,xe=O,Se=O=0,Vt=null,Ue=H.next();xe!==null&&!Ue.done;Se++,Ue=H.next()){xe.index>Se?(Vt=xe,xe=null):Vt=xe.sibling;var zi=J($,xe,Ue.value,re);if(zi===null){xe===null&&(xe=Vt);break}i&&xe&&zi.alternate===null&&o($,xe),O=y(zi,O,Se),Ie===null?ye=zi:Ie.sibling=zi,Ie=zi,xe=Vt}if(Ue.done)return u($,xe),rt&&Ds($,Se),ye;if(xe===null){for(;!Ue.done;Se++,Ue=H.next())Ue=ee($,Ue.value,re),Ue!==null&&(O=y(Ue,O,Se),Ie===null?ye=Ue:Ie.sibling=Ue,Ie=Ue);return rt&&Ds($,Se),ye}for(xe=h($,xe);!Ue.done;Se++,Ue=H.next())Ue=de(xe,$,Se,Ue.value,re),Ue!==null&&(i&&Ue.alternate!==null&&xe.delete(Ue.key===null?Se:Ue.key),O=y(Ue,O,Se),Ie===null?ye=Ue:Ie.sibling=Ue,Ie=Ue);return i&&xe.forEach(function(JS){return o($,JS)}),rt&&Ds($,Se),ye}function mt($,O,H,re){if(typeof H=="object"&&H!==null&&H.type===C&&H.key===null&&(H=H.props.children),typeof H=="object"&&H!==null){switch(H.$$typeof){case ue:e:{for(var ye=H.key,Ie=O;Ie!==null;){if(Ie.key===ye){if(ye=H.type,ye===C){if(Ie.tag===7){u($,Ie.sibling),O=p(Ie,H.props.children),O.return=$,$=O;break e}}else if(Ie.elementType===ye||typeof ye=="object"&&ye!==null&&ye.$$typeof===ie&&Qy(ye)===Ie.type){u($,Ie.sibling),O=p(Ie,H.props),O.ref=Bl($,Ie,H),O.return=$,$=O;break e}u($,Ie);break}else o($,Ie);Ie=Ie.sibling}H.type===C?(O=Bs(H.props.children,$.mode,re,H.key),O.return=$,$=O):(re=dd(H.type,H.key,H.props,null,$.mode,re),re.ref=Bl($,O,H),re.return=$,$=re)}return I($);case ce:e:{for(Ie=H.key;O!==null;){if(O.key===Ie)if(O.tag===4&&O.stateNode.containerInfo===H.containerInfo&&O.stateNode.implementation===H.implementation){u($,O.sibling),O=p(O,H.children||[]),O.return=$,$=O;break e}else{u($,O);break}else o($,O);O=O.sibling}O=bp(H,$.mode,re),O.return=$,$=O}return I($);case ie:return Ie=H._init,mt($,O,Ie(H._payload),re)}if(Ur(H))return pe($,O,H,re);if(Ee(H))return ge($,O,H,re);Bc($,H)}return typeof H=="string"&&H!==""||typeof H=="number"?(H=""+H,O!==null&&O.tag===6?(u($,O.sibling),O=p(O,H),O.return=$,$=O):(u($,O),O=kp(H,$.mode,re),O.return=$,$=O),I($)):u($,O)}return mt}var sa=Xy(!0),Yy=Xy(!1),zc=Pi(null),$c=null,oa=null,Lf=null;function Mf(){Lf=oa=$c=null}function jf(i){var o=zc.current;tt(zc),i._currentValue=o}function Ff(i,o,u){for(;i!==null;){var h=i.alternate;if((i.childLanes&o)!==o?(i.childLanes|=o,h!==null&&(h.childLanes|=o)):h!==null&&(h.childLanes&o)!==o&&(h.childLanes|=o),i===u)break;i=i.return}}function aa(i,o){$c=i,Lf=oa=null,i=i.dependencies,i!==null&&i.firstContext!==null&&((i.lanes&o)!==0&&(un=!0),i.firstContext=null)}function Dn(i){var o=i._currentValue;if(Lf!==i)if(i={context:i,memoizedValue:o,next:null},oa===null){if($c===null)throw Error(t(308));oa=i,$c.dependencies={lanes:0,firstContext:i}}else oa=oa.next=i;return o}var Vs=null;function Uf(i){Vs===null?Vs=[i]:Vs.push(i)}function Jy(i,o,u,h){var p=o.interleaved;return p===null?(u.next=u,Uf(o)):(u.next=p.next,p.next=u),o.interleaved=u,Zr(i,h)}function Zr(i,o){i.lanes|=o;var u=i.alternate;for(u!==null&&(u.lanes|=o),u=i,i=i.return;i!==null;)i.childLanes|=o,u=i.alternate,u!==null&&(u.childLanes|=o),u=i,i=i.return;return u.tag===3?u.stateNode:null}var Vi=!1;function Bf(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Zy(i,o){i=i.updateQueue,o.updateQueue===i&&(o.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function ei(i,o){return{eventTime:i,lane:o,tag:0,payload:null,callback:null,next:null}}function Oi(i,o,u){var h=i.updateQueue;if(h===null)return null;if(h=h.shared,(Fe&2)!==0){var p=h.pending;return p===null?o.next=o:(o.next=p.next,p.next=o),h.pending=o,Zr(i,u)}return p=h.interleaved,p===null?(o.next=o,Uf(h)):(o.next=p.next,p.next=o),h.interleaved=o,Zr(i,u)}function qc(i,o,u){if(o=o.updateQueue,o!==null&&(o=o.shared,(u&4194240)!==0)){var h=o.lanes;h&=i.pendingLanes,u|=h,o.lanes=u,Ti(i,u)}}function ev(i,o){var u=i.updateQueue,h=i.alternate;if(h!==null&&(h=h.updateQueue,u===h)){var p=null,y=null;if(u=u.firstBaseUpdate,u!==null){do{var I={eventTime:u.eventTime,lane:u.lane,tag:u.tag,payload:u.payload,callback:u.callback,next:null};y===null?p=y=I:y=y.next=I,u=u.next}while(u!==null);y===null?p=y=o:y=y.next=o}else p=y=o;u={baseState:h.baseState,firstBaseUpdate:p,lastBaseUpdate:y,shared:h.shared,effects:h.effects},i.updateQueue=u;return}i=u.lastBaseUpdate,i===null?u.firstBaseUpdate=o:i.next=o,u.lastBaseUpdate=o}function Hc(i,o,u,h){var p=i.updateQueue;Vi=!1;var y=p.firstBaseUpdate,I=p.lastBaseUpdate,b=p.shared.pending;if(b!==null){p.shared.pending=null;var N=b,W=N.next;N.next=null,I===null?y=W:I.next=W,I=N;var Z=i.alternate;Z!==null&&(Z=Z.updateQueue,b=Z.lastBaseUpdate,b!==I&&(b===null?Z.firstBaseUpdate=W:b.next=W,Z.lastBaseUpdate=N))}if(y!==null){var ee=p.baseState;I=0,Z=W=N=null,b=y;do{var J=b.lane,de=b.eventTime;if((h&J)===J){Z!==null&&(Z=Z.next={eventTime:de,lane:0,tag:b.tag,payload:b.payload,callback:b.callback,next:null});e:{var pe=i,ge=b;switch(J=o,de=u,ge.tag){case 1:if(pe=ge.payload,typeof pe=="function"){ee=pe.call(de,ee,J);break e}ee=pe;break e;case 3:pe.flags=pe.flags&-65537|128;case 0:if(pe=ge.payload,J=typeof pe=="function"?pe.call(de,ee,J):pe,J==null)break e;ee=he({},ee,J);break e;case 2:Vi=!0}}b.callback!==null&&b.lane!==0&&(i.flags|=64,J=p.effects,J===null?p.effects=[b]:J.push(b))}else de={eventTime:de,lane:J,tag:b.tag,payload:b.payload,callback:b.callback,next:null},Z===null?(W=Z=de,N=ee):Z=Z.next=de,I|=J;if(b=b.next,b===null){if(b=p.shared.pending,b===null)break;J=b,b=J.next,J.next=null,p.lastBaseUpdate=J,p.shared.pending=null}}while(!0);if(Z===null&&(N=ee),p.baseState=N,p.firstBaseUpdate=W,p.lastBaseUpdate=Z,o=p.shared.interleaved,o!==null){p=o;do I|=p.lane,p=p.next;while(p!==o)}else y===null&&(p.shared.lanes=0);Ms|=I,i.lanes=I,i.memoizedState=ee}}function tv(i,o,u){if(i=o.effects,o.effects=null,i!==null)for(o=0;o<i.length;o++){var h=i[o],p=h.callback;if(p!==null){if(h.callback=null,h=u,typeof p!="function")throw Error(t(191,p));p.call(h)}}}var zl={},Ir=Pi(zl),$l=Pi(zl),ql=Pi(zl);function Os(i){if(i===zl)throw Error(t(174));return i}function zf(i,o){switch(Ze(ql,o),Ze($l,i),Ze(Ir,zl),i=o.nodeType,i){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:Tt(null,"");break;default:i=i===8?o.parentNode:o,o=i.namespaceURI||null,i=i.tagName,o=Tt(o,i)}tt(Ir),Ze(Ir,o)}function la(){tt(Ir),tt($l),tt(ql)}function nv(i){Os(ql.current);var o=Os(Ir.current),u=Tt(o,i.type);o!==u&&(Ze($l,i),Ze(Ir,u))}function $f(i){$l.current===i&&(tt(Ir),tt($l))}var lt=Pi(0);function Wc(i){for(var o=i;o!==null;){if(o.tag===13){var u=o.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||u.data==="$?"||u.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var qf=[];function Hf(){for(var i=0;i<qf.length;i++)qf[i]._workInProgressVersionPrimary=null;qf.length=0}var Gc=ne.ReactCurrentDispatcher,Wf=ne.ReactCurrentBatchConfig,Ls=0,ut=null,kt=null,Nt=null,Kc=!1,Hl=!1,Wl=0,wS=0;function $t(){throw Error(t(321))}function Gf(i,o){if(o===null)return!1;for(var u=0;u<o.length&&u<i.length;u++)if(!Zn(i[u],o[u]))return!1;return!0}function Kf(i,o,u,h,p,y){if(Ls=y,ut=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,Gc.current=i===null||i.memoizedState===null?TS:SS,i=u(h,p),Hl){y=0;do{if(Hl=!1,Wl=0,25<=y)throw Error(t(301));y+=1,Nt=kt=null,o.updateQueue=null,Gc.current=kS,i=u(h,p)}while(Hl)}if(Gc.current=Yc,o=kt!==null&&kt.next!==null,Ls=0,Nt=kt=ut=null,Kc=!1,o)throw Error(t(300));return i}function Qf(){var i=Wl!==0;return Wl=0,i}function xr(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Nt===null?ut.memoizedState=Nt=i:Nt=Nt.next=i,Nt}function Vn(){if(kt===null){var i=ut.alternate;i=i!==null?i.memoizedState:null}else i=kt.next;var o=Nt===null?ut.memoizedState:Nt.next;if(o!==null)Nt=o,kt=i;else{if(i===null)throw Error(t(310));kt=i,i={memoizedState:kt.memoizedState,baseState:kt.baseState,baseQueue:kt.baseQueue,queue:kt.queue,next:null},Nt===null?ut.memoizedState=Nt=i:Nt=Nt.next=i}return Nt}function Gl(i,o){return typeof o=="function"?o(i):o}function Xf(i){var o=Vn(),u=o.queue;if(u===null)throw Error(t(311));u.lastRenderedReducer=i;var h=kt,p=h.baseQueue,y=u.pending;if(y!==null){if(p!==null){var I=p.next;p.next=y.next,y.next=I}h.baseQueue=p=y,u.pending=null}if(p!==null){y=p.next,h=h.baseState;var b=I=null,N=null,W=y;do{var Z=W.lane;if((Ls&Z)===Z)N!==null&&(N=N.next={lane:0,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null}),h=W.hasEagerState?W.eagerState:i(h,W.action);else{var ee={lane:Z,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null};N===null?(b=N=ee,I=h):N=N.next=ee,ut.lanes|=Z,Ms|=Z}W=W.next}while(W!==null&&W!==y);N===null?I=h:N.next=b,Zn(h,o.memoizedState)||(un=!0),o.memoizedState=h,o.baseState=I,o.baseQueue=N,u.lastRenderedState=h}if(i=u.interleaved,i!==null){p=i;do y=p.lane,ut.lanes|=y,Ms|=y,p=p.next;while(p!==i)}else p===null&&(u.lanes=0);return[o.memoizedState,u.dispatch]}function Yf(i){var o=Vn(),u=o.queue;if(u===null)throw Error(t(311));u.lastRenderedReducer=i;var h=u.dispatch,p=u.pending,y=o.memoizedState;if(p!==null){u.pending=null;var I=p=p.next;do y=i(y,I.action),I=I.next;while(I!==p);Zn(y,o.memoizedState)||(un=!0),o.memoizedState=y,o.baseQueue===null&&(o.baseState=y),u.lastRenderedState=y}return[y,h]}function rv(){}function iv(i,o){var u=ut,h=Vn(),p=o(),y=!Zn(h.memoizedState,p);if(y&&(h.memoizedState=p,un=!0),h=h.queue,Jf(av.bind(null,u,h,i),[i]),h.getSnapshot!==o||y||Nt!==null&&Nt.memoizedState.tag&1){if(u.flags|=2048,Kl(9,ov.bind(null,u,h,p,o),void 0,null),Dt===null)throw Error(t(349));(Ls&30)!==0||sv(u,o,p)}return p}function sv(i,o,u){i.flags|=16384,i={getSnapshot:o,value:u},o=ut.updateQueue,o===null?(o={lastEffect:null,stores:null},ut.updateQueue=o,o.stores=[i]):(u=o.stores,u===null?o.stores=[i]:u.push(i))}function ov(i,o,u,h){o.value=u,o.getSnapshot=h,lv(o)&&uv(i)}function av(i,o,u){return u(function(){lv(o)&&uv(i)})}function lv(i){var o=i.getSnapshot;i=i.value;try{var u=o();return!Zn(i,u)}catch{return!0}}function uv(i){var o=Zr(i,1);o!==null&&ir(o,i,1,-1)}function cv(i){var o=xr();return typeof i=="function"&&(i=i()),o.memoizedState=o.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Gl,lastRenderedState:i},o.queue=i,i=i.dispatch=xS.bind(null,ut,i),[o.memoizedState,i]}function Kl(i,o,u,h){return i={tag:i,create:o,destroy:u,deps:h,next:null},o=ut.updateQueue,o===null?(o={lastEffect:null,stores:null},ut.updateQueue=o,o.lastEffect=i.next=i):(u=o.lastEffect,u===null?o.lastEffect=i.next=i:(h=u.next,u.next=i,i.next=h,o.lastEffect=i)),i}function dv(){return Vn().memoizedState}function Qc(i,o,u,h){var p=xr();ut.flags|=i,p.memoizedState=Kl(1|o,u,void 0,h===void 0?null:h)}function Xc(i,o,u,h){var p=Vn();h=h===void 0?null:h;var y=void 0;if(kt!==null){var I=kt.memoizedState;if(y=I.destroy,h!==null&&Gf(h,I.deps)){p.memoizedState=Kl(o,u,y,h);return}}ut.flags|=i,p.memoizedState=Kl(1|o,u,y,h)}function hv(i,o){return Qc(8390656,8,i,o)}function Jf(i,o){return Xc(2048,8,i,o)}function fv(i,o){return Xc(4,2,i,o)}function pv(i,o){return Xc(4,4,i,o)}function mv(i,o){if(typeof o=="function")return i=i(),o(i),function(){o(null)};if(o!=null)return i=i(),o.current=i,function(){o.current=null}}function gv(i,o,u){return u=u!=null?u.concat([i]):null,Xc(4,4,mv.bind(null,o,i),u)}function Zf(){}function yv(i,o){var u=Vn();o=o===void 0?null:o;var h=u.memoizedState;return h!==null&&o!==null&&Gf(o,h[1])?h[0]:(u.memoizedState=[i,o],i)}function vv(i,o){var u=Vn();o=o===void 0?null:o;var h=u.memoizedState;return h!==null&&o!==null&&Gf(o,h[1])?h[0]:(i=i(),u.memoizedState=[i,o],i)}function _v(i,o,u){return(Ls&21)===0?(i.baseState&&(i.baseState=!1,un=!0),i.memoizedState=u):(Zn(u,o)||(u=Ss(),ut.lanes|=u,Ms|=u,i.baseState=!0),o)}function ES(i,o){var u=Oe;Oe=u!==0&&4>u?u:4,i(!0);var h=Wf.transition;Wf.transition={};try{i(!1),o()}finally{Oe=u,Wf.transition=h}}function wv(){return Vn().memoizedState}function IS(i,o,u){var h=Fi(i);if(u={lane:h,action:u,hasEagerState:!1,eagerState:null,next:null},Ev(i))Iv(o,u);else if(u=Jy(i,o,u,h),u!==null){var p=en();ir(u,i,h,p),xv(u,o,h)}}function xS(i,o,u){var h=Fi(i),p={lane:h,action:u,hasEagerState:!1,eagerState:null,next:null};if(Ev(i))Iv(o,p);else{var y=i.alternate;if(i.lanes===0&&(y===null||y.lanes===0)&&(y=o.lastRenderedReducer,y!==null))try{var I=o.lastRenderedState,b=y(I,u);if(p.hasEagerState=!0,p.eagerState=b,Zn(b,I)){var N=o.interleaved;N===null?(p.next=p,Uf(o)):(p.next=N.next,N.next=p),o.interleaved=p;return}}catch{}finally{}u=Jy(i,o,p,h),u!==null&&(p=en(),ir(u,i,h,p),xv(u,o,h))}}function Ev(i){var o=i.alternate;return i===ut||o!==null&&o===ut}function Iv(i,o){Hl=Kc=!0;var u=i.pending;u===null?o.next=o:(o.next=u.next,u.next=o),i.pending=o}function xv(i,o,u){if((u&4194240)!==0){var h=o.lanes;h&=i.pendingLanes,u|=h,o.lanes=u,Ti(i,u)}}var Yc={readContext:Dn,useCallback:$t,useContext:$t,useEffect:$t,useImperativeHandle:$t,useInsertionEffect:$t,useLayoutEffect:$t,useMemo:$t,useReducer:$t,useRef:$t,useState:$t,useDebugValue:$t,useDeferredValue:$t,useTransition:$t,useMutableSource:$t,useSyncExternalStore:$t,useId:$t,unstable_isNewReconciler:!1},TS={readContext:Dn,useCallback:function(i,o){return xr().memoizedState=[i,o===void 0?null:o],i},useContext:Dn,useEffect:hv,useImperativeHandle:function(i,o,u){return u=u!=null?u.concat([i]):null,Qc(4194308,4,mv.bind(null,o,i),u)},useLayoutEffect:function(i,o){return Qc(4194308,4,i,o)},useInsertionEffect:function(i,o){return Qc(4,2,i,o)},useMemo:function(i,o){var u=xr();return o=o===void 0?null:o,i=i(),u.memoizedState=[i,o],i},useReducer:function(i,o,u){var h=xr();return o=u!==void 0?u(o):o,h.memoizedState=h.baseState=o,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:o},h.queue=i,i=i.dispatch=IS.bind(null,ut,i),[h.memoizedState,i]},useRef:function(i){var o=xr();return i={current:i},o.memoizedState=i},useState:cv,useDebugValue:Zf,useDeferredValue:function(i){return xr().memoizedState=i},useTransition:function(){var i=cv(!1),o=i[0];return i=ES.bind(null,i[1]),xr().memoizedState=i,[o,i]},useMutableSource:function(){},useSyncExternalStore:function(i,o,u){var h=ut,p=xr();if(rt){if(u===void 0)throw Error(t(407));u=u()}else{if(u=o(),Dt===null)throw Error(t(349));(Ls&30)!==0||sv(h,o,u)}p.memoizedState=u;var y={value:u,getSnapshot:o};return p.queue=y,hv(av.bind(null,h,y,i),[i]),h.flags|=2048,Kl(9,ov.bind(null,h,y,u,o),void 0,null),u},useId:function(){var i=xr(),o=Dt.identifierPrefix;if(rt){var u=Jr,h=Yr;u=(h&~(1<<32-Yt(h)-1)).toString(32)+u,o=":"+o+"R"+u,u=Wl++,0<u&&(o+="H"+u.toString(32)),o+=":"}else u=wS++,o=":"+o+"r"+u.toString(32)+":";return i.memoizedState=o},unstable_isNewReconciler:!1},SS={readContext:Dn,useCallback:yv,useContext:Dn,useEffect:Jf,useImperativeHandle:gv,useInsertionEffect:fv,useLayoutEffect:pv,useMemo:vv,useReducer:Xf,useRef:dv,useState:function(){return Xf(Gl)},useDebugValue:Zf,useDeferredValue:function(i){var o=Vn();return _v(o,kt.memoizedState,i)},useTransition:function(){var i=Xf(Gl)[0],o=Vn().memoizedState;return[i,o]},useMutableSource:rv,useSyncExternalStore:iv,useId:wv,unstable_isNewReconciler:!1},kS={readContext:Dn,useCallback:yv,useContext:Dn,useEffect:Jf,useImperativeHandle:gv,useInsertionEffect:fv,useLayoutEffect:pv,useMemo:vv,useReducer:Yf,useRef:dv,useState:function(){return Yf(Gl)},useDebugValue:Zf,useDeferredValue:function(i){var o=Vn();return kt===null?o.memoizedState=i:_v(o,kt.memoizedState,i)},useTransition:function(){var i=Yf(Gl)[0],o=Vn().memoizedState;return[i,o]},useMutableSource:rv,useSyncExternalStore:iv,useId:wv,unstable_isNewReconciler:!1};function tr(i,o){if(i&&i.defaultProps){o=he({},o),i=i.defaultProps;for(var u in i)o[u]===void 0&&(o[u]=i[u]);return o}return o}function ep(i,o,u,h){o=i.memoizedState,u=u(h,o),u=u==null?o:he({},o,u),i.memoizedState=u,i.lanes===0&&(i.updateQueue.baseState=u)}var Jc={isMounted:function(i){return(i=i._reactInternals)?Wn(i)===i:!1},enqueueSetState:function(i,o,u){i=i._reactInternals;var h=en(),p=Fi(i),y=ei(h,p);y.payload=o,u!=null&&(y.callback=u),o=Oi(i,y,p),o!==null&&(ir(o,i,p,h),qc(o,i,p))},enqueueReplaceState:function(i,o,u){i=i._reactInternals;var h=en(),p=Fi(i),y=ei(h,p);y.tag=1,y.payload=o,u!=null&&(y.callback=u),o=Oi(i,y,p),o!==null&&(ir(o,i,p,h),qc(o,i,p))},enqueueForceUpdate:function(i,o){i=i._reactInternals;var u=en(),h=Fi(i),p=ei(u,h);p.tag=2,o!=null&&(p.callback=o),o=Oi(i,p,h),o!==null&&(ir(o,i,h,u),qc(o,i,h))}};function Tv(i,o,u,h,p,y,I){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(h,y,I):o.prototype&&o.prototype.isPureReactComponent?!Vl(u,h)||!Vl(p,y):!0}function Sv(i,o,u){var h=!1,p=Ni,y=o.contextType;return typeof y=="object"&&y!==null?y=Dn(y):(p=ln(o)?Ps:zt.current,h=o.contextTypes,y=(h=h!=null)?ta(i,p):Ni),o=new o(u,y),i.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=Jc,i.stateNode=o,o._reactInternals=i,h&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=p,i.__reactInternalMemoizedMaskedChildContext=y),o}function kv(i,o,u,h){i=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(u,h),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(u,h),o.state!==i&&Jc.enqueueReplaceState(o,o.state,null)}function tp(i,o,u,h){var p=i.stateNode;p.props=u,p.state=i.memoizedState,p.refs={},Bf(i);var y=o.contextType;typeof y=="object"&&y!==null?p.context=Dn(y):(y=ln(o)?Ps:zt.current,p.context=ta(i,y)),p.state=i.memoizedState,y=o.getDerivedStateFromProps,typeof y=="function"&&(ep(i,o,y,u),p.state=i.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(o=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),o!==p.state&&Jc.enqueueReplaceState(p,p.state,null),Hc(i,u,p,h),p.state=i.memoizedState),typeof p.componentDidMount=="function"&&(i.flags|=4194308)}function ua(i,o){try{var u="",h=o;do u+=Pe(h),h=h.return;while(h);var p=u}catch(y){p=`
Error generating stack: `+y.message+`
`+y.stack}return{value:i,source:o,stack:p,digest:null}}function np(i,o,u){return{value:i,source:null,stack:u??null,digest:o??null}}function rp(i,o){try{console.error(o.value)}catch(u){setTimeout(function(){throw u})}}var bS=typeof WeakMap=="function"?WeakMap:Map;function bv(i,o,u){u=ei(-1,u),u.tag=3,u.payload={element:null};var h=o.value;return u.callback=function(){sd||(sd=!0,vp=h),rp(i,o)},u}function Av(i,o,u){u=ei(-1,u),u.tag=3;var h=i.type.getDerivedStateFromError;if(typeof h=="function"){var p=o.value;u.payload=function(){return h(p)},u.callback=function(){rp(i,o)}}var y=i.stateNode;return y!==null&&typeof y.componentDidCatch=="function"&&(u.callback=function(){rp(i,o),typeof h!="function"&&(Mi===null?Mi=new Set([this]):Mi.add(this));var I=o.stack;this.componentDidCatch(o.value,{componentStack:I!==null?I:""})}),u}function Rv(i,o,u){var h=i.pingCache;if(h===null){h=i.pingCache=new bS;var p=new Set;h.set(o,p)}else p=h.get(o),p===void 0&&(p=new Set,h.set(o,p));p.has(u)||(p.add(u),i=BS.bind(null,i,o,u),o.then(i,i))}function Cv(i){do{var o;if((o=i.tag===13)&&(o=i.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return i;i=i.return}while(i!==null);return null}function Pv(i,o,u,h,p){return(i.mode&1)===0?(i===o?i.flags|=65536:(i.flags|=128,u.flags|=131072,u.flags&=-52805,u.tag===1&&(u.alternate===null?u.tag=17:(o=ei(-1,1),o.tag=2,Oi(u,o,1))),u.lanes|=1),i):(i.flags|=65536,i.lanes=p,i)}var AS=ne.ReactCurrentOwner,un=!1;function Zt(i,o,u,h){o.child=i===null?Yy(o,null,u,h):sa(o,i.child,u,h)}function Nv(i,o,u,h,p){u=u.render;var y=o.ref;return aa(o,p),h=Kf(i,o,u,h,y,p),u=Qf(),i!==null&&!un?(o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~p,ti(i,o,p)):(rt&&u&&Pf(o),o.flags|=1,Zt(i,o,h,p),o.child)}function Dv(i,o,u,h,p){if(i===null){var y=u.type;return typeof y=="function"&&!Sp(y)&&y.defaultProps===void 0&&u.compare===null&&u.defaultProps===void 0?(o.tag=15,o.type=y,Vv(i,o,y,h,p)):(i=dd(u.type,null,h,o,o.mode,p),i.ref=o.ref,i.return=o,o.child=i)}if(y=i.child,(i.lanes&p)===0){var I=y.memoizedProps;if(u=u.compare,u=u!==null?u:Vl,u(I,h)&&i.ref===o.ref)return ti(i,o,p)}return o.flags|=1,i=Bi(y,h),i.ref=o.ref,i.return=o,o.child=i}function Vv(i,o,u,h,p){if(i!==null){var y=i.memoizedProps;if(Vl(y,h)&&i.ref===o.ref)if(un=!1,o.pendingProps=h=y,(i.lanes&p)!==0)(i.flags&131072)!==0&&(un=!0);else return o.lanes=i.lanes,ti(i,o,p)}return ip(i,o,u,h,p)}function Ov(i,o,u){var h=o.pendingProps,p=h.children,y=i!==null?i.memoizedState:null;if(h.mode==="hidden")if((o.mode&1)===0)o.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ze(da,En),En|=u;else{if((u&1073741824)===0)return i=y!==null?y.baseLanes|u:u,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:i,cachePool:null,transitions:null},o.updateQueue=null,Ze(da,En),En|=i,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},h=y!==null?y.baseLanes:u,Ze(da,En),En|=h}else y!==null?(h=y.baseLanes|u,o.memoizedState=null):h=u,Ze(da,En),En|=h;return Zt(i,o,p,u),o.child}function Lv(i,o){var u=o.ref;(i===null&&u!==null||i!==null&&i.ref!==u)&&(o.flags|=512,o.flags|=2097152)}function ip(i,o,u,h,p){var y=ln(u)?Ps:zt.current;return y=ta(o,y),aa(o,p),u=Kf(i,o,u,h,y,p),h=Qf(),i!==null&&!un?(o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~p,ti(i,o,p)):(rt&&h&&Pf(o),o.flags|=1,Zt(i,o,u,p),o.child)}function Mv(i,o,u,h,p){if(ln(u)){var y=!0;Lc(o)}else y=!1;if(aa(o,p),o.stateNode===null)ed(i,o),Sv(o,u,h),tp(o,u,h,p),h=!0;else if(i===null){var I=o.stateNode,b=o.memoizedProps;I.props=b;var N=I.context,W=u.contextType;typeof W=="object"&&W!==null?W=Dn(W):(W=ln(u)?Ps:zt.current,W=ta(o,W));var Z=u.getDerivedStateFromProps,ee=typeof Z=="function"||typeof I.getSnapshotBeforeUpdate=="function";ee||typeof I.UNSAFE_componentWillReceiveProps!="function"&&typeof I.componentWillReceiveProps!="function"||(b!==h||N!==W)&&kv(o,I,h,W),Vi=!1;var J=o.memoizedState;I.state=J,Hc(o,h,I,p),N=o.memoizedState,b!==h||J!==N||an.current||Vi?(typeof Z=="function"&&(ep(o,u,Z,h),N=o.memoizedState),(b=Vi||Tv(o,u,b,h,J,N,W))?(ee||typeof I.UNSAFE_componentWillMount!="function"&&typeof I.componentWillMount!="function"||(typeof I.componentWillMount=="function"&&I.componentWillMount(),typeof I.UNSAFE_componentWillMount=="function"&&I.UNSAFE_componentWillMount()),typeof I.componentDidMount=="function"&&(o.flags|=4194308)):(typeof I.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=h,o.memoizedState=N),I.props=h,I.state=N,I.context=W,h=b):(typeof I.componentDidMount=="function"&&(o.flags|=4194308),h=!1)}else{I=o.stateNode,Zy(i,o),b=o.memoizedProps,W=o.type===o.elementType?b:tr(o.type,b),I.props=W,ee=o.pendingProps,J=I.context,N=u.contextType,typeof N=="object"&&N!==null?N=Dn(N):(N=ln(u)?Ps:zt.current,N=ta(o,N));var de=u.getDerivedStateFromProps;(Z=typeof de=="function"||typeof I.getSnapshotBeforeUpdate=="function")||typeof I.UNSAFE_componentWillReceiveProps!="function"&&typeof I.componentWillReceiveProps!="function"||(b!==ee||J!==N)&&kv(o,I,h,N),Vi=!1,J=o.memoizedState,I.state=J,Hc(o,h,I,p);var pe=o.memoizedState;b!==ee||J!==pe||an.current||Vi?(typeof de=="function"&&(ep(o,u,de,h),pe=o.memoizedState),(W=Vi||Tv(o,u,W,h,J,pe,N)||!1)?(Z||typeof I.UNSAFE_componentWillUpdate!="function"&&typeof I.componentWillUpdate!="function"||(typeof I.componentWillUpdate=="function"&&I.componentWillUpdate(h,pe,N),typeof I.UNSAFE_componentWillUpdate=="function"&&I.UNSAFE_componentWillUpdate(h,pe,N)),typeof I.componentDidUpdate=="function"&&(o.flags|=4),typeof I.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof I.componentDidUpdate!="function"||b===i.memoizedProps&&J===i.memoizedState||(o.flags|=4),typeof I.getSnapshotBeforeUpdate!="function"||b===i.memoizedProps&&J===i.memoizedState||(o.flags|=1024),o.memoizedProps=h,o.memoizedState=pe),I.props=h,I.state=pe,I.context=N,h=W):(typeof I.componentDidUpdate!="function"||b===i.memoizedProps&&J===i.memoizedState||(o.flags|=4),typeof I.getSnapshotBeforeUpdate!="function"||b===i.memoizedProps&&J===i.memoizedState||(o.flags|=1024),h=!1)}return sp(i,o,u,h,y,p)}function sp(i,o,u,h,p,y){Lv(i,o);var I=(o.flags&128)!==0;if(!h&&!I)return p&&zy(o,u,!1),ti(i,o,y);h=o.stateNode,AS.current=o;var b=I&&typeof u.getDerivedStateFromError!="function"?null:h.render();return o.flags|=1,i!==null&&I?(o.child=sa(o,i.child,null,y),o.child=sa(o,null,b,y)):Zt(i,o,b,y),o.memoizedState=h.state,p&&zy(o,u,!0),o.child}function jv(i){var o=i.stateNode;o.pendingContext?Uy(i,o.pendingContext,o.pendingContext!==o.context):o.context&&Uy(i,o.context,!1),zf(i,o.containerInfo)}function Fv(i,o,u,h,p){return ia(),Of(p),o.flags|=256,Zt(i,o,u,h),o.child}var op={dehydrated:null,treeContext:null,retryLane:0};function ap(i){return{baseLanes:i,cachePool:null,transitions:null}}function Uv(i,o,u){var h=o.pendingProps,p=lt.current,y=!1,I=(o.flags&128)!==0,b;if((b=I)||(b=i!==null&&i.memoizedState===null?!1:(p&2)!==0),b?(y=!0,o.flags&=-129):(i===null||i.memoizedState!==null)&&(p|=1),Ze(lt,p&1),i===null)return Vf(o),i=o.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?((o.mode&1)===0?o.lanes=1:i.data==="$!"?o.lanes=8:o.lanes=1073741824,null):(I=h.children,i=h.fallback,y?(h=o.mode,y=o.child,I={mode:"hidden",children:I},(h&1)===0&&y!==null?(y.childLanes=0,y.pendingProps=I):y=hd(I,h,0,null),i=Bs(i,h,u,null),y.return=o,i.return=o,y.sibling=i,o.child=y,o.child.memoizedState=ap(u),o.memoizedState=op,i):lp(o,I));if(p=i.memoizedState,p!==null&&(b=p.dehydrated,b!==null))return RS(i,o,I,h,b,p,u);if(y){y=h.fallback,I=o.mode,p=i.child,b=p.sibling;var N={mode:"hidden",children:h.children};return(I&1)===0&&o.child!==p?(h=o.child,h.childLanes=0,h.pendingProps=N,o.deletions=null):(h=Bi(p,N),h.subtreeFlags=p.subtreeFlags&14680064),b!==null?y=Bi(b,y):(y=Bs(y,I,u,null),y.flags|=2),y.return=o,h.return=o,h.sibling=y,o.child=h,h=y,y=o.child,I=i.child.memoizedState,I=I===null?ap(u):{baseLanes:I.baseLanes|u,cachePool:null,transitions:I.transitions},y.memoizedState=I,y.childLanes=i.childLanes&~u,o.memoizedState=op,h}return y=i.child,i=y.sibling,h=Bi(y,{mode:"visible",children:h.children}),(o.mode&1)===0&&(h.lanes=u),h.return=o,h.sibling=null,i!==null&&(u=o.deletions,u===null?(o.deletions=[i],o.flags|=16):u.push(i)),o.child=h,o.memoizedState=null,h}function lp(i,o){return o=hd({mode:"visible",children:o},i.mode,0,null),o.return=i,i.child=o}function Zc(i,o,u,h){return h!==null&&Of(h),sa(o,i.child,null,u),i=lp(o,o.pendingProps.children),i.flags|=2,o.memoizedState=null,i}function RS(i,o,u,h,p,y,I){if(u)return o.flags&256?(o.flags&=-257,h=np(Error(t(422))),Zc(i,o,I,h)):o.memoizedState!==null?(o.child=i.child,o.flags|=128,null):(y=h.fallback,p=o.mode,h=hd({mode:"visible",children:h.children},p,0,null),y=Bs(y,p,I,null),y.flags|=2,h.return=o,y.return=o,h.sibling=y,o.child=h,(o.mode&1)!==0&&sa(o,i.child,null,I),o.child.memoizedState=ap(I),o.memoizedState=op,y);if((o.mode&1)===0)return Zc(i,o,I,null);if(p.data==="$!"){if(h=p.nextSibling&&p.nextSibling.dataset,h)var b=h.dgst;return h=b,y=Error(t(419)),h=np(y,h,void 0),Zc(i,o,I,h)}if(b=(I&i.childLanes)!==0,un||b){if(h=Dt,h!==null){switch(I&-I){case 4:p=2;break;case 16:p=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:p=32;break;case 536870912:p=268435456;break;default:p=0}p=(p&(h.suspendedLanes|I))!==0?0:p,p!==0&&p!==y.retryLane&&(y.retryLane=p,Zr(i,p),ir(h,i,p,-1))}return Tp(),h=np(Error(t(421))),Zc(i,o,I,h)}return p.data==="$?"?(o.flags|=128,o.child=i.child,o=zS.bind(null,i),p._reactRetry=o,null):(i=y.treeContext,wn=Ci(p.nextSibling),_n=o,rt=!0,er=null,i!==null&&(Pn[Nn++]=Yr,Pn[Nn++]=Jr,Pn[Nn++]=Ns,Yr=i.id,Jr=i.overflow,Ns=o),o=lp(o,h.children),o.flags|=4096,o)}function Bv(i,o,u){i.lanes|=o;var h=i.alternate;h!==null&&(h.lanes|=o),Ff(i.return,o,u)}function up(i,o,u,h,p){var y=i.memoizedState;y===null?i.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:h,tail:u,tailMode:p}:(y.isBackwards=o,y.rendering=null,y.renderingStartTime=0,y.last=h,y.tail=u,y.tailMode=p)}function zv(i,o,u){var h=o.pendingProps,p=h.revealOrder,y=h.tail;if(Zt(i,o,h.children,u),h=lt.current,(h&2)!==0)h=h&1|2,o.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=o.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&Bv(i,u,o);else if(i.tag===19)Bv(i,u,o);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===o)break e;for(;i.sibling===null;){if(i.return===null||i.return===o)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}h&=1}if(Ze(lt,h),(o.mode&1)===0)o.memoizedState=null;else switch(p){case"forwards":for(u=o.child,p=null;u!==null;)i=u.alternate,i!==null&&Wc(i)===null&&(p=u),u=u.sibling;u=p,u===null?(p=o.child,o.child=null):(p=u.sibling,u.sibling=null),up(o,!1,p,u,y);break;case"backwards":for(u=null,p=o.child,o.child=null;p!==null;){if(i=p.alternate,i!==null&&Wc(i)===null){o.child=p;break}i=p.sibling,p.sibling=u,u=p,p=i}up(o,!0,u,null,y);break;case"together":up(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function ed(i,o){(o.mode&1)===0&&i!==null&&(i.alternate=null,o.alternate=null,o.flags|=2)}function ti(i,o,u){if(i!==null&&(o.dependencies=i.dependencies),Ms|=o.lanes,(u&o.childLanes)===0)return null;if(i!==null&&o.child!==i.child)throw Error(t(153));if(o.child!==null){for(i=o.child,u=Bi(i,i.pendingProps),o.child=u,u.return=o;i.sibling!==null;)i=i.sibling,u=u.sibling=Bi(i,i.pendingProps),u.return=o;u.sibling=null}return o.child}function CS(i,o,u){switch(o.tag){case 3:jv(o),ia();break;case 5:nv(o);break;case 1:ln(o.type)&&Lc(o);break;case 4:zf(o,o.stateNode.containerInfo);break;case 10:var h=o.type._context,p=o.memoizedProps.value;Ze(zc,h._currentValue),h._currentValue=p;break;case 13:if(h=o.memoizedState,h!==null)return h.dehydrated!==null?(Ze(lt,lt.current&1),o.flags|=128,null):(u&o.child.childLanes)!==0?Uv(i,o,u):(Ze(lt,lt.current&1),i=ti(i,o,u),i!==null?i.sibling:null);Ze(lt,lt.current&1);break;case 19:if(h=(u&o.childLanes)!==0,(i.flags&128)!==0){if(h)return zv(i,o,u);o.flags|=128}if(p=o.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),Ze(lt,lt.current),h)break;return null;case 22:case 23:return o.lanes=0,Ov(i,o,u)}return ti(i,o,u)}var $v,cp,qv,Hv;$v=function(i,o){for(var u=o.child;u!==null;){if(u.tag===5||u.tag===6)i.appendChild(u.stateNode);else if(u.tag!==4&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===o)break;for(;u.sibling===null;){if(u.return===null||u.return===o)return;u=u.return}u.sibling.return=u.return,u=u.sibling}},cp=function(){},qv=function(i,o,u,h){var p=i.memoizedProps;if(p!==h){i=o.stateNode,Os(Ir.current);var y=null;switch(u){case"input":p=ps(i,p),h=ps(i,h),y=[];break;case"select":p=he({},p,{value:void 0}),h=he({},h,{value:void 0}),y=[];break;case"textarea":p=ul(i,p),h=ul(i,h),y=[];break;default:typeof p.onClick!="function"&&typeof h.onClick=="function"&&(i.onclick=Dc)}ml(u,h);var I;u=null;for(W in p)if(!h.hasOwnProperty(W)&&p.hasOwnProperty(W)&&p[W]!=null)if(W==="style"){var b=p[W];for(I in b)b.hasOwnProperty(I)&&(u||(u={}),u[I]="")}else W!=="dangerouslySetInnerHTML"&&W!=="children"&&W!=="suppressContentEditableWarning"&&W!=="suppressHydrationWarning"&&W!=="autoFocus"&&(s.hasOwnProperty(W)?y||(y=[]):(y=y||[]).push(W,null));for(W in h){var N=h[W];if(b=p!=null?p[W]:void 0,h.hasOwnProperty(W)&&N!==b&&(N!=null||b!=null))if(W==="style")if(b){for(I in b)!b.hasOwnProperty(I)||N&&N.hasOwnProperty(I)||(u||(u={}),u[I]="");for(I in N)N.hasOwnProperty(I)&&b[I]!==N[I]&&(u||(u={}),u[I]=N[I])}else u||(y||(y=[]),y.push(W,u)),u=N;else W==="dangerouslySetInnerHTML"?(N=N?N.__html:void 0,b=b?b.__html:void 0,N!=null&&b!==N&&(y=y||[]).push(W,N)):W==="children"?typeof N!="string"&&typeof N!="number"||(y=y||[]).push(W,""+N):W!=="suppressContentEditableWarning"&&W!=="suppressHydrationWarning"&&(s.hasOwnProperty(W)?(N!=null&&W==="onScroll"&&et("scroll",i),y||b===N||(y=[])):(y=y||[]).push(W,N))}u&&(y=y||[]).push("style",u);var W=y;(o.updateQueue=W)&&(o.flags|=4)}},Hv=function(i,o,u,h){u!==h&&(o.flags|=4)};function Ql(i,o){if(!rt)switch(i.tailMode){case"hidden":o=i.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?i.tail=null:u.sibling=null;break;case"collapsed":u=i.tail;for(var h=null;u!==null;)u.alternate!==null&&(h=u),u=u.sibling;h===null?o||i.tail===null?i.tail=null:i.tail.sibling=null:h.sibling=null}}function qt(i){var o=i.alternate!==null&&i.alternate.child===i.child,u=0,h=0;if(o)for(var p=i.child;p!==null;)u|=p.lanes|p.childLanes,h|=p.subtreeFlags&14680064,h|=p.flags&14680064,p.return=i,p=p.sibling;else for(p=i.child;p!==null;)u|=p.lanes|p.childLanes,h|=p.subtreeFlags,h|=p.flags,p.return=i,p=p.sibling;return i.subtreeFlags|=h,i.childLanes=u,o}function PS(i,o,u){var h=o.pendingProps;switch(Nf(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qt(o),null;case 1:return ln(o.type)&&Oc(),qt(o),null;case 3:return h=o.stateNode,la(),tt(an),tt(zt),Hf(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(i===null||i.child===null)&&(Uc(o)?o.flags|=4:i===null||i.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,er!==null&&(Ep(er),er=null))),cp(i,o),qt(o),null;case 5:$f(o);var p=Os(ql.current);if(u=o.type,i!==null&&o.stateNode!=null)qv(i,o,u,h,p),i.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!h){if(o.stateNode===null)throw Error(t(166));return qt(o),null}if(i=Os(Ir.current),Uc(o)){h=o.stateNode,u=o.type;var y=o.memoizedProps;switch(h[Er]=o,h[Fl]=y,i=(o.mode&1)!==0,u){case"dialog":et("cancel",h),et("close",h);break;case"iframe":case"object":case"embed":et("load",h);break;case"video":case"audio":for(p=0;p<Ll.length;p++)et(Ll[p],h);break;case"source":et("error",h);break;case"img":case"image":case"link":et("error",h),et("load",h);break;case"details":et("toggle",h);break;case"input":xo(h,y),et("invalid",h);break;case"select":h._wrapperState={wasMultiple:!!y.multiple},et("invalid",h);break;case"textarea":So(h,y),et("invalid",h)}ml(u,y),p=null;for(var I in y)if(y.hasOwnProperty(I)){var b=y[I];I==="children"?typeof b=="string"?h.textContent!==b&&(y.suppressHydrationWarning!==!0&&Nc(h.textContent,b,i),p=["children",b]):typeof b=="number"&&h.textContent!==""+b&&(y.suppressHydrationWarning!==!0&&Nc(h.textContent,b,i),p=["children",""+b]):s.hasOwnProperty(I)&&b!=null&&I==="onScroll"&&et("scroll",h)}switch(u){case"input":Fr(h),ic(h,y,!0);break;case"textarea":Fr(h),cl(h);break;case"select":case"option":break;default:typeof y.onClick=="function"&&(h.onclick=Dc)}h=p,o.updateQueue=h,h!==null&&(o.flags|=4)}else{I=p.nodeType===9?p:p.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=xt(u)),i==="http://www.w3.org/1999/xhtml"?u==="script"?(i=I.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof h.is=="string"?i=I.createElement(u,{is:h.is}):(i=I.createElement(u),u==="select"&&(I=i,h.multiple?I.multiple=!0:h.size&&(I.size=h.size))):i=I.createElementNS(i,u),i[Er]=o,i[Fl]=h,$v(i,o,!1,!1),o.stateNode=i;e:{switch(I=gl(u,h),u){case"dialog":et("cancel",i),et("close",i),p=h;break;case"iframe":case"object":case"embed":et("load",i),p=h;break;case"video":case"audio":for(p=0;p<Ll.length;p++)et(Ll[p],i);p=h;break;case"source":et("error",i),p=h;break;case"img":case"image":case"link":et("error",i),et("load",i),p=h;break;case"details":et("toggle",i),p=h;break;case"input":xo(i,h),p=ps(i,h),et("invalid",i);break;case"option":p=h;break;case"select":i._wrapperState={wasMultiple:!!h.multiple},p=he({},h,{value:void 0}),et("invalid",i);break;case"textarea":So(i,h),p=ul(i,h),et("invalid",i);break;default:p=h}ml(u,p),b=p;for(y in b)if(b.hasOwnProperty(y)){var N=b[y];y==="style"?fl(i,N):y==="dangerouslySetInnerHTML"?(N=N?N.__html:void 0,N!=null&&dl(i,N)):y==="children"?typeof N=="string"?(u!=="textarea"||N!=="")&&_i(i,N):typeof N=="number"&&_i(i,""+N):y!=="suppressContentEditableWarning"&&y!=="suppressHydrationWarning"&&y!=="autoFocus"&&(s.hasOwnProperty(y)?N!=null&&y==="onScroll"&&et("scroll",i):N!=null&&q(i,y,N,I))}switch(u){case"input":Fr(i),ic(i,h,!1);break;case"textarea":Fr(i),cl(i);break;case"option":h.value!=null&&i.setAttribute("value",""+ze(h.value));break;case"select":i.multiple=!!h.multiple,y=h.value,y!=null?Br(i,!!h.multiple,y,!1):h.defaultValue!=null&&Br(i,!!h.multiple,h.defaultValue,!0);break;default:typeof p.onClick=="function"&&(i.onclick=Dc)}switch(u){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}}h&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return qt(o),null;case 6:if(i&&o.stateNode!=null)Hv(i,o,i.memoizedProps,h);else{if(typeof h!="string"&&o.stateNode===null)throw Error(t(166));if(u=Os(ql.current),Os(Ir.current),Uc(o)){if(h=o.stateNode,u=o.memoizedProps,h[Er]=o,(y=h.nodeValue!==u)&&(i=_n,i!==null))switch(i.tag){case 3:Nc(h.nodeValue,u,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&Nc(h.nodeValue,u,(i.mode&1)!==0)}y&&(o.flags|=4)}else h=(u.nodeType===9?u:u.ownerDocument).createTextNode(h),h[Er]=o,o.stateNode=h}return qt(o),null;case 13:if(tt(lt),h=o.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(rt&&wn!==null&&(o.mode&1)!==0&&(o.flags&128)===0)Ky(),ia(),o.flags|=98560,y=!1;else if(y=Uc(o),h!==null&&h.dehydrated!==null){if(i===null){if(!y)throw Error(t(318));if(y=o.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(t(317));y[Er]=o}else ia(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;qt(o),y=!1}else er!==null&&(Ep(er),er=null),y=!0;if(!y)return o.flags&65536?o:null}return(o.flags&128)!==0?(o.lanes=u,o):(h=h!==null,h!==(i!==null&&i.memoizedState!==null)&&h&&(o.child.flags|=8192,(o.mode&1)!==0&&(i===null||(lt.current&1)!==0?bt===0&&(bt=3):Tp())),o.updateQueue!==null&&(o.flags|=4),qt(o),null);case 4:return la(),cp(i,o),i===null&&Ml(o.stateNode.containerInfo),qt(o),null;case 10:return jf(o.type._context),qt(o),null;case 17:return ln(o.type)&&Oc(),qt(o),null;case 19:if(tt(lt),y=o.memoizedState,y===null)return qt(o),null;if(h=(o.flags&128)!==0,I=y.rendering,I===null)if(h)Ql(y,!1);else{if(bt!==0||i!==null&&(i.flags&128)!==0)for(i=o.child;i!==null;){if(I=Wc(i),I!==null){for(o.flags|=128,Ql(y,!1),h=I.updateQueue,h!==null&&(o.updateQueue=h,o.flags|=4),o.subtreeFlags=0,h=u,u=o.child;u!==null;)y=u,i=h,y.flags&=14680066,I=y.alternate,I===null?(y.childLanes=0,y.lanes=i,y.child=null,y.subtreeFlags=0,y.memoizedProps=null,y.memoizedState=null,y.updateQueue=null,y.dependencies=null,y.stateNode=null):(y.childLanes=I.childLanes,y.lanes=I.lanes,y.child=I.child,y.subtreeFlags=0,y.deletions=null,y.memoizedProps=I.memoizedProps,y.memoizedState=I.memoizedState,y.updateQueue=I.updateQueue,y.type=I.type,i=I.dependencies,y.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),u=u.sibling;return Ze(lt,lt.current&1|2),o.child}i=i.sibling}y.tail!==null&&Je()>ha&&(o.flags|=128,h=!0,Ql(y,!1),o.lanes=4194304)}else{if(!h)if(i=Wc(I),i!==null){if(o.flags|=128,h=!0,u=i.updateQueue,u!==null&&(o.updateQueue=u,o.flags|=4),Ql(y,!0),y.tail===null&&y.tailMode==="hidden"&&!I.alternate&&!rt)return qt(o),null}else 2*Je()-y.renderingStartTime>ha&&u!==1073741824&&(o.flags|=128,h=!0,Ql(y,!1),o.lanes=4194304);y.isBackwards?(I.sibling=o.child,o.child=I):(u=y.last,u!==null?u.sibling=I:o.child=I,y.last=I)}return y.tail!==null?(o=y.tail,y.rendering=o,y.tail=o.sibling,y.renderingStartTime=Je(),o.sibling=null,u=lt.current,Ze(lt,h?u&1|2:u&1),o):(qt(o),null);case 22:case 23:return xp(),h=o.memoizedState!==null,i!==null&&i.memoizedState!==null!==h&&(o.flags|=8192),h&&(o.mode&1)!==0?(En&1073741824)!==0&&(qt(o),o.subtreeFlags&6&&(o.flags|=8192)):qt(o),null;case 24:return null;case 25:return null}throw Error(t(156,o.tag))}function NS(i,o){switch(Nf(o),o.tag){case 1:return ln(o.type)&&Oc(),i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 3:return la(),tt(an),tt(zt),Hf(),i=o.flags,(i&65536)!==0&&(i&128)===0?(o.flags=i&-65537|128,o):null;case 5:return $f(o),null;case 13:if(tt(lt),i=o.memoizedState,i!==null&&i.dehydrated!==null){if(o.alternate===null)throw Error(t(340));ia()}return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 19:return tt(lt),null;case 4:return la(),null;case 10:return jf(o.type._context),null;case 22:case 23:return xp(),null;case 24:return null;default:return null}}var td=!1,Ht=!1,DS=typeof WeakSet=="function"?WeakSet:Set,fe=null;function ca(i,o){var u=i.ref;if(u!==null)if(typeof u=="function")try{u(null)}catch(h){dt(i,o,h)}else u.current=null}function dp(i,o,u){try{u()}catch(h){dt(i,o,h)}}var Wv=!1;function VS(i,o){if(xf=bi,i=Ty(),mf(i)){if("selectionStart"in i)var u={start:i.selectionStart,end:i.selectionEnd};else e:{u=(u=i.ownerDocument)&&u.defaultView||window;var h=u.getSelection&&u.getSelection();if(h&&h.rangeCount!==0){u=h.anchorNode;var p=h.anchorOffset,y=h.focusNode;h=h.focusOffset;try{u.nodeType,y.nodeType}catch{u=null;break e}var I=0,b=-1,N=-1,W=0,Z=0,ee=i,J=null;t:for(;;){for(var de;ee!==u||p!==0&&ee.nodeType!==3||(b=I+p),ee!==y||h!==0&&ee.nodeType!==3||(N=I+h),ee.nodeType===3&&(I+=ee.nodeValue.length),(de=ee.firstChild)!==null;)J=ee,ee=de;for(;;){if(ee===i)break t;if(J===u&&++W===p&&(b=I),J===y&&++Z===h&&(N=I),(de=ee.nextSibling)!==null)break;ee=J,J=ee.parentNode}ee=de}u=b===-1||N===-1?null:{start:b,end:N}}else u=null}u=u||{start:0,end:0}}else u=null;for(Tf={focusedElem:i,selectionRange:u},bi=!1,fe=o;fe!==null;)if(o=fe,i=o.child,(o.subtreeFlags&1028)!==0&&i!==null)i.return=o,fe=i;else for(;fe!==null;){o=fe;try{var pe=o.alternate;if((o.flags&1024)!==0)switch(o.tag){case 0:case 11:case 15:break;case 1:if(pe!==null){var ge=pe.memoizedProps,mt=pe.memoizedState,$=o.stateNode,O=$.getSnapshotBeforeUpdate(o.elementType===o.type?ge:tr(o.type,ge),mt);$.__reactInternalSnapshotBeforeUpdate=O}break;case 3:var H=o.stateNode.containerInfo;H.nodeType===1?H.textContent="":H.nodeType===9&&H.documentElement&&H.removeChild(H.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(re){dt(o,o.return,re)}if(i=o.sibling,i!==null){i.return=o.return,fe=i;break}fe=o.return}return pe=Wv,Wv=!1,pe}function Xl(i,o,u){var h=o.updateQueue;if(h=h!==null?h.lastEffect:null,h!==null){var p=h=h.next;do{if((p.tag&i)===i){var y=p.destroy;p.destroy=void 0,y!==void 0&&dp(o,u,y)}p=p.next}while(p!==h)}}function nd(i,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var u=o=o.next;do{if((u.tag&i)===i){var h=u.create;u.destroy=h()}u=u.next}while(u!==o)}}function hp(i){var o=i.ref;if(o!==null){var u=i.stateNode;switch(i.tag){case 5:i=u;break;default:i=u}typeof o=="function"?o(i):o.current=i}}function Gv(i){var o=i.alternate;o!==null&&(i.alternate=null,Gv(o)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(o=i.stateNode,o!==null&&(delete o[Er],delete o[Fl],delete o[Af],delete o[gS],delete o[yS])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function Kv(i){return i.tag===5||i.tag===3||i.tag===4}function Qv(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||Kv(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function fp(i,o,u){var h=i.tag;if(h===5||h===6)i=i.stateNode,o?u.nodeType===8?u.parentNode.insertBefore(i,o):u.insertBefore(i,o):(u.nodeType===8?(o=u.parentNode,o.insertBefore(i,u)):(o=u,o.appendChild(i)),u=u._reactRootContainer,u!=null||o.onclick!==null||(o.onclick=Dc));else if(h!==4&&(i=i.child,i!==null))for(fp(i,o,u),i=i.sibling;i!==null;)fp(i,o,u),i=i.sibling}function pp(i,o,u){var h=i.tag;if(h===5||h===6)i=i.stateNode,o?u.insertBefore(i,o):u.appendChild(i);else if(h!==4&&(i=i.child,i!==null))for(pp(i,o,u),i=i.sibling;i!==null;)pp(i,o,u),i=i.sibling}var jt=null,nr=!1;function Li(i,o,u){for(u=u.child;u!==null;)Xv(i,o,u),u=u.sibling}function Xv(i,o,u){if(mn&&typeof mn.onCommitFiberUnmount=="function")try{mn.onCommitFiberUnmount(xs,u)}catch{}switch(u.tag){case 5:Ht||ca(u,o);case 6:var h=jt,p=nr;jt=null,Li(i,o,u),jt=h,nr=p,jt!==null&&(nr?(i=jt,u=u.stateNode,i.nodeType===8?i.parentNode.removeChild(u):i.removeChild(u)):jt.removeChild(u.stateNode));break;case 18:jt!==null&&(nr?(i=jt,u=u.stateNode,i.nodeType===8?bf(i.parentNode,u):i.nodeType===1&&bf(i,u),Yn(i)):bf(jt,u.stateNode));break;case 4:h=jt,p=nr,jt=u.stateNode.containerInfo,nr=!0,Li(i,o,u),jt=h,nr=p;break;case 0:case 11:case 14:case 15:if(!Ht&&(h=u.updateQueue,h!==null&&(h=h.lastEffect,h!==null))){p=h=h.next;do{var y=p,I=y.destroy;y=y.tag,I!==void 0&&((y&2)!==0||(y&4)!==0)&&dp(u,o,I),p=p.next}while(p!==h)}Li(i,o,u);break;case 1:if(!Ht&&(ca(u,o),h=u.stateNode,typeof h.componentWillUnmount=="function"))try{h.props=u.memoizedProps,h.state=u.memoizedState,h.componentWillUnmount()}catch(b){dt(u,o,b)}Li(i,o,u);break;case 21:Li(i,o,u);break;case 22:u.mode&1?(Ht=(h=Ht)||u.memoizedState!==null,Li(i,o,u),Ht=h):Li(i,o,u);break;default:Li(i,o,u)}}function Yv(i){var o=i.updateQueue;if(o!==null){i.updateQueue=null;var u=i.stateNode;u===null&&(u=i.stateNode=new DS),o.forEach(function(h){var p=$S.bind(null,i,h);u.has(h)||(u.add(h),h.then(p,p))})}}function rr(i,o){var u=o.deletions;if(u!==null)for(var h=0;h<u.length;h++){var p=u[h];try{var y=i,I=o,b=I;e:for(;b!==null;){switch(b.tag){case 5:jt=b.stateNode,nr=!1;break e;case 3:jt=b.stateNode.containerInfo,nr=!0;break e;case 4:jt=b.stateNode.containerInfo,nr=!0;break e}b=b.return}if(jt===null)throw Error(t(160));Xv(y,I,p),jt=null,nr=!1;var N=p.alternate;N!==null&&(N.return=null),p.return=null}catch(W){dt(p,o,W)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)Jv(o,i),o=o.sibling}function Jv(i,o){var u=i.alternate,h=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(rr(o,i),Tr(i),h&4){try{Xl(3,i,i.return),nd(3,i)}catch(ge){dt(i,i.return,ge)}try{Xl(5,i,i.return)}catch(ge){dt(i,i.return,ge)}}break;case 1:rr(o,i),Tr(i),h&512&&u!==null&&ca(u,u.return);break;case 5:if(rr(o,i),Tr(i),h&512&&u!==null&&ca(u,u.return),i.flags&32){var p=i.stateNode;try{_i(p,"")}catch(ge){dt(i,i.return,ge)}}if(h&4&&(p=i.stateNode,p!=null)){var y=i.memoizedProps,I=u!==null?u.memoizedProps:y,b=i.type,N=i.updateQueue;if(i.updateQueue=null,N!==null)try{b==="input"&&y.type==="radio"&&y.name!=null&&al(p,y),gl(b,I);var W=gl(b,y);for(I=0;I<N.length;I+=2){var Z=N[I],ee=N[I+1];Z==="style"?fl(p,ee):Z==="dangerouslySetInnerHTML"?dl(p,ee):Z==="children"?_i(p,ee):q(p,Z,ee,W)}switch(b){case"input":ll(p,y);break;case"textarea":ko(p,y);break;case"select":var J=p._wrapperState.wasMultiple;p._wrapperState.wasMultiple=!!y.multiple;var de=y.value;de!=null?Br(p,!!y.multiple,de,!1):J!==!!y.multiple&&(y.defaultValue!=null?Br(p,!!y.multiple,y.defaultValue,!0):Br(p,!!y.multiple,y.multiple?[]:"",!1))}p[Fl]=y}catch(ge){dt(i,i.return,ge)}}break;case 6:if(rr(o,i),Tr(i),h&4){if(i.stateNode===null)throw Error(t(162));p=i.stateNode,y=i.memoizedProps;try{p.nodeValue=y}catch(ge){dt(i,i.return,ge)}}break;case 3:if(rr(o,i),Tr(i),h&4&&u!==null&&u.memoizedState.isDehydrated)try{Yn(o.containerInfo)}catch(ge){dt(i,i.return,ge)}break;case 4:rr(o,i),Tr(i);break;case 13:rr(o,i),Tr(i),p=i.child,p.flags&8192&&(y=p.memoizedState!==null,p.stateNode.isHidden=y,!y||p.alternate!==null&&p.alternate.memoizedState!==null||(yp=Je())),h&4&&Yv(i);break;case 22:if(Z=u!==null&&u.memoizedState!==null,i.mode&1?(Ht=(W=Ht)||Z,rr(o,i),Ht=W):rr(o,i),Tr(i),h&8192){if(W=i.memoizedState!==null,(i.stateNode.isHidden=W)&&!Z&&(i.mode&1)!==0)for(fe=i,Z=i.child;Z!==null;){for(ee=fe=Z;fe!==null;){switch(J=fe,de=J.child,J.tag){case 0:case 11:case 14:case 15:Xl(4,J,J.return);break;case 1:ca(J,J.return);var pe=J.stateNode;if(typeof pe.componentWillUnmount=="function"){h=J,u=J.return;try{o=h,pe.props=o.memoizedProps,pe.state=o.memoizedState,pe.componentWillUnmount()}catch(ge){dt(h,u,ge)}}break;case 5:ca(J,J.return);break;case 22:if(J.memoizedState!==null){t_(ee);continue}}de!==null?(de.return=J,fe=de):t_(ee)}Z=Z.sibling}e:for(Z=null,ee=i;;){if(ee.tag===5){if(Z===null){Z=ee;try{p=ee.stateNode,W?(y=p.style,typeof y.setProperty=="function"?y.setProperty("display","none","important"):y.display="none"):(b=ee.stateNode,N=ee.memoizedProps.style,I=N!=null&&N.hasOwnProperty("display")?N.display:null,b.style.display=hl("display",I))}catch(ge){dt(i,i.return,ge)}}}else if(ee.tag===6){if(Z===null)try{ee.stateNode.nodeValue=W?"":ee.memoizedProps}catch(ge){dt(i,i.return,ge)}}else if((ee.tag!==22&&ee.tag!==23||ee.memoizedState===null||ee===i)&&ee.child!==null){ee.child.return=ee,ee=ee.child;continue}if(ee===i)break e;for(;ee.sibling===null;){if(ee.return===null||ee.return===i)break e;Z===ee&&(Z=null),ee=ee.return}Z===ee&&(Z=null),ee.sibling.return=ee.return,ee=ee.sibling}}break;case 19:rr(o,i),Tr(i),h&4&&Yv(i);break;case 21:break;default:rr(o,i),Tr(i)}}function Tr(i){var o=i.flags;if(o&2){try{e:{for(var u=i.return;u!==null;){if(Kv(u)){var h=u;break e}u=u.return}throw Error(t(160))}switch(h.tag){case 5:var p=h.stateNode;h.flags&32&&(_i(p,""),h.flags&=-33);var y=Qv(i);pp(i,y,p);break;case 3:case 4:var I=h.stateNode.containerInfo,b=Qv(i);fp(i,b,I);break;default:throw Error(t(161))}}catch(N){dt(i,i.return,N)}i.flags&=-3}o&4096&&(i.flags&=-4097)}function OS(i,o,u){fe=i,Zv(i)}function Zv(i,o,u){for(var h=(i.mode&1)!==0;fe!==null;){var p=fe,y=p.child;if(p.tag===22&&h){var I=p.memoizedState!==null||td;if(!I){var b=p.alternate,N=b!==null&&b.memoizedState!==null||Ht;b=td;var W=Ht;if(td=I,(Ht=N)&&!W)for(fe=p;fe!==null;)I=fe,N=I.child,I.tag===22&&I.memoizedState!==null?n_(p):N!==null?(N.return=I,fe=N):n_(p);for(;y!==null;)fe=y,Zv(y),y=y.sibling;fe=p,td=b,Ht=W}e_(i)}else(p.subtreeFlags&8772)!==0&&y!==null?(y.return=p,fe=y):e_(i)}}function e_(i){for(;fe!==null;){var o=fe;if((o.flags&8772)!==0){var u=o.alternate;try{if((o.flags&8772)!==0)switch(o.tag){case 0:case 11:case 15:Ht||nd(5,o);break;case 1:var h=o.stateNode;if(o.flags&4&&!Ht)if(u===null)h.componentDidMount();else{var p=o.elementType===o.type?u.memoizedProps:tr(o.type,u.memoizedProps);h.componentDidUpdate(p,u.memoizedState,h.__reactInternalSnapshotBeforeUpdate)}var y=o.updateQueue;y!==null&&tv(o,y,h);break;case 3:var I=o.updateQueue;if(I!==null){if(u=null,o.child!==null)switch(o.child.tag){case 5:u=o.child.stateNode;break;case 1:u=o.child.stateNode}tv(o,I,u)}break;case 5:var b=o.stateNode;if(u===null&&o.flags&4){u=b;var N=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":N.autoFocus&&u.focus();break;case"img":N.src&&(u.src=N.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var W=o.alternate;if(W!==null){var Z=W.memoizedState;if(Z!==null){var ee=Z.dehydrated;ee!==null&&Yn(ee)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Ht||o.flags&512&&hp(o)}catch(J){dt(o,o.return,J)}}if(o===i){fe=null;break}if(u=o.sibling,u!==null){u.return=o.return,fe=u;break}fe=o.return}}function t_(i){for(;fe!==null;){var o=fe;if(o===i){fe=null;break}var u=o.sibling;if(u!==null){u.return=o.return,fe=u;break}fe=o.return}}function n_(i){for(;fe!==null;){var o=fe;try{switch(o.tag){case 0:case 11:case 15:var u=o.return;try{nd(4,o)}catch(N){dt(o,u,N)}break;case 1:var h=o.stateNode;if(typeof h.componentDidMount=="function"){var p=o.return;try{h.componentDidMount()}catch(N){dt(o,p,N)}}var y=o.return;try{hp(o)}catch(N){dt(o,y,N)}break;case 5:var I=o.return;try{hp(o)}catch(N){dt(o,I,N)}}}catch(N){dt(o,o.return,N)}if(o===i){fe=null;break}var b=o.sibling;if(b!==null){b.return=o.return,fe=b;break}fe=o.return}}var LS=Math.ceil,rd=ne.ReactCurrentDispatcher,mp=ne.ReactCurrentOwner,On=ne.ReactCurrentBatchConfig,Fe=0,Dt=null,yt=null,Ft=0,En=0,da=Pi(0),bt=0,Yl=null,Ms=0,id=0,gp=0,Jl=null,cn=null,yp=0,ha=1/0,ni=null,sd=!1,vp=null,Mi=null,od=!1,ji=null,ad=0,Zl=0,_p=null,ld=-1,ud=0;function en(){return(Fe&6)!==0?Je():ld!==-1?ld:ld=Je()}function Fi(i){return(i.mode&1)===0?1:(Fe&2)!==0&&Ft!==0?Ft&-Ft:_S.transition!==null?(ud===0&&(ud=Ss()),ud):(i=Oe,i!==0||(i=window.event,i=i===void 0?16:bl(i.type)),i)}function ir(i,o,u,h){if(50<Zl)throw Zl=0,_p=null,Error(t(185));xi(i,u,h),((Fe&2)===0||i!==Dt)&&(i===Dt&&((Fe&2)===0&&(id|=u),bt===4&&Ui(i,Ft)),dn(i,h),u===1&&Fe===0&&(o.mode&1)===0&&(ha=Je()+500,Mc&&Di()))}function dn(i,o){var u=i.callbackNode;qr(i,o);var h=Ts(i,i===Dt?Ft:0);if(h===0)u!==null&&Il(u),i.callbackNode=null,i.callbackPriority=0;else if(o=h&-h,i.callbackPriority!==o){if(u!=null&&Il(u),o===1)i.tag===0?vS(i_.bind(null,i)):$y(i_.bind(null,i)),pS(function(){(Fe&6)===0&&Di()}),u=null;else{switch(Si(h)){case 1:u=Is;break;case 4:u=wi;break;case 16:u=An;break;case 536870912:u=uc;break;default:u=An}u=h_(u,r_.bind(null,i))}i.callbackPriority=o,i.callbackNode=u}}function r_(i,o){if(ld=-1,ud=0,(Fe&6)!==0)throw Error(t(327));var u=i.callbackNode;if(fa()&&i.callbackNode!==u)return null;var h=Ts(i,i===Dt?Ft:0);if(h===0)return null;if((h&30)!==0||(h&i.expiredLanes)!==0||o)o=cd(i,h);else{o=h;var p=Fe;Fe|=2;var y=o_();(Dt!==i||Ft!==o)&&(ni=null,ha=Je()+500,Fs(i,o));do try{FS();break}catch(b){s_(i,b)}while(!0);Mf(),rd.current=y,Fe=p,yt!==null?o=0:(Dt=null,Ft=0,o=bt)}if(o!==0){if(o===2&&(p=gn(i),p!==0&&(h=p,o=wp(i,p))),o===1)throw u=Yl,Fs(i,0),Ui(i,h),dn(i,Je()),u;if(o===6)Ui(i,h);else{if(p=i.current.alternate,(h&30)===0&&!MS(p)&&(o=cd(i,h),o===2&&(y=gn(i),y!==0&&(h=y,o=wp(i,y))),o===1))throw u=Yl,Fs(i,0),Ui(i,h),dn(i,Je()),u;switch(i.finishedWork=p,i.finishedLanes=h,o){case 0:case 1:throw Error(t(345));case 2:Us(i,cn,ni);break;case 3:if(Ui(i,h),(h&130023424)===h&&(o=yp+500-Je(),10<o)){if(Ts(i,0)!==0)break;if(p=i.suspendedLanes,(p&h)!==h){en(),i.pingedLanes|=i.suspendedLanes&p;break}i.timeoutHandle=kf(Us.bind(null,i,cn,ni),o);break}Us(i,cn,ni);break;case 4:if(Ui(i,h),(h&4194240)===h)break;for(o=i.eventTimes,p=-1;0<h;){var I=31-Yt(h);y=1<<I,I=o[I],I>p&&(p=I),h&=~y}if(h=p,h=Je()-h,h=(120>h?120:480>h?480:1080>h?1080:1920>h?1920:3e3>h?3e3:4320>h?4320:1960*LS(h/1960))-h,10<h){i.timeoutHandle=kf(Us.bind(null,i,cn,ni),h);break}Us(i,cn,ni);break;case 5:Us(i,cn,ni);break;default:throw Error(t(329))}}}return dn(i,Je()),i.callbackNode===u?r_.bind(null,i):null}function wp(i,o){var u=Jl;return i.current.memoizedState.isDehydrated&&(Fs(i,o).flags|=256),i=cd(i,o),i!==2&&(o=cn,cn=u,o!==null&&Ep(o)),i}function Ep(i){cn===null?cn=i:cn.push.apply(cn,i)}function MS(i){for(var o=i;;){if(o.flags&16384){var u=o.updateQueue;if(u!==null&&(u=u.stores,u!==null))for(var h=0;h<u.length;h++){var p=u[h],y=p.getSnapshot;p=p.value;try{if(!Zn(y(),p))return!1}catch{return!1}}}if(u=o.child,o.subtreeFlags&16384&&u!==null)u.return=o,o=u;else{if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Ui(i,o){for(o&=~gp,o&=~id,i.suspendedLanes|=o,i.pingedLanes&=~o,i=i.expirationTimes;0<o;){var u=31-Yt(o),h=1<<u;i[u]=-1,o&=~h}}function i_(i){if((Fe&6)!==0)throw Error(t(327));fa();var o=Ts(i,0);if((o&1)===0)return dn(i,Je()),null;var u=cd(i,o);if(i.tag!==0&&u===2){var h=gn(i);h!==0&&(o=h,u=wp(i,h))}if(u===1)throw u=Yl,Fs(i,0),Ui(i,o),dn(i,Je()),u;if(u===6)throw Error(t(345));return i.finishedWork=i.current.alternate,i.finishedLanes=o,Us(i,cn,ni),dn(i,Je()),null}function Ip(i,o){var u=Fe;Fe|=1;try{return i(o)}finally{Fe=u,Fe===0&&(ha=Je()+500,Mc&&Di())}}function js(i){ji!==null&&ji.tag===0&&(Fe&6)===0&&fa();var o=Fe;Fe|=1;var u=On.transition,h=Oe;try{if(On.transition=null,Oe=1,i)return i()}finally{Oe=h,On.transition=u,Fe=o,(Fe&6)===0&&Di()}}function xp(){En=da.current,tt(da)}function Fs(i,o){i.finishedWork=null,i.finishedLanes=0;var u=i.timeoutHandle;if(u!==-1&&(i.timeoutHandle=-1,fS(u)),yt!==null)for(u=yt.return;u!==null;){var h=u;switch(Nf(h),h.tag){case 1:h=h.type.childContextTypes,h!=null&&Oc();break;case 3:la(),tt(an),tt(zt),Hf();break;case 5:$f(h);break;case 4:la();break;case 13:tt(lt);break;case 19:tt(lt);break;case 10:jf(h.type._context);break;case 22:case 23:xp()}u=u.return}if(Dt=i,yt=i=Bi(i.current,null),Ft=En=o,bt=0,Yl=null,gp=id=Ms=0,cn=Jl=null,Vs!==null){for(o=0;o<Vs.length;o++)if(u=Vs[o],h=u.interleaved,h!==null){u.interleaved=null;var p=h.next,y=u.pending;if(y!==null){var I=y.next;y.next=p,h.next=I}u.pending=h}Vs=null}return i}function s_(i,o){do{var u=yt;try{if(Mf(),Gc.current=Yc,Kc){for(var h=ut.memoizedState;h!==null;){var p=h.queue;p!==null&&(p.pending=null),h=h.next}Kc=!1}if(Ls=0,Nt=kt=ut=null,Hl=!1,Wl=0,mp.current=null,u===null||u.return===null){bt=1,Yl=o,yt=null;break}e:{var y=i,I=u.return,b=u,N=o;if(o=Ft,b.flags|=32768,N!==null&&typeof N=="object"&&typeof N.then=="function"){var W=N,Z=b,ee=Z.tag;if((Z.mode&1)===0&&(ee===0||ee===11||ee===15)){var J=Z.alternate;J?(Z.updateQueue=J.updateQueue,Z.memoizedState=J.memoizedState,Z.lanes=J.lanes):(Z.updateQueue=null,Z.memoizedState=null)}var de=Cv(I);if(de!==null){de.flags&=-257,Pv(de,I,b,y,o),de.mode&1&&Rv(y,W,o),o=de,N=W;var pe=o.updateQueue;if(pe===null){var ge=new Set;ge.add(N),o.updateQueue=ge}else pe.add(N);break e}else{if((o&1)===0){Rv(y,W,o),Tp();break e}N=Error(t(426))}}else if(rt&&b.mode&1){var mt=Cv(I);if(mt!==null){(mt.flags&65536)===0&&(mt.flags|=256),Pv(mt,I,b,y,o),Of(ua(N,b));break e}}y=N=ua(N,b),bt!==4&&(bt=2),Jl===null?Jl=[y]:Jl.push(y),y=I;do{switch(y.tag){case 3:y.flags|=65536,o&=-o,y.lanes|=o;var $=bv(y,N,o);ev(y,$);break e;case 1:b=N;var O=y.type,H=y.stateNode;if((y.flags&128)===0&&(typeof O.getDerivedStateFromError=="function"||H!==null&&typeof H.componentDidCatch=="function"&&(Mi===null||!Mi.has(H)))){y.flags|=65536,o&=-o,y.lanes|=o;var re=Av(y,b,o);ev(y,re);break e}}y=y.return}while(y!==null)}l_(u)}catch(ye){o=ye,yt===u&&u!==null&&(yt=u=u.return);continue}break}while(!0)}function o_(){var i=rd.current;return rd.current=Yc,i===null?Yc:i}function Tp(){(bt===0||bt===3||bt===2)&&(bt=4),Dt===null||(Ms&268435455)===0&&(id&268435455)===0||Ui(Dt,Ft)}function cd(i,o){var u=Fe;Fe|=2;var h=o_();(Dt!==i||Ft!==o)&&(ni=null,Fs(i,o));do try{jS();break}catch(p){s_(i,p)}while(!0);if(Mf(),Fe=u,rd.current=h,yt!==null)throw Error(t(261));return Dt=null,Ft=0,bt}function jS(){for(;yt!==null;)a_(yt)}function FS(){for(;yt!==null&&!ac();)a_(yt)}function a_(i){var o=d_(i.alternate,i,En);i.memoizedProps=i.pendingProps,o===null?l_(i):yt=o,mp.current=null}function l_(i){var o=i;do{var u=o.alternate;if(i=o.return,(o.flags&32768)===0){if(u=PS(u,o,En),u!==null){yt=u;return}}else{if(u=NS(u,o),u!==null){u.flags&=32767,yt=u;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{bt=6,yt=null;return}}if(o=o.sibling,o!==null){yt=o;return}yt=o=i}while(o!==null);bt===0&&(bt=5)}function Us(i,o,u){var h=Oe,p=On.transition;try{On.transition=null,Oe=1,US(i,o,u,h)}finally{On.transition=p,Oe=h}return null}function US(i,o,u,h){do fa();while(ji!==null);if((Fe&6)!==0)throw Error(t(327));u=i.finishedWork;var p=i.finishedLanes;if(u===null)return null;if(i.finishedWork=null,i.finishedLanes=0,u===i.current)throw Error(t(177));i.callbackNode=null,i.callbackPriority=0;var y=u.lanes|u.childLanes;if(Qe(i,y),i===Dt&&(yt=Dt=null,Ft=0),(u.subtreeFlags&2064)===0&&(u.flags&2064)===0||od||(od=!0,h_(An,function(){return fa(),null})),y=(u.flags&15990)!==0,(u.subtreeFlags&15990)!==0||y){y=On.transition,On.transition=null;var I=Oe;Oe=1;var b=Fe;Fe|=4,mp.current=null,VS(i,u),Jv(u,i),oS(Tf),bi=!!xf,Tf=xf=null,i.current=u,OS(u),af(),Fe=b,Oe=I,On.transition=y}else i.current=u;if(od&&(od=!1,ji=i,ad=p),y=i.pendingLanes,y===0&&(Mi=null),cc(u.stateNode),dn(i,Je()),o!==null)for(h=i.onRecoverableError,u=0;u<o.length;u++)p=o[u],h(p.value,{componentStack:p.stack,digest:p.digest});if(sd)throw sd=!1,i=vp,vp=null,i;return(ad&1)!==0&&i.tag!==0&&fa(),y=i.pendingLanes,(y&1)!==0?i===_p?Zl++:(Zl=0,_p=i):Zl=0,Di(),null}function fa(){if(ji!==null){var i=Si(ad),o=On.transition,u=Oe;try{if(On.transition=null,Oe=16>i?16:i,ji===null)var h=!1;else{if(i=ji,ji=null,ad=0,(Fe&6)!==0)throw Error(t(331));var p=Fe;for(Fe|=4,fe=i.current;fe!==null;){var y=fe,I=y.child;if((fe.flags&16)!==0){var b=y.deletions;if(b!==null){for(var N=0;N<b.length;N++){var W=b[N];for(fe=W;fe!==null;){var Z=fe;switch(Z.tag){case 0:case 11:case 15:Xl(8,Z,y)}var ee=Z.child;if(ee!==null)ee.return=Z,fe=ee;else for(;fe!==null;){Z=fe;var J=Z.sibling,de=Z.return;if(Gv(Z),Z===W){fe=null;break}if(J!==null){J.return=de,fe=J;break}fe=de}}}var pe=y.alternate;if(pe!==null){var ge=pe.child;if(ge!==null){pe.child=null;do{var mt=ge.sibling;ge.sibling=null,ge=mt}while(ge!==null)}}fe=y}}if((y.subtreeFlags&2064)!==0&&I!==null)I.return=y,fe=I;else e:for(;fe!==null;){if(y=fe,(y.flags&2048)!==0)switch(y.tag){case 0:case 11:case 15:Xl(9,y,y.return)}var $=y.sibling;if($!==null){$.return=y.return,fe=$;break e}fe=y.return}}var O=i.current;for(fe=O;fe!==null;){I=fe;var H=I.child;if((I.subtreeFlags&2064)!==0&&H!==null)H.return=I,fe=H;else e:for(I=O;fe!==null;){if(b=fe,(b.flags&2048)!==0)try{switch(b.tag){case 0:case 11:case 15:nd(9,b)}}catch(ye){dt(b,b.return,ye)}if(b===I){fe=null;break e}var re=b.sibling;if(re!==null){re.return=b.return,fe=re;break e}fe=b.return}}if(Fe=p,Di(),mn&&typeof mn.onPostCommitFiberRoot=="function")try{mn.onPostCommitFiberRoot(xs,i)}catch{}h=!0}return h}finally{Oe=u,On.transition=o}}return!1}function u_(i,o,u){o=ua(u,o),o=bv(i,o,1),i=Oi(i,o,1),o=en(),i!==null&&(xi(i,1,o),dn(i,o))}function dt(i,o,u){if(i.tag===3)u_(i,i,u);else for(;o!==null;){if(o.tag===3){u_(o,i,u);break}else if(o.tag===1){var h=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(Mi===null||!Mi.has(h))){i=ua(u,i),i=Av(o,i,1),o=Oi(o,i,1),i=en(),o!==null&&(xi(o,1,i),dn(o,i));break}}o=o.return}}function BS(i,o,u){var h=i.pingCache;h!==null&&h.delete(o),o=en(),i.pingedLanes|=i.suspendedLanes&u,Dt===i&&(Ft&u)===u&&(bt===4||bt===3&&(Ft&130023424)===Ft&&500>Je()-yp?Fs(i,0):gp|=u),dn(i,o)}function c_(i,o){o===0&&((i.mode&1)===0?o=1:(o=Lo,Lo<<=1,(Lo&130023424)===0&&(Lo=4194304)));var u=en();i=Zr(i,o),i!==null&&(xi(i,o,u),dn(i,u))}function zS(i){var o=i.memoizedState,u=0;o!==null&&(u=o.retryLane),c_(i,u)}function $S(i,o){var u=0;switch(i.tag){case 13:var h=i.stateNode,p=i.memoizedState;p!==null&&(u=p.retryLane);break;case 19:h=i.stateNode;break;default:throw Error(t(314))}h!==null&&h.delete(o),c_(i,u)}var d_;d_=function(i,o,u){if(i!==null)if(i.memoizedProps!==o.pendingProps||an.current)un=!0;else{if((i.lanes&u)===0&&(o.flags&128)===0)return un=!1,CS(i,o,u);un=(i.flags&131072)!==0}else un=!1,rt&&(o.flags&1048576)!==0&&qy(o,Fc,o.index);switch(o.lanes=0,o.tag){case 2:var h=o.type;ed(i,o),i=o.pendingProps;var p=ta(o,zt.current);aa(o,u),p=Kf(null,o,h,i,p,u);var y=Qf();return o.flags|=1,typeof p=="object"&&p!==null&&typeof p.render=="function"&&p.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,ln(h)?(y=!0,Lc(o)):y=!1,o.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,Bf(o),p.updater=Jc,o.stateNode=p,p._reactInternals=o,tp(o,h,i,u),o=sp(null,o,h,!0,y,u)):(o.tag=0,rt&&y&&Pf(o),Zt(null,o,p,u),o=o.child),o;case 16:h=o.elementType;e:{switch(ed(i,o),i=o.pendingProps,p=h._init,h=p(h._payload),o.type=h,p=o.tag=HS(h),i=tr(h,i),p){case 0:o=ip(null,o,h,i,u);break e;case 1:o=Mv(null,o,h,i,u);break e;case 11:o=Nv(null,o,h,i,u);break e;case 14:o=Dv(null,o,h,tr(h.type,i),u);break e}throw Error(t(306,h,""))}return o;case 0:return h=o.type,p=o.pendingProps,p=o.elementType===h?p:tr(h,p),ip(i,o,h,p,u);case 1:return h=o.type,p=o.pendingProps,p=o.elementType===h?p:tr(h,p),Mv(i,o,h,p,u);case 3:e:{if(jv(o),i===null)throw Error(t(387));h=o.pendingProps,y=o.memoizedState,p=y.element,Zy(i,o),Hc(o,h,null,u);var I=o.memoizedState;if(h=I.element,y.isDehydrated)if(y={element:h,isDehydrated:!1,cache:I.cache,pendingSuspenseBoundaries:I.pendingSuspenseBoundaries,transitions:I.transitions},o.updateQueue.baseState=y,o.memoizedState=y,o.flags&256){p=ua(Error(t(423)),o),o=Fv(i,o,h,u,p);break e}else if(h!==p){p=ua(Error(t(424)),o),o=Fv(i,o,h,u,p);break e}else for(wn=Ci(o.stateNode.containerInfo.firstChild),_n=o,rt=!0,er=null,u=Yy(o,null,h,u),o.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling;else{if(ia(),h===p){o=ti(i,o,u);break e}Zt(i,o,h,u)}o=o.child}return o;case 5:return nv(o),i===null&&Vf(o),h=o.type,p=o.pendingProps,y=i!==null?i.memoizedProps:null,I=p.children,Sf(h,p)?I=null:y!==null&&Sf(h,y)&&(o.flags|=32),Lv(i,o),Zt(i,o,I,u),o.child;case 6:return i===null&&Vf(o),null;case 13:return Uv(i,o,u);case 4:return zf(o,o.stateNode.containerInfo),h=o.pendingProps,i===null?o.child=sa(o,null,h,u):Zt(i,o,h,u),o.child;case 11:return h=o.type,p=o.pendingProps,p=o.elementType===h?p:tr(h,p),Nv(i,o,h,p,u);case 7:return Zt(i,o,o.pendingProps,u),o.child;case 8:return Zt(i,o,o.pendingProps.children,u),o.child;case 12:return Zt(i,o,o.pendingProps.children,u),o.child;case 10:e:{if(h=o.type._context,p=o.pendingProps,y=o.memoizedProps,I=p.value,Ze(zc,h._currentValue),h._currentValue=I,y!==null)if(Zn(y.value,I)){if(y.children===p.children&&!an.current){o=ti(i,o,u);break e}}else for(y=o.child,y!==null&&(y.return=o);y!==null;){var b=y.dependencies;if(b!==null){I=y.child;for(var N=b.firstContext;N!==null;){if(N.context===h){if(y.tag===1){N=ei(-1,u&-u),N.tag=2;var W=y.updateQueue;if(W!==null){W=W.shared;var Z=W.pending;Z===null?N.next=N:(N.next=Z.next,Z.next=N),W.pending=N}}y.lanes|=u,N=y.alternate,N!==null&&(N.lanes|=u),Ff(y.return,u,o),b.lanes|=u;break}N=N.next}}else if(y.tag===10)I=y.type===o.type?null:y.child;else if(y.tag===18){if(I=y.return,I===null)throw Error(t(341));I.lanes|=u,b=I.alternate,b!==null&&(b.lanes|=u),Ff(I,u,o),I=y.sibling}else I=y.child;if(I!==null)I.return=y;else for(I=y;I!==null;){if(I===o){I=null;break}if(y=I.sibling,y!==null){y.return=I.return,I=y;break}I=I.return}y=I}Zt(i,o,p.children,u),o=o.child}return o;case 9:return p=o.type,h=o.pendingProps.children,aa(o,u),p=Dn(p),h=h(p),o.flags|=1,Zt(i,o,h,u),o.child;case 14:return h=o.type,p=tr(h,o.pendingProps),p=tr(h.type,p),Dv(i,o,h,p,u);case 15:return Vv(i,o,o.type,o.pendingProps,u);case 17:return h=o.type,p=o.pendingProps,p=o.elementType===h?p:tr(h,p),ed(i,o),o.tag=1,ln(h)?(i=!0,Lc(o)):i=!1,aa(o,u),Sv(o,h,p),tp(o,h,p,u),sp(null,o,h,!0,i,u);case 19:return zv(i,o,u);case 22:return Ov(i,o,u)}throw Error(t(156,o.tag))};function h_(i,o){return Vo(i,o)}function qS(i,o,u,h){this.tag=i,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ln(i,o,u,h){return new qS(i,o,u,h)}function Sp(i){return i=i.prototype,!(!i||!i.isReactComponent)}function HS(i){if(typeof i=="function")return Sp(i)?1:0;if(i!=null){if(i=i.$$typeof,i===M)return 11;if(i===Xe)return 14}return 2}function Bi(i,o){var u=i.alternate;return u===null?(u=Ln(i.tag,o,i.key,i.mode),u.elementType=i.elementType,u.type=i.type,u.stateNode=i.stateNode,u.alternate=i,i.alternate=u):(u.pendingProps=o,u.type=i.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=i.flags&14680064,u.childLanes=i.childLanes,u.lanes=i.lanes,u.child=i.child,u.memoizedProps=i.memoizedProps,u.memoizedState=i.memoizedState,u.updateQueue=i.updateQueue,o=i.dependencies,u.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},u.sibling=i.sibling,u.index=i.index,u.ref=i.ref,u}function dd(i,o,u,h,p,y){var I=2;if(h=i,typeof i=="function")Sp(i)&&(I=1);else if(typeof i=="string")I=5;else e:switch(i){case C:return Bs(u.children,p,y,o);case k:I=8,p|=8;break;case R:return i=Ln(12,u,o,p|2),i.elementType=R,i.lanes=y,i;case A:return i=Ln(13,u,o,p),i.elementType=A,i.lanes=y,i;case Ae:return i=Ln(19,u,o,p),i.elementType=Ae,i.lanes=y,i;case Ke:return hd(u,p,y,o);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case P:I=10;break e;case V:I=9;break e;case M:I=11;break e;case Xe:I=14;break e;case ie:I=16,h=null;break e}throw Error(t(130,i==null?i:typeof i,""))}return o=Ln(I,u,o,p),o.elementType=i,o.type=h,o.lanes=y,o}function Bs(i,o,u,h){return i=Ln(7,i,h,o),i.lanes=u,i}function hd(i,o,u,h){return i=Ln(22,i,h,o),i.elementType=Ke,i.lanes=u,i.stateNode={isHidden:!1},i}function kp(i,o,u){return i=Ln(6,i,null,o),i.lanes=u,i}function bp(i,o,u){return o=Ln(4,i.children!==null?i.children:[],i.key,o),o.lanes=u,o.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},o}function WS(i,o,u,h,p){this.tag=o,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ii(0),this.expirationTimes=Ii(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ii(0),this.identifierPrefix=h,this.onRecoverableError=p,this.mutableSourceEagerHydrationData=null}function Ap(i,o,u,h,p,y,I,b,N){return i=new WS(i,o,u,b,N),o===1?(o=1,y===!0&&(o|=8)):o=0,y=Ln(3,null,null,o),i.current=y,y.stateNode=i,y.memoizedState={element:h,isDehydrated:u,cache:null,transitions:null,pendingSuspenseBoundaries:null},Bf(y),i}function GS(i,o,u){var h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ce,key:h==null?null:""+h,children:i,containerInfo:o,implementation:u}}function f_(i){if(!i)return Ni;i=i._reactInternals;e:{if(Wn(i)!==i||i.tag!==1)throw Error(t(170));var o=i;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(ln(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(t(171))}if(i.tag===1){var u=i.type;if(ln(u))return By(i,u,o)}return o}function p_(i,o,u,h,p,y,I,b,N){return i=Ap(u,h,!0,i,p,y,I,b,N),i.context=f_(null),u=i.current,h=en(),p=Fi(u),y=ei(h,p),y.callback=o??null,Oi(u,y,p),i.current.lanes=p,xi(i,p,h),dn(i,h),i}function fd(i,o,u,h){var p=o.current,y=en(),I=Fi(p);return u=f_(u),o.context===null?o.context=u:o.pendingContext=u,o=ei(y,I),o.payload={element:i},h=h===void 0?null:h,h!==null&&(o.callback=h),i=Oi(p,o,I),i!==null&&(ir(i,p,I,y),qc(i,p,I)),I}function pd(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function m_(i,o){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var u=i.retryLane;i.retryLane=u!==0&&u<o?u:o}}function Rp(i,o){m_(i,o),(i=i.alternate)&&m_(i,o)}function KS(){return null}var g_=typeof reportError=="function"?reportError:function(i){console.error(i)};function Cp(i){this._internalRoot=i}md.prototype.render=Cp.prototype.render=function(i){var o=this._internalRoot;if(o===null)throw Error(t(409));fd(i,o,null,null)},md.prototype.unmount=Cp.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var o=i.containerInfo;js(function(){fd(null,i,null,null)}),o[Qr]=null}};function md(i){this._internalRoot=i}md.prototype.unstable_scheduleHydration=function(i){if(i){var o=mc();i={blockedOn:null,target:i,priority:o};for(var u=0;u<yr.length&&o!==0&&o<yr[u].priority;u++);yr.splice(u,0,i),u===0&&vc(i)}};function Pp(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function gd(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function y_(){}function QS(i,o,u,h,p){if(p){if(typeof h=="function"){var y=h;h=function(){var W=pd(I);y.call(W)}}var I=p_(o,h,i,0,null,!1,!1,"",y_);return i._reactRootContainer=I,i[Qr]=I.current,Ml(i.nodeType===8?i.parentNode:i),js(),I}for(;p=i.lastChild;)i.removeChild(p);if(typeof h=="function"){var b=h;h=function(){var W=pd(N);b.call(W)}}var N=Ap(i,0,!1,null,null,!1,!1,"",y_);return i._reactRootContainer=N,i[Qr]=N.current,Ml(i.nodeType===8?i.parentNode:i),js(function(){fd(o,N,u,h)}),N}function yd(i,o,u,h,p){var y=u._reactRootContainer;if(y){var I=y;if(typeof p=="function"){var b=p;p=function(){var N=pd(I);b.call(N)}}fd(o,I,i,p)}else I=QS(u,o,i,p,h);return pd(I)}fc=function(i){switch(i.tag){case 3:var o=i.stateNode;if(o.current.memoizedState.isDehydrated){var u=Ei(o.pendingLanes);u!==0&&(Ti(o,u|1),dn(o,Je()),(Fe&6)===0&&(ha=Je()+500,Di()))}break;case 13:js(function(){var h=Zr(i,1);if(h!==null){var p=en();ir(h,i,1,p)}}),Rp(i,1)}},Mo=function(i){if(i.tag===13){var o=Zr(i,134217728);if(o!==null){var u=en();ir(o,i,134217728,u)}Rp(i,134217728)}},pc=function(i){if(i.tag===13){var o=Fi(i),u=Zr(i,o);if(u!==null){var h=en();ir(u,i,o,h)}Rp(i,o)}},mc=function(){return Oe},gc=function(i,o){var u=Oe;try{return Oe=i,o()}finally{Oe=u}},Ao=function(i,o,u){switch(o){case"input":if(ll(i,u),o=u.name,u.type==="radio"&&o!=null){for(u=i;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<u.length;o++){var h=u[o];if(h!==i&&h.form===i.form){var p=Vc(h);if(!p)throw Error(t(90));Io(h),ll(h,p)}}}break;case"textarea":ko(i,u);break;case"select":o=u.value,o!=null&&Br(i,!!u.multiple,o,!1)}},vs=Ip,vl=js;var XS={usingClientEntryPoint:!1,Events:[Ul,Zo,Vc,mr,yl,Ip]},eu={findFiberByHostInstance:Cs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},YS={bundleType:eu.bundleType,version:eu.version,rendererPackageName:eu.rendererPackageName,rendererConfig:eu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ne.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=El(i),i===null?null:i.stateNode},findFiberByHostInstance:eu.findFiberByHostInstance||KS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vd.isDisabled&&vd.supportsFiber)try{xs=vd.inject(YS),mn=vd}catch{}}return hn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=XS,hn.createPortal=function(i,o){var u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Pp(o))throw Error(t(200));return GS(i,o,null,u)},hn.createRoot=function(i,o){if(!Pp(i))throw Error(t(299));var u=!1,h="",p=g_;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(h=o.identifierPrefix),o.onRecoverableError!==void 0&&(p=o.onRecoverableError)),o=Ap(i,1,!1,null,null,u,!1,h,p),i[Qr]=o.current,Ml(i.nodeType===8?i.parentNode:i),new Cp(o)},hn.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var o=i._reactInternals;if(o===void 0)throw typeof i.render=="function"?Error(t(188)):(i=Object.keys(i).join(","),Error(t(268,i)));return i=El(o),i=i===null?null:i.stateNode,i},hn.flushSync=function(i){return js(i)},hn.hydrate=function(i,o,u){if(!gd(o))throw Error(t(200));return yd(null,i,o,!0,u)},hn.hydrateRoot=function(i,o,u){if(!Pp(i))throw Error(t(405));var h=u!=null&&u.hydratedSources||null,p=!1,y="",I=g_;if(u!=null&&(u.unstable_strictMode===!0&&(p=!0),u.identifierPrefix!==void 0&&(y=u.identifierPrefix),u.onRecoverableError!==void 0&&(I=u.onRecoverableError)),o=p_(o,null,i,1,u??null,p,!1,y,I),i[Qr]=o.current,Ml(i),h)for(i=0;i<h.length;i++)u=h[i],p=u._getVersion,p=p(u._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[u,p]:o.mutableSourceEagerHydrationData.push(u,p);return new md(o)},hn.render=function(i,o,u){if(!gd(o))throw Error(t(200));return yd(null,i,o,!1,u)},hn.unmountComponentAtNode=function(i){if(!gd(i))throw Error(t(40));return i._reactRootContainer?(js(function(){yd(null,null,i,!1,function(){i._reactRootContainer=null,i[Qr]=null})}),!0):!1},hn.unstable_batchedUpdates=Ip,hn.unstable_renderSubtreeIntoContainer=function(i,o,u,h){if(!gd(u))throw Error(t(200));if(i==null||i._reactInternals===void 0)throw Error(t(38));return yd(i,o,u,!1,h)},hn.version="18.3.1-next-f1338f8080-20240426",hn}var S_;function sk(){if(S_)return Vp.exports;S_=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Vp.exports=ik(),Vp.exports}var k_;function ok(){if(k_)return _d;k_=1;var n=sk();return _d.createRoot=n.createRoot,_d.hydrateRoot=n.hydrateRoot,_d}var ak=ok();const lk=H0(ak);/**
 * react-router v7.10.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var b_="popstate";function uk(n={}){function e(r,s){let{pathname:a,search:l,hash:d}=r.location;return tm("",{pathname:a,search:l,hash:d},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function t(r,s){return typeof s=="string"?s:Tu(s)}return dk(e,t,null,n)}function st(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Bn(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function ck(){return Math.random().toString(36).substring(2,10)}function A_(n,e){return{usr:n.state,key:n.key,idx:e}}function tm(n,e,t=null,r){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?Ga(e):e,state:t,key:e&&e.key||r||ck()}}function Tu({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function Ga(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substring(r),n=n.substring(0,r)),n&&(e.pathname=n)}return e}function dk(n,e,t,r={}){let{window:s=document.defaultView,v5Compat:a=!1}=r,l=s.history,d="POP",f=null,m=v();m==null&&(m=0,l.replaceState({...l.state,idx:m},""));function v(){return(l.state||{idx:null}).idx}function _(){d="POP";let L=v(),K=L==null?null:L-m;m=L,f&&f({action:d,location:U.location,delta:K})}function x(L,K){d="PUSH";let X=tm(U.location,L,K);m=v()+1;let q=A_(X,m),ne=U.createHref(X);try{l.pushState(q,"",ne)}catch(ue){if(ue instanceof DOMException&&ue.name==="DataCloneError")throw ue;s.location.assign(ne)}a&&f&&f({action:d,location:U.location,delta:1})}function S(L,K){d="REPLACE";let X=tm(U.location,L,K);m=v();let q=A_(X,m),ne=U.createHref(X);l.replaceState(q,"",ne),a&&f&&f({action:d,location:U.location,delta:0})}function D(L){return hk(L)}let U={get action(){return d},get location(){return n(s,l)},listen(L){if(f)throw new Error("A history only accepts one active listener");return s.addEventListener(b_,_),f=L,()=>{s.removeEventListener(b_,_),f=null}},createHref(L){return e(s,L)},createURL:D,encodeLocation(L){let K=D(L);return{pathname:K.pathname,search:K.search,hash:K.hash}},push:x,replace:S,go(L){return l.go(L)}};return U}function hk(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),st(t,"No window.location.(origin|href) available to create URL");let r=typeof n=="string"?n:Tu(n);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=t+r),new URL(r,t)}function W0(n,e,t="/"){return fk(n,e,t,!1)}function fk(n,e,t,r){let s=typeof e=="string"?Ga(e):e,a=ui(s.pathname||"/",t);if(a==null)return null;let l=G0(n);pk(l);let d=null;for(let f=0;d==null&&f<l.length;++f){let m=Sk(a);d=xk(l[f],m,r)}return d}function G0(n,e=[],t=[],r="",s=!1){let a=(l,d,f=s,m)=>{let v={relativePath:m===void 0?l.path||"":m,caseSensitive:l.caseSensitive===!0,childrenIndex:d,route:l};if(v.relativePath.startsWith("/")){if(!v.relativePath.startsWith(r)&&f)return;st(v.relativePath.startsWith(r),`Absolute route path "${v.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),v.relativePath=v.relativePath.slice(r.length)}let _=li([r,v.relativePath]),x=t.concat(v);l.children&&l.children.length>0&&(st(l.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${_}".`),G0(l.children,e,x,_,f)),!(l.path==null&&!l.index)&&e.push({path:_,score:Ek(_,l.index),routesMeta:x})};return n.forEach((l,d)=>{var f;if(l.path===""||!((f=l.path)!=null&&f.includes("?")))a(l,d);else for(let m of K0(l.path))a(l,d,!0,m)}),e}function K0(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,s=t.endsWith("?"),a=t.replace(/\?$/,"");if(r.length===0)return s?[a,""]:[a];let l=K0(r.join("/")),d=[];return d.push(...l.map(f=>f===""?a:[a,f].join("/"))),s&&d.push(...l),d.map(f=>n.startsWith("/")&&f===""?"/":f)}function pk(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:Ik(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}var mk=/^:[\w-]+$/,gk=3,yk=2,vk=1,_k=10,wk=-2,R_=n=>n==="*";function Ek(n,e){let t=n.split("/"),r=t.length;return t.some(R_)&&(r+=wk),e&&(r+=yk),t.filter(s=>!R_(s)).reduce((s,a)=>s+(mk.test(a)?gk:a===""?vk:_k),r)}function Ik(n,e){return n.length===e.length&&n.slice(0,-1).every((r,s)=>r===e[s])?n[n.length-1]-e[e.length-1]:0}function xk(n,e,t=!1){let{routesMeta:r}=n,s={},a="/",l=[];for(let d=0;d<r.length;++d){let f=r[d],m=d===r.length-1,v=a==="/"?e:e.slice(a.length)||"/",_=Gd({path:f.relativePath,caseSensitive:f.caseSensitive,end:m},v),x=f.route;if(!_&&m&&t&&!r[r.length-1].route.index&&(_=Gd({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},v)),!_)return null;Object.assign(s,_.params),l.push({params:s,pathname:li([a,_.pathname]),pathnameBase:Ck(li([a,_.pathnameBase])),route:x}),_.pathnameBase!=="/"&&(a=li([a,_.pathnameBase]))}return l}function Gd(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=Tk(n.path,n.caseSensitive,n.end),s=e.match(t);if(!s)return null;let a=s[0],l=a.replace(/(.)\/+$/,"$1"),d=s.slice(1);return{params:r.reduce((m,{paramName:v,isOptional:_},x)=>{if(v==="*"){let D=d[x]||"";l=a.slice(0,a.length-D.length).replace(/(.)\/+$/,"$1")}const S=d[x];return _&&!S?m[v]=void 0:m[v]=(S||"").replace(/%2F/g,"/"),m},{}),pathname:a,pathnameBase:l,pattern:n}}function Tk(n,e=!1,t=!0){Bn(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let r=[],s="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,d,f)=>(r.push({paramName:d,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(r.push({paramName:"*"}),s+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?s+="\\/*$":n!==""&&n!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function Sk(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Bn(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function ui(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}var kk=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,bk=n=>kk.test(n);function Ak(n,e="/"){let{pathname:t,search:r="",hash:s=""}=typeof n=="string"?Ga(n):n,a;if(t)if(bk(t))a=t;else{if(t.includes("//")){let l=t;t=t.replace(/\/\/+/g,"/"),Bn(!1,`Pathnames cannot have embedded double slashes - normalizing ${l} -> ${t}`)}t.startsWith("/")?a=C_(t.substring(1),"/"):a=C_(t,e)}else a=e;return{pathname:a,search:Pk(r),hash:Nk(s)}}function C_(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(s=>{s===".."?t.length>1&&t.pop():s!=="."&&t.push(s)}),t.length>1?t.join("/"):"/"}function Mp(n,e,t,r){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Rk(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Fm(n){let e=Rk(n);return e.map((t,r)=>r===e.length-1?t.pathname:t.pathnameBase)}function Um(n,e,t,r=!1){let s;typeof n=="string"?s=Ga(n):(s={...n},st(!s.pathname||!s.pathname.includes("?"),Mp("?","pathname","search",s)),st(!s.pathname||!s.pathname.includes("#"),Mp("#","pathname","hash",s)),st(!s.search||!s.search.includes("#"),Mp("#","search","hash",s)));let a=n===""||s.pathname==="",l=a?"/":s.pathname,d;if(l==null)d=t;else{let _=e.length-1;if(!r&&l.startsWith("..")){let x=l.split("/");for(;x[0]==="..";)x.shift(),_-=1;s.pathname=x.join("/")}d=_>=0?e[_]:"/"}let f=Ak(s,d),m=l&&l!=="/"&&l.endsWith("/"),v=(a||l===".")&&t.endsWith("/");return!f.pathname.endsWith("/")&&(m||v)&&(f.pathname+="/"),f}var li=n=>n.join("/").replace(/\/\/+/g,"/"),Ck=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),Pk=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,Nk=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function Dk(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}function Vk(n){return n.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Q0=["POST","PUT","PATCH","DELETE"];new Set(Q0);var Ok=["GET",...Q0];new Set(Ok);var Ka=F.createContext(null);Ka.displayName="DataRouter";var Ih=F.createContext(null);Ih.displayName="DataRouterState";F.createContext(!1);var X0=F.createContext({isTransitioning:!1});X0.displayName="ViewTransition";var Lk=F.createContext(new Map);Lk.displayName="Fetchers";var Mk=F.createContext(null);Mk.displayName="Await";var zn=F.createContext(null);zn.displayName="Navigation";var Bu=F.createContext(null);Bu.displayName="Location";var dr=F.createContext({outlet:null,matches:[],isDataRoute:!1});dr.displayName="Route";var Bm=F.createContext(null);Bm.displayName="RouteError";function jk(n,{relative:e}={}){st(Qa(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:r}=F.useContext(zn),{hash:s,pathname:a,search:l}=zu(n,{relative:e}),d=a;return t!=="/"&&(d=a==="/"?t:li([t,a])),r.createHref({pathname:d,search:l,hash:s})}function Qa(){return F.useContext(Bu)!=null}function ds(){return st(Qa(),"useLocation() may be used only in the context of a <Router> component."),F.useContext(Bu).location}var Y0="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function J0(n){F.useContext(zn).static||F.useLayoutEffect(n)}function $n(){let{isDataRoute:n}=F.useContext(dr);return n?Yk():Fk()}function Fk(){st(Qa(),"useNavigate() may be used only in the context of a <Router> component.");let n=F.useContext(Ka),{basename:e,navigator:t}=F.useContext(zn),{matches:r}=F.useContext(dr),{pathname:s}=ds(),a=JSON.stringify(Fm(r)),l=F.useRef(!1);return J0(()=>{l.current=!0}),F.useCallback((f,m={})=>{if(Bn(l.current,Y0),!l.current)return;if(typeof f=="number"){t.go(f);return}let v=Um(f,JSON.parse(a),s,m.relative==="path");n==null&&e!=="/"&&(v.pathname=v.pathname==="/"?e:li([e,v.pathname])),(m.replace?t.replace:t.push)(v,m.state,m)},[e,t,a,s,n])}F.createContext(null);function zm(){let{matches:n}=F.useContext(dr),e=n[n.length-1];return e?e.params:{}}function zu(n,{relative:e}={}){let{matches:t}=F.useContext(dr),{pathname:r}=ds(),s=JSON.stringify(Fm(t));return F.useMemo(()=>Um(n,JSON.parse(s),r,e==="path"),[n,s,r,e])}function Uk(n,e){return Z0(n,e)}function Z0(n,e,t,r,s){var X;st(Qa(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=F.useContext(zn),{matches:l}=F.useContext(dr),d=l[l.length-1],f=d?d.params:{},m=d?d.pathname:"/",v=d?d.pathnameBase:"/",_=d&&d.route;{let q=_&&_.path||"";eE(m,!_||q.endsWith("*")||q.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${m}" (under <Route path="${q}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${q}"> to <Route path="${q==="/"?"*":`${q}/*`}">.`)}let x=ds(),S;if(e){let q=typeof e=="string"?Ga(e):e;st(v==="/"||((X=q.pathname)==null?void 0:X.startsWith(v)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${v}" but pathname "${q.pathname}" was given in the \`location\` prop.`),S=q}else S=x;let D=S.pathname||"/",U=D;if(v!=="/"){let q=v.replace(/^\//,"").split("/");U="/"+D.replace(/^\//,"").split("/").slice(q.length).join("/")}let L=W0(n,{pathname:U});Bn(_||L!=null,`No routes matched location "${S.pathname}${S.search}${S.hash}" `),Bn(L==null||L[L.length-1].route.element!==void 0||L[L.length-1].route.Component!==void 0||L[L.length-1].route.lazy!==void 0,`Matched leaf route at location "${S.pathname}${S.search}${S.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let K=Hk(L&&L.map(q=>Object.assign({},q,{params:Object.assign({},f,q.params),pathname:li([v,a.encodeLocation?a.encodeLocation(q.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:q.pathname]),pathnameBase:q.pathnameBase==="/"?v:li([v,a.encodeLocation?a.encodeLocation(q.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:q.pathnameBase])})),l,t,r,s);return e&&K?F.createElement(Bu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...S},navigationType:"POP"}},K):K}function Bk(){let n=Xk(),e=Dk(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,r="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:r},a={padding:"2px 4px",backgroundColor:r},l=null;return console.error("Error handled by React Router default ErrorBoundary:",n),l=F.createElement(F.Fragment,null,F.createElement("p",null," Hey developer "),F.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",F.createElement("code",{style:a},"ErrorBoundary")," or"," ",F.createElement("code",{style:a},"errorElement")," prop on your route.")),F.createElement(F.Fragment,null,F.createElement("h2",null,"Unexpected Application Error!"),F.createElement("h3",{style:{fontStyle:"italic"}},e),t?F.createElement("pre",{style:s},t):null,l)}var zk=F.createElement(Bk,null),$k=class extends F.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){this.props.onError?this.props.onError(n,e):console.error("React Router caught the following error during render",n)}render(){return this.state.error!==void 0?F.createElement(dr.Provider,{value:this.props.routeContext},F.createElement(Bm.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function qk({routeContext:n,match:e,children:t}){let r=F.useContext(Ka);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),F.createElement(dr.Provider,{value:n},t)}function Hk(n,e=[],t=null,r=null,s=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let a=n,l=t==null?void 0:t.errors;if(l!=null){let v=a.findIndex(_=>_.route.id&&(l==null?void 0:l[_.route.id])!==void 0);st(v>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(l).join(",")}`),a=a.slice(0,Math.min(a.length,v+1))}let d=!1,f=-1;if(t)for(let v=0;v<a.length;v++){let _=a[v];if((_.route.HydrateFallback||_.route.hydrateFallbackElement)&&(f=v),_.route.id){let{loaderData:x,errors:S}=t,D=_.route.loader&&!x.hasOwnProperty(_.route.id)&&(!S||S[_.route.id]===void 0);if(_.route.lazy||D){d=!0,f>=0?a=a.slice(0,f+1):a=[a[0]];break}}}let m=t&&r?(v,_)=>{var x,S;r(v,{location:t.location,params:((S=(x=t.matches)==null?void 0:x[0])==null?void 0:S.params)??{},unstable_pattern:Vk(t.matches),errorInfo:_})}:void 0;return a.reduceRight((v,_,x)=>{let S,D=!1,U=null,L=null;t&&(S=l&&_.route.id?l[_.route.id]:void 0,U=_.route.errorElement||zk,d&&(f<0&&x===0?(eE("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),D=!0,L=null):f===x&&(D=!0,L=_.route.hydrateFallbackElement||null)));let K=e.concat(a.slice(0,x+1)),X=()=>{let q;return S?q=U:D?q=L:_.route.Component?q=F.createElement(_.route.Component,null):_.route.element?q=_.route.element:q=v,F.createElement(qk,{match:_,routeContext:{outlet:v,matches:K,isDataRoute:t!=null},children:q})};return t&&(_.route.ErrorBoundary||_.route.errorElement||x===0)?F.createElement($k,{location:t.location,revalidation:t.revalidation,component:U,error:S,children:X(),routeContext:{outlet:null,matches:K,isDataRoute:!0},onError:m}):X()},null)}function $m(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Wk(n){let e=F.useContext(Ka);return st(e,$m(n)),e}function Gk(n){let e=F.useContext(Ih);return st(e,$m(n)),e}function Kk(n){let e=F.useContext(dr);return st(e,$m(n)),e}function qm(n){let e=Kk(n),t=e.matches[e.matches.length-1];return st(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function Qk(){return qm("useRouteId")}function Xk(){var r;let n=F.useContext(Bm),e=Gk("useRouteError"),t=qm("useRouteError");return n!==void 0?n:(r=e.errors)==null?void 0:r[t]}function Yk(){let{router:n}=Wk("useNavigate"),e=qm("useNavigate"),t=F.useRef(!1);return J0(()=>{t.current=!0}),F.useCallback(async(s,a={})=>{Bn(t.current,Y0),t.current&&(typeof s=="number"?await n.navigate(s):await n.navigate(s,{fromRouteId:e,...a}))},[n,e])}var P_={};function eE(n,e,t){!e&&!P_[n]&&(P_[n]=!0,Bn(!1,t))}F.memo(Jk);function Jk({routes:n,future:e,state:t,unstable_onError:r}){return Z0(n,void 0,t,r,e)}function Zk({to:n,replace:e,state:t,relative:r}){st(Qa(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=F.useContext(zn);Bn(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:a}=F.useContext(dr),{pathname:l}=ds(),d=$n(),f=Um(n,Fm(a),l,r==="path"),m=JSON.stringify(f);return F.useEffect(()=>{d(JSON.parse(m),{replace:e,state:t,relative:r})},[d,m,r,e,t]),null}function Sr(n){st(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function e1({basename:n="/",children:e=null,location:t,navigationType:r="POP",navigator:s,static:a=!1,unstable_useTransitions:l}){st(!Qa(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let d=n.replace(/^\/*/,"/"),f=F.useMemo(()=>({basename:d,navigator:s,static:a,unstable_useTransitions:l,future:{}}),[d,s,a,l]);typeof t=="string"&&(t=Ga(t));let{pathname:m="/",search:v="",hash:_="",state:x=null,key:S="default"}=t,D=F.useMemo(()=>{let U=ui(m,d);return U==null?null:{location:{pathname:U,search:v,hash:_,state:x,key:S},navigationType:r}},[d,m,v,_,x,S,r]);return Bn(D!=null,`<Router basename="${d}"> is not able to match the URL "${m}${v}${_}" because it does not start with the basename, so the <Router> won't render anything.`),D==null?null:F.createElement(zn.Provider,{value:f},F.createElement(Bu.Provider,{children:e,value:D}))}function t1({children:n,location:e}){return Uk(nm(n),e)}function nm(n,e=[]){let t=[];return F.Children.forEach(n,(r,s)=>{if(!F.isValidElement(r))return;let a=[...e,s];if(r.type===F.Fragment){t.push.apply(t,nm(r.props.children,a));return}st(r.type===Sr,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),st(!r.props.index||!r.props.children,"An index route cannot have child routes.");let l={id:r.props.id||a.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(l.children=nm(r.props.children,a)),t.push(l)}),t}var Rd="get",Cd="application/x-www-form-urlencoded";function xh(n){return typeof HTMLElement<"u"&&n instanceof HTMLElement}function n1(n){return xh(n)&&n.tagName.toLowerCase()==="button"}function r1(n){return xh(n)&&n.tagName.toLowerCase()==="form"}function i1(n){return xh(n)&&n.tagName.toLowerCase()==="input"}function s1(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function o1(n,e){return n.button===0&&(!e||e==="_self")&&!s1(n)}var wd=null;function a1(){if(wd===null)try{new FormData(document.createElement("form"),0),wd=!1}catch{wd=!0}return wd}var l1=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function jp(n){return n!=null&&!l1.has(n)?(Bn(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Cd}"`),null):n}function u1(n,e){let t,r,s,a,l;if(r1(n)){let d=n.getAttribute("action");r=d?ui(d,e):null,t=n.getAttribute("method")||Rd,s=jp(n.getAttribute("enctype"))||Cd,a=new FormData(n)}else if(n1(n)||i1(n)&&(n.type==="submit"||n.type==="image")){let d=n.form;if(d==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let f=n.getAttribute("formaction")||d.getAttribute("action");if(r=f?ui(f,e):null,t=n.getAttribute("formmethod")||d.getAttribute("method")||Rd,s=jp(n.getAttribute("formenctype"))||jp(d.getAttribute("enctype"))||Cd,a=new FormData(d,n),!a1()){let{name:m,type:v,value:_}=n;if(v==="image"){let x=m?`${m}.`:"";a.append(`${x}x`,"0"),a.append(`${x}y`,"0")}else m&&a.append(m,_)}}else{if(xh(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Rd,r=null,s=Cd,l=n}return a&&s==="text/plain"&&(l=a,a=void 0),{action:r,method:t.toLowerCase(),encType:s,formData:a,body:l}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Hm(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function c1(n,e,t){let r=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return r.pathname==="/"?r.pathname=`_root.${t}`:e&&ui(r.pathname,e)==="/"?r.pathname=`${e.replace(/\/$/,"")}/_root.${t}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${t}`,r}async function d1(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function h1(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function f1(n,e,t){let r=await Promise.all(n.map(async s=>{let a=e.routes[s.route.id];if(a){let l=await d1(a,t);return l.links?l.links():[]}return[]}));return y1(r.flat(1).filter(h1).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function N_(n,e,t,r,s,a){let l=(f,m)=>t[m]?f.route.id!==t[m].route.id:!0,d=(f,m)=>{var v;return t[m].pathname!==f.pathname||((v=t[m].route.path)==null?void 0:v.endsWith("*"))&&t[m].params["*"]!==f.params["*"]};return a==="assets"?e.filter((f,m)=>l(f,m)||d(f,m)):a==="data"?e.filter((f,m)=>{var _;let v=r.routes[f.route.id];if(!v||!v.hasLoader)return!1;if(l(f,m)||d(f,m))return!0;if(f.route.shouldRevalidate){let x=f.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:((_=t[0])==null?void 0:_.params)||{},nextUrl:new URL(n,window.origin),nextParams:f.params,defaultShouldRevalidate:!0});if(typeof x=="boolean")return x}return!0}):[]}function p1(n,e,{includeHydrateFallback:t}={}){return m1(n.map(r=>{let s=e.routes[r.route.id];if(!s)return[];let a=[s.module];return s.clientActionModule&&(a=a.concat(s.clientActionModule)),s.clientLoaderModule&&(a=a.concat(s.clientLoaderModule)),t&&s.hydrateFallbackModule&&(a=a.concat(s.hydrateFallbackModule)),s.imports&&(a=a.concat(s.imports)),a}).flat(1))}function m1(n){return[...new Set(n)]}function g1(n){let e={},t=Object.keys(n).sort();for(let r of t)e[r]=n[r];return e}function y1(n,e){let t=new Set;return new Set(e),n.reduce((r,s)=>{let a=JSON.stringify(g1(s));return t.has(a)||(t.add(a),r.push({key:a,link:s})),r},[])}function tE(){let n=F.useContext(Ka);return Hm(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function v1(){let n=F.useContext(Ih);return Hm(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var Wm=F.createContext(void 0);Wm.displayName="FrameworkContext";function nE(){let n=F.useContext(Wm);return Hm(n,"You must render this element inside a <HydratedRouter> element"),n}function _1(n,e){let t=F.useContext(Wm),[r,s]=F.useState(!1),[a,l]=F.useState(!1),{onFocus:d,onBlur:f,onMouseEnter:m,onMouseLeave:v,onTouchStart:_}=e,x=F.useRef(null);F.useEffect(()=>{if(n==="render"&&l(!0),n==="viewport"){let U=K=>{K.forEach(X=>{l(X.isIntersecting)})},L=new IntersectionObserver(U,{threshold:.5});return x.current&&L.observe(x.current),()=>{L.disconnect()}}},[n]),F.useEffect(()=>{if(r){let U=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(U)}}},[r]);let S=()=>{s(!0)},D=()=>{s(!1),l(!1)};return t?n!=="intent"?[a,x,{}]:[a,x,{onFocus:nu(d,S),onBlur:nu(f,D),onMouseEnter:nu(m,S),onMouseLeave:nu(v,D),onTouchStart:nu(_,S)}]:[!1,x,{}]}function nu(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function w1({page:n,...e}){let{router:t}=tE(),r=F.useMemo(()=>W0(t.routes,n,t.basename),[t.routes,n,t.basename]);return r?F.createElement(I1,{page:n,matches:r,...e}):null}function E1(n){let{manifest:e,routeModules:t}=nE(),[r,s]=F.useState([]);return F.useEffect(()=>{let a=!1;return f1(n,e,t).then(l=>{a||s(l)}),()=>{a=!0}},[n,e,t]),r}function I1({page:n,matches:e,...t}){let r=ds(),{manifest:s,routeModules:a}=nE(),{basename:l}=tE(),{loaderData:d,matches:f}=v1(),m=F.useMemo(()=>N_(n,e,f,s,r,"data"),[n,e,f,s,r]),v=F.useMemo(()=>N_(n,e,f,s,r,"assets"),[n,e,f,s,r]),_=F.useMemo(()=>{if(n===r.pathname+r.search+r.hash)return[];let D=new Set,U=!1;if(e.forEach(K=>{var q;let X=s.routes[K.route.id];!X||!X.hasLoader||(!m.some(ne=>ne.route.id===K.route.id)&&K.route.id in d&&((q=a[K.route.id])!=null&&q.shouldRevalidate)||X.hasClientLoader?U=!0:D.add(K.route.id))}),D.size===0)return[];let L=c1(n,l,"data");return U&&D.size>0&&L.searchParams.set("_routes",e.filter(K=>D.has(K.route.id)).map(K=>K.route.id).join(",")),[L.pathname+L.search]},[l,d,r,s,m,e,n,a]),x=F.useMemo(()=>p1(v,s),[v,s]),S=E1(v);return F.createElement(F.Fragment,null,_.map(D=>F.createElement("link",{key:D,rel:"prefetch",as:"fetch",href:D,...t})),x.map(D=>F.createElement("link",{key:D,rel:"modulepreload",href:D,...t})),S.map(({key:D,link:U})=>F.createElement("link",{key:D,nonce:t.nonce,...U})))}function x1(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var rE=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{rE&&(window.__reactRouterVersion="7.10.1")}catch{}function T1({basename:n,children:e,unstable_useTransitions:t,window:r}){let s=F.useRef();s.current==null&&(s.current=uk({window:r,v5Compat:!0}));let a=s.current,[l,d]=F.useState({action:a.action,location:a.location}),f=F.useCallback(m=>{t===!1?d(m):F.startTransition(()=>d(m))},[t]);return F.useLayoutEffect(()=>a.listen(f),[a,f]),F.createElement(e1,{basename:n,children:e,location:l.location,navigationType:l.action,navigator:a,unstable_useTransitions:t===!0})}var iE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,sE=F.forwardRef(function({onClick:e,discover:t="render",prefetch:r="none",relative:s,reloadDocument:a,replace:l,state:d,target:f,to:m,preventScrollReset:v,viewTransition:_,...x},S){let{basename:D,unstable_useTransitions:U}=F.useContext(zn),L=typeof m=="string"&&iE.test(m),K,X=!1;if(typeof m=="string"&&L&&(K=m,rE))try{let P=new URL(window.location.href),V=m.startsWith("//")?new URL(P.protocol+m):new URL(m),M=ui(V.pathname,D);V.origin===P.origin&&M!=null?m=M+V.search+V.hash:X=!0}catch{Bn(!1,`<Link to="${m}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let q=jk(m,{relative:s}),[ne,ue,ce]=_1(r,x),C=b1(m,{replace:l,state:d,target:f,preventScrollReset:v,relative:s,viewTransition:_,unstable_useTransitions:U});function k(P){e&&e(P),P.defaultPrevented||C(P)}let R=F.createElement("a",{...x,...ce,href:K||q,onClick:X||a?e:k,ref:x1(S,ue),target:f,"data-discover":!L&&t==="render"?"true":void 0});return ne&&!L?F.createElement(F.Fragment,null,R,F.createElement(w1,{page:q})):R});sE.displayName="Link";var oE=F.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:r="",end:s=!1,style:a,to:l,viewTransition:d,children:f,...m},v){let _=zu(l,{relative:m.relative}),x=ds(),S=F.useContext(Ih),{navigator:D,basename:U}=F.useContext(zn),L=S!=null&&N1(_)&&d===!0,K=D.encodeLocation?D.encodeLocation(_).pathname:_.pathname,X=x.pathname,q=S&&S.navigation&&S.navigation.location?S.navigation.location.pathname:null;t||(X=X.toLowerCase(),q=q?q.toLowerCase():null,K=K.toLowerCase()),q&&U&&(q=ui(q,U)||q);const ne=K!=="/"&&K.endsWith("/")?K.length-1:K.length;let ue=X===K||!s&&X.startsWith(K)&&X.charAt(ne)==="/",ce=q!=null&&(q===K||!s&&q.startsWith(K)&&q.charAt(K.length)==="/"),C={isActive:ue,isPending:ce,isTransitioning:L},k=ue?e:void 0,R;typeof r=="function"?R=r(C):R=[r,ue?"active":null,ce?"pending":null,L?"transitioning":null].filter(Boolean).join(" ");let P=typeof a=="function"?a(C):a;return F.createElement(sE,{...m,"aria-current":k,className:R,ref:v,style:P,to:l,viewTransition:d},typeof f=="function"?f(C):f)});oE.displayName="NavLink";var S1=F.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:r,replace:s,state:a,method:l=Rd,action:d,onSubmit:f,relative:m,preventScrollReset:v,viewTransition:_,...x},S)=>{let{unstable_useTransitions:D}=F.useContext(zn),U=C1(),L=P1(d,{relative:m}),K=l.toLowerCase()==="get"?"get":"post",X=typeof d=="string"&&iE.test(d),q=ne=>{if(f&&f(ne),ne.defaultPrevented)return;ne.preventDefault();let ue=ne.nativeEvent.submitter,ce=(ue==null?void 0:ue.getAttribute("formmethod"))||l,C=()=>U(ue||ne.currentTarget,{fetcherKey:e,method:ce,navigate:t,replace:s,state:a,relative:m,preventScrollReset:v,viewTransition:_});D&&t!==!1?F.startTransition(()=>C()):C()};return F.createElement("form",{ref:S,method:K,action:L,onSubmit:r?f:q,...x,"data-discover":!X&&n==="render"?"true":void 0})});S1.displayName="Form";function k1(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function aE(n){let e=F.useContext(Ka);return st(e,k1(n)),e}function b1(n,{target:e,replace:t,state:r,preventScrollReset:s,relative:a,viewTransition:l,unstable_useTransitions:d}={}){let f=$n(),m=ds(),v=zu(n,{relative:a});return F.useCallback(_=>{if(o1(_,e)){_.preventDefault();let x=t!==void 0?t:Tu(m)===Tu(v),S=()=>f(n,{replace:x,state:r,preventScrollReset:s,relative:a,viewTransition:l});d?F.startTransition(()=>S()):S()}},[m,f,v,t,r,e,n,s,a,l,d])}var A1=0,R1=()=>`__${String(++A1)}__`;function C1(){let{router:n}=aE("useSubmit"),{basename:e}=F.useContext(zn),t=Qk(),r=n.fetch,s=n.navigate;return F.useCallback(async(a,l={})=>{let{action:d,method:f,encType:m,formData:v,body:_}=u1(a,e);if(l.navigate===!1){let x=l.fetcherKey||R1();await r(x,t,l.action||d,{preventScrollReset:l.preventScrollReset,formData:v,body:_,formMethod:l.method||f,formEncType:l.encType||m,flushSync:l.flushSync})}else await s(l.action||d,{preventScrollReset:l.preventScrollReset,formData:v,body:_,formMethod:l.method||f,formEncType:l.encType||m,replace:l.replace,state:l.state,fromRouteId:t,flushSync:l.flushSync,viewTransition:l.viewTransition})},[r,s,e,t])}function P1(n,{relative:e}={}){let{basename:t}=F.useContext(zn),r=F.useContext(dr);st(r,"useFormAction must be used inside a RouteContext");let[s]=r.matches.slice(-1),a={...zu(n||".",{relative:e})},l=ds();if(n==null){a.search=l.search;let d=new URLSearchParams(a.search),f=d.getAll("index");if(f.some(v=>v==="")){d.delete("index"),f.filter(_=>_).forEach(_=>d.append("index",_));let v=d.toString();a.search=v?`?${v}`:""}}return(!n||n===".")&&s.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(a.pathname=a.pathname==="/"?t:li([t,a.pathname])),Tu(a)}function N1(n,{relative:e}={}){let t=F.useContext(X0);st(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=aE("useViewTransitionState"),s=zu(n,{relative:e});if(!t.isTransitioning)return!1;let a=ui(t.currentLocation.pathname,r)||t.currentLocation.pathname,l=ui(t.nextLocation.pathname,r)||t.nextLocation.pathname;return Gd(s.pathname,l)!=null||Gd(s.pathname,a)!=null}const D_=n=>{let e;const t=new Set,r=(m,v)=>{const _=typeof m=="function"?m(e):m;if(!Object.is(_,e)){const x=e;e=v??(typeof _!="object"||_===null)?_:Object.assign({},e,_),t.forEach(S=>S(e,x))}},s=()=>e,d={setState:r,getState:s,getInitialState:()=>f,subscribe:m=>(t.add(m),()=>t.delete(m))},f=e=n(r,s,d);return d},D1=(n=>n?D_(n):D_),V1=n=>n;function O1(n,e=V1){const t=Sa.useSyncExternalStore(n.subscribe,Sa.useCallback(()=>e(n.getState()),[n,e]),Sa.useCallback(()=>e(n.getInitialState()),[n,e]));return Sa.useDebugValue(t),t}const V_=n=>{const e=D1(n),t=r=>O1(e,r);return Object.assign(t,e),t},lE=(n=>n?V_(n):V_),go=lE(n=>({user:null,isLoading:!0,isAuthenticated:!1,setUser:e=>n({user:e,isAuthenticated:!!e}),setLoading:e=>n({isLoading:e}),clearUser:()=>n({user:null,isAuthenticated:!1})})),L1=()=>{};var O_={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uE=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},M1=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const s=n[t++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const a=n[t++];e[r++]=String.fromCharCode((s&31)<<6|a&63)}else if(s>239&&s<365){const a=n[t++],l=n[t++],d=n[t++],f=((s&7)<<18|(a&63)<<12|(l&63)<<6|d&63)-65536;e[r++]=String.fromCharCode(55296+(f>>10)),e[r++]=String.fromCharCode(56320+(f&1023))}else{const a=n[t++],l=n[t++];e[r++]=String.fromCharCode((s&15)<<12|(a&63)<<6|l&63)}}return e.join("")},cE={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const a=n[s],l=s+1<n.length,d=l?n[s+1]:0,f=s+2<n.length,m=f?n[s+2]:0,v=a>>2,_=(a&3)<<4|d>>4;let x=(d&15)<<2|m>>6,S=m&63;f||(S=64,l||(x=64)),r.push(t[v],t[_],t[x],t[S])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(uE(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):M1(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const a=t[n.charAt(s++)],d=s<n.length?t[n.charAt(s)]:0;++s;const m=s<n.length?t[n.charAt(s)]:64;++s;const _=s<n.length?t[n.charAt(s)]:64;if(++s,a==null||d==null||m==null||_==null)throw new j1;const x=a<<2|d>>4;if(r.push(x),m!==64){const S=d<<4&240|m>>2;if(r.push(S),_!==64){const D=m<<6&192|_;r.push(D)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class j1 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const F1=function(n){const e=uE(n);return cE.encodeByteArray(e,!0)},Kd=function(n){return F1(n).replace(/\./g,"")},dE=function(n){try{return cE.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hE(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U1=()=>hE().__FIREBASE_DEFAULTS__,B1=()=>{if(typeof process>"u"||typeof O_>"u")return;const n=O_.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},z1=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&dE(n[1]);return e&&JSON.parse(e)},Th=()=>{try{return L1()||U1()||B1()||z1()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},fE=n=>{var e,t;return(t=(e=Th())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},$1=n=>{const e=fE(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},pE=()=>{var n;return(n=Th())===null||n===void 0?void 0:n.config},mE=n=>{var e;return(e=Th())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q1{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xa(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function gE(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H1(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",s=n.iat||0,a=n.sub||n.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Kd(JSON.stringify(t)),Kd(JSON.stringify(l)),""].join(".")}const fu={};function W1(){const n={prod:[],emulator:[]};for(const e of Object.keys(fu))fu[e]?n.emulator.push(e):n.prod.push(e);return n}function G1(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let L_=!1;function yE(n,e){if(typeof window>"u"||typeof document>"u"||!Xa(window.location.host)||fu[n]===e||fu[n]||L_)return;fu[n]=e;function t(x){return`__firebase__banner__${x}`}const r="__firebase__banner",a=W1().prod.length>0;function l(){const x=document.getElementById(r);x&&x.remove()}function d(x){x.style.display="flex",x.style.background="#7faaf0",x.style.position="fixed",x.style.bottom="5px",x.style.left="5px",x.style.padding=".5em",x.style.borderRadius="5px",x.style.alignItems="center"}function f(x,S){x.setAttribute("width","24"),x.setAttribute("id",S),x.setAttribute("height","24"),x.setAttribute("viewBox","0 0 24 24"),x.setAttribute("fill","none"),x.style.marginLeft="-6px"}function m(){const x=document.createElement("span");return x.style.cursor="pointer",x.style.marginLeft="16px",x.style.fontSize="24px",x.innerHTML=" &times;",x.onclick=()=>{L_=!0,l()},x}function v(x,S){x.setAttribute("id",S),x.innerText="Learn more",x.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",x.setAttribute("target","__blank"),x.style.paddingLeft="5px",x.style.textDecoration="underline"}function _(){const x=G1(r),S=t("text"),D=document.getElementById(S)||document.createElement("span"),U=t("learnmore"),L=document.getElementById(U)||document.createElement("a"),K=t("preprendIcon"),X=document.getElementById(K)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(x.created){const q=x.element;d(q),v(L,U);const ne=m();f(X,K),q.append(X,D,L,ne),document.body.appendChild(q)}a?(D.innerText="Preview backend disconnected.",X.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(X.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,D.innerText="Preview backend running in this workspace."),D.setAttribute("id",S)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",_):_()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function At(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function K1(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(At())}function vE(){var n;const e=(n=Th())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Q1(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Gm(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function X1(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Y1(){const n=At();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function _E(){return!vE()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function wE(){return!vE()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function Sh(){try{return typeof indexedDB=="object"}catch{return!1}}function Km(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var a;e(((a=s.error)===null||a===void 0?void 0:a.message)||"")}}catch(t){e(t)}})}function EE(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J1="FirebaseError";class hr extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=J1,Object.setPrototypeOf(this,hr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,yo.prototype.create)}}class yo{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},s=`${this.service}/${e}`,a=this.errors[e],l=a?Z1(a,r):"Error",d=`${this.serviceName}: ${l} (${s}).`;return new hr(s,d,r)}}function Z1(n,e){return n.replace(eb,(t,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const eb=/\{\$([^}]+)}/g;function tb(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function ss(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const s of t){if(!r.includes(s))return!1;const a=n[s],l=e[s];if(M_(a)&&M_(l)){if(!ss(a,l))return!1}else if(a!==l)return!1}for(const s of r)if(!t.includes(s))return!1;return!0}function M_(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $u(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function nb(n,e){const t=new rb(n,e);return t.subscribe.bind(t)}class rb{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let s;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");ib(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:r},s.next===void 0&&(s.next=Fp),s.error===void 0&&(s.error=Fp),s.complete===void 0&&(s.complete=Fp);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function ib(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Fp(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sb=1e3,ob=2,ab=14400*1e3,lb=.5;function j_(n,e=sb,t=ob){const r=e*Math.pow(t,n),s=Math.round(lb*r*(Math.random()-.5)*2);return Math.min(ab,r+s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Et(n){return n&&n._delegate?n._delegate:n}class ur{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $s="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ub{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new q1;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(a){if(s)return null;throw a}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(db(e))try{this.getOrInitializeService({instanceIdentifier:$s})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const a=this.getOrInitializeService({instanceIdentifier:s});r.resolve(a)}catch{}}}}clearInstance(e=$s){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=$s){return this.instances.has(e)}getOptions(e=$s){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[a,l]of this.instancesDeferred.entries()){const d=this.normalizeInstanceIdentifier(a);r===d&&l.resolve(s)}return s}onInit(e,t){var r;const s=this.normalizeInstanceIdentifier(t),a=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;a.add(e),this.onInitCallbacks.set(s,a);const l=this.instances.get(s);return l&&e(l,s),()=>{a.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const s of r)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:cb(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=$s){return this.component?this.component.multipleInstances?e:$s:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function cb(n){return n===$s?void 0:n}function db(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hb{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new ub(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var De;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(De||(De={}));const fb={debug:De.DEBUG,verbose:De.VERBOSE,info:De.INFO,warn:De.WARN,error:De.ERROR,silent:De.SILENT},pb=De.INFO,mb={[De.DEBUG]:"log",[De.VERBOSE]:"log",[De.INFO]:"info",[De.WARN]:"warn",[De.ERROR]:"error"},gb=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),s=mb[e];if(s)console[s](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class kh{constructor(e){this.name=e,this._logLevel=pb,this._logHandler=gb,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in De))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?fb[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,De.DEBUG,...e),this._logHandler(this,De.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,De.VERBOSE,...e),this._logHandler(this,De.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,De.INFO,...e),this._logHandler(this,De.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,De.WARN,...e),this._logHandler(this,De.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,De.ERROR,...e),this._logHandler(this,De.ERROR,...e)}}const yb=(n,e)=>e.some(t=>n instanceof t);let F_,U_;function vb(){return F_||(F_=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function _b(){return U_||(U_=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const IE=new WeakMap,rm=new WeakMap,xE=new WeakMap,Up=new WeakMap,Qm=new WeakMap;function wb(n){const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("success",a),n.removeEventListener("error",l)},a=()=>{t(Zi(n.result)),s()},l=()=>{r(n.error),s()};n.addEventListener("success",a),n.addEventListener("error",l)});return e.then(t=>{t instanceof IDBCursor&&IE.set(t,n)}).catch(()=>{}),Qm.set(e,n),e}function Eb(n){if(rm.has(n))return;const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("complete",a),n.removeEventListener("error",l),n.removeEventListener("abort",l)},a=()=>{t(),s()},l=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",a),n.addEventListener("error",l),n.addEventListener("abort",l)});rm.set(n,e)}let im={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return rm.get(n);if(e==="objectStoreNames")return n.objectStoreNames||xE.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Zi(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Ib(n){im=n(im)}function xb(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(Bp(this),e,...t);return xE.set(r,e.sort?e.sort():[e]),Zi(r)}:_b().includes(n)?function(...e){return n.apply(Bp(this),e),Zi(IE.get(this))}:function(...e){return Zi(n.apply(Bp(this),e))}}function Tb(n){return typeof n=="function"?xb(n):(n instanceof IDBTransaction&&Eb(n),yb(n,vb())?new Proxy(n,im):n)}function Zi(n){if(n instanceof IDBRequest)return wb(n);if(Up.has(n))return Up.get(n);const e=Tb(n);return e!==n&&(Up.set(n,e),Qm.set(e,n)),e}const Bp=n=>Qm.get(n);function TE(n,e,{blocked:t,upgrade:r,blocking:s,terminated:a}={}){const l=indexedDB.open(n,e),d=Zi(l);return r&&l.addEventListener("upgradeneeded",f=>{r(Zi(l.result),f.oldVersion,f.newVersion,Zi(l.transaction),f)}),t&&l.addEventListener("blocked",f=>t(f.oldVersion,f.newVersion,f)),d.then(f=>{a&&f.addEventListener("close",()=>a()),s&&f.addEventListener("versionchange",m=>s(m.oldVersion,m.newVersion,m))}).catch(()=>{}),d}const Sb=["get","getKey","getAll","getAllKeys","count"],kb=["put","add","delete","clear"],zp=new Map;function B_(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(zp.get(e))return zp.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,s=kb.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(s||Sb.includes(t)))return;const a=async function(l,...d){const f=this.transaction(l,s?"readwrite":"readonly");let m=f.store;return r&&(m=m.index(d.shift())),(await Promise.all([m[t](...d),s&&f.done]))[0]};return zp.set(e,a),a}Ib(n=>({...n,get:(e,t,r)=>B_(e,t)||n.get(e,t,r),has:(e,t)=>!!B_(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bb{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Ab(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function Ab(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const sm="@firebase/app",z_="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ci=new kh("@firebase/app"),Rb="@firebase/app-compat",Cb="@firebase/analytics-compat",Pb="@firebase/analytics",Nb="@firebase/app-check-compat",Db="@firebase/app-check",Vb="@firebase/auth",Ob="@firebase/auth-compat",Lb="@firebase/database",Mb="@firebase/data-connect",jb="@firebase/database-compat",Fb="@firebase/functions",Ub="@firebase/functions-compat",Bb="@firebase/installations",zb="@firebase/installations-compat",$b="@firebase/messaging",qb="@firebase/messaging-compat",Hb="@firebase/performance",Wb="@firebase/performance-compat",Gb="@firebase/remote-config",Kb="@firebase/remote-config-compat",Qb="@firebase/storage",Xb="@firebase/storage-compat",Yb="@firebase/firestore",Jb="@firebase/ai",Zb="@firebase/firestore-compat",eA="firebase",tA="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const om="[DEFAULT]",nA={[sm]:"fire-core",[Rb]:"fire-core-compat",[Pb]:"fire-analytics",[Cb]:"fire-analytics-compat",[Db]:"fire-app-check",[Nb]:"fire-app-check-compat",[Vb]:"fire-auth",[Ob]:"fire-auth-compat",[Lb]:"fire-rtdb",[Mb]:"fire-data-connect",[jb]:"fire-rtdb-compat",[Fb]:"fire-fn",[Ub]:"fire-fn-compat",[Bb]:"fire-iid",[zb]:"fire-iid-compat",[$b]:"fire-fcm",[qb]:"fire-fcm-compat",[Hb]:"fire-perf",[Wb]:"fire-perf-compat",[Gb]:"fire-rc",[Kb]:"fire-rc-compat",[Qb]:"fire-gcs",[Xb]:"fire-gcs-compat",[Yb]:"fire-fst",[Zb]:"fire-fst-compat",[Jb]:"fire-vertex","fire-js":"fire-js",[eA]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qd=new Map,rA=new Map,am=new Map;function $_(n,e){try{n.container.addComponent(e)}catch(t){ci.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Vr(n){const e=n.name;if(am.has(e))return ci.debug(`There were multiple attempts to register component ${e}.`),!1;am.set(e,n);for(const t of Qd.values())$_(t,n);for(const t of rA.values())$_(t,n);return!0}function vo(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function or(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iA={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},es=new yo("app","Firebase",iA);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sA{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new ur("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw es.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ya=tA;function SE(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:om,automaticDataCollectionEnabled:!0},e),s=r.name;if(typeof s!="string"||!s)throw es.create("bad-app-name",{appName:String(s)});if(t||(t=pE()),!t)throw es.create("no-options");const a=Qd.get(s);if(a){if(ss(t,a.options)&&ss(r,a.config))return a;throw es.create("duplicate-app",{appName:s})}const l=new hb(s);for(const f of am.values())l.addComponent(f);const d=new sA(t,r,l);return Qd.set(s,d),d}function Xm(n=om){const e=Qd.get(n);if(!e&&n===om&&pE())return SE();if(!e)throw es.create("no-app",{appName:n});return e}function Fn(n,e,t){var r;let s=(r=nA[n])!==null&&r!==void 0?r:n;t&&(s+=`-${t}`);const a=s.match(/\s|\//),l=e.match(/\s|\//);if(a||l){const d=[`Unable to register library "${s}" with version "${e}":`];a&&d.push(`library name "${s}" contains illegal characters (whitespace or "/")`),a&&l&&d.push("and"),l&&d.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ci.warn(d.join(" "));return}Vr(new ur(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oA="firebase-heartbeat-database",aA=1,Su="firebase-heartbeat-store";let $p=null;function kE(){return $p||($p=TE(oA,aA,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Su)}catch(t){console.warn(t)}}}}).catch(n=>{throw es.create("idb-open",{originalErrorMessage:n.message})})),$p}async function lA(n){try{const t=(await kE()).transaction(Su),r=await t.objectStore(Su).get(bE(n));return await t.done,r}catch(e){if(e instanceof hr)ci.warn(e.message);else{const t=es.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ci.warn(t.message)}}}async function q_(n,e){try{const r=(await kE()).transaction(Su,"readwrite");await r.objectStore(Su).put(e,bE(n)),await r.done}catch(t){if(t instanceof hr)ci.warn(t.message);else{const r=es.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});ci.warn(r.message)}}}function bE(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uA=1024,cA=30;class dA{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new fA(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=H_();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(l=>l.date===a))return;if(this._heartbeatsCache.heartbeats.push({date:a,agent:s}),this._heartbeatsCache.heartbeats.length>cA){const l=pA(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){ci.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=H_(),{heartbeatsToSend:r,unsentEntries:s}=hA(this._heartbeatsCache.heartbeats),a=Kd(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(t){return ci.warn(t),""}}}function H_(){return new Date().toISOString().substring(0,10)}function hA(n,e=uA){const t=[];let r=n.slice();for(const s of n){const a=t.find(l=>l.agent===s.agent);if(a){if(a.dates.push(s.date),W_(t)>e){a.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),W_(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class fA{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Sh()?Km().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await lA(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return q_(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return q_(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function W_(n){return Kd(JSON.stringify({version:2,heartbeats:n})).length}function pA(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mA(n){Vr(new ur("platform-logger",e=>new bb(e),"PRIVATE")),Vr(new ur("heartbeat",e=>new dA(e),"PRIVATE")),Fn(sm,z_,n),Fn(sm,z_,"esm2017"),Fn("fire-js","")}mA("");var G_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ts,AE;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(C,k){function R(){}R.prototype=k.prototype,C.D=k.prototype,C.prototype=new R,C.prototype.constructor=C,C.C=function(P,V,M){for(var A=Array(arguments.length-2),Ae=2;Ae<arguments.length;Ae++)A[Ae-2]=arguments[Ae];return k.prototype[V].apply(P,A)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(C,k,R){R||(R=0);var P=Array(16);if(typeof k=="string")for(var V=0;16>V;++V)P[V]=k.charCodeAt(R++)|k.charCodeAt(R++)<<8|k.charCodeAt(R++)<<16|k.charCodeAt(R++)<<24;else for(V=0;16>V;++V)P[V]=k[R++]|k[R++]<<8|k[R++]<<16|k[R++]<<24;k=C.g[0],R=C.g[1],V=C.g[2];var M=C.g[3],A=k+(M^R&(V^M))+P[0]+3614090360&4294967295;k=R+(A<<7&4294967295|A>>>25),A=M+(V^k&(R^V))+P[1]+3905402710&4294967295,M=k+(A<<12&4294967295|A>>>20),A=V+(R^M&(k^R))+P[2]+606105819&4294967295,V=M+(A<<17&4294967295|A>>>15),A=R+(k^V&(M^k))+P[3]+3250441966&4294967295,R=V+(A<<22&4294967295|A>>>10),A=k+(M^R&(V^M))+P[4]+4118548399&4294967295,k=R+(A<<7&4294967295|A>>>25),A=M+(V^k&(R^V))+P[5]+1200080426&4294967295,M=k+(A<<12&4294967295|A>>>20),A=V+(R^M&(k^R))+P[6]+2821735955&4294967295,V=M+(A<<17&4294967295|A>>>15),A=R+(k^V&(M^k))+P[7]+4249261313&4294967295,R=V+(A<<22&4294967295|A>>>10),A=k+(M^R&(V^M))+P[8]+1770035416&4294967295,k=R+(A<<7&4294967295|A>>>25),A=M+(V^k&(R^V))+P[9]+2336552879&4294967295,M=k+(A<<12&4294967295|A>>>20),A=V+(R^M&(k^R))+P[10]+4294925233&4294967295,V=M+(A<<17&4294967295|A>>>15),A=R+(k^V&(M^k))+P[11]+2304563134&4294967295,R=V+(A<<22&4294967295|A>>>10),A=k+(M^R&(V^M))+P[12]+1804603682&4294967295,k=R+(A<<7&4294967295|A>>>25),A=M+(V^k&(R^V))+P[13]+4254626195&4294967295,M=k+(A<<12&4294967295|A>>>20),A=V+(R^M&(k^R))+P[14]+2792965006&4294967295,V=M+(A<<17&4294967295|A>>>15),A=R+(k^V&(M^k))+P[15]+1236535329&4294967295,R=V+(A<<22&4294967295|A>>>10),A=k+(V^M&(R^V))+P[1]+4129170786&4294967295,k=R+(A<<5&4294967295|A>>>27),A=M+(R^V&(k^R))+P[6]+3225465664&4294967295,M=k+(A<<9&4294967295|A>>>23),A=V+(k^R&(M^k))+P[11]+643717713&4294967295,V=M+(A<<14&4294967295|A>>>18),A=R+(M^k&(V^M))+P[0]+3921069994&4294967295,R=V+(A<<20&4294967295|A>>>12),A=k+(V^M&(R^V))+P[5]+3593408605&4294967295,k=R+(A<<5&4294967295|A>>>27),A=M+(R^V&(k^R))+P[10]+38016083&4294967295,M=k+(A<<9&4294967295|A>>>23),A=V+(k^R&(M^k))+P[15]+3634488961&4294967295,V=M+(A<<14&4294967295|A>>>18),A=R+(M^k&(V^M))+P[4]+3889429448&4294967295,R=V+(A<<20&4294967295|A>>>12),A=k+(V^M&(R^V))+P[9]+568446438&4294967295,k=R+(A<<5&4294967295|A>>>27),A=M+(R^V&(k^R))+P[14]+3275163606&4294967295,M=k+(A<<9&4294967295|A>>>23),A=V+(k^R&(M^k))+P[3]+4107603335&4294967295,V=M+(A<<14&4294967295|A>>>18),A=R+(M^k&(V^M))+P[8]+1163531501&4294967295,R=V+(A<<20&4294967295|A>>>12),A=k+(V^M&(R^V))+P[13]+2850285829&4294967295,k=R+(A<<5&4294967295|A>>>27),A=M+(R^V&(k^R))+P[2]+4243563512&4294967295,M=k+(A<<9&4294967295|A>>>23),A=V+(k^R&(M^k))+P[7]+1735328473&4294967295,V=M+(A<<14&4294967295|A>>>18),A=R+(M^k&(V^M))+P[12]+2368359562&4294967295,R=V+(A<<20&4294967295|A>>>12),A=k+(R^V^M)+P[5]+4294588738&4294967295,k=R+(A<<4&4294967295|A>>>28),A=M+(k^R^V)+P[8]+2272392833&4294967295,M=k+(A<<11&4294967295|A>>>21),A=V+(M^k^R)+P[11]+1839030562&4294967295,V=M+(A<<16&4294967295|A>>>16),A=R+(V^M^k)+P[14]+4259657740&4294967295,R=V+(A<<23&4294967295|A>>>9),A=k+(R^V^M)+P[1]+2763975236&4294967295,k=R+(A<<4&4294967295|A>>>28),A=M+(k^R^V)+P[4]+1272893353&4294967295,M=k+(A<<11&4294967295|A>>>21),A=V+(M^k^R)+P[7]+4139469664&4294967295,V=M+(A<<16&4294967295|A>>>16),A=R+(V^M^k)+P[10]+3200236656&4294967295,R=V+(A<<23&4294967295|A>>>9),A=k+(R^V^M)+P[13]+681279174&4294967295,k=R+(A<<4&4294967295|A>>>28),A=M+(k^R^V)+P[0]+3936430074&4294967295,M=k+(A<<11&4294967295|A>>>21),A=V+(M^k^R)+P[3]+3572445317&4294967295,V=M+(A<<16&4294967295|A>>>16),A=R+(V^M^k)+P[6]+76029189&4294967295,R=V+(A<<23&4294967295|A>>>9),A=k+(R^V^M)+P[9]+3654602809&4294967295,k=R+(A<<4&4294967295|A>>>28),A=M+(k^R^V)+P[12]+3873151461&4294967295,M=k+(A<<11&4294967295|A>>>21),A=V+(M^k^R)+P[15]+530742520&4294967295,V=M+(A<<16&4294967295|A>>>16),A=R+(V^M^k)+P[2]+3299628645&4294967295,R=V+(A<<23&4294967295|A>>>9),A=k+(V^(R|~M))+P[0]+4096336452&4294967295,k=R+(A<<6&4294967295|A>>>26),A=M+(R^(k|~V))+P[7]+1126891415&4294967295,M=k+(A<<10&4294967295|A>>>22),A=V+(k^(M|~R))+P[14]+2878612391&4294967295,V=M+(A<<15&4294967295|A>>>17),A=R+(M^(V|~k))+P[5]+4237533241&4294967295,R=V+(A<<21&4294967295|A>>>11),A=k+(V^(R|~M))+P[12]+1700485571&4294967295,k=R+(A<<6&4294967295|A>>>26),A=M+(R^(k|~V))+P[3]+2399980690&4294967295,M=k+(A<<10&4294967295|A>>>22),A=V+(k^(M|~R))+P[10]+4293915773&4294967295,V=M+(A<<15&4294967295|A>>>17),A=R+(M^(V|~k))+P[1]+2240044497&4294967295,R=V+(A<<21&4294967295|A>>>11),A=k+(V^(R|~M))+P[8]+1873313359&4294967295,k=R+(A<<6&4294967295|A>>>26),A=M+(R^(k|~V))+P[15]+4264355552&4294967295,M=k+(A<<10&4294967295|A>>>22),A=V+(k^(M|~R))+P[6]+2734768916&4294967295,V=M+(A<<15&4294967295|A>>>17),A=R+(M^(V|~k))+P[13]+1309151649&4294967295,R=V+(A<<21&4294967295|A>>>11),A=k+(V^(R|~M))+P[4]+4149444226&4294967295,k=R+(A<<6&4294967295|A>>>26),A=M+(R^(k|~V))+P[11]+3174756917&4294967295,M=k+(A<<10&4294967295|A>>>22),A=V+(k^(M|~R))+P[2]+718787259&4294967295,V=M+(A<<15&4294967295|A>>>17),A=R+(M^(V|~k))+P[9]+3951481745&4294967295,C.g[0]=C.g[0]+k&4294967295,C.g[1]=C.g[1]+(V+(A<<21&4294967295|A>>>11))&4294967295,C.g[2]=C.g[2]+V&4294967295,C.g[3]=C.g[3]+M&4294967295}r.prototype.u=function(C,k){k===void 0&&(k=C.length);for(var R=k-this.blockSize,P=this.B,V=this.h,M=0;M<k;){if(V==0)for(;M<=R;)s(this,C,M),M+=this.blockSize;if(typeof C=="string"){for(;M<k;)if(P[V++]=C.charCodeAt(M++),V==this.blockSize){s(this,P),V=0;break}}else for(;M<k;)if(P[V++]=C[M++],V==this.blockSize){s(this,P),V=0;break}}this.h=V,this.o+=k},r.prototype.v=function(){var C=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);C[0]=128;for(var k=1;k<C.length-8;++k)C[k]=0;var R=8*this.o;for(k=C.length-8;k<C.length;++k)C[k]=R&255,R/=256;for(this.u(C),C=Array(16),k=R=0;4>k;++k)for(var P=0;32>P;P+=8)C[R++]=this.g[k]>>>P&255;return C};function a(C,k){var R=d;return Object.prototype.hasOwnProperty.call(R,C)?R[C]:R[C]=k(C)}function l(C,k){this.h=k;for(var R=[],P=!0,V=C.length-1;0<=V;V--){var M=C[V]|0;P&&M==k||(R[V]=M,P=!1)}this.g=R}var d={};function f(C){return-128<=C&&128>C?a(C,function(k){return new l([k|0],0>k?-1:0)}):new l([C|0],0>C?-1:0)}function m(C){if(isNaN(C)||!isFinite(C))return _;if(0>C)return L(m(-C));for(var k=[],R=1,P=0;C>=R;P++)k[P]=C/R|0,R*=4294967296;return new l(k,0)}function v(C,k){if(C.length==0)throw Error("number format error: empty string");if(k=k||10,2>k||36<k)throw Error("radix out of range: "+k);if(C.charAt(0)=="-")return L(v(C.substring(1),k));if(0<=C.indexOf("-"))throw Error('number format error: interior "-" character');for(var R=m(Math.pow(k,8)),P=_,V=0;V<C.length;V+=8){var M=Math.min(8,C.length-V),A=parseInt(C.substring(V,V+M),k);8>M?(M=m(Math.pow(k,M)),P=P.j(M).add(m(A))):(P=P.j(R),P=P.add(m(A)))}return P}var _=f(0),x=f(1),S=f(16777216);n=l.prototype,n.m=function(){if(U(this))return-L(this).m();for(var C=0,k=1,R=0;R<this.g.length;R++){var P=this.i(R);C+=(0<=P?P:4294967296+P)*k,k*=4294967296}return C},n.toString=function(C){if(C=C||10,2>C||36<C)throw Error("radix out of range: "+C);if(D(this))return"0";if(U(this))return"-"+L(this).toString(C);for(var k=m(Math.pow(C,6)),R=this,P="";;){var V=ne(R,k).g;R=K(R,V.j(k));var M=((0<R.g.length?R.g[0]:R.h)>>>0).toString(C);if(R=V,D(R))return M+P;for(;6>M.length;)M="0"+M;P=M+P}},n.i=function(C){return 0>C?0:C<this.g.length?this.g[C]:this.h};function D(C){if(C.h!=0)return!1;for(var k=0;k<C.g.length;k++)if(C.g[k]!=0)return!1;return!0}function U(C){return C.h==-1}n.l=function(C){return C=K(this,C),U(C)?-1:D(C)?0:1};function L(C){for(var k=C.g.length,R=[],P=0;P<k;P++)R[P]=~C.g[P];return new l(R,~C.h).add(x)}n.abs=function(){return U(this)?L(this):this},n.add=function(C){for(var k=Math.max(this.g.length,C.g.length),R=[],P=0,V=0;V<=k;V++){var M=P+(this.i(V)&65535)+(C.i(V)&65535),A=(M>>>16)+(this.i(V)>>>16)+(C.i(V)>>>16);P=A>>>16,M&=65535,A&=65535,R[V]=A<<16|M}return new l(R,R[R.length-1]&-2147483648?-1:0)};function K(C,k){return C.add(L(k))}n.j=function(C){if(D(this)||D(C))return _;if(U(this))return U(C)?L(this).j(L(C)):L(L(this).j(C));if(U(C))return L(this.j(L(C)));if(0>this.l(S)&&0>C.l(S))return m(this.m()*C.m());for(var k=this.g.length+C.g.length,R=[],P=0;P<2*k;P++)R[P]=0;for(P=0;P<this.g.length;P++)for(var V=0;V<C.g.length;V++){var M=this.i(P)>>>16,A=this.i(P)&65535,Ae=C.i(V)>>>16,Xe=C.i(V)&65535;R[2*P+2*V]+=A*Xe,X(R,2*P+2*V),R[2*P+2*V+1]+=M*Xe,X(R,2*P+2*V+1),R[2*P+2*V+1]+=A*Ae,X(R,2*P+2*V+1),R[2*P+2*V+2]+=M*Ae,X(R,2*P+2*V+2)}for(P=0;P<k;P++)R[P]=R[2*P+1]<<16|R[2*P];for(P=k;P<2*k;P++)R[P]=0;return new l(R,0)};function X(C,k){for(;(C[k]&65535)!=C[k];)C[k+1]+=C[k]>>>16,C[k]&=65535,k++}function q(C,k){this.g=C,this.h=k}function ne(C,k){if(D(k))throw Error("division by zero");if(D(C))return new q(_,_);if(U(C))return k=ne(L(C),k),new q(L(k.g),L(k.h));if(U(k))return k=ne(C,L(k)),new q(L(k.g),k.h);if(30<C.g.length){if(U(C)||U(k))throw Error("slowDivide_ only works with positive integers.");for(var R=x,P=k;0>=P.l(C);)R=ue(R),P=ue(P);var V=ce(R,1),M=ce(P,1);for(P=ce(P,2),R=ce(R,2);!D(P);){var A=M.add(P);0>=A.l(C)&&(V=V.add(R),M=A),P=ce(P,1),R=ce(R,1)}return k=K(C,V.j(k)),new q(V,k)}for(V=_;0<=C.l(k);){for(R=Math.max(1,Math.floor(C.m()/k.m())),P=Math.ceil(Math.log(R)/Math.LN2),P=48>=P?1:Math.pow(2,P-48),M=m(R),A=M.j(k);U(A)||0<A.l(C);)R-=P,M=m(R),A=M.j(k);D(M)&&(M=x),V=V.add(M),C=K(C,A)}return new q(V,C)}n.A=function(C){return ne(this,C).h},n.and=function(C){for(var k=Math.max(this.g.length,C.g.length),R=[],P=0;P<k;P++)R[P]=this.i(P)&C.i(P);return new l(R,this.h&C.h)},n.or=function(C){for(var k=Math.max(this.g.length,C.g.length),R=[],P=0;P<k;P++)R[P]=this.i(P)|C.i(P);return new l(R,this.h|C.h)},n.xor=function(C){for(var k=Math.max(this.g.length,C.g.length),R=[],P=0;P<k;P++)R[P]=this.i(P)^C.i(P);return new l(R,this.h^C.h)};function ue(C){for(var k=C.g.length+1,R=[],P=0;P<k;P++)R[P]=C.i(P)<<1|C.i(P-1)>>>31;return new l(R,C.h)}function ce(C,k){var R=k>>5;k%=32;for(var P=C.g.length-R,V=[],M=0;M<P;M++)V[M]=0<k?C.i(M+R)>>>k|C.i(M+R+1)<<32-k:C.i(M+R);return new l(V,C.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,AE=r,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.A,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=m,l.fromString=v,ts=l}).apply(typeof G_<"u"?G_:typeof self<"u"?self:typeof window<"u"?window:{});var Ed=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var RE,lu,CE,Pd,lm,PE,NE,DE;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(c,g,w){return c==Array.prototype||c==Object.prototype||(c[g]=w.value),c};function t(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ed=="object"&&Ed];for(var g=0;g<c.length;++g){var w=c[g];if(w&&w.Math==Math)return w}throw Error("Cannot find global object")}var r=t(this);function s(c,g){if(g)e:{var w=r;c=c.split(".");for(var T=0;T<c.length-1;T++){var B=c[T];if(!(B in w))break e;w=w[B]}c=c[c.length-1],T=w[c],g=g(T),g!=T&&g!=null&&e(w,c,{configurable:!0,writable:!0,value:g})}}function a(c,g){c instanceof String&&(c+="");var w=0,T=!1,B={next:function(){if(!T&&w<c.length){var G=w++;return{value:g(G,c[G]),done:!1}}return T=!0,{done:!0,value:void 0}}};return B[Symbol.iterator]=function(){return B},B}s("Array.prototype.values",function(c){return c||function(){return a(this,function(g,w){return w})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var l=l||{},d=this||self;function f(c){var g=typeof c;return g=g!="object"?g:c?Array.isArray(c)?"array":g:"null",g=="array"||g=="object"&&typeof c.length=="number"}function m(c){var g=typeof c;return g=="object"&&c!=null||g=="function"}function v(c,g,w){return c.call.apply(c.bind,arguments)}function _(c,g,w){if(!c)throw Error();if(2<arguments.length){var T=Array.prototype.slice.call(arguments,2);return function(){var B=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(B,T),c.apply(g,B)}}return function(){return c.apply(g,arguments)}}function x(c,g,w){return x=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?v:_,x.apply(null,arguments)}function S(c,g){var w=Array.prototype.slice.call(arguments,1);return function(){var T=w.slice();return T.push.apply(T,arguments),c.apply(this,T)}}function D(c,g){function w(){}w.prototype=g.prototype,c.aa=g.prototype,c.prototype=new w,c.prototype.constructor=c,c.Qb=function(T,B,G){for(var oe=Array(arguments.length-2),qe=2;qe<arguments.length;qe++)oe[qe-2]=arguments[qe];return g.prototype[B].apply(T,oe)}}function U(c){const g=c.length;if(0<g){const w=Array(g);for(let T=0;T<g;T++)w[T]=c[T];return w}return[]}function L(c,g){for(let w=1;w<arguments.length;w++){const T=arguments[w];if(f(T)){const B=c.length||0,G=T.length||0;c.length=B+G;for(let oe=0;oe<G;oe++)c[B+oe]=T[oe]}else c.push(T)}}class K{constructor(g,w){this.i=g,this.j=w,this.h=0,this.g=null}get(){let g;return 0<this.h?(this.h--,g=this.g,this.g=g.next,g.next=null):g=this.i(),g}}function X(c){return/^[\s\xa0]*$/.test(c)}function q(){var c=d.navigator;return c&&(c=c.userAgent)?c:""}function ne(c){return ne[" "](c),c}ne[" "]=function(){};var ue=q().indexOf("Gecko")!=-1&&!(q().toLowerCase().indexOf("webkit")!=-1&&q().indexOf("Edge")==-1)&&!(q().indexOf("Trident")!=-1||q().indexOf("MSIE")!=-1)&&q().indexOf("Edge")==-1;function ce(c,g,w){for(const T in c)g.call(w,c[T],T,c)}function C(c,g){for(const w in c)g.call(void 0,c[w],w,c)}function k(c){const g={};for(const w in c)g[w]=c[w];return g}const R="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function P(c,g){let w,T;for(let B=1;B<arguments.length;B++){T=arguments[B];for(w in T)c[w]=T[w];for(let G=0;G<R.length;G++)w=R[G],Object.prototype.hasOwnProperty.call(T,w)&&(c[w]=T[w])}}function V(c){var g=1;c=c.split(":");const w=[];for(;0<g&&c.length;)w.push(c.shift()),g--;return c.length&&w.push(c.join(":")),w}function M(c){d.setTimeout(()=>{throw c},0)}function A(){var c=Ee;let g=null;return c.g&&(g=c.g,c.g=c.g.next,c.g||(c.h=null),g.next=null),g}class Ae{constructor(){this.h=this.g=null}add(g,w){const T=Xe.get();T.set(g,w),this.h?this.h.next=T:this.g=T,this.h=T}}var Xe=new K(()=>new ie,c=>c.reset());class ie{constructor(){this.next=this.g=this.h=null}set(g,w){this.h=g,this.g=w,this.next=null}reset(){this.next=this.g=this.h=null}}let Ke,ae=!1,Ee=new Ae,he=()=>{const c=d.Promise.resolve(void 0);Ke=()=>{c.then(j)}};var j=()=>{for(var c;c=A();){try{c.h.call(c.g)}catch(w){M(w)}var g=Xe;g.j(c),100>g.h&&(g.h++,c.next=g.g,g.g=c)}ae=!1};function Y(){this.s=this.s,this.C=this.C}Y.prototype.s=!1,Y.prototype.ma=function(){this.s||(this.s=!0,this.N())},Y.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function _e(c,g){this.type=c,this.g=this.target=g,this.defaultPrevented=!1}_e.prototype.h=function(){this.defaultPrevented=!0};var Re=(function(){if(!d.addEventListener||!Object.defineProperty)return!1;var c=!1,g=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const w=()=>{};d.addEventListener("test",w,g),d.removeEventListener("test",w,g)}catch{}return c})();function Pe(c,g){if(_e.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c){var w=this.type=c.type,T=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;if(this.target=c.target||c.srcElement,this.g=g,g=c.relatedTarget){if(ue){e:{try{ne(g.nodeName);var B=!0;break e}catch{}B=!1}B||(g=null)}}else w=="mouseover"?g=c.fromElement:w=="mouseout"&&(g=c.toElement);this.relatedTarget=g,T?(this.clientX=T.clientX!==void 0?T.clientX:T.pageX,this.clientY=T.clientY!==void 0?T.clientY:T.pageY,this.screenX=T.screenX||0,this.screenY=T.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=typeof c.pointerType=="string"?c.pointerType:Le[c.pointerType]||"",this.state=c.state,this.i=c,c.defaultPrevented&&Pe.aa.h.call(this)}}D(Pe,_e);var Le={2:"touch",3:"pen",4:"mouse"};Pe.prototype.h=function(){Pe.aa.h.call(this);var c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var Be="closure_listenable_"+(1e6*Math.random()|0),ze=0;function Ye(c,g,w,T,B){this.listener=c,this.proxy=null,this.src=g,this.type=w,this.capture=!!T,this.ha=B,this.key=++ze,this.da=this.fa=!1}function Ct(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function Fr(c){this.src=c,this.g={},this.h=0}Fr.prototype.add=function(c,g,w,T,B){var G=c.toString();c=this.g[G],c||(c=this.g[G]=[],this.h++);var oe=vi(c,g,T,B);return-1<oe?(g=c[oe],w||(g.fa=!1)):(g=new Ye(g,this.src,G,!!T,B),g.fa=w,c.push(g)),g};function Io(c,g){var w=g.type;if(w in c.g){var T=c.g[w],B=Array.prototype.indexOf.call(T,g,void 0),G;(G=0<=B)&&Array.prototype.splice.call(T,B,1),G&&(Ct(g),c.g[w].length==0&&(delete c.g[w],c.h--))}}function vi(c,g,w,T){for(var B=0;B<c.length;++B){var G=c[B];if(!G.da&&G.listener==g&&G.capture==!!w&&G.ha==T)return B}return-1}var ps="closure_lm_"+(1e6*Math.random()|0),xo={};function al(c,g,w,T,B){if(Array.isArray(g)){for(var G=0;G<g.length;G++)al(c,g[G],w,T,B);return null}return w=cl(w),c&&c[Be]?c.K(g,w,m(T)?!!T.capture:!1,B):ll(c,g,w,!1,T,B)}function ll(c,g,w,T,B,G){if(!g)throw Error("Invalid event type");var oe=m(B)?!!B.capture:!!B,qe=So(c);if(qe||(c[ps]=qe=new Fr(c)),w=qe.add(g,w,T,oe,G),w.proxy)return w;if(T=ic(),w.proxy=T,T.src=c,T.listener=w,c.addEventListener)Re||(B=oe),B===void 0&&(B=!1),c.addEventListener(g.toString(),T,B);else if(c.attachEvent)c.attachEvent(Br(g.toString()),T);else if(c.addListener&&c.removeListener)c.addListener(T);else throw Error("addEventListener and attachEvent are unavailable.");return w}function ic(){function c(w){return g.call(c.src,c.listener,w)}const g=ul;return c}function To(c,g,w,T,B){if(Array.isArray(g))for(var G=0;G<g.length;G++)To(c,g[G],w,T,B);else T=m(T)?!!T.capture:!!T,w=cl(w),c&&c[Be]?(c=c.i,g=String(g).toString(),g in c.g&&(G=c.g[g],w=vi(G,w,T,B),-1<w&&(Ct(G[w]),Array.prototype.splice.call(G,w,1),G.length==0&&(delete c.g[g],c.h--)))):c&&(c=So(c))&&(g=c.g[g.toString()],c=-1,g&&(c=vi(g,w,T,B)),(w=-1<c?g[c]:null)&&Ur(w))}function Ur(c){if(typeof c!="number"&&c&&!c.da){var g=c.src;if(g&&g[Be])Io(g.i,c);else{var w=c.type,T=c.proxy;g.removeEventListener?g.removeEventListener(w,T,c.capture):g.detachEvent?g.detachEvent(Br(w),T):g.addListener&&g.removeListener&&g.removeListener(T),(w=So(g))?(Io(w,c),w.h==0&&(w.src=null,g[ps]=null)):Ct(c)}}}function Br(c){return c in xo?xo[c]:xo[c]="on"+c}function ul(c,g){if(c.da)c=!0;else{g=new Pe(g,this);var w=c.listener,T=c.ha||c.src;c.fa&&Ur(c),c=w.call(T,g)}return c}function So(c){return c=c[ps],c instanceof Fr?c:null}var ko="__closure_events_fn_"+(1e9*Math.random()>>>0);function cl(c){return typeof c=="function"?c:(c[ko]||(c[ko]=function(g){return c.handleEvent(g)}),c[ko])}function xt(){Y.call(this),this.i=new Fr(this),this.M=this,this.F=null}D(xt,Y),xt.prototype[Be]=!0,xt.prototype.removeEventListener=function(c,g,w,T){To(this,c,g,w,T)};function Tt(c,g){var w,T=c.F;if(T)for(w=[];T;T=T.F)w.push(T);if(c=c.M,T=g.type||g,typeof g=="string")g=new _e(g,c);else if(g instanceof _e)g.target=g.target||c;else{var B=g;g=new _e(T,c),P(g,B)}if(B=!0,w)for(var G=w.length-1;0<=G;G--){var oe=g.g=w[G];B=zr(oe,T,!0,g)&&B}if(oe=g.g=c,B=zr(oe,T,!0,g)&&B,B=zr(oe,T,!1,g)&&B,w)for(G=0;G<w.length;G++)oe=g.g=w[G],B=zr(oe,T,!1,g)&&B}xt.prototype.N=function(){if(xt.aa.N.call(this),this.i){var c=this.i,g;for(g in c.g){for(var w=c.g[g],T=0;T<w.length;T++)Ct(w[T]);delete c.g[g],c.h--}}this.F=null},xt.prototype.K=function(c,g,w,T){return this.i.add(String(c),g,!1,w,T)},xt.prototype.L=function(c,g,w,T){return this.i.add(String(c),g,!0,w,T)};function zr(c,g,w,T){if(g=c.i.g[String(g)],!g)return!0;g=g.concat();for(var B=!0,G=0;G<g.length;++G){var oe=g[G];if(oe&&!oe.da&&oe.capture==w){var qe=oe.listener,St=oe.ha||oe.src;oe.fa&&Io(c.i,oe),B=qe.call(St,T)!==!1&&B}}return B&&!T.defaultPrevented}function dl(c,g,w){if(typeof c=="function")w&&(c=x(c,w));else if(c&&typeof c.handleEvent=="function")c=x(c.handleEvent,c);else throw Error("Invalid listener argument");return 2147483647<Number(g)?-1:d.setTimeout(c,g||0)}function _i(c){c.g=dl(()=>{c.g=null,c.i&&(c.i=!1,_i(c))},c.l);const g=c.h;c.h=null,c.m.apply(null,g)}class ms extends Y{constructor(g,w){super(),this.m=g,this.l=w,this.h=null,this.i=!1,this.g=null}j(g){this.h=arguments,this.g?this.i=!0:_i(this)}N(){super.N(),this.g&&(d.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function gs(c){Y.call(this),this.h=c,this.g={}}D(gs,Y);var hl=[];function fl(c){ce(c.g,function(g,w){this.g.hasOwnProperty(w)&&Ur(g)},c),c.g={}}gs.prototype.N=function(){gs.aa.N.call(this),fl(this)},gs.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var pl=d.JSON.stringify,ml=d.JSON.parse,gl=class{stringify(c){return d.JSON.stringify(c,void 0)}parse(c){return d.JSON.parse(c,void 0)}};function ys(){}ys.prototype.h=null;function bo(c){return c.h||(c.h=c.i())}function Ao(){}var bn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function pr(){_e.call(this,"d")}D(pr,_e);function Ro(){_e.call(this,"c")}D(Ro,_e);var mr={},yl=null;function vs(){return yl=yl||new xt}mr.La="serverreachability";function vl(c){_e.call(this,mr.La,c)}D(vl,_e);function $r(c){const g=vs();Tt(g,new vl(g))}mr.STAT_EVENT="statevent";function _l(c,g){_e.call(this,mr.STAT_EVENT,c),this.stat=g}D(_l,_e);function pt(c){const g=vs();Tt(g,new _l(g,c))}mr.Ma="timingevent";function Co(c,g){_e.call(this,mr.Ma,c),this.size=g}D(Co,_e);function qn(c,g){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return d.setTimeout(function(){c()},g)}function _s(){this.g=!0}_s.prototype.xa=function(){this.g=!1};function ws(c,g,w,T,B,G){c.info(function(){if(c.g)if(G)for(var oe="",qe=G.split("&"),St=0;St<qe.length;St++){var Me=qe[St].split("=");if(1<Me.length){var Pt=Me[0];Me=Me[1];var gt=Pt.split("_");oe=2<=gt.length&&gt[1]=="type"?oe+(Pt+"="+Me+"&"):oe+(Pt+"=redacted&")}}else oe=null;else oe=G;return"XMLHTTP REQ ("+T+") [attempt "+B+"]: "+g+`
`+w+`
`+oe})}function Po(c,g,w,T,B,G,oe){c.info(function(){return"XMLHTTP RESP ("+T+") [ attempt "+B+"]: "+g+`
`+w+`
`+G+" "+oe})}function Hn(c,g,w,T){c.info(function(){return"XMLHTTP TEXT ("+g+"): "+of(c,w)+(T?" "+T:"")})}function wl(c,g){c.info(function(){return"TIMEOUT: "+g})}_s.prototype.info=function(){};function of(c,g){if(!c.g)return g;if(!g)return null;try{var w=JSON.parse(g);if(w){for(c=0;c<w.length;c++)if(Array.isArray(w[c])){var T=w[c];if(!(2>T.length)){var B=T[1];if(Array.isArray(B)&&!(1>B.length)){var G=B[0];if(G!="noop"&&G!="stop"&&G!="close")for(var oe=1;oe<B.length;oe++)B[oe]=""}}}}return pl(w)}catch{return g}}var No={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},sc={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Wn;function Es(){}D(Es,ys),Es.prototype.g=function(){return new XMLHttpRequest},Es.prototype.i=function(){return{}},Wn=new Es;function Gn(c,g,w,T){this.j=c,this.i=g,this.l=w,this.R=T||1,this.U=new gs(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new oc}function oc(){this.i=null,this.g="",this.h=!1}var El={},Do={};function Vo(c,g,w){c.L=1,c.v=Ti(gn(g)),c.m=w,c.P=!0,Il(c,null)}function Il(c,g){c.F=Date.now(),Je(c),c.A=gn(c.v);var w=c.A,T=c.R;Array.isArray(T)||(T=[String(T)]),ki(w.i,"t",T),c.C=0,w=c.j.J,c.h=new oc,c.g=Tc(c.j,w?g:null,!c.m),0<c.O&&(c.M=new ms(x(c.Y,c,c.g),c.O)),g=c.U,w=c.g,T=c.ca;var B="readystatechange";Array.isArray(B)||(B&&(hl[0]=B.toString()),B=hl);for(var G=0;G<B.length;G++){var oe=al(w,B[G],T||g.handleEvent,!1,g.h||g);if(!oe)break;g.g[oe.key]=oe}g=c.H?k(c.H):{},c.m?(c.u||(c.u="POST"),g["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.A,c.u,c.m,g)):(c.u="GET",c.g.ea(c.A,c.u,null,g)),$r(),ws(c.i,c.u,c.A,c.l,c.R,c.m)}Gn.prototype.ca=function(c){c=c.target;const g=this.M;g&&on(c)==3?g.j():this.Y(c)},Gn.prototype.Y=function(c){try{if(c==this.g)e:{const gt=on(this.g);var g=this.g.Ba();const Cn=this.g.Z();if(!(3>gt)&&(gt!=3||this.g&&(this.h.h||this.g.oa()||Al(this.g)))){this.J||gt!=4||g==7||(g==8||0>=Cn?$r(3):$r(2)),Is(this);var w=this.g.Z();this.X=w;t:if(ac(this)){var T=Al(this.g);c="";var B=T.length,G=on(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){An(this),wi(this);var oe="";break t}this.h.i=new d.TextDecoder}for(g=0;g<B;g++)this.h.h=!0,c+=this.h.i.decode(T[g],{stream:!(G&&g==B-1)});T.length=0,this.h.g+=c,this.C=0,oe=this.h.g}else oe=this.g.oa();if(this.o=w==200,Po(this.i,this.u,this.A,this.l,this.R,gt,w),this.o){if(this.T&&!this.K){t:{if(this.g){var qe,St=this.g;if((qe=St.g?St.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!X(qe)){var Me=qe;break t}}Me=null}if(w=Me)Hn(this.i,this.l,w,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,xl(this,w);else{this.o=!1,this.s=3,pt(12),An(this),wi(this);break e}}if(this.P){w=!0;let vn;for(;!this.J&&this.C<oe.length;)if(vn=af(this,oe),vn==Do){gt==4&&(this.s=4,pt(14),w=!1),Hn(this.i,this.l,null,"[Incomplete Response]");break}else if(vn==El){this.s=4,pt(15),Hn(this.i,this.l,oe,"[Invalid Chunk]"),w=!1;break}else Hn(this.i,this.l,vn,null),xl(this,vn);if(ac(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),gt!=4||oe.length!=0||this.h.h||(this.s=1,pt(16),w=!1),this.o=this.o&&w,!w)Hn(this.i,this.l,oe,"[Invalid Chunked Response]"),An(this),wi(this);else if(0<oe.length&&!this.W){this.W=!0;var Pt=this.j;Pt.g==this&&Pt.ba&&!Pt.M&&(Pt.j.info("Great, no buffering proxy detected. Bytes received: "+oe.length),Cl(Pt),Pt.M=!0,pt(11))}}else Hn(this.i,this.l,oe,null),xl(this,oe);gt==4&&An(this),this.o&&!this.J&&(gt==4?Ho(this.j,this):(this.o=!1,Je(this)))}else Uo(this.g),w==400&&0<oe.indexOf("Unknown SID")?(this.s=3,pt(12)):(this.s=0,pt(13)),An(this),wi(this)}}}catch{}finally{}};function ac(c){return c.g?c.u=="GET"&&c.L!=2&&c.j.Ca:!1}function af(c,g){var w=c.C,T=g.indexOf(`
`,w);return T==-1?Do:(w=Number(g.substring(w,T)),isNaN(w)?El:(T+=1,T+w>g.length?Do:(g=g.slice(T,T+w),c.C=T+w,g)))}Gn.prototype.cancel=function(){this.J=!0,An(this)};function Je(c){c.S=Date.now()+c.I,lc(c,c.I)}function lc(c,g){if(c.B!=null)throw Error("WatchDog timer not null");c.B=qn(x(c.ba,c),g)}function Is(c){c.B&&(d.clearTimeout(c.B),c.B=null)}Gn.prototype.ba=function(){this.B=null;const c=Date.now();0<=c-this.S?(wl(this.i,this.A),this.L!=2&&($r(),pt(17)),An(this),this.s=2,wi(this)):lc(this,this.S-c)};function wi(c){c.j.G==0||c.J||Ho(c.j,c)}function An(c){Is(c);var g=c.M;g&&typeof g.ma=="function"&&g.ma(),c.M=null,fl(c.U),c.g&&(g=c.g,c.g=null,g.abort(),g.ma())}function xl(c,g){try{var w=c.j;if(w.G!=0&&(w.g==c||Yt(w.h,c))){if(!c.K&&Yt(w.h,c)&&w.G==3){try{var T=w.Da.g.parse(g)}catch{T=null}if(Array.isArray(T)&&T.length==3){var B=T;if(B[0]==0){e:if(!w.u){if(w.g)if(w.g.F+3e3<c.F)qo(w),Jn(w);else break e;$o(w),pt(18)}}else w.za=B[1],0<w.za-w.T&&37500>B[2]&&w.F&&w.v==0&&!w.C&&(w.C=qn(x(w.Za,w),6e3));if(1>=cc(w.h)&&w.ca){try{w.ca()}catch{}w.ca=void 0}}else Kr(w,11)}else if((c.K||w.g==c)&&qo(w),!X(g))for(B=w.Da.g.parse(g),g=0;g<B.length;g++){let Me=B[g];if(w.T=Me[0],Me=Me[1],w.G==2)if(Me[0]=="c"){w.K=Me[1],w.ia=Me[2];const Pt=Me[3];Pt!=null&&(w.la=Pt,w.j.info("VER="+w.la));const gt=Me[4];gt!=null&&(w.Aa=gt,w.j.info("SVER="+w.Aa));const Cn=Me[5];Cn!=null&&typeof Cn=="number"&&0<Cn&&(T=1.5*Cn,w.L=T,w.j.info("backChannelRequestTimeoutMs_="+T)),T=w;const vn=c.g;if(vn){const Rs=vn.g?vn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Rs){var G=T.h;G.g||Rs.indexOf("spdy")==-1&&Rs.indexOf("quic")==-1&&Rs.indexOf("h2")==-1||(G.j=G.l,G.g=new Set,G.h&&(Tl(G,G.h),G.h=null))}if(T.D){const Go=vn.g?vn.g.getResponseHeader("X-HTTP-Session-Id"):null;Go&&(T.ya=Go,Qe(T.I,T.D,Go))}}w.G=3,w.l&&w.l.ua(),w.ba&&(w.R=Date.now()-c.F,w.j.info("Handshake RTT: "+w.R+"ms")),T=w;var oe=c;if(T.qa=xc(T,T.J?T.ia:null,T.W),oe.K){dc(T.h,oe);var qe=oe,St=T.L;St&&(qe.I=St),qe.B&&(Is(qe),Je(qe)),T.g=oe}else As(T);0<w.i.length&&_r(w)}else Me[0]!="stop"&&Me[0]!="close"||Kr(w,7);else w.G==3&&(Me[0]=="stop"||Me[0]=="close"?Me[0]=="stop"?Kr(w,7):Mt(w):Me[0]!="noop"&&w.l&&w.l.ta(Me),w.v=0)}}$r(4)}catch{}}var uc=class{constructor(c,g){this.g=c,this.map=g}};function xs(c){this.l=c||10,d.PerformanceNavigationTiming?(c=d.performance.getEntriesByType("navigation"),c=0<c.length&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(d.chrome&&d.chrome.loadTimes&&d.chrome.loadTimes()&&d.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function mn(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function cc(c){return c.h?1:c.g?c.g.size:0}function Yt(c,g){return c.h?c.h==g:c.g?c.g.has(g):!1}function Tl(c,g){c.g?c.g.add(g):c.h=g}function dc(c,g){c.h&&c.h==g?c.h=null:c.g&&c.g.has(g)&&c.g.delete(g)}xs.prototype.cancel=function(){if(this.i=hc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function hc(c){if(c.h!=null)return c.i.concat(c.h.D);if(c.g!=null&&c.g.size!==0){let g=c.i;for(const w of c.g.values())g=g.concat(w.D);return g}return U(c.i)}function Oo(c){if(c.V&&typeof c.V=="function")return c.V();if(typeof Map<"u"&&c instanceof Map||typeof Set<"u"&&c instanceof Set)return Array.from(c.values());if(typeof c=="string")return c.split("");if(f(c)){for(var g=[],w=c.length,T=0;T<w;T++)g.push(c[T]);return g}g=[],w=0;for(T in c)g[w++]=c[T];return g}function Lo(c){if(c.na&&typeof c.na=="function")return c.na();if(!c.V||typeof c.V!="function"){if(typeof Map<"u"&&c instanceof Map)return Array.from(c.keys());if(!(typeof Set<"u"&&c instanceof Set)){if(f(c)||typeof c=="string"){var g=[];c=c.length;for(var w=0;w<c;w++)g.push(w);return g}g=[],w=0;for(const T in c)g[w++]=T;return g}}}function Ei(c,g){if(c.forEach&&typeof c.forEach=="function")c.forEach(g,void 0);else if(f(c)||typeof c=="string")Array.prototype.forEach.call(c,g,void 0);else for(var w=Lo(c),T=Oo(c),B=T.length,G=0;G<B;G++)g.call(void 0,T[G],w&&w[G],c)}var Ts=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function lf(c,g){if(c){c=c.split("&");for(var w=0;w<c.length;w++){var T=c[w].indexOf("="),B=null;if(0<=T){var G=c[w].substring(0,T);B=c[w].substring(T+1)}else G=c[w];g(G,B?decodeURIComponent(B.replace(/\+/g," ")):"")}}}function qr(c){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,c instanceof qr){this.h=c.h,Ss(this,c.j),this.o=c.o,this.g=c.g,Ii(this,c.s),this.l=c.l;var g=c.i,w=new gr;w.i=g.i,g.g&&(w.g=new Map(g.g),w.h=g.h),xi(this,w),this.m=c.m}else c&&(g=String(c).match(Ts))?(this.h=!1,Ss(this,g[1]||"",!0),this.o=Oe(g[2]||""),this.g=Oe(g[3]||"",!0),Ii(this,g[4]),this.l=Oe(g[5]||"",!0),xi(this,g[6]||"",!0),this.m=Oe(g[7]||"")):(this.h=!1,this.i=new gr(null,this.h))}qr.prototype.toString=function(){var c=[],g=this.j;g&&c.push(Si(g,Mo,!0),":");var w=this.g;return(w||g=="file")&&(c.push("//"),(g=this.o)&&c.push(Si(g,Mo,!0),"@"),c.push(encodeURIComponent(String(w)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),w=this.s,w!=null&&c.push(":",String(w))),(w=this.l)&&(this.g&&w.charAt(0)!="/"&&c.push("/"),c.push(Si(w,w.charAt(0)=="/"?mc:pc,!0))),(w=this.i.toString())&&c.push("?",w),(w=this.m)&&c.push("#",Si(w,Sl)),c.join("")};function gn(c){return new qr(c)}function Ss(c,g,w){c.j=w?Oe(g,!0):g,c.j&&(c.j=c.j.replace(/:$/,""))}function Ii(c,g){if(g){if(g=Number(g),isNaN(g)||0>g)throw Error("Bad port number "+g);c.s=g}else c.s=null}function xi(c,g,w){g instanceof gr?(c.i=g,yr(c.i,c.h)):(w||(g=Si(g,gc)),c.i=new gr(g,c.h))}function Qe(c,g,w){c.i.set(g,w)}function Ti(c){return Qe(c,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),c}function Oe(c,g){return c?g?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function Si(c,g,w){return typeof c=="string"?(c=encodeURI(c).replace(g,fc),w&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function fc(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var Mo=/[#\/\?@]/g,pc=/[#\?:]/g,mc=/[#\?]/g,gc=/[#\?@]/g,Sl=/#/g;function gr(c,g){this.h=this.g=null,this.i=c||null,this.j=!!g}function Lt(c){c.g||(c.g=new Map,c.h=0,c.i&&lf(c.i,function(g,w){c.add(decodeURIComponent(g.replace(/\+/g," ")),w)}))}n=gr.prototype,n.add=function(c,g){Lt(this),this.i=null,c=Rn(this,c);var w=this.g.get(c);return w||this.g.set(c,w=[]),w.push(g),this.h+=1,this};function Kn(c,g){Lt(c),g=Rn(c,g),c.g.has(g)&&(c.i=null,c.h-=c.g.get(g).length,c.g.delete(g))}function Qn(c,g){return Lt(c),g=Rn(c,g),c.g.has(g)}n.forEach=function(c,g){Lt(this),this.g.forEach(function(w,T){w.forEach(function(B){c.call(g,B,T,this)},this)},this)},n.na=function(){Lt(this);const c=Array.from(this.g.values()),g=Array.from(this.g.keys()),w=[];for(let T=0;T<g.length;T++){const B=c[T];for(let G=0;G<B.length;G++)w.push(g[T])}return w},n.V=function(c){Lt(this);let g=[];if(typeof c=="string")Qn(this,c)&&(g=g.concat(this.g.get(Rn(this,c))));else{c=Array.from(this.g.values());for(let w=0;w<c.length;w++)g=g.concat(c[w])}return g},n.set=function(c,g){return Lt(this),this.i=null,c=Rn(this,c),Qn(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[g]),this.h+=1,this},n.get=function(c,g){return c?(c=this.V(c),0<c.length?String(c[0]):g):g};function ki(c,g,w){Kn(c,g),0<w.length&&(c.i=null,c.g.set(Rn(c,g),U(w)),c.h+=w.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],g=Array.from(this.g.keys());for(var w=0;w<g.length;w++){var T=g[w];const G=encodeURIComponent(String(T)),oe=this.V(T);for(T=0;T<oe.length;T++){var B=G;oe[T]!==""&&(B+="="+encodeURIComponent(String(oe[T]))),c.push(B)}}return this.i=c.join("&")};function Rn(c,g){return g=String(g),c.j&&(g=g.toLowerCase()),g}function yr(c,g){g&&!c.j&&(Lt(c),c.i=null,c.g.forEach(function(w,T){var B=T.toLowerCase();T!=B&&(Kn(this,T),ki(this,B,w))},c)),c.j=g}function uf(c,g){const w=new _s;if(d.Image){const T=new Image;T.onload=S(sn,w,"TestLoadImage: loaded",!0,g,T),T.onerror=S(sn,w,"TestLoadImage: error",!1,g,T),T.onabort=S(sn,w,"TestLoadImage: abort",!1,g,T),T.ontimeout=S(sn,w,"TestLoadImage: timeout",!1,g,T),d.setTimeout(function(){T.ontimeout&&T.ontimeout()},1e4),T.src=c}else g(!1)}function yc(c,g){const w=new _s,T=new AbortController,B=setTimeout(()=>{T.abort(),sn(w,"TestPingServer: timeout",!1,g)},1e4);fetch(c,{signal:T.signal}).then(G=>{clearTimeout(B),G.ok?sn(w,"TestPingServer: ok",!0,g):sn(w,"TestPingServer: server error",!1,g)}).catch(()=>{clearTimeout(B),sn(w,"TestPingServer: error",!1,g)})}function sn(c,g,w,T,B){try{B&&(B.onload=null,B.onerror=null,B.onabort=null,B.ontimeout=null),T(w)}catch{}}function cf(){this.g=new gl}function vc(c,g,w){const T=w||"";try{Ei(c,function(B,G){let oe=B;m(B)&&(oe=pl(B)),g.push(T+G+"="+encodeURIComponent(oe))})}catch(B){throw g.push(T+"type="+encodeURIComponent("_badmap")),B}}function Hr(c){this.l=c.Ub||null,this.j=c.eb||!1}D(Hr,ys),Hr.prototype.g=function(){return new ks(this.l,this.j)},Hr.prototype.i=(function(c){return function(){return c}})({});function ks(c,g){xt.call(this),this.D=c,this.o=g,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}D(ks,xt),n=ks.prototype,n.open=function(c,g){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=c,this.A=g,this.readyState=1,Yn(this)},n.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const g={headers:this.u,method:this.B,credentials:this.m,cache:void 0};c&&(g.body=c),(this.D||d).fetch(new Request(this.A,g)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Xn(this)),this.readyState=0},n.Sa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,Yn(this)),this.g&&(this.readyState=3,Yn(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof d.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;_c(this)}else c.text().then(this.Ra.bind(this),this.ga.bind(this))};function _c(c){c.j.read().then(c.Pa.bind(c)).catch(c.ga.bind(c))}n.Pa=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var g=c.value?c.value:new Uint8Array(0);(g=this.v.decode(g,{stream:!c.done}))&&(this.response=this.responseText+=g)}c.done?Xn(this):Yn(this),this.readyState==3&&_c(this)}},n.Ra=function(c){this.g&&(this.response=this.responseText=c,Xn(this))},n.Qa=function(c){this.g&&(this.response=c,Xn(this))},n.ga=function(){this.g&&Xn(this)};function Xn(c){c.readyState=4,c.l=null,c.j=null,c.v=null,Yn(c)}n.setRequestHeader=function(c,g){this.u.append(c,g)},n.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],g=this.h.entries();for(var w=g.next();!w.done;)w=w.value,c.push(w[0]+": "+w[1]),w=g.next();return c.join(`\r
`)};function Yn(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(ks.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function Wr(c){let g="";return ce(c,function(w,T){g+=T,g+=":",g+=w,g+=`\r
`}),g}function bi(c,g,w){e:{for(T in w){var T=!1;break e}T=!0}T||(w=Wr(w),typeof c=="string"?w!=null&&encodeURIComponent(String(w)):Qe(c,g,w))}function nt(c){xt.call(this),this.headers=new Map,this.o=c||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}D(nt,xt);var df=/^https?$/i,kl=["POST","PUT"];n=nt.prototype,n.Ha=function(c){this.J=c},n.ea=function(c,g,w,T){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);g=g?g.toUpperCase():"GET",this.D=c,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Wn.g(),this.v=this.o?bo(this.o):bo(Wn),this.g.onreadystatechange=x(this.Ea,this);try{this.B=!0,this.g.open(g,String(c),!0),this.B=!1}catch(G){bs(this,G);return}if(c=w||"",w=new Map(this.headers),T)if(Object.getPrototypeOf(T)===Object.prototype)for(var B in T)w.set(B,T[B]);else if(typeof T.keys=="function"&&typeof T.get=="function")for(const G of T.keys())w.set(G,T.get(G));else throw Error("Unknown input type for opt_headers: "+String(T));T=Array.from(w.keys()).find(G=>G.toLowerCase()=="content-type"),B=d.FormData&&c instanceof d.FormData,!(0<=Array.prototype.indexOf.call(kl,g,void 0))||T||B||w.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[G,oe]of w)this.g.setRequestHeader(G,oe);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Fo(this),this.u=!0,this.g.send(c),this.u=!1}catch(G){bs(this,G)}};function bs(c,g){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=g,c.m=5,jo(c),yn(c)}function jo(c){c.A||(c.A=!0,Tt(c,"complete"),Tt(c,"error"))}n.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=c||7,Tt(this,"complete"),Tt(this,"abort"),yn(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),yn(this,!0)),nt.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?bl(this):this.bb())},n.bb=function(){bl(this)};function bl(c){if(c.h&&typeof l<"u"&&(!c.v[1]||on(c)!=4||c.Z()!=2)){if(c.u&&on(c)==4)dl(c.Ea,0,c);else if(Tt(c,"readystatechange"),on(c)==4){c.h=!1;try{const oe=c.Z();e:switch(oe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var g=!0;break e;default:g=!1}var w;if(!(w=g)){var T;if(T=oe===0){var B=String(c.D).match(Ts)[1]||null;!B&&d.self&&d.self.location&&(B=d.self.location.protocol.slice(0,-1)),T=!df.test(B?B.toLowerCase():"")}w=T}if(w)Tt(c,"complete"),Tt(c,"success");else{c.m=6;try{var G=2<on(c)?c.g.statusText:""}catch{G=""}c.l=G+" ["+c.Z()+"]",jo(c)}}finally{yn(c)}}}}function yn(c,g){if(c.g){Fo(c);const w=c.g,T=c.v[0]?()=>{}:null;c.g=null,c.v=null,g||Tt(c,"ready");try{w.onreadystatechange=T}catch{}}}function Fo(c){c.I&&(d.clearTimeout(c.I),c.I=null)}n.isActive=function(){return!!this.g};function on(c){return c.g?c.g.readyState:0}n.Z=function(){try{return 2<on(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(c){if(this.g){var g=this.g.responseText;return c&&g.indexOf(c)==0&&(g=g.substring(c.length)),ml(g)}};function Al(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.H){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function Uo(c){const g={};c=(c.g&&2<=on(c)&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let T=0;T<c.length;T++){if(X(c[T]))continue;var w=V(c[T]);const B=w[0];if(w=w[1],typeof w!="string")continue;w=w.trim();const G=g[B]||[];g[B]=G,G.push(w)}C(g,function(T){return T.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function vr(c,g,w){return w&&w.internalChannelParams&&w.internalChannelParams[c]||g}function Rl(c){this.Aa=0,this.i=[],this.j=new _s,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=vr("failFast",!1,c),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=vr("baseRetryDelayMs",5e3,c),this.cb=vr("retryDelaySeedMs",1e4,c),this.Wa=vr("forwardChannelMaxRetries",2,c),this.wa=vr("forwardChannelRequestTimeoutMs",2e4,c),this.pa=c&&c.xmlHttpFactory||void 0,this.Xa=c&&c.Tb||void 0,this.Ca=c&&c.useFetchStreams||!1,this.L=void 0,this.J=c&&c.supportsCrossDomainXhr||!1,this.K="",this.h=new xs(c&&c.concurrentRequestLimit),this.Da=new cf,this.P=c&&c.fastHandshake||!1,this.O=c&&c.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=c&&c.Rb||!1,c&&c.xa&&this.j.xa(),c&&c.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&c&&c.detectBufferingProxy||!1,this.ja=void 0,c&&c.longPollingTimeout&&0<c.longPollingTimeout&&(this.ja=c.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Rl.prototype,n.la=8,n.G=1,n.connect=function(c,g,w,T){pt(0),this.W=c,this.H=g||{},w&&T!==void 0&&(this.H.OSID=w,this.H.OAID=T),this.F=this.X,this.I=xc(this,null,this.W),_r(this)};function Mt(c){if(Bo(c),c.G==3){var g=c.U++,w=gn(c.I);if(Qe(w,"SID",c.K),Qe(w,"RID",g),Qe(w,"TYPE","terminate"),Gr(c,w),g=new Gn(c,c.j,g),g.L=2,g.v=Ti(gn(w)),w=!1,d.navigator&&d.navigator.sendBeacon)try{w=d.navigator.sendBeacon(g.v.toString(),"")}catch{}!w&&d.Image&&(new Image().src=g.v,w=!0),w||(g.g=Tc(g.j,null),g.g.ea(g.v)),g.F=Date.now(),Je(g)}Ic(c)}function Jn(c){c.g&&(Cl(c),c.g.cancel(),c.g=null)}function Bo(c){Jn(c),c.u&&(d.clearTimeout(c.u),c.u=null),qo(c),c.h.cancel(),c.s&&(typeof c.s=="number"&&d.clearTimeout(c.s),c.s=null)}function _r(c){if(!mn(c.h)&&!c.s){c.s=!0;var g=c.Ga;Ke||he(),ae||(Ke(),ae=!0),Ee.add(g,c),c.B=0}}function hf(c,g){return cc(c.h)>=c.h.j-(c.s?1:0)?!1:c.s?(c.i=g.D.concat(c.i),!0):c.G==1||c.G==2||c.B>=(c.Va?0:c.Wa)?!1:(c.s=qn(x(c.Ga,c,g),Ec(c,c.B)),c.B++,!0)}n.Ga=function(c){if(this.s)if(this.s=null,this.G==1){if(!c){this.U=Math.floor(1e5*Math.random()),c=this.U++;const B=new Gn(this,this.j,c);let G=this.o;if(this.S&&(G?(G=k(G),P(G,this.S)):G=this.S),this.m!==null||this.O||(B.H=G,G=null),this.P)e:{for(var g=0,w=0;w<this.i.length;w++){t:{var T=this.i[w];if("__data__"in T.map&&(T=T.map.__data__,typeof T=="string")){T=T.length;break t}T=void 0}if(T===void 0)break;if(g+=T,4096<g){g=w;break e}if(g===4096||w===this.i.length-1){g=w+1;break e}}g=1e3}else g=1e3;g=Ai(this,B,g),w=gn(this.I),Qe(w,"RID",c),Qe(w,"CVER",22),this.D&&Qe(w,"X-HTTP-Session-Id",this.D),Gr(this,w),G&&(this.O?g="headers="+encodeURIComponent(String(Wr(G)))+"&"+g:this.m&&bi(w,this.m,G)),Tl(this.h,B),this.Ua&&Qe(w,"TYPE","init"),this.P?(Qe(w,"$req",g),Qe(w,"SID","null"),B.T=!0,Vo(B,w,null)):Vo(B,w,g),this.G=2}}else this.G==3&&(c?zo(this,c):this.i.length==0||mn(this.h)||zo(this))};function zo(c,g){var w;g?w=g.l:w=c.U++;const T=gn(c.I);Qe(T,"SID",c.K),Qe(T,"RID",w),Qe(T,"AID",c.T),Gr(c,T),c.m&&c.o&&bi(T,c.m,c.o),w=new Gn(c,c.j,w,c.B+1),c.m===null&&(w.H=c.o),g&&(c.i=g.D.concat(c.i)),g=Ai(c,w,1e3),w.I=Math.round(.5*c.wa)+Math.round(.5*c.wa*Math.random()),Tl(c.h,w),Vo(w,T,g)}function Gr(c,g){c.H&&ce(c.H,function(w,T){Qe(g,T,w)}),c.l&&Ei({},function(w,T){Qe(g,T,w)})}function Ai(c,g,w){w=Math.min(c.i.length,w);var T=c.l?x(c.l.Na,c.l,c):null;e:{var B=c.i;let G=-1;for(;;){const oe=["count="+w];G==-1?0<w?(G=B[0].g,oe.push("ofs="+G)):G=0:oe.push("ofs="+G);let qe=!0;for(let St=0;St<w;St++){let Me=B[St].g;const Pt=B[St].map;if(Me-=G,0>Me)G=Math.max(0,B[St].g-100),qe=!1;else try{vc(Pt,oe,"req"+Me+"_")}catch{T&&T(Pt)}}if(qe){T=oe.join("&");break e}}}return c=c.i.splice(0,w),g.D=c,T}function As(c){if(!c.g&&!c.u){c.Y=1;var g=c.Fa;Ke||he(),ae||(Ke(),ae=!0),Ee.add(g,c),c.v=0}}function $o(c){return c.g||c.u||3<=c.v?!1:(c.Y++,c.u=qn(x(c.Fa,c),Ec(c,c.v)),c.v++,!0)}n.Fa=function(){if(this.u=null,wc(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var c=2*this.R;this.j.info("BP detection timer enabled: "+c),this.A=qn(x(this.ab,this),c)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,pt(10),Jn(this),wc(this))};function Cl(c){c.A!=null&&(d.clearTimeout(c.A),c.A=null)}function wc(c){c.g=new Gn(c,c.j,"rpc",c.Y),c.m===null&&(c.g.H=c.o),c.g.O=0;var g=gn(c.qa);Qe(g,"RID","rpc"),Qe(g,"SID",c.K),Qe(g,"AID",c.T),Qe(g,"CI",c.F?"0":"1"),!c.F&&c.ja&&Qe(g,"TO",c.ja),Qe(g,"TYPE","xmlhttp"),Gr(c,g),c.m&&c.o&&bi(g,c.m,c.o),c.L&&(c.g.I=c.L);var w=c.g;c=c.ia,w.L=1,w.v=Ti(gn(g)),w.m=null,w.P=!0,Il(w,c)}n.Za=function(){this.C!=null&&(this.C=null,Jn(this),$o(this),pt(19))};function qo(c){c.C!=null&&(d.clearTimeout(c.C),c.C=null)}function Ho(c,g){var w=null;if(c.g==g){qo(c),Cl(c),c.g=null;var T=2}else if(Yt(c.h,g))w=g.D,dc(c.h,g),T=1;else return;if(c.G!=0){if(g.o)if(T==1){w=g.m?g.m.length:0,g=Date.now()-g.F;var B=c.B;T=vs(),Tt(T,new Co(T,w)),_r(c)}else As(c);else if(B=g.s,B==3||B==0&&0<g.X||!(T==1&&hf(c,g)||T==2&&$o(c)))switch(w&&0<w.length&&(g=c.h,g.i=g.i.concat(w)),B){case 1:Kr(c,5);break;case 4:Kr(c,10);break;case 3:Kr(c,6);break;default:Kr(c,2)}}}function Ec(c,g){let w=c.Ta+Math.floor(Math.random()*c.cb);return c.isActive()||(w*=2),w*g}function Kr(c,g){if(c.j.info("Error code "+g),g==2){var w=x(c.fb,c),T=c.Xa;const B=!T;T=new qr(T||"//www.google.com/images/cleardot.gif"),d.location&&d.location.protocol=="http"||Ss(T,"https"),Ti(T),B?uf(T.toString(),w):yc(T.toString(),w)}else pt(2);c.G=0,c.l&&c.l.sa(g),Ic(c),Bo(c)}n.fb=function(c){c?(this.j.info("Successfully pinged google.com"),pt(2)):(this.j.info("Failed to ping google.com"),pt(1))};function Ic(c){if(c.G=0,c.ka=[],c.l){const g=hc(c.h);(g.length!=0||c.i.length!=0)&&(L(c.ka,g),L(c.ka,c.i),c.h.i.length=0,U(c.i),c.i.length=0),c.l.ra()}}function xc(c,g,w){var T=w instanceof qr?gn(w):new qr(w);if(T.g!="")g&&(T.g=g+"."+T.g),Ii(T,T.s);else{var B=d.location;T=B.protocol,g=g?g+"."+B.hostname:B.hostname,B=+B.port;var G=new qr(null);T&&Ss(G,T),g&&(G.g=g),B&&Ii(G,B),w&&(G.l=w),T=G}return w=c.D,g=c.ya,w&&g&&Qe(T,w,g),Qe(T,"VER",c.la),Gr(c,T),T}function Tc(c,g,w){if(g&&!c.J)throw Error("Can't create secondary domain capable XhrIo object.");return g=c.Ca&&!c.pa?new nt(new Hr({eb:w})):new nt(c.pa),g.Ha(c.J),g}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Pl(){}n=Pl.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Wo(){}Wo.prototype.g=function(c,g){return new Jt(c,g)};function Jt(c,g){xt.call(this),this.g=new Rl(g),this.l=c,this.h=g&&g.messageUrlParams||null,c=g&&g.messageHeaders||null,g&&g.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=g&&g.initMessageHeaders||null,g&&g.messageContentType&&(c?c["X-WebChannel-Content-Type"]=g.messageContentType:c={"X-WebChannel-Content-Type":g.messageContentType}),g&&g.va&&(c?c["X-WebChannel-Client-Profile"]=g.va:c={"X-WebChannel-Client-Profile":g.va}),this.g.S=c,(c=g&&g.Sb)&&!X(c)&&(this.g.m=c),this.v=g&&g.supportsCrossDomainXhr||!1,this.u=g&&g.sendRawJson||!1,(g=g&&g.httpSessionIdParam)&&!X(g)&&(this.g.D=g,c=this.h,c!==null&&g in c&&(c=this.h,g in c&&delete c[g])),this.j=new wr(this)}D(Jt,xt),Jt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Jt.prototype.close=function(){Mt(this.g)},Jt.prototype.o=function(c){var g=this.g;if(typeof c=="string"){var w={};w.__data__=c,c=w}else this.u&&(w={},w.__data__=pl(c),c=w);g.i.push(new uc(g.Ya++,c)),g.G==3&&_r(g)},Jt.prototype.N=function(){this.g.l=null,delete this.j,Mt(this.g),delete this.g,Jt.aa.N.call(this)};function Sc(c){pr.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var g=c.__sm__;if(g){e:{for(const w in g){c=w;break e}c=void 0}(this.i=c)&&(c=this.i,g=g!==null&&c in g?g[c]:void 0),this.data=g}else this.data=c}D(Sc,pr);function kc(){Ro.call(this),this.status=1}D(kc,Ro);function wr(c){this.g=c}D(wr,Pl),wr.prototype.ua=function(){Tt(this.g,"a")},wr.prototype.ta=function(c){Tt(this.g,new Sc(c))},wr.prototype.sa=function(c){Tt(this.g,new kc)},wr.prototype.ra=function(){Tt(this.g,"b")},Wo.prototype.createWebChannel=Wo.prototype.g,Jt.prototype.send=Jt.prototype.o,Jt.prototype.open=Jt.prototype.m,Jt.prototype.close=Jt.prototype.close,DE=function(){return new Wo},NE=function(){return vs()},PE=mr,lm={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},No.NO_ERROR=0,No.TIMEOUT=8,No.HTTP_ERROR=6,Pd=No,sc.COMPLETE="complete",CE=sc,Ao.EventType=bn,bn.OPEN="a",bn.CLOSE="b",bn.ERROR="c",bn.MESSAGE="d",xt.prototype.listen=xt.prototype.K,lu=Ao,nt.prototype.listenOnce=nt.prototype.L,nt.prototype.getLastError=nt.prototype.Ka,nt.prototype.getLastErrorCode=nt.prototype.Ba,nt.prototype.getStatus=nt.prototype.Z,nt.prototype.getResponseJson=nt.prototype.Oa,nt.prototype.getResponseText=nt.prototype.oa,nt.prototype.send=nt.prototype.ea,nt.prototype.setWithCredentials=nt.prototype.Ha,RE=nt}).apply(typeof Ed<"u"?Ed:typeof self<"u"?self:typeof window<"u"?window:{});const K_="@firebase/firestore",Q_="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ut{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ut.UNAUTHENTICATED=new Ut(null),Ut.GOOGLE_CREDENTIALS=new Ut("google-credentials-uid"),Ut.FIRST_PARTY=new Ut("first-party-uid"),Ut.MOCK_USER=new Ut("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ja="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const so=new kh("@firebase/firestore");function wa(){return so.logLevel}function te(n,...e){if(so.logLevel<=De.DEBUG){const t=e.map(Ym);so.debug(`Firestore (${Ja}): ${n}`,...t)}}function tn(n,...e){if(so.logLevel<=De.ERROR){const t=e.map(Ym);so.error(`Firestore (${Ja}): ${n}`,...t)}}function Or(n,...e){if(so.logLevel<=De.WARN){const t=e.map(Ym);so.warn(`Firestore (${Ja}): ${n}`,...t)}}function Ym(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function me(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,VE(n,r,t)}function VE(n,e,t){let r=`FIRESTORE (${Ja}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw tn(r),new Error(r)}function ve(n,e,t,r){let s="Unexpected state";typeof t=="string"?s=t:r=t,n||VE(e,s,r)}function be(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class se extends hr{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cr{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OE{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class gA{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Ut.UNAUTHENTICATED)))}shutdown(){}}class yA{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class vA{constructor(e){this.t=e,this.currentUser=Ut.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){ve(this.o===void 0,42304);let r=this.i;const s=f=>this.i!==r?(r=this.i,t(f)):Promise.resolve();let a=new Cr;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new Cr,e.enqueueRetryable((()=>s(this.currentUser)))};const l=()=>{const f=a;e.enqueueRetryable((async()=>{await f.promise,await s(this.currentUser)}))},d=f=>{te("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=f,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit((f=>d(f))),setTimeout((()=>{if(!this.auth){const f=this.t.getImmediate({optional:!0});f?d(f):(te("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new Cr)}}),0),l()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(te("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ve(typeof r.accessToken=="string",31837,{l:r}),new OE(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ve(e===null||typeof e=="string",2055,{h:e}),new Ut(e)}}class _A{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Ut.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class wA{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new _A(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Ut.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class X_{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class EA{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,or(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){ve(this.o===void 0,3512);const r=a=>{a.error!=null&&te("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const l=a.token!==this.m;return this.m=a.token,te("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?t(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable((()=>r(a)))};const s=a=>{te("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((a=>s(a))),setTimeout((()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?s(a):te("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new X_(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(ve(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new X_(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IA(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LE(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jm{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=IA(40);for(let a=0;a<s.length;++a)r.length<20&&s[a]<t&&(r+=e.charAt(s[a]%62))}return r}}function Te(n,e){return n<e?-1:n>e?1:0}function um(n,e){let t=0;for(;t<n.length&&t<e.length;){const r=n.codePointAt(t),s=e.codePointAt(t);if(r!==s){if(r<128&&s<128)return Te(r,s);{const a=LE(),l=xA(a.encode(Y_(n,t)),a.encode(Y_(e,t)));return l!==0?l:Te(r,s)}}t+=r>65535?2:1}return Te(n.length,e.length)}function Y_(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function xA(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return Te(n[t],e[t]);return Te(n.length,e.length)}function Ca(n,e,t){return n.length===e.length&&n.every(((r,s)=>t(r,e[s])))}function ME(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J_="__name__";class kr{constructor(e,t,r){t===void 0?t=0:t>e.length&&me(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&me(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return kr.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof kr?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let s=0;s<r;s++){const a=kr.compareSegments(e.get(s),t.get(s));if(a!==0)return a}return Te(e.length,t.length)}static compareSegments(e,t){const r=kr.isNumericId(e),s=kr.isNumericId(t);return r&&!s?-1:!r&&s?1:r&&s?kr.extractNumericId(e).compare(kr.extractNumericId(t)):um(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ts.fromString(e.substring(4,e.length-2))}}class $e extends kr{construct(e,t,r){return new $e(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new se(Q.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((s=>s.length>0)))}return new $e(t)}static emptyPath(){return new $e([])}}const TA=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ct extends kr{construct(e,t,r){return new ct(e,t,r)}static isValidIdentifier(e){return TA.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ct.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===J_}static keyField(){return new ct([J_])}static fromServerFormat(e){const t=[];let r="",s=0;const a=()=>{if(r.length===0)throw new se(Q.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let l=!1;for(;s<e.length;){const d=e[s];if(d==="\\"){if(s+1===e.length)throw new se(Q.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const f=e[s+1];if(f!=="\\"&&f!=="."&&f!=="`")throw new se(Q.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=f,s+=2}else d==="`"?(l=!l,s++):d!=="."||l?(r+=d,s++):(a(),s++)}if(a(),l)throw new se(Q.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ct(t)}static emptyPath(){return new ct([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class le{constructor(e){this.path=e}static fromPath(e){return new le($e.fromString(e))}static fromName(e){return new le($e.fromString(e).popFirst(5))}static empty(){return new le($e.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&$e.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return $e.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new le(new $e(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jE(n,e,t){if(!t)throw new se(Q.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function SA(n,e,t,r){if(e===!0&&r===!0)throw new se(Q.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function Z_(n){if(!le.isDocumentKey(n))throw new se(Q.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function ew(n){if(le.isDocumentKey(n))throw new se(Q.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function FE(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function bh(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":me(12329,{type:typeof n})}function nn(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new se(Q.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=bh(n);throw new se(Q.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function kA(n,e){if(e<=0)throw new se(Q.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _t(n,e){const t={typeString:n};return e&&(t.value=e),t}function qu(n,e){if(!FE(n))throw new se(Q.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const s=e[r].typeString,a="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const l=n[r];if(s&&typeof l!==s){t=`JSON field '${r}' must be a ${s}.`;break}if(a!==void 0&&l!==a.value){t=`Expected '${r}' field to equal '${a.value}'`;break}}if(t)throw new se(Q.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tw=-62135596800,nw=1e6;class He{static now(){return He.fromMillis(Date.now())}static fromDate(e){return He.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*nw);return new He(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new se(Q.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new se(Q.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<tw)throw new se(Q.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new se(Q.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/nw}_compareTo(e){return this.seconds===e.seconds?Te(this.nanoseconds,e.nanoseconds):Te(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:He._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(qu(e,He._jsonSchema))return new He(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-tw;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}He._jsonSchemaVersion="firestore/timestamp/1.0",He._jsonSchema={type:_t("string",He._jsonSchemaVersion),seconds:_t("number"),nanoseconds:_t("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class we{static fromTimestamp(e){return new we(e)}static min(){return new we(new He(0,0))}static max(){return new we(new He(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ku=-1;class Xd{constructor(e,t,r,s){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=s}}function cm(n){return n.fields.find((e=>e.kind===2))}function qs(n){return n.fields.filter((e=>e.kind!==2))}Xd.UNKNOWN_ID=-1;class Nd{constructor(e,t){this.fieldPath=e,this.kind=t}}class bu{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new bu(0,Sn.min())}}function bA(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=we.fromTimestamp(r===1e9?new He(t+1,0):new He(t,r));return new Sn(s,le.empty(),e)}function UE(n){return new Sn(n.readTime,n.key,ku)}class Sn{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Sn(we.min(),le.empty(),ku)}static max(){return new Sn(we.max(),le.empty(),ku)}}function Zm(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=le.comparator(n.documentKey,e.documentKey),t!==0?t:Te(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BE="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class zE{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _o(n){if(n.code!==Q.FAILED_PRECONDITION||n.message!==BE)throw n;te("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&me(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new z(((r,s)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(r,s)},this.catchCallback=a=>{this.wrapFailure(t,a).next(r,s)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof z?t:z.resolve(t)}catch(t){return z.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):z.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):z.reject(t)}static resolve(e){return new z(((t,r)=>{t(e)}))}static reject(e){return new z(((t,r)=>{r(e)}))}static waitFor(e){return new z(((t,r)=>{let s=0,a=0,l=!1;e.forEach((d=>{++s,d.next((()=>{++a,l&&a===s&&t()}),(f=>r(f)))})),l=!0,a===s&&t()}))}static or(e){let t=z.resolve(!1);for(const r of e)t=t.next((s=>s?z.resolve(s):r()));return t}static forEach(e,t){const r=[];return e.forEach(((s,a)=>{r.push(t.call(this,s,a))})),this.waitFor(r)}static mapArray(e,t){return new z(((r,s)=>{const a=e.length,l=new Array(a);let d=0;for(let f=0;f<a;f++){const m=f;t(e[m]).next((v=>{l[m]=v,++d,d===a&&r(l)}),(v=>s(v)))}}))}static doWhile(e,t){return new z(((r,s)=>{const a=()=>{e()===!0?t().next((()=>{a()}),s):r()};a()}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const In="SimpleDb";class Ah{static open(e,t,r,s){try{return new Ah(t,e.transaction(s,r))}catch(a){throw new pu(t,a)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new Cr,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new pu(e,t.error)):this.S.resolve()},this.transaction.onerror=r=>{const s=eg(r.target.error);this.S.reject(new pu(e,s))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(te(In,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}v(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new RA(t)}}class ns{static delete(e){return te(In,"Removing database:",e),Ws(hE().indexedDB.deleteDatabase(e)).toPromise()}static C(){if(!Sh())return!1;if(ns.F())return!0;const e=At(),t=ns.M(e),r=0<t&&t<10,s=$E(e),a=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||a)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.O)==="YES"}static N(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.B=r,this.L=null,ns.M(At())===12.2&&tn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async k(e){return this.db||(te(In,"Opening database:",this.name),this.db=await new Promise(((t,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=a=>{const l=a.target.result;t(l)},s.onblocked=()=>{r(new pu(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=a=>{const l=a.target.error;l.name==="VersionError"?r(new se(Q.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):l.name==="InvalidStateError"?r(new se(Q.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+l)):r(new pu(e,l))},s.onupgradeneeded=a=>{te(In,'Database "'+this.name+'" requires upgrade from version:',a.oldVersion);const l=a.target.result;if(this.L!==null&&this.L!==a.oldVersion)throw new Error(`refusing to open IndexedDB database due to potential corruption of the IndexedDB database data; this corruption could be caused by clicking the "clear site data" button in a web browser; try reloading the web page to re-initialize the IndexedDB database: lastClosedDbVersion=${this.L}, event.oldVersion=${a.oldVersion}, event.newVersion=${a.newVersion}, db.version=${l.version}`);this.B.q(l,s.transaction,a.oldVersion,this.version).next((()=>{te(In,"Database upgrade to version "+this.version+" complete")}))}})),this.db.addEventListener("close",(t=>{const r=t.target;this.L=r.version}),{passive:!0})),this.db.addEventListener("versionchange",(t=>{var r;t.newVersion===null&&(Or('Received "versionchange" event with newVersion===null; notifying the registered DatabaseDeletedListener, if any'),(r=this.databaseDeletedListener)===null||r===void 0||r.call(this))}),{passive:!0}),this.db}setDatabaseDeletedListener(e){if(this.databaseDeletedListener)throw new Error("setDatabaseDeletedListener() may only be called once, and it has already been called");this.databaseDeletedListener=e}async runTransaction(e,t,r,s){const a=t==="readonly";let l=0;for(;;){++l;try{this.db=await this.k(e);const d=Ah.open(this.db,e,a?"readonly":"readwrite",r),f=s(d).next((m=>(d.v(),m))).catch((m=>(d.abort(m),z.reject(m)))).toPromise();return f.catch((()=>{})),await d.D,f}catch(d){const f=d,m=f.name!=="FirebaseError"&&l<3;if(te(In,"Transaction failed with error:",f.message,"Retrying:",m),this.close(),!m)return Promise.reject(f)}}}close(){this.db&&this.db.close(),this.db=void 0}}function $E(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class AA{constructor(e){this.$=e,this.U=!1,this.K=null}get isDone(){return this.U}get W(){return this.K}set cursor(e){this.$=e}done(){this.U=!0}G(e){this.K=e}delete(){return Ws(this.$.delete())}}class pu extends se{constructor(e,t){super(Q.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function hs(n){return n.name==="IndexedDbTransactionError"}class RA{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(te(In,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(te(In,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Ws(r)}add(e){return te(In,"ADD",this.store.name,e,e),Ws(this.store.add(e))}get(e){return Ws(this.store.get(e)).next((t=>(t===void 0&&(t=null),te(In,"GET",this.store.name,e,t),t)))}delete(e){return te(In,"DELETE",this.store.name,e),Ws(this.store.delete(e))}count(){return te(In,"COUNT",this.store.name),Ws(this.store.count())}j(e,t){const r=this.options(e,t),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const a=s.getAll(r.range);return new z(((l,d)=>{a.onerror=f=>{d(f.target.error)},a.onsuccess=f=>{l(f.target.result)}}))}{const a=this.cursor(r),l=[];return this.J(a,((d,f)=>{l.push(f)})).next((()=>l))}}H(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new z(((s,a)=>{r.onerror=l=>{a(l.target.error)},r.onsuccess=l=>{s(l.target.result)}}))}Y(e,t){te(In,"DELETE ALL",this.store.name);const r=this.options(e,t);r.Z=!1;const s=this.cursor(r);return this.J(s,((a,l,d)=>d.delete()))}X(e,t){let r;t?r=e:(r={},t=e);const s=this.cursor(r);return this.J(s,t)}ee(e){const t=this.cursor({});return new z(((r,s)=>{t.onerror=a=>{const l=eg(a.target.error);s(l)},t.onsuccess=a=>{const l=a.target.result;l?e(l.primaryKey,l.value).next((d=>{d?l.continue():r()})):r()}}))}J(e,t){const r=[];return new z(((s,a)=>{e.onerror=l=>{a(l.target.error)},e.onsuccess=l=>{const d=l.target.result;if(!d)return void s();const f=new AA(d),m=t(d.primaryKey,d.value,f);if(m instanceof z){const v=m.catch((_=>(f.done(),z.reject(_))));r.push(v)}f.isDone?s():f.W===null?d.continue():d.continue(f.W)}})).next((()=>z.waitFor(r)))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.Z?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Ws(n){return new z(((e,t)=>{n.onsuccess=r=>{const s=r.target.result;e(s)},n.onerror=r=>{const s=eg(r.target.error);t(s)}}))}let rw=!1;function eg(n){const e=ns.M(At());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new se("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return rw||(rw=!0,setTimeout((()=>{throw r}),0)),r}}return n}const mu="IndexBackfiller";class CA{constructor(e,t){this.asyncQueue=e,this.te=t,this.task=null}start(){this.ne(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}ne(e){te(mu,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.te.re();te(mu,`Documents written: ${t}`)}catch(t){hs(t)?te(mu,"Ignoring IndexedDB error during index backfill: ",t):await _o(t)}await this.ne(6e4)}))}}class PA{constructor(e,t){this.localStore=e,this.persistence=t}async re(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.ie(t,e)))}ie(e,t){const r=new Set;let s=t,a=!0;return z.doWhile((()=>a===!0&&s>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((l=>{if(l!==null&&!r.has(l))return te(mu,`Processing collection: ${l}`),this.se(e,l,s).next((d=>{s-=d,r.add(l)}));a=!1})))).next((()=>t-s))}se(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((s=>this.localStore.localDocuments.getNextDocuments(e,t,s,r).next((a=>{const l=a.changes;return this.localStore.indexManager.updateIndexEntries(e,l).next((()=>this.oe(s,a))).next((d=>(te(mu,`Updating offset: ${d}`),this.localStore.indexManager.updateCollectionGroup(e,t,d)))).next((()=>l.size))}))))}oe(e,t){let r=e;return t.changes.forEach(((s,a)=>{const l=UE(a);Zm(l,r)>0&&(r=l)})),new Sn(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jn{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this._e(r),this.ae=r=>t.writeSequenceNumber(r))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}jn.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zs=-1;function Rh(n){return n==null}function Au(n){return n===0&&1/n==-1/0}function NA(n){return typeof n=="number"&&Number.isInteger(n)&&!Au(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yd="";function Xt(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=iw(e)),e=DA(n.get(t),e);return iw(e)}function DA(n,e){let t=e;const r=n.length;for(let s=0;s<r;s++){const a=n.charAt(s);switch(a){case"\0":t+="";break;case Yd:t+="";break;default:t+=a}}return t}function iw(n){return n+Yd+""}function Ar(n){const e=n.length;if(ve(e>=2,64408,{path:n}),e===2)return ve(n.charAt(0)===Yd&&n.charAt(1)==="",56145,{path:n}),$e.emptyPath();const t=e-2,r=[];let s="";for(let a=0;a<e;){const l=n.indexOf(Yd,a);switch((l<0||l>t)&&me(50515,{path:n}),n.charAt(l+1)){case"":const d=n.substring(a,l);let f;s.length===0?f=d:(s+=d,f=s,s=""),r.push(f);break;case"":s+=n.substring(a,l),s+="\0";break;case"":s+=n.substring(a,l+1);break;default:me(61167,{path:n})}a=l+2}return new $e(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hs="remoteDocuments",Hu="owner",pa="owner",Ru="mutationQueues",VA="userId",sr="mutations",sw="batchId",Xs="userMutationsIndex",ow=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dd(n,e){return[n,Xt(e)]}function qE(n,e,t){return[n,Xt(e),t]}const OA={},Pa="documentMutations",Jd="remoteDocumentsV14",LA=["prefixPath","collectionGroup","readTime","documentId"],Vd="documentKeyIndex",MA=["prefixPath","collectionGroup","documentId"],HE="collectionGroupIndex",jA=["collectionGroup","readTime","prefixPath","documentId"],Cu="remoteDocumentGlobal",dm="remoteDocumentGlobalKey",Na="targets",WE="queryTargetsIndex",FA=["canonicalId","targetId"],Da="targetDocuments",UA=["targetId","path"],tg="documentTargetsIndex",BA=["path","targetId"],Zd="targetGlobalKey",eo="targetGlobal",Pu="collectionParents",zA=["collectionId","parent"],Va="clientMetadata",$A="clientId",Ch="bundles",qA="bundleId",Ph="namedQueries",HA="name",ng="indexConfiguration",WA="indexId",hm="collectionGroupIndex",GA="collectionGroup",gu="indexState",KA=["indexId","uid"],GE="sequenceNumberIndex",QA=["uid","sequenceNumber"],yu="indexEntries",XA=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],KE="documentKeyIndex",YA=["indexId","uid","orderedDocumentKey"],Nh="documentOverlays",JA=["userId","collectionPath","documentId"],fm="collectionPathOverlayIndex",ZA=["userId","collectionPath","largestBatchId"],QE="collectionGroupOverlayIndex",eR=["userId","collectionGroup","largestBatchId"],rg="globals",tR="name",XE=[Ru,sr,Pa,Hs,Na,Hu,eo,Da,Va,Cu,Pu,Ch,Ph],nR=[...XE,Nh],YE=[Ru,sr,Pa,Jd,Na,Hu,eo,Da,Va,Cu,Pu,Ch,Ph,Nh],JE=YE,ig=[...JE,ng,gu,yu],rR=ig,ZE=[...ig,rg],iR=ZE;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pm extends zE{constructor(e,t){super(),this.ce=e,this.currentSequenceNumber=t}}function Rt(n,e){const t=be(n);return ns.N(t.ce,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aw(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function fs(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function eI(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class at{constructor(e,t){this.comparator=e,this.root=t||Bt.EMPTY}insert(e,t){return new at(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Bt.BLACK,null,null))}remove(e){return new at(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Bt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return t+r.left.size;s<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Id(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Id(this.root,e,this.comparator,!1)}getReverseIterator(){return new Id(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Id(this.root,e,this.comparator,!0)}}class Id{constructor(e,t,r,s){this.isReverse=s,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?r(e.key,t):1,t&&s&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Bt{constructor(e,t,r,s,a){this.key=e,this.value=t,this.color=r??Bt.RED,this.left=s??Bt.EMPTY,this.right=a??Bt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,s,a){return new Bt(e??this.key,t??this.value,r??this.color,s??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this;const a=r(e,s.key);return s=a<0?s.copy(null,null,null,s.left.insert(e,t,r),null):a===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Bt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return Bt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Bt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Bt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw me(43730,{key:this.key,value:this.value});if(this.right.isRed())throw me(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw me(27949);return e+(this.isRed()?0:1)}}Bt.EMPTY=null,Bt.RED=!0,Bt.BLACK=!1;Bt.EMPTY=new class{constructor(){this.size=0}get key(){throw me(57766)}get value(){throw me(16141)}get color(){throw me(16727)}get left(){throw me(29726)}get right(){throw me(36894)}copy(e,t,r,s,a){return this}insert(e,t,r){return new Bt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ge{constructor(e){this.comparator=e,this.data=new at(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new lw(this.data.getIterator())}getIteratorFrom(e){return new lw(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof Ge)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,a=r.getNext().key;if(this.comparator(s,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Ge(this.comparator);return t.data=e,t}}class lw{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function ma(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fn{constructor(e){this.fields=e,e.sort(ct.comparator)}static empty(){return new fn([])}unionWith(e){let t=new Ge(ct.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new fn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Ca(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tI extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class It{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(s){try{return atob(s)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new tI("Invalid base64 string: "+a):a}})(e);return new It(t)}static fromUint8Array(e){const t=(function(s){let a="";for(let l=0;l<s.length;++l)a+=String.fromCharCode(s[l]);return a})(e);return new It(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Te(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}It.EMPTY_BYTE_STRING=new It("");const sR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function di(n){if(ve(!!n,39018),typeof n=="string"){let e=0;const t=sR.exec(n);if(ve(!!t,46558,{timestamp:n}),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:it(n.seconds),nanos:it(n.nanos)}}function it(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function hi(n){return typeof n=="string"?It.fromBase64String(n):It.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nI="server_timestamp",rI="__type__",iI="__previous_value__",sI="__local_write_time__";function sg(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[rI])===null||t===void 0?void 0:t.stringValue)===nI}function Dh(n){const e=n.mapValue.fields[iI];return sg(e)?Dh(e):e}function Nu(n){const e=di(n.mapValue.fields[sI].timestampValue);return new He(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oR{constructor(e,t,r,s,a,l,d,f,m,v){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=s,this.ssl=a,this.forceLongPolling=l,this.autoDetectLongPolling=d,this.longPollingOptions=f,this.useFetchStreams=m,this.isUsingEmulator=v}}const eh="(default)";class oo{constructor(e,t){this.projectId=e,this.database=t||eh}static empty(){return new oo("","")}get isDefaultDatabase(){return this.database===eh}isEqual(e){return e instanceof oo&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const og="__type__",oI="__max__",Ji={mapValue:{fields:{__type__:{stringValue:oI}}}},ag="__vector__",Oa="value",Od={nullValue:"NULL_VALUE"};function os(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?sg(n)?4:aI(n)?9007199254740991:Vh(n)?10:11:me(28295,{value:n})}function Lr(n,e){if(n===e)return!0;const t=os(n);if(t!==os(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Nu(n).isEqual(Nu(e));case 3:return(function(s,a){if(typeof s.timestampValue=="string"&&typeof a.timestampValue=="string"&&s.timestampValue.length===a.timestampValue.length)return s.timestampValue===a.timestampValue;const l=di(s.timestampValue),d=di(a.timestampValue);return l.seconds===d.seconds&&l.nanos===d.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(s,a){return hi(s.bytesValue).isEqual(hi(a.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(s,a){return it(s.geoPointValue.latitude)===it(a.geoPointValue.latitude)&&it(s.geoPointValue.longitude)===it(a.geoPointValue.longitude)})(n,e);case 2:return(function(s,a){if("integerValue"in s&&"integerValue"in a)return it(s.integerValue)===it(a.integerValue);if("doubleValue"in s&&"doubleValue"in a){const l=it(s.doubleValue),d=it(a.doubleValue);return l===d?Au(l)===Au(d):isNaN(l)&&isNaN(d)}return!1})(n,e);case 9:return Ca(n.arrayValue.values||[],e.arrayValue.values||[],Lr);case 10:case 11:return(function(s,a){const l=s.mapValue.fields||{},d=a.mapValue.fields||{};if(aw(l)!==aw(d))return!1;for(const f in l)if(l.hasOwnProperty(f)&&(d[f]===void 0||!Lr(l[f],d[f])))return!1;return!0})(n,e);default:return me(52216,{left:n})}}function Du(n,e){return(n.values||[]).find((t=>Lr(t,e)))!==void 0}function as(n,e){if(n===e)return 0;const t=os(n),r=os(e);if(t!==r)return Te(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Te(n.booleanValue,e.booleanValue);case 2:return(function(a,l){const d=it(a.integerValue||a.doubleValue),f=it(l.integerValue||l.doubleValue);return d<f?-1:d>f?1:d===f?0:isNaN(d)?isNaN(f)?0:-1:1})(n,e);case 3:return uw(n.timestampValue,e.timestampValue);case 4:return uw(Nu(n),Nu(e));case 5:return um(n.stringValue,e.stringValue);case 6:return(function(a,l){const d=hi(a),f=hi(l);return d.compareTo(f)})(n.bytesValue,e.bytesValue);case 7:return(function(a,l){const d=a.split("/"),f=l.split("/");for(let m=0;m<d.length&&m<f.length;m++){const v=Te(d[m],f[m]);if(v!==0)return v}return Te(d.length,f.length)})(n.referenceValue,e.referenceValue);case 8:return(function(a,l){const d=Te(it(a.latitude),it(l.latitude));return d!==0?d:Te(it(a.longitude),it(l.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return cw(n.arrayValue,e.arrayValue);case 10:return(function(a,l){var d,f,m,v;const _=a.fields||{},x=l.fields||{},S=(d=_[Oa])===null||d===void 0?void 0:d.arrayValue,D=(f=x[Oa])===null||f===void 0?void 0:f.arrayValue,U=Te(((m=S==null?void 0:S.values)===null||m===void 0?void 0:m.length)||0,((v=D==null?void 0:D.values)===null||v===void 0?void 0:v.length)||0);return U!==0?U:cw(S,D)})(n.mapValue,e.mapValue);case 11:return(function(a,l){if(a===Ji.mapValue&&l===Ji.mapValue)return 0;if(a===Ji.mapValue)return 1;if(l===Ji.mapValue)return-1;const d=a.fields||{},f=Object.keys(d),m=l.fields||{},v=Object.keys(m);f.sort(),v.sort();for(let _=0;_<f.length&&_<v.length;++_){const x=um(f[_],v[_]);if(x!==0)return x;const S=as(d[f[_]],m[v[_]]);if(S!==0)return S}return Te(f.length,v.length)})(n.mapValue,e.mapValue);default:throw me(23264,{le:t})}}function uw(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Te(n,e);const t=di(n),r=di(e),s=Te(t.seconds,r.seconds);return s!==0?s:Te(t.nanos,r.nanos)}function cw(n,e){const t=n.values||[],r=e.values||[];for(let s=0;s<t.length&&s<r.length;++s){const a=as(t[s],r[s]);if(a)return a}return Te(t.length,r.length)}function La(n){return mm(n)}function mm(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=di(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return hi(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return le.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",s=!0;for(const a of t.values||[])s?s=!1:r+=",",r+=mm(a);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let s="{",a=!0;for(const l of r)a?a=!1:s+=",",s+=`${l}:${mm(t.fields[l])}`;return s+"}"})(n.mapValue):me(61005,{value:n})}function Ld(n){switch(os(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Dh(n);return e?16+Ld(e):16;case 5:return 2*n.stringValue.length;case 6:return hi(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((s,a)=>s+Ld(a)),0)})(n.arrayValue);case 10:case 11:return(function(r){let s=0;return fs(r.fields,((a,l)=>{s+=a.length+Ld(l)})),s})(n.mapValue);default:throw me(13486,{value:n})}}function Vu(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function gm(n){return!!n&&"integerValue"in n}function Ou(n){return!!n&&"arrayValue"in n}function dw(n){return!!n&&"nullValue"in n}function hw(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Md(n){return!!n&&"mapValue"in n}function Vh(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[og])===null||t===void 0?void 0:t.stringValue)===ag}function vu(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return fs(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=vu(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=vu(n.arrayValue.values[t]);return e}return Object.assign({},n)}function aI(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===oI}const lI={mapValue:{fields:{[og]:{stringValue:ag},[Oa]:{arrayValue:{}}}}};function aR(n){return"nullValue"in n?Od:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Vu(oo.empty(),le.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Vh(n)?lI:{mapValue:{}}:me(35942,{value:n})}function lR(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Vu(oo.empty(),le.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?lI:"mapValue"in n?Vh(n)?{mapValue:{}}:Ji:me(61959,{value:n})}function fw(n,e){const t=as(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function pw(n,e){const t=as(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kt{constructor(e){this.value=e}static empty(){return new Kt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Md(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=vu(t)}setAll(e){let t=ct.emptyPath(),r={},s=[];e.forEach(((l,d)=>{if(!t.isImmediateParentOf(d)){const f=this.getFieldsMap(t);this.applyChanges(f,r,s),r={},s=[],t=d.popLast()}l?r[d.lastSegment()]=vu(l):s.push(d.lastSegment())}));const a=this.getFieldsMap(t);this.applyChanges(a,r,s)}delete(e){const t=this.field(e.popLast());Md(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Lr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=t.mapValue.fields[e.get(r)];Md(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,r){fs(t,((s,a)=>e[s]=a));for(const s of r)delete e[s]}clone(){return new Kt(vu(this.value))}}function uI(n){const e=[];return fs(n.fields,((t,r)=>{const s=new ct([t]);if(Md(r)){const a=uI(r.mapValue).fields;if(a.length===0)e.push(s);else for(const l of a)e.push(s.child(l))}else e.push(s)})),new fn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ht{constructor(e,t,r,s,a,l,d){this.key=e,this.documentType=t,this.version=r,this.readTime=s,this.createTime=a,this.data=l,this.documentState=d}static newInvalidDocument(e){return new ht(e,0,we.min(),we.min(),we.min(),Kt.empty(),0)}static newFoundDocument(e,t,r,s){return new ht(e,1,t,we.min(),r,s,0)}static newNoDocument(e,t){return new ht(e,2,t,we.min(),we.min(),Kt.empty(),0)}static newUnknownDocument(e,t){return new ht(e,3,t,we.min(),we.min(),Kt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(we.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Kt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Kt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=we.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ht&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ht(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ma{constructor(e,t){this.position=e,this.inclusive=t}}function mw(n,e,t){let r=0;for(let s=0;s<n.position.length;s++){const a=e[s],l=n.position[s];if(a.field.isKeyField()?r=le.comparator(le.fromName(l.referenceValue),t.key):r=as(l,t.data.field(a.field)),a.dir==="desc"&&(r*=-1),r!==0)break}return r}function gw(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Lr(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lu{constructor(e,t="asc"){this.field=e,this.dir=t}}function uR(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cI{}class Ve extends cI{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new cR(e,t,r):t==="array-contains"?new fR(e,r):t==="in"?new gI(e,r):t==="not-in"?new pR(e,r):t==="array-contains-any"?new mR(e,r):new Ve(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new dR(e,r):new hR(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(as(t,this.value)):t!==null&&os(this.value)===os(t)&&this.matchesComparison(as(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return me(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class We extends cI{constructor(e,t){super(),this.filters=e,this.op=t,this.he=null}static create(e,t){return new We(e,t)}matches(e){return ja(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function ja(n){return n.op==="and"}function ym(n){return n.op==="or"}function lg(n){return dI(n)&&ja(n)}function dI(n){for(const e of n.filters)if(e instanceof We)return!1;return!0}function vm(n){if(n instanceof Ve)return n.field.canonicalString()+n.op.toString()+La(n.value);if(lg(n))return n.filters.map((e=>vm(e))).join(",");{const e=n.filters.map((t=>vm(t))).join(",");return`${n.op}(${e})`}}function hI(n,e){return n instanceof Ve?(function(r,s){return s instanceof Ve&&r.op===s.op&&r.field.isEqual(s.field)&&Lr(r.value,s.value)})(n,e):n instanceof We?(function(r,s){return s instanceof We&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce(((a,l,d)=>a&&hI(l,s.filters[d])),!0):!1})(n,e):void me(19439)}function fI(n,e){const t=n.filters.concat(e);return We.create(t,n.op)}function pI(n){return n instanceof Ve?(function(t){return`${t.field.canonicalString()} ${t.op} ${La(t.value)}`})(n):n instanceof We?(function(t){return t.op.toString()+" {"+t.getFilters().map(pI).join(" ,")+"}"})(n):"Filter"}class cR extends Ve{constructor(e,t,r){super(e,t,r),this.key=le.fromName(r.referenceValue)}matches(e){const t=le.comparator(e.key,this.key);return this.matchesComparison(t)}}class dR extends Ve{constructor(e,t){super(e,"in",t),this.keys=mI("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class hR extends Ve{constructor(e,t){super(e,"not-in",t),this.keys=mI("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function mI(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map((r=>le.fromName(r.referenceValue)))}class fR extends Ve{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Ou(t)&&Du(t.arrayValue,this.value)}}class gI extends Ve{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Du(this.value.arrayValue,t)}}class pR extends Ve{constructor(e,t){super(e,"not-in",t)}matches(e){if(Du(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Du(this.value.arrayValue,t)}}class mR extends Ve{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Ou(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>Du(this.value.arrayValue,r)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gR{constructor(e,t=null,r=[],s=[],a=null,l=null,d=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=s,this.limit=a,this.startAt=l,this.endAt=d,this.Pe=null}}function _m(n,e=null,t=[],r=[],s=null,a=null,l=null){return new gR(n,e,t,r,s,a,l)}function ao(n){const e=be(n);if(e.Pe===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>vm(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(a){return a.field.canonicalString()+a.dir})(r))).join(","),Rh(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>La(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>La(r))).join(",")),e.Pe=t}return e.Pe}function Wu(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!uR(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!hI(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!gw(n.startAt,e.startAt)&&gw(n.endAt,e.endAt)}function th(n){return le.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function nh(n,e){return n.filters.filter((t=>t instanceof Ve&&t.field.isEqual(e)))}function yw(n,e,t){let r=Od,s=!0;for(const a of nh(n,e)){let l=Od,d=!0;switch(a.op){case"<":case"<=":l=aR(a.value);break;case"==":case"in":case">=":l=a.value;break;case">":l=a.value,d=!1;break;case"!=":case"not-in":l=Od}fw({value:r,inclusive:s},{value:l,inclusive:d})<0&&(r=l,s=d)}if(t!==null){for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const l=t.position[a];fw({value:r,inclusive:s},{value:l,inclusive:t.inclusive})<0&&(r=l,s=t.inclusive);break}}return{value:r,inclusive:s}}function vw(n,e,t){let r=Ji,s=!0;for(const a of nh(n,e)){let l=Ji,d=!0;switch(a.op){case">=":case">":l=lR(a.value),d=!1;break;case"==":case"in":case"<=":l=a.value;break;case"<":l=a.value,d=!1;break;case"!=":case"not-in":l=Ji}pw({value:r,inclusive:s},{value:l,inclusive:d})>0&&(r=l,s=d)}if(t!==null){for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const l=t.position[a];pw({value:r,inclusive:s},{value:l,inclusive:t.inclusive})>0&&(r=l,s=t.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Za{constructor(e,t=null,r=[],s=[],a=null,l="F",d=null,f=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=s,this.limit=a,this.limitType=l,this.startAt=d,this.endAt=f,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function yR(n,e,t,r,s,a,l,d){return new Za(n,e,t,r,s,a,l,d)}function Gu(n){return new Za(n)}function _w(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function yI(n){return n.collectionGroup!==null}function _u(n){const e=be(n);if(e.Te===null){e.Te=[];const t=new Set;for(const a of e.explicitOrderBy)e.Te.push(a),t.add(a.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(l){let d=new Ge(ct.comparator);return l.filters.forEach((f=>{f.getFlattenedFilters().forEach((m=>{m.isInequality()&&(d=d.add(m.field))}))})),d})(e).forEach((a=>{t.has(a.canonicalString())||a.isKeyField()||e.Te.push(new Lu(a,r))})),t.has(ct.keyField().canonicalString())||e.Te.push(new Lu(ct.keyField(),r))}return e.Te}function Un(n){const e=be(n);return e.Ie||(e.Ie=vR(e,_u(n))),e.Ie}function vR(n,e){if(n.limitType==="F")return _m(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((s=>{const a=s.dir==="desc"?"asc":"desc";return new Lu(s.field,a)}));const t=n.endAt?new Ma(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Ma(n.startAt.position,n.startAt.inclusive):null;return _m(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function wm(n,e){const t=n.filters.concat([e]);return new Za(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function rh(n,e,t){return new Za(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Oh(n,e){return Wu(Un(n),Un(e))&&n.limitType===e.limitType}function vI(n){return`${ao(Un(n))}|lt:${n.limitType}`}function Ea(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((s=>pI(s))).join(", ")}]`),Rh(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((s=>(function(l){return`${l.field.canonicalString()} (${l.dir})`})(s))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((s=>La(s))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((s=>La(s))).join(",")),`Target(${r})`})(Un(n))}; limitType=${n.limitType})`}function Ku(n,e){return e.isFoundDocument()&&(function(r,s){const a=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(a):le.isDocumentKey(r.path)?r.path.isEqual(a):r.path.isImmediateParentOf(a)})(n,e)&&(function(r,s){for(const a of _u(r))if(!a.field.isKeyField()&&s.data.field(a.field)===null)return!1;return!0})(n,e)&&(function(r,s){for(const a of r.filters)if(!a.matches(s))return!1;return!0})(n,e)&&(function(r,s){return!(r.startAt&&!(function(l,d,f){const m=mw(l,d,f);return l.inclusive?m<=0:m<0})(r.startAt,_u(r),s)||r.endAt&&!(function(l,d,f){const m=mw(l,d,f);return l.inclusive?m>=0:m>0})(r.endAt,_u(r),s))})(n,e)}function _R(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function _I(n){return(e,t)=>{let r=!1;for(const s of _u(n)){const a=wR(s,e,t);if(a!==0)return a;r=r||s.field.isKeyField()}return 0}}function wR(n,e,t){const r=n.field.isKeyField()?le.comparator(e.key,t.key):(function(a,l,d){const f=l.data.field(a),m=d.data.field(a);return f!==null&&m!==null?as(f,m):me(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return me(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pi{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[s,a]of r)if(this.equalsFn(s,e))return a}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let a=0;a<s.length;a++)if(this.equalsFn(s[a][0],e))return void(s[a]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[t]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){fs(this.inner,((t,r)=>{for(const[s,a]of r)e(s,a)}))}isEmpty(){return eI(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ER=new at(le.comparator);function xn(){return ER}const wI=new at(le.comparator);function uu(...n){let e=wI;for(const t of n)e=e.insert(t.key,t);return e}function EI(n){let e=wI;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function Rr(){return wu()}function II(){return wu()}function wu(){return new pi((n=>n.toString()),((n,e)=>n.isEqual(e)))}const IR=new at(le.comparator),xR=new Ge(le.comparator);function Ce(...n){let e=xR;for(const t of n)e=e.add(t);return e}const TR=new Ge(Te);function SR(){return TR}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ug(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Au(e)?"-0":e}}function xI(n){return{integerValue:""+n}}function kR(n,e){return NA(e)?xI(e):ug(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lh{constructor(){this._=void 0}}function bR(n,e,t){return n instanceof Fa?(function(s,a){const l={fields:{[rI]:{stringValue:nI},[sI]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return a&&sg(a)&&(a=Dh(a)),a&&(l.fields[iI]=a),{mapValue:l}})(t,e):n instanceof Ua?SI(n,e):n instanceof Ba?kI(n,e):(function(s,a){const l=TI(s,a),d=ww(l)+ww(s.Ee);return gm(l)&&gm(s.Ee)?xI(d):ug(s.serializer,d)})(n,e)}function AR(n,e,t){return n instanceof Ua?SI(n,e):n instanceof Ba?kI(n,e):t}function TI(n,e){return n instanceof Mu?(function(r){return gm(r)||(function(a){return!!a&&"doubleValue"in a})(r)})(e)?e:{integerValue:0}:null}class Fa extends Lh{}class Ua extends Lh{constructor(e){super(),this.elements=e}}function SI(n,e){const t=bI(e);for(const r of n.elements)t.some((s=>Lr(s,r)))||t.push(r);return{arrayValue:{values:t}}}class Ba extends Lh{constructor(e){super(),this.elements=e}}function kI(n,e){let t=bI(e);for(const r of n.elements)t=t.filter((s=>!Lr(s,r)));return{arrayValue:{values:t}}}class Mu extends Lh{constructor(e,t){super(),this.serializer=e,this.Ee=t}}function ww(n){return it(n.integerValue||n.doubleValue)}function bI(n){return Ou(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AI{constructor(e,t){this.field=e,this.transform=t}}function RR(n,e){return n.field.isEqual(e.field)&&(function(r,s){return r instanceof Ua&&s instanceof Ua||r instanceof Ba&&s instanceof Ba?Ca(r.elements,s.elements,Lr):r instanceof Mu&&s instanceof Mu?Lr(r.Ee,s.Ee):r instanceof Fa&&s instanceof Fa})(n.transform,e.transform)}class CR{constructor(e,t){this.version=e,this.transformResults=t}}class Qt{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Qt}static exists(e){return new Qt(void 0,e)}static updateTime(e){return new Qt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function jd(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Mh{}function RI(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new jh(n.key,Qt.none()):new el(n.key,n.data,Qt.none());{const t=n.data,r=Kt.empty();let s=new Ge(ct.comparator);for(let a of e.fields)if(!s.has(a)){let l=t.field(a);l===null&&a.length>1&&(a=a.popLast(),l=t.field(a)),l===null?r.delete(a):r.set(a,l),s=s.add(a)}return new mi(n.key,r,new fn(s.toArray()),Qt.none())}}function PR(n,e,t){n instanceof el?(function(s,a,l){const d=s.value.clone(),f=Iw(s.fieldTransforms,a,l.transformResults);d.setAll(f),a.convertToFoundDocument(l.version,d).setHasCommittedMutations()})(n,e,t):n instanceof mi?(function(s,a,l){if(!jd(s.precondition,a))return void a.convertToUnknownDocument(l.version);const d=Iw(s.fieldTransforms,a,l.transformResults),f=a.data;f.setAll(CI(s)),f.setAll(d),a.convertToFoundDocument(l.version,f).setHasCommittedMutations()})(n,e,t):(function(s,a,l){a.convertToNoDocument(l.version).setHasCommittedMutations()})(0,e,t)}function Eu(n,e,t,r){return n instanceof el?(function(a,l,d,f){if(!jd(a.precondition,l))return d;const m=a.value.clone(),v=xw(a.fieldTransforms,f,l);return m.setAll(v),l.convertToFoundDocument(l.version,m).setHasLocalMutations(),null})(n,e,t,r):n instanceof mi?(function(a,l,d,f){if(!jd(a.precondition,l))return d;const m=xw(a.fieldTransforms,f,l),v=l.data;return v.setAll(CI(a)),v.setAll(m),l.convertToFoundDocument(l.version,v).setHasLocalMutations(),d===null?null:d.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map((_=>_.field)))})(n,e,t,r):(function(a,l,d){return jd(a.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):d})(n,e,t)}function NR(n,e){let t=null;for(const r of n.fieldTransforms){const s=e.data.field(r.field),a=TI(r.transform,s||null);a!=null&&(t===null&&(t=Kt.empty()),t.set(r.field,a))}return t||null}function Ew(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Ca(r,s,((a,l)=>RR(a,l)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class el extends Mh{constructor(e,t,r,s=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class mi extends Mh{constructor(e,t,r,s,a=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=s,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function CI(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function Iw(n,e,t){const r=new Map;ve(n.length===t.length,32656,{Ae:t.length,Re:n.length});for(let s=0;s<t.length;s++){const a=n[s],l=a.transform,d=e.data.field(a.field);r.set(a.field,AR(l,d,t[s]))}return r}function xw(n,e,t){const r=new Map;for(const s of n){const a=s.transform,l=t.data.field(s.field);r.set(s.field,bR(a,l,e))}return r}class jh extends Mh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class PI extends Mh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cg{constructor(e,t,r,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const a=this.mutations[s];a.key.isEqual(e.key)&&PR(a,e,r[s])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Eu(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Eu(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=II();return this.mutations.forEach((s=>{const a=e.get(s.key),l=a.overlayedDocument;let d=this.applyToLocalView(l,a.mutatedFields);d=t.has(s.key)?null:d;const f=RI(l,d);f!==null&&r.set(s.key,f),l.isValidDocument()||l.convertToNoDocument(we.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Ce())}isEqual(e){return this.batchId===e.batchId&&Ca(this.mutations,e.mutations,((t,r)=>Ew(t,r)))&&Ca(this.baseMutations,e.baseMutations,((t,r)=>Ew(t,r)))}}class dg{constructor(e,t,r,s){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=s}static from(e,t,r){ve(e.mutations.length===r.length,58842,{Ve:e.mutations.length,me:r.length});let s=(function(){return IR})();const a=e.mutations;for(let l=0;l<a.length;l++)s=s.insert(a[l].key,r[l].version);return new dg(e,t,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hg{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DR{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var vt,je;function VR(n){switch(n){case Q.OK:return me(64938);case Q.CANCELLED:case Q.UNKNOWN:case Q.DEADLINE_EXCEEDED:case Q.RESOURCE_EXHAUSTED:case Q.INTERNAL:case Q.UNAVAILABLE:case Q.UNAUTHENTICATED:return!1;case Q.INVALID_ARGUMENT:case Q.NOT_FOUND:case Q.ALREADY_EXISTS:case Q.PERMISSION_DENIED:case Q.FAILED_PRECONDITION:case Q.ABORTED:case Q.OUT_OF_RANGE:case Q.UNIMPLEMENTED:case Q.DATA_LOSS:return!0;default:return me(15467,{code:n})}}function NI(n){if(n===void 0)return tn("GRPC error has no .code"),Q.UNKNOWN;switch(n){case vt.OK:return Q.OK;case vt.CANCELLED:return Q.CANCELLED;case vt.UNKNOWN:return Q.UNKNOWN;case vt.DEADLINE_EXCEEDED:return Q.DEADLINE_EXCEEDED;case vt.RESOURCE_EXHAUSTED:return Q.RESOURCE_EXHAUSTED;case vt.INTERNAL:return Q.INTERNAL;case vt.UNAVAILABLE:return Q.UNAVAILABLE;case vt.UNAUTHENTICATED:return Q.UNAUTHENTICATED;case vt.INVALID_ARGUMENT:return Q.INVALID_ARGUMENT;case vt.NOT_FOUND:return Q.NOT_FOUND;case vt.ALREADY_EXISTS:return Q.ALREADY_EXISTS;case vt.PERMISSION_DENIED:return Q.PERMISSION_DENIED;case vt.FAILED_PRECONDITION:return Q.FAILED_PRECONDITION;case vt.ABORTED:return Q.ABORTED;case vt.OUT_OF_RANGE:return Q.OUT_OF_RANGE;case vt.UNIMPLEMENTED:return Q.UNIMPLEMENTED;case vt.DATA_LOSS:return Q.DATA_LOSS;default:return me(39323,{code:n})}}(je=vt||(vt={}))[je.OK=0]="OK",je[je.CANCELLED=1]="CANCELLED",je[je.UNKNOWN=2]="UNKNOWN",je[je.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",je[je.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",je[je.NOT_FOUND=5]="NOT_FOUND",je[je.ALREADY_EXISTS=6]="ALREADY_EXISTS",je[je.PERMISSION_DENIED=7]="PERMISSION_DENIED",je[je.UNAUTHENTICATED=16]="UNAUTHENTICATED",je[je.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",je[je.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",je[je.ABORTED=10]="ABORTED",je[je.OUT_OF_RANGE=11]="OUT_OF_RANGE",je[je.UNIMPLEMENTED=12]="UNIMPLEMENTED",je[je.INTERNAL=13]="INTERNAL",je[je.UNAVAILABLE=14]="UNAVAILABLE",je[je.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OR=new ts([4294967295,4294967295],0);function Tw(n){const e=LE().encode(n),t=new AE;return t.update(e),new Uint8Array(t.digest())}function Sw(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new ts([t,r],0),new ts([s,a],0)]}class fg{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new cu(`Invalid padding: ${t}`);if(r<0)throw new cu(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new cu(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new cu(`Invalid padding when bitmap length is 0: ${t}`);this.fe=8*e.length-t,this.ge=ts.fromNumber(this.fe)}pe(e,t,r){let s=e.add(t.multiply(ts.fromNumber(r)));return s.compare(OR)===1&&(s=new ts([s.getBits(0),s.getBits(1)],0)),s.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;const t=Tw(e),[r,s]=Sw(t);for(let a=0;a<this.hashCount;a++){const l=this.pe(r,s,a);if(!this.ye(l))return!1}return!0}static create(e,t,r){const s=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),l=new fg(a,s,t);return r.forEach((d=>l.insert(d))),l}insert(e){if(this.fe===0)return;const t=Tw(e),[r,s]=Sw(t);for(let a=0;a<this.hashCount;a++){const l=this.pe(r,s,a);this.we(l)}}we(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class cu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fh{constructor(e,t,r,s,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const s=new Map;return s.set(e,Qu.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Fh(we.min(),s,new at(Te),xn(),Ce())}}class Qu{constructor(e,t,r,s,a){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Qu(r,t,Ce(),Ce(),Ce())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fd{constructor(e,t,r,s){this.Se=e,this.removedTargetIds=t,this.key=r,this.be=s}}class DI{constructor(e,t){this.targetId=e,this.De=t}}class VI{constructor(e,t,r=It.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=s}}class kw{constructor(){this.ve=0,this.Ce=bw(),this.Fe=It.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=Ce(),t=Ce(),r=Ce();return this.Ce.forEach(((s,a)=>{switch(a){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:r=r.add(s);break;default:me(38017,{changeType:a})}})),new Qu(this.Fe,this.Me,e,t,r)}ke(){this.xe=!1,this.Ce=bw()}qe(e,t){this.xe=!0,this.Ce=this.Ce.insert(e,t)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,ve(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class LR{constructor(e){this.We=e,this.Ge=new Map,this.ze=xn(),this.je=xd(),this.Je=xd(),this.He=new at(Te)}Ye(e){for(const t of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(t,e.be):this.Xe(t,e.key,e.be);for(const t of e.removedTargetIds)this.Xe(t,e.key,e.be)}et(e){this.forEachTarget(e,(t=>{const r=this.tt(t);switch(e.state){case 0:this.nt(t)&&r.Be(e.resumeToken);break;case 1:r.Ue(),r.Oe||r.ke(),r.Be(e.resumeToken);break;case 2:r.Ue(),r.Oe||this.removeTarget(t);break;case 3:this.nt(t)&&(r.Ke(),r.Be(e.resumeToken));break;case 4:this.nt(t)&&(this.rt(t),r.Be(e.resumeToken));break;default:me(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ge.forEach(((r,s)=>{this.nt(s)&&t(s)}))}it(e){const t=e.targetId,r=e.De.count,s=this.st(t);if(s){const a=s.target;if(th(a))if(r===0){const l=new le(a.path);this.Xe(t,l,ht.newNoDocument(l,we.min()))}else ve(r===1,20013,{expectedCount:r});else{const l=this.ot(t);if(l!==r){const d=this._t(e),f=d?this.ut(d,e,l):1;if(f!==0){this.rt(t);const m=f===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(t,m)}}}}}_t(e){const t=e.De.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:a=0}=t;let l,d;try{l=hi(r).toUint8Array()}catch(f){if(f instanceof tI)return Or("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw f}try{d=new fg(l,s,a)}catch(f){return Or(f instanceof cu?"BloomFilter error: ":"Applying bloom filter failed: ",f),null}return d.fe===0?null:d}ut(e,t,r){return t.De.count===r-this.ht(e,t.targetId)?0:2}ht(e,t){const r=this.We.getRemoteKeysForTarget(t);let s=0;return r.forEach((a=>{const l=this.We.lt(),d=`projects/${l.projectId}/databases/${l.database}/documents/${a.path.canonicalString()}`;e.mightContain(d)||(this.Xe(t,a,null),s++)})),s}Pt(e){const t=new Map;this.Ge.forEach(((a,l)=>{const d=this.st(l);if(d){if(a.current&&th(d.target)){const f=new le(d.target.path);this.Tt(f).has(l)||this.It(l,f)||this.Xe(l,f,ht.newNoDocument(f,e))}a.Ne&&(t.set(l,a.Le()),a.ke())}}));let r=Ce();this.Je.forEach(((a,l)=>{let d=!0;l.forEachWhile((f=>{const m=this.st(f);return!m||m.purpose==="TargetPurposeLimboResolution"||(d=!1,!1)})),d&&(r=r.add(a))})),this.ze.forEach(((a,l)=>l.setReadTime(e)));const s=new Fh(e,t,this.He,this.ze,r);return this.ze=xn(),this.je=xd(),this.Je=xd(),this.He=new at(Te),s}Ze(e,t){if(!this.nt(e))return;const r=this.It(e,t.key)?2:0;this.tt(e).qe(t.key,r),this.ze=this.ze.insert(t.key,t),this.je=this.je.insert(t.key,this.Tt(t.key).add(e)),this.Je=this.Je.insert(t.key,this.dt(t.key).add(e))}Xe(e,t,r){if(!this.nt(e))return;const s=this.tt(e);this.It(e,t)?s.qe(t,1):s.Qe(t),this.Je=this.Je.insert(t,this.dt(t).delete(e)),this.Je=this.Je.insert(t,this.dt(t).add(e)),r&&(this.ze=this.ze.insert(t,r))}removeTarget(e){this.Ge.delete(e)}ot(e){const t=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let t=this.Ge.get(e);return t||(t=new kw,this.Ge.set(e,t)),t}dt(e){let t=this.Je.get(e);return t||(t=new Ge(Te),this.Je=this.Je.insert(e,t)),t}Tt(e){let t=this.je.get(e);return t||(t=new Ge(Te),this.je=this.je.insert(e,t)),t}nt(e){const t=this.st(e)!==null;return t||te("WatchChangeAggregator","Detected inactive target",e),t}st(e){const t=this.Ge.get(e);return t&&t.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new kw),this.We.getRemoteKeysForTarget(e).forEach((t=>{this.Xe(e,t,null)}))}It(e,t){return this.We.getRemoteKeysForTarget(e).has(t)}}function xd(){return new at(le.comparator)}function bw(){return new at(le.comparator)}const MR={asc:"ASCENDING",desc:"DESCENDING"},jR={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},FR={and:"AND",or:"OR"};class UR{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Em(n,e){return n.useProto3Json||Rh(e)?e:{value:e}}function za(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function OI(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function BR(n,e){return za(n,e.toTimestamp())}function rn(n){return ve(!!n,49232),we.fromTimestamp((function(t){const r=di(t);return new He(r.seconds,r.nanos)})(n))}function pg(n,e){return Im(n,e).canonicalString()}function Im(n,e){const t=(function(s){return new $e(["projects",s.projectId,"databases",s.database])})(n).child("documents");return e===void 0?t:t.child(e)}function LI(n){const e=$e.fromString(n);return ve(HI(e),10190,{key:e.toString()}),e}function ih(n,e){return pg(n.databaseId,e.path)}function to(n,e){const t=LI(e);if(t.get(1)!==n.databaseId.projectId)throw new se(Q.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new se(Q.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new le(FI(t))}function MI(n,e){return pg(n.databaseId,e)}function jI(n){const e=LI(n);return e.length===4?$e.emptyPath():FI(e)}function xm(n){return new $e(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function FI(n){return ve(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Aw(n,e,t){return{name:ih(n,e),fields:t.value.mapValue.fields}}function zR(n,e,t){const r=to(n,e.name),s=rn(e.updateTime),a=e.createTime?rn(e.createTime):we.min(),l=new Kt({mapValue:{fields:e.fields}}),d=ht.newFoundDocument(r,s,a,l);return t&&d.setHasCommittedMutations(),t?d.setHasCommittedMutations():d}function $R(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:me(39313,{state:m})})(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],a=(function(m,v){return m.useProto3Json?(ve(v===void 0||typeof v=="string",58123),It.fromBase64String(v||"")):(ve(v===void 0||v instanceof Buffer||v instanceof Uint8Array,16193),It.fromUint8Array(v||new Uint8Array))})(n,e.targetChange.resumeToken),l=e.targetChange.cause,d=l&&(function(m){const v=m.code===void 0?Q.UNKNOWN:NI(m.code);return new se(v,m.message||"")})(l);t=new VI(r,s,a,d||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=to(n,r.document.name),a=rn(r.document.updateTime),l=r.document.createTime?rn(r.document.createTime):we.min(),d=new Kt({mapValue:{fields:r.document.fields}}),f=ht.newFoundDocument(s,a,l,d),m=r.targetIds||[],v=r.removedTargetIds||[];t=new Fd(m,v,f.key,f)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=to(n,r.document),a=r.readTime?rn(r.readTime):we.min(),l=ht.newNoDocument(s,a),d=r.removedTargetIds||[];t=new Fd([],d,l.key,l)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=to(n,r.document),a=r.removedTargetIds||[];t=new Fd([],a,s,null)}else{if(!("filter"in e))return me(11601,{At:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:a}=r,l=new DR(s,a),d=r.targetId;t=new DI(d,l)}}return t}function sh(n,e){let t;if(e instanceof el)t={update:Aw(n,e.key,e.value)};else if(e instanceof jh)t={delete:ih(n,e.key)};else if(e instanceof mi)t={update:Aw(n,e.key,e.data),updateMask:QR(e.fieldMask)};else{if(!(e instanceof PI))return me(16599,{Rt:e.type});t={verify:ih(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(a,l){const d=l.transform;if(d instanceof Fa)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(d instanceof Ua)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:d.elements}};if(d instanceof Ba)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:d.elements}};if(d instanceof Mu)return{fieldPath:l.field.canonicalString(),increment:d.Ee};throw me(20930,{transform:l.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(s,a){return a.updateTime!==void 0?{updateTime:BR(s,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:me(27497)})(n,e.precondition)),t}function Tm(n,e){const t=e.currentDocument?(function(a){return a.updateTime!==void 0?Qt.updateTime(rn(a.updateTime)):a.exists!==void 0?Qt.exists(a.exists):Qt.none()})(e.currentDocument):Qt.none(),r=e.updateTransforms?e.updateTransforms.map((s=>(function(l,d){let f=null;if("setToServerValue"in d)ve(d.setToServerValue==="REQUEST_TIME",16630,{proto:d}),f=new Fa;else if("appendMissingElements"in d){const v=d.appendMissingElements.values||[];f=new Ua(v)}else if("removeAllFromArray"in d){const v=d.removeAllFromArray.values||[];f=new Ba(v)}else"increment"in d?f=new Mu(l,d.increment):me(16584,{proto:d});const m=ct.fromServerFormat(d.fieldPath);return new AI(m,f)})(n,s))):[];if(e.update){e.update.name;const s=to(n,e.update.name),a=new Kt({mapValue:{fields:e.update.fields}});if(e.updateMask){const l=(function(f){const m=f.fieldPaths||[];return new fn(m.map((v=>ct.fromServerFormat(v))))})(e.updateMask);return new mi(s,a,l,t,r)}return new el(s,a,t,r)}if(e.delete){const s=to(n,e.delete);return new jh(s,t)}if(e.verify){const s=to(n,e.verify);return new PI(s,t)}return me(1463,{proto:e})}function qR(n,e){return n&&n.length>0?(ve(e!==void 0,14353),n.map((t=>(function(s,a){let l=s.updateTime?rn(s.updateTime):rn(a);return l.isEqual(we.min())&&(l=rn(a)),new CR(l,s.transformResults||[])})(t,e)))):[]}function UI(n,e){return{documents:[MI(n,e.path)]}}function BI(n,e){const t={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=MI(n,s);const a=(function(m){if(m.length!==0)return qI(We.create(m,"and"))})(e.filters);a&&(t.structuredQuery.where=a);const l=(function(m){if(m.length!==0)return m.map((v=>(function(x){return{field:Ia(x.field),direction:WR(x.dir)}})(v)))})(e.orderBy);l&&(t.structuredQuery.orderBy=l);const d=Em(n,e.limit);return d!==null&&(t.structuredQuery.limit=d),e.startAt&&(t.structuredQuery.startAt=(function(m){return{before:m.inclusive,values:m.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(m){return{before:!m.inclusive,values:m.position}})(e.endAt)),{Vt:t,parent:s}}function zI(n){let e=jI(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let s=null;if(r>0){ve(r===1,65062);const v=t.from[0];v.allDescendants?s=v.collectionId:e=e.child(v.collectionId)}let a=[];t.where&&(a=(function(_){const x=$I(_);return x instanceof We&&lg(x)?x.getFilters():[x]})(t.where));let l=[];t.orderBy&&(l=(function(_){return _.map((x=>(function(D){return new Lu(xa(D.field),(function(L){switch(L){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(D.direction))})(x)))})(t.orderBy));let d=null;t.limit&&(d=(function(_){let x;return x=typeof _=="object"?_.value:_,Rh(x)?null:x})(t.limit));let f=null;t.startAt&&(f=(function(_){const x=!!_.before,S=_.values||[];return new Ma(S,x)})(t.startAt));let m=null;return t.endAt&&(m=(function(_){const x=!_.before,S=_.values||[];return new Ma(S,x)})(t.endAt)),yR(e,s,l,a,d,"F",f,m)}function HR(n,e){const t=(function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return me(28987,{purpose:s})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function $I(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=xa(t.unaryFilter.field);return Ve.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=xa(t.unaryFilter.field);return Ve.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=xa(t.unaryFilter.field);return Ve.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=xa(t.unaryFilter.field);return Ve.create(l,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return me(61313);default:return me(60726)}})(n):n.fieldFilter!==void 0?(function(t){return Ve.create(xa(t.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return me(58110);default:return me(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return We.create(t.compositeFilter.filters.map((r=>$I(r))),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return me(1026)}})(t.compositeFilter.op))})(n):me(30097,{filter:n})}function WR(n){return MR[n]}function GR(n){return jR[n]}function KR(n){return FR[n]}function Ia(n){return{fieldPath:n.canonicalString()}}function xa(n){return ct.fromServerFormat(n.fieldPath)}function qI(n){return n instanceof Ve?(function(t){if(t.op==="=="){if(hw(t.value))return{unaryFilter:{field:Ia(t.field),op:"IS_NAN"}};if(dw(t.value))return{unaryFilter:{field:Ia(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(hw(t.value))return{unaryFilter:{field:Ia(t.field),op:"IS_NOT_NAN"}};if(dw(t.value))return{unaryFilter:{field:Ia(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ia(t.field),op:GR(t.op),value:t.value}}})(n):n instanceof We?(function(t){const r=t.getFilters().map((s=>qI(s)));return r.length===1?r[0]:{compositeFilter:{op:KR(t.op),filters:r}}})(n):me(54877,{filter:n})}function QR(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function HI(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class si{constructor(e,t,r,s,a=we.min(),l=we.min(),d=It.EMPTY_BYTE_STRING,f=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=d,this.expectedCount=f}withSequenceNumber(e){return new si(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new si(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new si(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new si(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WI{constructor(e){this.gt=e}}function XR(n,e){let t;if(e.document)t=zR(n.gt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=le.fromSegments(e.noDocument.path),s=uo(e.noDocument.readTime);t=ht.newNoDocument(r,s),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return me(56709);{const r=le.fromSegments(e.unknownDocument.path),s=uo(e.unknownDocument.version);t=ht.newUnknownDocument(r,s)}}return e.readTime&&t.setReadTime((function(s){const a=new He(s[0],s[1]);return we.fromTimestamp(a)})(e.readTime)),t}function Rw(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:oh(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=(function(a,l){return{name:ih(a,l.key),fields:l.data.value.mapValue.fields,updateTime:za(a,l.version.toTimestamp()),createTime:za(a,l.createTime.toTimestamp())}})(n.gt,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:lo(e.version)};else{if(!e.isUnknownDocument())return me(57904,{document:e});r.unknownDocument={path:t.path.toArray(),version:lo(e.version)}}return r}function oh(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function lo(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function uo(n){const e=new He(n.seconds,n.nanoseconds);return we.fromTimestamp(e)}function Gs(n,e){const t=(e.baseMutations||[]).map((a=>Tm(n.gt,a)));for(let a=0;a<e.mutations.length-1;++a){const l=e.mutations[a];if(a+1<e.mutations.length&&e.mutations[a+1].transform!==void 0){const d=e.mutations[a+1];l.updateTransforms=d.transform.fieldTransforms,e.mutations.splice(a+1,1),++a}}const r=e.mutations.map((a=>Tm(n.gt,a))),s=He.fromMillis(e.localWriteTimeMs);return new cg(e.batchId,s,t,r)}function du(n){const e=uo(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?uo(n.lastLimboFreeSnapshotVersion):we.min();let r;return r=(function(a){return a.documents!==void 0})(n.query)?(function(a){const l=a.documents.length;return ve(l===1,1966,{count:l}),Un(Gu(jI(a.documents[0])))})(n.query):(function(a){return Un(zI(a))})(n.query),new si(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,It.fromBase64String(n.resumeToken))}function GI(n,e){const t=lo(e.snapshotVersion),r=lo(e.lastLimboFreeSnapshotVersion);let s;s=th(e.target)?UI(n.gt,e.target):BI(n.gt,e.target).Vt;const a=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:ao(e.target),readTime:t,resumeToken:a,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function KI(n){const e=zI({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?rh(e,e.limit,"L"):e}function qp(n,e){return new hg(e.largestBatchId,Tm(n.gt,e.overlayMutation))}function Cw(n,e){const t=e.path.lastSegment();return[n,Xt(e.path.popLast()),t]}function Pw(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:lo(r.readTime),documentKey:Xt(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YR{getBundleMetadata(e,t){return Nw(e).get(t).next((r=>{if(r)return(function(a){return{id:a.bundleId,createTime:uo(a.createTime),version:a.version}})(r)}))}saveBundleMetadata(e,t){return Nw(e).put((function(s){return{bundleId:s.id,createTime:lo(rn(s.createTime)),version:s.version}})(t))}getNamedQuery(e,t){return Dw(e).get(t).next((r=>{if(r)return(function(a){return{name:a.name,query:KI(a.bundledQuery),readTime:uo(a.readTime)}})(r)}))}saveNamedQuery(e,t){return Dw(e).put((function(s){return{name:s.name,readTime:lo(rn(s.readTime)),bundledQuery:s.bundledQuery}})(t))}}function Nw(n){return Rt(n,Ch)}function Dw(n){return Rt(n,Ph)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uh{constructor(e,t){this.serializer=e,this.userId=t}static yt(e,t){const r=t.uid||"";return new Uh(e,r)}getOverlay(e,t){return ru(e).get(Cw(this.userId,t)).next((r=>r?qp(this.serializer,r):null))}getOverlays(e,t){const r=Rr();return z.forEach(t,(s=>this.getOverlay(e,s).next((a=>{a!==null&&r.set(s,a)})))).next((()=>r))}saveOverlays(e,t,r){const s=[];return r.forEach(((a,l)=>{const d=new hg(t,l);s.push(this.wt(e,d))})),z.waitFor(s)}removeOverlaysForBatchId(e,t,r){const s=new Set;t.forEach((l=>s.add(Xt(l.getCollectionPath()))));const a=[];return s.forEach((l=>{const d=IDBKeyRange.bound([this.userId,l,r],[this.userId,l,r+1],!1,!0);a.push(ru(e).Y(fm,d))})),z.waitFor(a)}getOverlaysForCollection(e,t,r){const s=Rr(),a=Xt(t),l=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,Number.POSITIVE_INFINITY],!0);return ru(e).j(fm,l).next((d=>{for(const f of d){const m=qp(this.serializer,f);s.set(m.getKey(),m)}return s}))}getOverlaysForCollectionGroup(e,t,r,s){const a=Rr();let l;const d=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return ru(e).X({index:QE,range:d},((f,m,v)=>{const _=qp(this.serializer,m);a.size()<s||_.largestBatchId===l?(a.set(_.getKey(),_),l=_.largestBatchId):v.done()})).next((()=>a))}wt(e,t){return ru(e).put((function(s,a,l){const[d,f,m]=Cw(a,l.mutation.key);return{userId:a,collectionPath:f,documentId:m,collectionGroup:l.mutation.key.getCollectionGroup(),largestBatchId:l.largestBatchId,overlayMutation:sh(s.gt,l.mutation)}})(this.serializer,this.userId,t))}}function ru(n){return Rt(n,Nh)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JR{St(e){return Rt(e,rg)}getSessionToken(e){return this.St(e).get("sessionToken").next((t=>{const r=t==null?void 0:t.value;return r?It.fromUint8Array(r):It.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.St(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ks{constructor(){}bt(e,t){this.Dt(e,t),t.vt()}Dt(e,t){if("nullValue"in e)this.Ct(t,5);else if("booleanValue"in e)this.Ct(t,10),t.Ft(e.booleanValue?1:0);else if("integerValue"in e)this.Ct(t,15),t.Ft(it(e.integerValue));else if("doubleValue"in e){const r=it(e.doubleValue);isNaN(r)?this.Ct(t,13):(this.Ct(t,15),Au(r)?t.Ft(0):t.Ft(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ct(t,20),typeof r=="string"&&(r=di(r)),t.Mt(`${r.seconds||""}`),t.Ft(r.nanos||0)}else if("stringValue"in e)this.xt(e.stringValue,t),this.Ot(t);else if("bytesValue"in e)this.Ct(t,30),t.Nt(hi(e.bytesValue)),this.Ot(t);else if("referenceValue"in e)this.Bt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ct(t,45),t.Ft(r.latitude||0),t.Ft(r.longitude||0)}else"mapValue"in e?aI(e)?this.Ct(t,Number.MAX_SAFE_INTEGER):Vh(e)?this.Lt(e.mapValue,t):(this.kt(e.mapValue,t),this.Ot(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Ot(t)):me(19022,{Qt:e})}xt(e,t){this.Ct(t,25),this.$t(e,t)}$t(e,t){t.Mt(e)}kt(e,t){const r=e.fields||{};this.Ct(t,55);for(const s of Object.keys(r))this.xt(s,t),this.Dt(r[s],t)}Lt(e,t){var r,s;const a=e.fields||{};this.Ct(t,53);const l=Oa,d=((s=(r=a[l].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.length)||0;this.Ct(t,15),t.Ft(it(d)),this.xt(l,t),this.Dt(a[l],t)}qt(e,t){const r=e.values||[];this.Ct(t,50);for(const s of r)this.Dt(s,t)}Bt(e,t){this.Ct(t,37),le.fromName(e).path.forEach((r=>{this.Ct(t,60),this.$t(r,t)}))}Ct(e,t){e.Ft(t)}Ot(e){e.Ft(2)}}Ks.Ut=new Ks;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ga=255;function ZR(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function Vw(n){const e=64-(function(r){let s=0;for(let a=0;a<8;++a){const l=ZR(255&r[a]);if(s+=l,l!==8)break}return s})(n);return Math.ceil(e/8)}class eC{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Kt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Wt(r.value),r=t.next();this.Gt()}zt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.jt(r.value),r=t.next();this.Jt()}Ht(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Wt(r);else if(r<2048)this.Wt(960|r>>>6),this.Wt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Wt(480|r>>>12),this.Wt(128|63&r>>>6),this.Wt(128|63&r);else{const s=t.codePointAt(0);this.Wt(240|s>>>18),this.Wt(128|63&s>>>12),this.Wt(128|63&s>>>6),this.Wt(128|63&s)}}this.Gt()}Yt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.jt(r);else if(r<2048)this.jt(960|r>>>6),this.jt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.jt(480|r>>>12),this.jt(128|63&r>>>6),this.jt(128|63&r);else{const s=t.codePointAt(0);this.jt(240|s>>>18),this.jt(128|63&s>>>12),this.jt(128|63&s>>>6),this.jt(128|63&s)}}this.Jt()}Zt(e){const t=this.Xt(e),r=Vw(t);this.en(1+r),this.buffer[this.position++]=255&r;for(let s=t.length-r;s<t.length;++s)this.buffer[this.position++]=255&t[s]}tn(e){const t=this.Xt(e),r=Vw(t);this.en(1+r),this.buffer[this.position++]=~(255&r);for(let s=t.length-r;s<t.length;++s)this.buffer[this.position++]=~(255&t[s])}nn(){this.rn(ga),this.rn(255)}sn(){this._n(ga),this._n(255)}reset(){this.position=0}seed(e){this.en(e.length),this.buffer.set(e,this.position),this.position+=e.length}an(){return this.buffer.slice(0,this.position)}Xt(e){const t=(function(a){const l=new DataView(new ArrayBuffer(8));return l.setFloat64(0,a,!1),new Uint8Array(l.buffer)})(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let s=1;s<t.length;++s)t[s]^=r?255:0;return t}Wt(e){const t=255&e;t===0?(this.rn(0),this.rn(255)):t===ga?(this.rn(ga),this.rn(0)):this.rn(t)}jt(e){const t=255&e;t===0?(this._n(0),this._n(255)):t===ga?(this._n(ga),this._n(0)):this._n(e)}Gt(){this.rn(0),this.rn(1)}Jt(){this._n(0),this._n(1)}rn(e){this.en(1),this.buffer[this.position++]=e}_n(e){this.en(1),this.buffer[this.position++]=~e}en(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class tC{constructor(e){this.un=e}Nt(e){this.un.Kt(e)}Mt(e){this.un.Ht(e)}Ft(e){this.un.Zt(e)}vt(){this.un.nn()}}class nC{constructor(e){this.un=e}Nt(e){this.un.zt(e)}Mt(e){this.un.Yt(e)}Ft(e){this.un.tn(e)}vt(){this.un.sn()}}class iu{constructor(){this.un=new eC,this.cn=new tC(this.un),this.ln=new nC(this.un)}seed(e){this.un.seed(e)}hn(e){return e===0?this.cn:this.ln}an(){return this.un.an()}reset(){this.un.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qs{constructor(e,t,r,s){this.Pn=e,this.Tn=t,this.In=r,this.dn=s}En(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.dn,0),t!==e?r.set([0],this.dn.length):++r[r.length-1],new Qs(this.Pn,this.Tn,this.In,r)}An(e,t,r){return{indexId:this.Pn,uid:e,arrayValue:Ud(this.In),directionalValue:Ud(this.dn),orderedDocumentKey:Ud(t),documentKey:r.path.toArray()}}Rn(e,t,r){const s=this.An(e,t,r);return[s.indexId,s.uid,s.arrayValue,s.directionalValue,s.orderedDocumentKey,s.documentKey]}}function $i(n,e){let t=n.Pn-e.Pn;return t!==0?t:(t=Ow(n.In,e.In),t!==0?t:(t=Ow(n.dn,e.dn),t!==0?t:le.comparator(n.Tn,e.Tn)))}function Ow(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}function Ud(n){return wE()?(function(t){let r="";for(let s=0;s<t.length;s++)r+=String.fromCharCode(t[s]);return r})(n):n}function Lw(n){return typeof n!="string"?n:(function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r})(n)}class Mw{constructor(e){this.Vn=new Ge(((t,r)=>ct.comparator(t.field,r.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.mn=e.orderBy,this.fn=[];for(const t of e.filters){const r=t;r.isInequality()?this.Vn=this.Vn.add(r):this.fn.push(r)}}get gn(){return this.Vn.size>1}pn(e){if(ve(e.collectionGroup===this.collectionId,49279),this.gn)return!1;const t=cm(e);if(t!==void 0&&!this.yn(t))return!1;const r=qs(e);let s=new Set,a=0,l=0;for(;a<r.length&&this.yn(r[a]);++a)s=s.add(r[a].fieldPath.canonicalString());if(a===r.length)return!0;if(this.Vn.size>0){const d=this.Vn.getIterator().getNext();if(!s.has(d.field.canonicalString())){const f=r[a];if(!this.wn(d,f)||!this.Sn(this.mn[l++],f))return!1}++a}for(;a<r.length;++a){const d=r[a];if(l>=this.mn.length||!this.Sn(this.mn[l++],d))return!1}return!0}bn(){if(this.gn)return null;let e=new Ge(ct.comparator);const t=[];for(const r of this.fn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new Nd(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new Nd(r.field,0))}for(const r of this.mn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new Nd(r.field,r.dir==="asc"?0:1)));return new Xd(Xd.UNKNOWN_ID,this.collectionId,t,bu.empty())}yn(e){for(const t of this.fn)if(this.wn(t,e))return!0;return!1}wn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}Sn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QI(n){var e,t;if(ve(n instanceof Ve||n instanceof We,20012),n instanceof Ve){if(n instanceof gI){const s=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map((a=>Ve.create(n.field,"==",a))))||[];return We.create(s,"or")}return n}const r=n.filters.map((s=>QI(s)));return We.create(r,n.op)}function rC(n){if(n.getFilters().length===0)return[];const e=bm(QI(n));return ve(XI(e),7391),Sm(e)||km(e)?[e]:e.getFilters()}function Sm(n){return n instanceof Ve}function km(n){return n instanceof We&&lg(n)}function XI(n){return Sm(n)||km(n)||(function(t){if(t instanceof We&&ym(t)){for(const r of t.getFilters())if(!Sm(r)&&!km(r))return!1;return!0}return!1})(n)}function bm(n){if(ve(n instanceof Ve||n instanceof We,34018),n instanceof Ve)return n;if(n.filters.length===1)return bm(n.filters[0]);const e=n.filters.map((r=>bm(r)));let t=We.create(e,n.op);return t=ah(t),XI(t)?t:(ve(t instanceof We,64498),ve(ja(t),40251),ve(t.filters.length>1,57927),t.filters.reduce(((r,s)=>mg(r,s))))}function mg(n,e){let t;return ve(n instanceof Ve||n instanceof We,38388),ve(e instanceof Ve||e instanceof We,25473),t=n instanceof Ve?e instanceof Ve?(function(s,a){return We.create([s,a],"and")})(n,e):jw(n,e):e instanceof Ve?jw(e,n):(function(s,a){if(ve(s.filters.length>0&&a.filters.length>0,48005),ja(s)&&ja(a))return fI(s,a.getFilters());const l=ym(s)?s:a,d=ym(s)?a:s,f=l.filters.map((m=>mg(m,d)));return We.create(f,"or")})(n,e),ah(t)}function jw(n,e){if(ja(e))return fI(e,n.getFilters());{const t=e.filters.map((r=>mg(n,r)));return We.create(t,"or")}}function ah(n){if(ve(n instanceof Ve||n instanceof We,11850),n instanceof Ve)return n;const e=n.getFilters();if(e.length===1)return ah(e[0]);if(dI(n))return n;const t=e.map((s=>ah(s))),r=[];return t.forEach((s=>{s instanceof Ve?r.push(s):s instanceof We&&(s.op===n.op?r.push(...s.filters):r.push(s))})),r.length===1?r[0]:We.create(r,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iC{constructor(){this.Dn=new gg}addToCollectionParentIndex(e,t){return this.Dn.add(t),z.resolve()}getCollectionParents(e,t){return z.resolve(this.Dn.getEntries(t))}addFieldIndex(e,t){return z.resolve()}deleteFieldIndex(e,t){return z.resolve()}deleteAllFieldIndexes(e){return z.resolve()}createTargetIndexes(e,t){return z.resolve()}getDocumentsMatchingTarget(e,t){return z.resolve(null)}getIndexType(e,t){return z.resolve(0)}getFieldIndexes(e,t){return z.resolve([])}getNextCollectionGroupToUpdate(e){return z.resolve(null)}getMinOffset(e,t){return z.resolve(Sn.min())}getMinOffsetFromCollectionGroup(e,t){return z.resolve(Sn.min())}updateCollectionGroup(e,t,r){return z.resolve()}updateIndexEntries(e,t){return z.resolve()}}class gg{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t]||new Ge($e.comparator),a=!s.has(r);return this.index[t]=s.add(r),a}has(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Ge($e.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fw="IndexedDbIndexManager",Td=new Uint8Array(0);class sC{constructor(e,t){this.databaseId=t,this.vn=new gg,this.Cn=new pi((r=>ao(r)),((r,s)=>Wu(r,s))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const r=t.lastSegment(),s=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const a={collectionId:r,parent:Xt(s)};return Uw(e).put(a)}return z.resolve()}getCollectionParents(e,t){const r=[],s=IDBKeyRange.bound([t,""],[ME(t),""],!1,!0);return Uw(e).j(s).next((a=>{for(const l of a){if(l.collectionId!==t)break;r.push(Ar(l.parent))}return r}))}addFieldIndex(e,t){const r=su(e),s=(function(d){return{indexId:d.indexId,collectionGroup:d.collectionGroup,fields:d.fields.map((f=>[f.fieldPath.canonicalString(),f.kind]))}})(t);delete s.indexId;const a=r.add(s);if(t.indexState){const l=va(e);return a.next((d=>{l.put(Pw(d,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return a.next()}deleteFieldIndex(e,t){const r=su(e),s=va(e),a=ya(e);return r.delete(t.indexId).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=su(e),r=ya(e),s=va(e);return t.Y().next((()=>r.Y())).next((()=>s.Y()))}createTargetIndexes(e,t){return z.forEach(this.Fn(t),(r=>this.getIndexType(e,r).next((s=>{if(s===0||s===1){const a=new Mw(r).bn();if(a!=null)return this.addFieldIndex(e,a)}}))))}getDocumentsMatchingTarget(e,t){const r=ya(e);let s=!0;const a=new Map;return z.forEach(this.Fn(t),(l=>this.Mn(e,l).next((d=>{s&&(s=!!d),a.set(l,d)})))).next((()=>{if(s){let l=Ce();const d=[];return z.forEach(a,((f,m)=>{te(Fw,`Using index ${(function(q){return`id=${q.indexId}|cg=${q.collectionGroup}|f=${q.fields.map((ne=>`${ne.fieldPath}:${ne.kind}`)).join(",")}`})(f)} to execute ${ao(t)}`);const v=(function(q,ne){const ue=cm(ne);if(ue===void 0)return null;for(const ce of nh(q,ue.fieldPath))switch(ce.op){case"array-contains-any":return ce.value.arrayValue.values||[];case"array-contains":return[ce.value]}return null})(m,f),_=(function(q,ne){const ue=new Map;for(const ce of qs(ne))for(const C of nh(q,ce.fieldPath))switch(C.op){case"==":case"in":ue.set(ce.fieldPath.canonicalString(),C.value);break;case"not-in":case"!=":return ue.set(ce.fieldPath.canonicalString(),C.value),Array.from(ue.values())}return null})(m,f),x=(function(q,ne){const ue=[];let ce=!0;for(const C of qs(ne)){const k=C.kind===0?yw(q,C.fieldPath,q.startAt):vw(q,C.fieldPath,q.startAt);ue.push(k.value),ce&&(ce=k.inclusive)}return new Ma(ue,ce)})(m,f),S=(function(q,ne){const ue=[];let ce=!0;for(const C of qs(ne)){const k=C.kind===0?vw(q,C.fieldPath,q.endAt):yw(q,C.fieldPath,q.endAt);ue.push(k.value),ce&&(ce=k.inclusive)}return new Ma(ue,ce)})(m,f),D=this.xn(f,m,x),U=this.xn(f,m,S),L=this.On(f,m,_),K=this.Nn(f.indexId,v,D,x.inclusive,U,S.inclusive,L);return z.forEach(K,(X=>r.H(X,t.limit).next((q=>{q.forEach((ne=>{const ue=le.fromSegments(ne.documentKey);l.has(ue)||(l=l.add(ue),d.push(ue))}))}))))})).next((()=>d))}return z.resolve(null)}))}Fn(e){let t=this.Cn.get(e);return t||(e.filters.length===0?t=[e]:t=rC(We.create(e.filters,"and")).map((r=>_m(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt))),this.Cn.set(e,t),t)}Nn(e,t,r,s,a,l,d){const f=(t!=null?t.length:1)*Math.max(r.length,a.length),m=f/(t!=null?t.length:1),v=[];for(let _=0;_<f;++_){const x=t?this.Bn(t[_/m]):Td,S=this.Ln(e,x,r[_%m],s),D=this.kn(e,x,a[_%m],l),U=d.map((L=>this.Ln(e,x,L,!0)));v.push(...this.createRange(S,D,U))}return v}Ln(e,t,r,s){const a=new Qs(e,le.empty(),t,r);return s?a:a.En()}kn(e,t,r,s){const a=new Qs(e,le.empty(),t,r);return s?a.En():a}Mn(e,t){const r=new Mw(t),s=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,s).next((a=>{let l=null;for(const d of a)r.pn(d)&&(!l||d.fields.length>l.fields.length)&&(l=d);return l}))}getIndexType(e,t){let r=2;const s=this.Fn(t);return z.forEach(s,(a=>this.Mn(e,a).next((l=>{l?r!==0&&l.fields.length<(function(f){let m=new Ge(ct.comparator),v=!1;for(const _ of f.filters)for(const x of _.getFlattenedFilters())x.field.isKeyField()||(x.op==="array-contains"||x.op==="array-contains-any"?v=!0:m=m.add(x.field));for(const _ of f.orderBy)_.field.isKeyField()||(m=m.add(_.field));return m.size+(v?1:0)})(a)&&(r=1):r=0})))).next((()=>(function(l){return l.limit!==null})(t)&&s.length>1&&r===2?1:r))}qn(e,t){const r=new iu;for(const s of qs(e)){const a=t.data.field(s.fieldPath);if(a==null)return null;const l=r.hn(s.kind);Ks.Ut.bt(a,l)}return r.an()}Bn(e){const t=new iu;return Ks.Ut.bt(e,t.hn(0)),t.an()}Qn(e,t){const r=new iu;return Ks.Ut.bt(Vu(this.databaseId,t),r.hn((function(a){const l=qs(a);return l.length===0?0:l[l.length-1].kind})(e))),r.an()}On(e,t,r){if(r===null)return[];let s=[];s.push(new iu);let a=0;for(const l of qs(e)){const d=r[a++];for(const f of s)if(this.$n(t,l.fieldPath)&&Ou(d))s=this.Un(s,l,d);else{const m=f.hn(l.kind);Ks.Ut.bt(d,m)}}return this.Kn(s)}xn(e,t,r){return this.On(e,t,r.position)}Kn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].an();return t}Un(e,t,r){const s=[...e],a=[];for(const l of r.arrayValue.values||[])for(const d of s){const f=new iu;f.seed(d.an()),Ks.Ut.bt(l,f.hn(t.kind)),a.push(f)}return a}$n(e,t){return!!e.filters.find((r=>r instanceof Ve&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in")))}getFieldIndexes(e,t){const r=su(e),s=va(e);return(t?r.j(hm,IDBKeyRange.bound(t,t)):r.j()).next((a=>{const l=[];return z.forEach(a,(d=>s.get([d.indexId,this.uid]).next((f=>{l.push((function(v,_){const x=_?new bu(_.sequenceNumber,new Sn(uo(_.readTime),new le(Ar(_.documentKey)),_.largestBatchId)):bu.empty(),S=v.fields.map((([D,U])=>new Nd(ct.fromServerFormat(D),U)));return new Xd(v.indexId,v.collectionGroup,S,x)})(d,f))})))).next((()=>l))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((r,s)=>{const a=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return a!==0?a:Te(r.collectionGroup,s.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,r){const s=su(e),a=va(e);return this.Wn(e).next((l=>s.j(hm,IDBKeyRange.bound(t,t)).next((d=>z.forEach(d,(f=>a.put(Pw(f.indexId,this.uid,l,r))))))))}updateIndexEntries(e,t){const r=new Map;return z.forEach(t,((s,a)=>{const l=r.get(s.collectionGroup);return(l?z.resolve(l):this.getFieldIndexes(e,s.collectionGroup)).next((d=>(r.set(s.collectionGroup,d),z.forEach(d,(f=>this.Gn(e,s,f).next((m=>{const v=this.zn(a,f);return m.isEqual(v)?z.resolve():this.jn(e,a,f,m,v)})))))))}))}Jn(e,t,r,s){return ya(e).put(s.An(this.uid,this.Qn(r,t.key),t.key))}Hn(e,t,r,s){return ya(e).delete(s.Rn(this.uid,this.Qn(r,t.key),t.key))}Gn(e,t,r){const s=ya(e);let a=new Ge($i);return s.X({index:KE,range:IDBKeyRange.only([r.indexId,this.uid,Ud(this.Qn(r,t))])},((l,d)=>{a=a.add(new Qs(r.indexId,t,Lw(d.arrayValue),Lw(d.directionalValue)))})).next((()=>a))}zn(e,t){let r=new Ge($i);const s=this.qn(t,e);if(s==null)return r;const a=cm(t);if(a!=null){const l=e.data.field(a.fieldPath);if(Ou(l))for(const d of l.arrayValue.values||[])r=r.add(new Qs(t.indexId,e.key,this.Bn(d),s))}else r=r.add(new Qs(t.indexId,e.key,Td,s));return r}jn(e,t,r,s,a){te(Fw,"Updating index entries for document '%s'",t.key);const l=[];return(function(f,m,v,_,x){const S=f.getIterator(),D=m.getIterator();let U=ma(S),L=ma(D);for(;U||L;){let K=!1,X=!1;if(U&&L){const q=v(U,L);q<0?X=!0:q>0&&(K=!0)}else U!=null?X=!0:K=!0;K?(_(L),L=ma(D)):X?(x(U),U=ma(S)):(U=ma(S),L=ma(D))}})(s,a,$i,(d=>{l.push(this.Jn(e,t,r,d))}),(d=>{l.push(this.Hn(e,t,r,d))})),z.waitFor(l)}Wn(e){let t=1;return va(e).X({index:GE,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((r,s,a)=>{a.done(),t=s.sequenceNumber+1})).next((()=>t))}createRange(e,t,r){r=r.sort(((l,d)=>$i(l,d))).filter(((l,d,f)=>!d||$i(l,f[d-1])!==0));const s=[];s.push(e);for(const l of r){const d=$i(l,e),f=$i(l,t);if(d===0)s[0]=e.En();else if(d>0&&f<0)s.push(l),s.push(l.En());else if(f>0)break}s.push(t);const a=[];for(let l=0;l<s.length;l+=2){if(this.Yn(s[l],s[l+1]))return[];const d=s[l].Rn(this.uid,Td,le.empty()),f=s[l+1].Rn(this.uid,Td,le.empty());a.push(IDBKeyRange.bound(d,f))}return a}Yn(e,t){return $i(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Bw)}getMinOffset(e,t){return z.mapArray(this.Fn(t),(r=>this.Mn(e,r).next((s=>s||me(44426))))).next(Bw)}}function Uw(n){return Rt(n,Pu)}function ya(n){return Rt(n,yu)}function su(n){return Rt(n,ng)}function va(n){return Rt(n,gu)}function Bw(n){ve(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const s=n[r].indexState.offset;Zm(s,e)<0&&(e=s),t<s.largestBatchId&&(t=s.largestBatchId)}return new Sn(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zw={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},YI=41943040;class Gt{static withCacheSize(e){return new Gt(e,Gt.DEFAULT_COLLECTION_PERCENTILE,Gt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JI(n,e,t){const r=n.store(sr),s=n.store(Pa),a=[],l=IDBKeyRange.only(t.batchId);let d=0;const f=r.X({range:l},((v,_,x)=>(d++,x.delete())));a.push(f.next((()=>{ve(d===1,47070,{batchId:t.batchId})})));const m=[];for(const v of t.mutations){const _=qE(e,v.key.path,t.batchId);a.push(s.delete(_)),m.push(v.key)}return z.waitFor(a).next((()=>m))}function lh(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw me(14731);e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Gt.DEFAULT_COLLECTION_PERCENTILE=10,Gt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Gt.DEFAULT=new Gt(YI,Gt.DEFAULT_COLLECTION_PERCENTILE,Gt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Gt.DISABLED=new Gt(-1,0,0);class Bh{constructor(e,t,r,s){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=s,this.Zn={}}static yt(e,t,r,s){ve(e.uid!=="",64387);const a=e.isAuthenticated()?e.uid:"";return new Bh(a,t,r,s)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return qi(e).X({index:Xs,range:r},((s,a,l)=>{t=!1,l.done()})).next((()=>t))}addMutationBatch(e,t,r,s){const a=Ta(e),l=qi(e);return l.add({}).next((d=>{ve(typeof d=="number",49019);const f=new cg(d,t,r,s),m=(function(S,D,U){const L=U.baseMutations.map((X=>sh(S.gt,X))),K=U.mutations.map((X=>sh(S.gt,X)));return{userId:D,batchId:U.batchId,localWriteTimeMs:U.localWriteTime.toMillis(),baseMutations:L,mutations:K}})(this.serializer,this.userId,f),v=[];let _=new Ge(((x,S)=>Te(x.canonicalString(),S.canonicalString())));for(const x of s){const S=qE(this.userId,x.key.path,d);_=_.add(x.key.path.popLast()),v.push(l.put(m)),v.push(a.put(S,OA))}return _.forEach((x=>{v.push(this.indexManager.addToCollectionParentIndex(e,x))})),e.addOnCommittedListener((()=>{this.Zn[d]=f.keys()})),z.waitFor(v).next((()=>f))}))}lookupMutationBatch(e,t){return qi(e).get(t).next((r=>r?(ve(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:t}),Gs(this.serializer,r)):null))}Xn(e,t){return this.Zn[t]?z.resolve(this.Zn[t]):this.lookupMutationBatch(e,t).next((r=>{if(r){const s=r.keys();return this.Zn[t]=s,s}return null}))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=IDBKeyRange.lowerBound([this.userId,r]);let a=null;return qi(e).X({index:Xs,range:s},((l,d,f)=>{d.userId===this.userId&&(ve(d.batchId>=r,47524,{er:r}),a=Gs(this.serializer,d)),f.done()})).next((()=>a))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=Zs;return qi(e).X({index:Xs,range:t,reverse:!0},((s,a,l)=>{r=a.batchId,l.done()})).next((()=>r))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Zs],[this.userId,Number.POSITIVE_INFINITY]);return qi(e).j(Xs,t).next((r=>r.map((s=>Gs(this.serializer,s)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=Dd(this.userId,t.path),s=IDBKeyRange.lowerBound(r),a=[];return Ta(e).X({range:s},((l,d,f)=>{const[m,v,_]=l,x=Ar(v);if(m===this.userId&&t.path.isEqual(x))return qi(e).get(_).next((S=>{if(!S)throw me(61480,{tr:l,batchId:_});ve(S.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:S.userId,batchId:_}),a.push(Gs(this.serializer,S))}));f.done()})).next((()=>a))}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ge(Te);const s=[];return t.forEach((a=>{const l=Dd(this.userId,a.path),d=IDBKeyRange.lowerBound(l),f=Ta(e).X({range:d},((m,v,_)=>{const[x,S,D]=m,U=Ar(S);x===this.userId&&a.path.isEqual(U)?r=r.add(D):_.done()}));s.push(f)})),z.waitFor(s).next((()=>this.nr(e,r)))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1,a=Dd(this.userId,r),l=IDBKeyRange.lowerBound(a);let d=new Ge(Te);return Ta(e).X({range:l},((f,m,v)=>{const[_,x,S]=f,D=Ar(x);_===this.userId&&r.isPrefixOf(D)?D.length===s&&(d=d.add(S)):v.done()})).next((()=>this.nr(e,d)))}nr(e,t){const r=[],s=[];return t.forEach((a=>{s.push(qi(e).get(a).next((l=>{if(l===null)throw me(35274,{batchId:a});ve(l.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:l.userId,batchId:a}),r.push(Gs(this.serializer,l))})))})),z.waitFor(s).next((()=>r))}removeMutationBatch(e,t){return JI(e.ce,this.userId,t).next((r=>(e.addOnCommittedListener((()=>{this.rr(t.batchId)})),z.forEach(r,(s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))))}rr(e){delete this.Zn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return z.resolve();const r=IDBKeyRange.lowerBound((function(l){return[l]})(this.userId)),s=[];return Ta(e).X({range:r},((a,l,d)=>{if(a[0]===this.userId){const f=Ar(a[1]);s.push(f)}else d.done()})).next((()=>{ve(s.length===0,56720,{ir:s.map((a=>a.canonicalString()))})}))}))}containsKey(e,t){return ZI(e,this.userId,t)}sr(e){return ex(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:Zs,lastStreamToken:""}))}}function ZI(n,e,t){const r=Dd(e,t.path),s=r[1],a=IDBKeyRange.lowerBound(r);let l=!1;return Ta(n).X({range:a,Z:!0},((d,f,m)=>{const[v,_,x]=d;v===e&&_===s&&(l=!0),m.done()})).next((()=>l))}function qi(n){return Rt(n,sr)}function Ta(n){return Rt(n,Pa)}function ex(n){return Rt(n,Ru)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class co{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new co(0)}static ur(){return new co(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oC{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.cr(e).next((t=>{const r=new co(t.highestTargetId);return t.highestTargetId=r.next(),this.lr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.cr(e).next((t=>we.fromTimestamp(new He(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.cr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,r){return this.cr(e).next((s=>(s.highestListenSequenceNumber=t,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),t>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=t),this.lr(e,s))))}addTargetData(e,t){return this.hr(e,t).next((()=>this.cr(e).next((r=>(r.targetCount+=1,this.Pr(t,r),this.lr(e,r))))))}updateTargetData(e,t){return this.hr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>_a(e).delete(t.targetId))).next((()=>this.cr(e))).next((r=>(ve(r.targetCount>0,8065),r.targetCount-=1,this.lr(e,r))))}removeTargets(e,t,r){let s=0;const a=[];return _a(e).X(((l,d)=>{const f=du(d);f.sequenceNumber<=t&&r.get(f.targetId)===null&&(s++,a.push(this.removeTargetData(e,f)))})).next((()=>z.waitFor(a))).next((()=>s))}forEachTarget(e,t){return _a(e).X(((r,s)=>{const a=du(s);t(a)}))}cr(e){return $w(e).get(Zd).next((t=>(ve(t!==null,2888),t)))}lr(e,t){return $w(e).put(Zd,t)}hr(e,t){return _a(e).put(GI(this.serializer,t))}Pr(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.cr(e).next((t=>t.targetCount))}getTargetData(e,t){const r=ao(t),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let a=null;return _a(e).X({range:s,index:WE},((l,d,f)=>{const m=du(d);Wu(t,m.target)&&(a=m,f.done())})).next((()=>a))}addMatchingKeys(e,t,r){const s=[],a=Ki(e);return t.forEach((l=>{const d=Xt(l.path);s.push(a.put({targetId:r,path:d})),s.push(this.referenceDelegate.addReference(e,r,l))})),z.waitFor(s)}removeMatchingKeys(e,t,r){const s=Ki(e);return z.forEach(t,(a=>{const l=Xt(a.path);return z.waitFor([s.delete([r,l]),this.referenceDelegate.removeReference(e,r,a)])}))}removeMatchingKeysForTargetId(e,t){const r=Ki(e),s=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),s=Ki(e);let a=Ce();return s.X({range:r,Z:!0},((l,d,f)=>{const m=Ar(l[1]),v=new le(m);a=a.add(v)})).next((()=>a))}containsKey(e,t){const r=Xt(t.path),s=IDBKeyRange.bound([r],[ME(r)],!1,!0);let a=0;return Ki(e).X({index:tg,Z:!0,range:s},(([l,d],f,m)=>{l!==0&&(a++,m.done())})).next((()=>a>0))}Et(e,t){return _a(e).get(t).next((r=>r?du(r):null))}}function _a(n){return Rt(n,Na)}function $w(n){return Rt(n,eo)}function Ki(n){return Rt(n,Da)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qw="LruGarbageCollector",aC=1048576;function Hw([n,e],[t,r]){const s=Te(n,t);return s===0?Te(e,r):s}class lC{constructor(e){this.Tr=e,this.buffer=new Ge(Hw),this.Ir=0}dr(){return++this.Ir}Er(e){const t=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();Hw(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class tx{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){te(qw,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){hs(t)?te(qw,"Ignoring IndexedDB error during garbage collection: ",t):await _o(t)}await this.Rr(3e5)}))}}class uC{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.mr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return z.resolve(jn.ue);const r=new lC(t);return this.Vr.forEachTarget(e,(s=>r.Er(s.sequenceNumber))).next((()=>this.Vr.gr(e,(s=>r.Er(s))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.Vr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(te("LruGarbageCollector","Garbage collection skipped; disabled"),z.resolve(zw)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(te("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),zw):this.pr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,t){let r,s,a,l,d,f,m;const v=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((_=>(_>this.params.maximumSequenceNumbersToCollect?(te("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${_}`),s=this.params.maximumSequenceNumbersToCollect):s=_,l=Date.now(),this.nthSequenceNumber(e,s)))).next((_=>(r=_,d=Date.now(),this.removeTargets(e,r,t)))).next((_=>(a=_,f=Date.now(),this.removeOrphanedDocuments(e,r)))).next((_=>(m=Date.now(),wa()<=De.DEBUG&&te("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${l-v}ms
	Determined least recently used ${s} in `+(d-l)+`ms
	Removed ${a} targets in `+(f-d)+`ms
	Removed ${_} documents in `+(m-f)+`ms
Total Duration: ${m-v}ms`),z.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:a,documentsRemoved:_}))))}}function nx(n,e){return new uC(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cC{constructor(e,t){this.db=e,this.garbageCollector=nx(this,t)}mr(e){const t=this.yr(e);return this.db.getTargetCache().getTargetCount(e).next((r=>t.next((s=>r+s))))}yr(e){let t=0;return this.gr(e,(r=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}gr(e,t){return this.wr(e,((r,s)=>t(s)))}addReference(e,t,r){return Sd(e,r)}removeReference(e,t,r){return Sd(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Sd(e,t)}Sr(e,t){return(function(s,a){let l=!1;return ex(s).ee((d=>ZI(s,d,a).next((f=>(f&&(l=!0),z.resolve(!f)))))).next((()=>l))})(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let a=0;return this.wr(e,((l,d)=>{if(d<=t){const f=this.Sr(e,l).next((m=>{if(!m)return a++,r.getEntry(e,l).next((()=>(r.removeEntry(l,we.min()),Ki(e).delete((function(_){return[0,Xt(_.path)]})(l)))))}));s.push(f)}})).next((()=>z.waitFor(s))).next((()=>r.apply(e))).next((()=>a))}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Sd(e,t)}wr(e,t){const r=Ki(e);let s,a=jn.ue;return r.X({index:tg},(([l,d],{path:f,sequenceNumber:m})=>{l===0?(a!==jn.ue&&t(new le(Ar(s)),a),a=m,s=f):a=jn.ue})).next((()=>{a!==jn.ue&&t(new le(Ar(s)),a)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Sd(n,e){return Ki(n).put((function(r,s){return{targetId:0,path:Xt(r.path),sequenceNumber:s}})(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rx{constructor(){this.changes=new pi((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ht.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?z.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dC{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return zs(e).put(r)}removeEntry(e,t,r){return zs(e).delete((function(a,l){const d=a.path.toArray();return[d.slice(0,d.length-2),d[d.length-2],oh(l),d[d.length-1]]})(t,r))}updateMetadata(e,t){return this.getMetadata(e).next((r=>(r.byteSize+=t,this.br(e,r))))}getEntry(e,t){let r=ht.newInvalidDocument(t);return zs(e).X({index:Vd,range:IDBKeyRange.only(ou(t))},((s,a)=>{r=this.Dr(t,a)})).next((()=>r))}vr(e,t){let r={size:0,document:ht.newInvalidDocument(t)};return zs(e).X({index:Vd,range:IDBKeyRange.only(ou(t))},((s,a)=>{r={document:this.Dr(t,a),size:lh(a)}})).next((()=>r))}getEntries(e,t){let r=xn();return this.Cr(e,t,((s,a)=>{const l=this.Dr(s,a);r=r.insert(s,l)})).next((()=>r))}Fr(e,t){let r=xn(),s=new at(le.comparator);return this.Cr(e,t,((a,l)=>{const d=this.Dr(a,l);r=r.insert(a,d),s=s.insert(a,lh(l))})).next((()=>({documents:r,Mr:s})))}Cr(e,t,r){if(t.isEmpty())return z.resolve();let s=new Ge(Kw);t.forEach((f=>s=s.add(f)));const a=IDBKeyRange.bound(ou(s.first()),ou(s.last())),l=s.getIterator();let d=l.getNext();return zs(e).X({index:Vd,range:a},((f,m,v)=>{const _=le.fromSegments([...m.prefixPath,m.collectionGroup,m.documentId]);for(;d&&Kw(d,_)<0;)r(d,null),d=l.getNext();d&&d.isEqual(_)&&(r(d,m),d=l.hasNext()?l.getNext():null),d?v.G(ou(d)):v.done()})).next((()=>{for(;d;)r(d,null),d=l.hasNext()?l.getNext():null}))}getDocumentsMatchingQuery(e,t,r,s,a){const l=t.path,d=[l.popLast().toArray(),l.lastSegment(),oh(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],f=[l.popLast().toArray(),l.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return zs(e).j(IDBKeyRange.bound(d,f,!0)).next((m=>{a==null||a.incrementDocumentReadCount(m.length);let v=xn();for(const _ of m){const x=this.Dr(le.fromSegments(_.prefixPath.concat(_.collectionGroup,_.documentId)),_);x.isFoundDocument()&&(Ku(t,x)||s.has(x.key))&&(v=v.insert(x.key,x))}return v}))}getAllFromCollectionGroup(e,t,r,s){let a=xn();const l=Gw(t,r),d=Gw(t,Sn.max());return zs(e).X({index:HE,range:IDBKeyRange.bound(l,d,!0)},((f,m,v)=>{const _=this.Dr(le.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);a=a.insert(_.key,_),a.size===s&&v.done()})).next((()=>a))}newChangeBuffer(e){return new hC(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return Ww(e).get(dm).next((t=>(ve(!!t,20021),t)))}br(e,t){return Ww(e).put(dm,t)}Dr(e,t){if(t){const r=XR(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(we.min())))return r}return ht.newInvalidDocument(e)}}function ix(n){return new dC(n)}class hC extends rx{constructor(e,t){super(),this.Or=e,this.trackRemovals=t,this.Nr=new pi((r=>r.toString()),((r,s)=>r.isEqual(s)))}applyChanges(e){const t=[];let r=0,s=new Ge(((a,l)=>Te(a.canonicalString(),l.canonicalString())));return this.changes.forEach(((a,l)=>{const d=this.Nr.get(a);if(t.push(this.Or.removeEntry(e,a,d.readTime)),l.isValidDocument()){const f=Rw(this.Or.serializer,l);s=s.add(a.path.popLast());const m=lh(f);r+=m-d.size,t.push(this.Or.addEntry(e,a,f))}else if(r-=d.size,this.trackRemovals){const f=Rw(this.Or.serializer,l.convertToNoDocument(we.min()));t.push(this.Or.addEntry(e,a,f))}})),s.forEach((a=>{t.push(this.Or.indexManager.addToCollectionParentIndex(e,a))})),t.push(this.Or.updateMetadata(e,r)),z.waitFor(t)}getFromCache(e,t){return this.Or.vr(e,t).next((r=>(this.Nr.set(t,{size:r.size,readTime:r.document.readTime}),r.document)))}getAllFromCache(e,t){return this.Or.Fr(e,t).next((({documents:r,Mr:s})=>(s.forEach(((a,l)=>{this.Nr.set(a,{size:l,readTime:r.get(a).readTime})})),r)))}}function Ww(n){return Rt(n,Cu)}function zs(n){return Rt(n,Jd)}function ou(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Gw(n,e){const t=e.documentKey.path.toArray();return[n,oh(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function Kw(n,e){const t=n.path.toArray(),r=e.path.toArray();let s=0;for(let a=0;a<t.length-2&&a<r.length-2;++a)if(s=Te(t[a],r[a]),s)return s;return s=Te(t.length,r.length),s||(s=Te(t[t.length-2],r[r.length-2]),s||Te(t[t.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fC{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sx{constructor(e,t,r,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((s=>(r=s,this.remoteDocumentCache.getEntry(e,t)))).next((s=>(r!==null&&Eu(r.mutation,s,fn.empty(),He.now()),s)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,Ce()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=Ce()){const s=Rr();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,r).next((a=>{let l=uu();return a.forEach(((d,f)=>{l=l.insert(d,f.overlayedDocument)})),l}))))}getOverlayedDocuments(e,t){const r=Rr();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,Ce())))}populateOverlays(e,t,r){const s=[];return r.forEach((a=>{t.has(a)||s.push(a)})),this.documentOverlayCache.getOverlays(e,s).next((a=>{a.forEach(((l,d)=>{t.set(l,d)}))}))}computeViews(e,t,r,s){let a=xn();const l=wu(),d=(function(){return wu()})();return t.forEach(((f,m)=>{const v=r.get(m.key);s.has(m.key)&&(v===void 0||v.mutation instanceof mi)?a=a.insert(m.key,m):v!==void 0?(l.set(m.key,v.mutation.getFieldMask()),Eu(v.mutation,m,v.mutation.getFieldMask(),He.now())):l.set(m.key,fn.empty())})),this.recalculateAndSaveOverlays(e,a).next((f=>(f.forEach(((m,v)=>l.set(m,v))),t.forEach(((m,v)=>{var _;return d.set(m,new fC(v,(_=l.get(m))!==null&&_!==void 0?_:null))})),d)))}recalculateAndSaveOverlays(e,t){const r=wu();let s=new at(((l,d)=>l-d)),a=Ce();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((l=>{for(const d of l)d.keys().forEach((f=>{const m=t.get(f);if(m===null)return;let v=r.get(f)||fn.empty();v=d.applyToLocalView(m,v),r.set(f,v);const _=(s.get(d.batchId)||Ce()).add(f);s=s.insert(d.batchId,_)}))})).next((()=>{const l=[],d=s.getReverseIterator();for(;d.hasNext();){const f=d.getNext(),m=f.key,v=f.value,_=II();v.forEach((x=>{if(!a.has(x)){const S=RI(t.get(x),r.get(x));S!==null&&_.set(x,S),a=a.add(x)}})),l.push(this.documentOverlayCache.saveOverlays(e,m,_))}return z.waitFor(l)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,s){return(function(l){return le.isDocumentKey(l.path)&&l.collectionGroup===null&&l.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):yI(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,s):this.getDocumentsMatchingCollectionQuery(e,t,r,s)}getNextDocuments(e,t,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,s).next((a=>{const l=s-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,s-a.size):z.resolve(Rr());let d=ku,f=a;return l.next((m=>z.forEach(m,((v,_)=>(d<_.largestBatchId&&(d=_.largestBatchId),a.get(v)?z.resolve():this.remoteDocumentCache.getEntry(e,v).next((x=>{f=f.insert(v,x)}))))).next((()=>this.populateOverlays(e,m,a))).next((()=>this.computeViews(e,f,m,Ce()))).next((v=>({batchId:d,changes:EI(v)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new le(t)).next((r=>{let s=uu();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,s){const a=t.collectionGroup;let l=uu();return this.indexManager.getCollectionParents(e,a).next((d=>z.forEach(d,(f=>{const m=(function(_,x){return new Za(x,null,_.explicitOrderBy.slice(),_.filters.slice(),_.limit,_.limitType,_.startAt,_.endAt)})(t,f.child(a));return this.getDocumentsMatchingCollectionQuery(e,m,r,s).next((v=>{v.forEach(((_,x)=>{l=l.insert(_,x)}))}))})).next((()=>l))))}getDocumentsMatchingCollectionQuery(e,t,r,s){let a;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((l=>(a=l,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,a,s)))).next((l=>{a.forEach(((f,m)=>{const v=m.getKey();l.get(v)===null&&(l=l.insert(v,ht.newInvalidDocument(v)))}));let d=uu();return l.forEach(((f,m)=>{const v=a.get(f);v!==void 0&&Eu(v.mutation,m,fn.empty(),He.now()),Ku(t,m)&&(d=d.insert(f,m))})),d}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pC{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,t){return z.resolve(this.Br.get(t))}saveBundleMetadata(e,t){return this.Br.set(t.id,(function(s){return{id:s.id,version:s.version,createTime:rn(s.createTime)}})(t)),z.resolve()}getNamedQuery(e,t){return z.resolve(this.Lr.get(t))}saveNamedQuery(e,t){return this.Lr.set(t.name,(function(s){return{name:s.name,query:KI(s.bundledQuery),readTime:rn(s.readTime)}})(t)),z.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mC{constructor(){this.overlays=new at(le.comparator),this.kr=new Map}getOverlay(e,t){return z.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Rr();return z.forEach(t,(s=>this.getOverlay(e,s).next((a=>{a!==null&&r.set(s,a)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((s,a)=>{this.wt(e,t,a)})),z.resolve()}removeOverlaysForBatchId(e,t,r){const s=this.kr.get(r);return s!==void 0&&(s.forEach((a=>this.overlays=this.overlays.remove(a))),this.kr.delete(r)),z.resolve()}getOverlaysForCollection(e,t,r){const s=Rr(),a=t.length+1,l=new le(t.child("")),d=this.overlays.getIteratorFrom(l);for(;d.hasNext();){const f=d.getNext().value,m=f.getKey();if(!t.isPrefixOf(m.path))break;m.path.length===a&&f.largestBatchId>r&&s.set(f.getKey(),f)}return z.resolve(s)}getOverlaysForCollectionGroup(e,t,r,s){let a=new at(((m,v)=>m-v));const l=this.overlays.getIterator();for(;l.hasNext();){const m=l.getNext().value;if(m.getKey().getCollectionGroup()===t&&m.largestBatchId>r){let v=a.get(m.largestBatchId);v===null&&(v=Rr(),a=a.insert(m.largestBatchId,v)),v.set(m.getKey(),m)}}const d=Rr(),f=a.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach(((m,v)=>d.set(m,v))),!(d.size()>=s)););return z.resolve(d)}wt(e,t,r){const s=this.overlays.get(r.key);if(s!==null){const l=this.kr.get(s.largestBatchId).delete(r.key);this.kr.set(s.largestBatchId,l)}this.overlays=this.overlays.insert(r.key,new hg(t,r));let a=this.kr.get(t);a===void 0&&(a=Ce(),this.kr.set(t,a)),this.kr.set(t,a.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gC{constructor(){this.sessionToken=It.EMPTY_BYTE_STRING}getSessionToken(e){return z.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,z.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yg{constructor(){this.qr=new Ge(Ot.Qr),this.$r=new Ge(Ot.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,t){const r=new Ot(e,t);this.qr=this.qr.add(r),this.$r=this.$r.add(r)}Kr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Wr(new Ot(e,t))}Gr(e,t){e.forEach((r=>this.removeReference(r,t)))}zr(e){const t=new le(new $e([])),r=new Ot(t,e),s=new Ot(t,e+1),a=[];return this.$r.forEachInRange([r,s],(l=>{this.Wr(l),a.push(l.key)})),a}jr(){this.qr.forEach((e=>this.Wr(e)))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const t=new le(new $e([])),r=new Ot(t,e),s=new Ot(t,e+1);let a=Ce();return this.$r.forEachInRange([r,s],(l=>{a=a.add(l.key)})),a}containsKey(e){const t=new Ot(e,0),r=this.qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class Ot{constructor(e,t){this.key=e,this.Hr=t}static Qr(e,t){return le.comparator(e.key,t.key)||Te(e.Hr,t.Hr)}static Ur(e,t){return Te(e.Hr,t.Hr)||le.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yC{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.er=1,this.Yr=new Ge(Ot.Qr)}checkEmpty(e){return z.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,s){const a=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const l=new cg(a,t,r,s);this.mutationQueue.push(l);for(const d of s)this.Yr=this.Yr.add(new Ot(d.key,a)),this.indexManager.addToCollectionParentIndex(e,d.key.path.popLast());return z.resolve(l)}lookupMutationBatch(e,t){return z.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=this.Xr(r),a=s<0?0:s;return z.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return z.resolve(this.mutationQueue.length===0?Zs:this.er-1)}getAllMutationBatches(e){return z.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Ot(t,0),s=new Ot(t,Number.POSITIVE_INFINITY),a=[];return this.Yr.forEachInRange([r,s],(l=>{const d=this.Zr(l.Hr);a.push(d)})),z.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ge(Te);return t.forEach((s=>{const a=new Ot(s,0),l=new Ot(s,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([a,l],(d=>{r=r.add(d.Hr)}))})),z.resolve(this.ei(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1;let a=r;le.isDocumentKey(a)||(a=a.child(""));const l=new Ot(new le(a),0);let d=new Ge(Te);return this.Yr.forEachWhile((f=>{const m=f.key.path;return!!r.isPrefixOf(m)&&(m.length===s&&(d=d.add(f.Hr)),!0)}),l),z.resolve(this.ei(d))}ei(e){const t=[];return e.forEach((r=>{const s=this.Zr(r);s!==null&&t.push(s)})),t}removeMutationBatch(e,t){ve(this.ti(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Yr;return z.forEach(t.mutations,(s=>{const a=new Ot(s.key,t.batchId);return r=r.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)})).next((()=>{this.Yr=r}))}rr(e){}containsKey(e,t){const r=new Ot(t,0),s=this.Yr.firstAfterOrEqual(r);return z.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,z.resolve()}ti(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vC{constructor(e){this.ni=e,this.docs=(function(){return new at(le.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,s=this.docs.get(r),a=s?s.size:0,l=this.ni(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:l}),this.size+=l-a,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return z.resolve(r?r.document.mutableCopy():ht.newInvalidDocument(t))}getEntries(e,t){let r=xn();return t.forEach((s=>{const a=this.docs.get(s);r=r.insert(s,a?a.document.mutableCopy():ht.newInvalidDocument(s))})),z.resolve(r)}getDocumentsMatchingQuery(e,t,r,s){let a=xn();const l=t.path,d=new le(l.child("__id-9223372036854775808__")),f=this.docs.getIteratorFrom(d);for(;f.hasNext();){const{key:m,value:{document:v}}=f.getNext();if(!l.isPrefixOf(m.path))break;m.path.length>l.length+1||Zm(UE(v),r)<=0||(s.has(v.key)||Ku(t,v))&&(a=a.insert(v.key,v.mutableCopy()))}return z.resolve(a)}getAllFromCollectionGroup(e,t,r,s){me(9500)}ri(e,t){return z.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new _C(this)}getSize(e){return z.resolve(this.size)}}class _C extends rx{constructor(e){super(),this.Or=e}applyChanges(e){const t=[];return this.changes.forEach(((r,s)=>{s.isValidDocument()?t.push(this.Or.addEntry(e,s)):this.Or.removeEntry(r)})),z.waitFor(t)}getFromCache(e,t){return this.Or.getEntry(e,t)}getAllFromCache(e,t){return this.Or.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wC{constructor(e){this.persistence=e,this.ii=new pi((t=>ao(t)),Wu),this.lastRemoteSnapshotVersion=we.min(),this.highestTargetId=0,this.si=0,this.oi=new yg,this.targetCount=0,this._i=co.ar()}forEachTarget(e,t){return this.ii.forEach(((r,s)=>t(s))),z.resolve()}getLastRemoteSnapshotVersion(e){return z.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return z.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),z.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.si&&(this.si=t),z.resolve()}hr(e){this.ii.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this._i=new co(t),this.highestTargetId=t),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,t){return this.hr(t),this.targetCount+=1,z.resolve()}updateTargetData(e,t){return this.hr(t),z.resolve()}removeTargetData(e,t){return this.ii.delete(t.target),this.oi.zr(t.targetId),this.targetCount-=1,z.resolve()}removeTargets(e,t,r){let s=0;const a=[];return this.ii.forEach(((l,d)=>{d.sequenceNumber<=t&&r.get(d.targetId)===null&&(this.ii.delete(l),a.push(this.removeMatchingKeysForTargetId(e,d.targetId)),s++)})),z.waitFor(a).next((()=>s))}getTargetCount(e){return z.resolve(this.targetCount)}getTargetData(e,t){const r=this.ii.get(t)||null;return z.resolve(r)}addMatchingKeys(e,t,r){return this.oi.Kr(t,r),z.resolve()}removeMatchingKeys(e,t,r){this.oi.Gr(t,r);const s=this.persistence.referenceDelegate,a=[];return s&&t.forEach((l=>{a.push(s.markPotentiallyOrphaned(e,l))})),z.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this.oi.zr(t),z.resolve()}getMatchingKeysForTargetId(e,t){const r=this.oi.Jr(t);return z.resolve(r)}containsKey(e,t){return z.resolve(this.oi.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vg{constructor(e,t){this.ai={},this.overlays={},this.ui=new jn(0),this.ci=!1,this.ci=!0,this.li=new gC,this.referenceDelegate=e(this),this.hi=new wC(this),this.indexManager=new iC,this.remoteDocumentCache=(function(s){return new vC(s)})((r=>this.referenceDelegate.Pi(r))),this.serializer=new WI(t),this.Ti=new pC(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new mC,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ai[e.toKey()];return r||(r=new yC(t,this.referenceDelegate),this.ai[e.toKey()]=r),r}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,t,r){te("MemoryPersistence","Starting transaction:",e);const s=new EC(this.ui.next());return this.referenceDelegate.Ii(),r(s).next((a=>this.referenceDelegate.di(s).next((()=>a)))).toPromise().then((a=>(s.raiseOnCommittedEvent(),a)))}Ei(e,t){return z.or(Object.values(this.ai).map((r=>()=>r.containsKey(e,t))))}}class EC extends zE{constructor(e){super(),this.currentSequenceNumber=e}}class zh{constructor(e){this.persistence=e,this.Ai=new yg,this.Ri=null}static Vi(e){return new zh(e)}get mi(){if(this.Ri)return this.Ri;throw me(60996)}addReference(e,t,r){return this.Ai.addReference(r,t),this.mi.delete(r.toString()),z.resolve()}removeReference(e,t,r){return this.Ai.removeReference(r,t),this.mi.add(r.toString()),z.resolve()}markPotentiallyOrphaned(e,t){return this.mi.add(t.toString()),z.resolve()}removeTarget(e,t){this.Ai.zr(t.targetId).forEach((s=>this.mi.add(s.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((s=>{s.forEach((a=>this.mi.add(a.toString())))})).next((()=>r.removeTargetData(e,t)))}Ii(){this.Ri=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return z.forEach(this.mi,(r=>{const s=le.fromPath(r);return this.fi(e,s).next((a=>{a||t.removeEntry(s,we.min())}))})).next((()=>(this.Ri=null,t.apply(e))))}updateLimboDocument(e,t){return this.fi(e,t).next((r=>{r?this.mi.delete(t.toString()):this.mi.add(t.toString())}))}Pi(e){return 0}fi(e,t){return z.or([()=>z.resolve(this.Ai.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class uh{constructor(e,t){this.persistence=e,this.gi=new pi((r=>Xt(r.path)),((r,s)=>r.isEqual(s))),this.garbageCollector=nx(this,t)}static Vi(e,t){return new uh(e,t)}Ii(){}di(e){return z.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}mr(e){const t=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((s=>r+s))))}yr(e){let t=0;return this.gr(e,(r=>{t++})).next((()=>t))}gr(e,t){return z.forEach(this.gi,((r,s)=>this.Sr(e,r,s).next((a=>a?z.resolve():t(s)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const s=this.persistence.getRemoteDocumentCache(),a=s.newChangeBuffer();return s.ri(e,(l=>this.Sr(e,l,t).next((d=>{d||(r++,a.removeEntry(l,we.min()))})))).next((()=>a.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.gi.set(t,e.currentSequenceNumber),z.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.gi.set(r,e.currentSequenceNumber),z.resolve()}removeReference(e,t,r){return this.gi.set(r,e.currentSequenceNumber),z.resolve()}updateLimboDocument(e,t){return this.gi.set(t,e.currentSequenceNumber),z.resolve()}Pi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Ld(e.data.value)),t}Sr(e,t,r){return z.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.gi.get(t);return z.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IC{constructor(e){this.serializer=e}q(e,t,r,s){const a=new Ah("createOrUpgrade",t);r<1&&s>=1&&((function(f){f.createObjectStore(Hu)})(e),(function(f){f.createObjectStore(Ru,{keyPath:VA}),f.createObjectStore(sr,{keyPath:sw,autoIncrement:!0}).createIndex(Xs,ow,{unique:!0}),f.createObjectStore(Pa)})(e),Qw(e),(function(f){f.createObjectStore(Hs)})(e));let l=z.resolve();return r<3&&s>=3&&(r!==0&&((function(f){f.deleteObjectStore(Da),f.deleteObjectStore(Na),f.deleteObjectStore(eo)})(e),Qw(e)),l=l.next((()=>(function(f){const m=f.store(eo),v={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:we.min().toTimestamp(),targetCount:0};return m.put(Zd,v)})(a)))),r<4&&s>=4&&(r!==0&&(l=l.next((()=>(function(f,m){return m.store(sr).j().next((_=>{f.deleteObjectStore(sr),f.createObjectStore(sr,{keyPath:sw,autoIncrement:!0}).createIndex(Xs,ow,{unique:!0});const x=m.store(sr),S=_.map((D=>x.put(D)));return z.waitFor(S)}))})(e,a)))),l=l.next((()=>{(function(f){f.createObjectStore(Va,{keyPath:$A})})(e)}))),r<5&&s>=5&&(l=l.next((()=>this.pi(a)))),r<6&&s>=6&&(l=l.next((()=>((function(f){f.createObjectStore(Cu)})(e),this.yi(a))))),r<7&&s>=7&&(l=l.next((()=>this.wi(a)))),r<8&&s>=8&&(l=l.next((()=>this.Si(e,a)))),r<9&&s>=9&&(l=l.next((()=>{(function(f){f.objectStoreNames.contains("remoteDocumentChanges")&&f.deleteObjectStore("remoteDocumentChanges")})(e)}))),r<10&&s>=10&&(l=l.next((()=>this.bi(a)))),r<11&&s>=11&&(l=l.next((()=>{(function(f){f.createObjectStore(Ch,{keyPath:qA})})(e),(function(f){f.createObjectStore(Ph,{keyPath:HA})})(e)}))),r<12&&s>=12&&(l=l.next((()=>{(function(f){const m=f.createObjectStore(Nh,{keyPath:JA});m.createIndex(fm,ZA,{unique:!1}),m.createIndex(QE,eR,{unique:!1})})(e)}))),r<13&&s>=13&&(l=l.next((()=>(function(f){const m=f.createObjectStore(Jd,{keyPath:LA});m.createIndex(Vd,MA),m.createIndex(HE,jA)})(e))).next((()=>this.Di(e,a))).next((()=>e.deleteObjectStore(Hs)))),r<14&&s>=14&&(l=l.next((()=>this.Ci(e,a)))),r<15&&s>=15&&(l=l.next((()=>(function(f){f.createObjectStore(ng,{keyPath:WA,autoIncrement:!0}).createIndex(hm,GA,{unique:!1}),f.createObjectStore(gu,{keyPath:KA}).createIndex(GE,QA,{unique:!1}),f.createObjectStore(yu,{keyPath:XA}).createIndex(KE,YA,{unique:!1})})(e)))),r<16&&s>=16&&(l=l.next((()=>{t.objectStore(gu).clear()})).next((()=>{t.objectStore(yu).clear()}))),r<17&&s>=17&&(l=l.next((()=>{(function(f){f.createObjectStore(rg,{keyPath:tR})})(e)}))),r<18&&s>=18&&wE()&&(l=l.next((()=>{t.objectStore(gu).clear()})).next((()=>{t.objectStore(yu).clear()}))),l}yi(e){let t=0;return e.store(Hs).X(((r,s)=>{t+=lh(s)})).next((()=>{const r={byteSize:t};return e.store(Cu).put(dm,r)}))}pi(e){const t=e.store(Ru),r=e.store(sr);return t.j().next((s=>z.forEach(s,(a=>{const l=IDBKeyRange.bound([a.userId,Zs],[a.userId,a.lastAcknowledgedBatchId]);return r.j(Xs,l).next((d=>z.forEach(d,(f=>{ve(f.userId===a.userId,18650,"Cannot process batch from unexpected user",{batchId:f.batchId});const m=Gs(this.serializer,f);return JI(e,a.userId,m).next((()=>{}))}))))}))))}wi(e){const t=e.store(Da),r=e.store(Hs);return e.store(eo).get(Zd).next((s=>{const a=[];return r.X(((l,d)=>{const f=new $e(l),m=(function(_){return[0,Xt(_)]})(f);a.push(t.get(m).next((v=>v?z.resolve():(_=>t.put({targetId:0,path:Xt(_),sequenceNumber:s.highestListenSequenceNumber}))(f))))})).next((()=>z.waitFor(a)))}))}Si(e,t){e.createObjectStore(Pu,{keyPath:zA});const r=t.store(Pu),s=new gg,a=l=>{if(s.add(l)){const d=l.lastSegment(),f=l.popLast();return r.put({collectionId:d,parent:Xt(f)})}};return t.store(Hs).X({Z:!0},((l,d)=>{const f=new $e(l);return a(f.popLast())})).next((()=>t.store(Pa).X({Z:!0},(([l,d,f],m)=>{const v=Ar(d);return a(v.popLast())}))))}bi(e){const t=e.store(Na);return t.X(((r,s)=>{const a=du(s),l=GI(this.serializer,a);return t.put(l)}))}Di(e,t){const r=t.store(Hs),s=[];return r.X(((a,l)=>{const d=t.store(Jd),f=(function(_){return _.document?new le($e.fromString(_.document.name).popFirst(5)):_.noDocument?le.fromSegments(_.noDocument.path):_.unknownDocument?le.fromSegments(_.unknownDocument.path):me(36783)})(l).path.toArray(),m={prefixPath:f.slice(0,f.length-2),collectionGroup:f[f.length-2],documentId:f[f.length-1],readTime:l.readTime||[0,0],unknownDocument:l.unknownDocument,noDocument:l.noDocument,document:l.document,hasCommittedMutations:!!l.hasCommittedMutations};s.push(d.put(m))})).next((()=>z.waitFor(s)))}Ci(e,t){const r=t.store(sr),s=ix(this.serializer),a=new vg(zh.Vi,this.serializer.gt);return r.j().next((l=>{const d=new Map;return l.forEach((f=>{var m;let v=(m=d.get(f.userId))!==null&&m!==void 0?m:Ce();Gs(this.serializer,f).keys().forEach((_=>v=v.add(_))),d.set(f.userId,v)})),z.forEach(d,((f,m)=>{const v=new Ut(m),_=Uh.yt(this.serializer,v),x=a.getIndexManager(v),S=Bh.yt(v,this.serializer,x,a.referenceDelegate);return new sx(s,S,_,x).recalculateAndSaveOverlaysForDocumentKeys(new pm(t,jn.ue),f).next()}))}))}}function Qw(n){n.createObjectStore(Da,{keyPath:UA}).createIndex(tg,BA,{unique:!0}),n.createObjectStore(Na,{keyPath:"targetId"}).createIndex(WE,FA,{unique:!0}),n.createObjectStore(eo)}const Hi="IndexedDbPersistence",Hp=18e5,Wp=5e3,Gp="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",xC="main";class _g{constructor(e,t,r,s,a,l,d,f,m,v,_=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Fi=a,this.window=l,this.document=d,this.Mi=m,this.xi=v,this.Oi=_,this.ui=null,this.ci=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Ni=null,this.inForeground=!1,this.Bi=null,this.Li=null,this.ki=Number.NEGATIVE_INFINITY,this.qi=x=>Promise.resolve(),!_g.C())throw new se(Q.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new cC(this,s),this.Qi=t+xC,this.serializer=new WI(f),this.$i=new ns(this.Qi,this.Oi,new IC(this.serializer)),this.li=new JR,this.hi=new oC(this.referenceDelegate,this.serializer),this.remoteDocumentCache=ix(this.serializer),this.Ti=new YR,this.window&&this.window.localStorage?this.Ui=this.window.localStorage:(this.Ui=null,v===!1&&tn(Hi,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ki().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new se(Q.FAILED_PRECONDITION,Gp);return this.Wi(),this.Gi(),this.zi(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.hi.getHighestSequenceNumber(e)))})).then((e=>{this.ui=new jn(e,this.Mi)})).then((()=>{this.ci=!0})).catch((e=>(this.$i&&this.$i.close(),Promise.reject(e))))}ji(e){return this.qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.$i.setDatabaseDeletedListener(e)}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Fi.enqueueAndForget((async()=>{this.started&&await this.Ki()})))}Ki(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>kd(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Ji(e).next((t=>{t||(this.isPrimary=!1,this.Fi.enqueueRetryable((()=>this.qi(!1))))}))})).next((()=>this.Hi(e))).next((t=>this.isPrimary&&!t?this.Yi(e).next((()=>!1)):!!t&&this.Zi(e).next((()=>!0)))))).catch((e=>{if(hs(e))return te(Hi,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return te(Hi,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Fi.enqueueRetryable((()=>this.qi(e))),this.isPrimary=e}))}Ji(e){return au(e).get(pa).next((t=>z.resolve(this.Xi(t))))}es(e){return kd(e).delete(this.clientId)}async ts(){if(this.isPrimary&&!this.ns(this.ki,Hp)){this.ki=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const r=Rt(t,Va);return r.j().next((s=>{const a=this.rs(s,Hp),l=s.filter((d=>a.indexOf(d)===-1));return z.forEach(l,(d=>r.delete(d.clientId))).next((()=>l))}))})).catch((()=>[]));if(this.Ui)for(const t of e)this.Ui.removeItem(this.ss(t.clientId))}}zi(){this.Li=this.Fi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Ki().then((()=>this.ts())).then((()=>this.zi()))))}Xi(e){return!!e&&e.ownerId===this.clientId}Hi(e){return this.xi?z.resolve(!0):au(e).get(pa).next((t=>{if(t!==null&&this.ns(t.leaseTimestampMs,Wp)&&!this._s(t.ownerId)){if(this.Xi(t)&&this.networkEnabled)return!0;if(!this.Xi(t)){if(!t.allowTabSynchronization)throw new se(Q.FAILED_PRECONDITION,Gp);return!1}}return!(!this.networkEnabled||!this.inForeground)||kd(e).j().next((r=>this.rs(r,Wp).find((s=>{if(this.clientId!==s.clientId){const a=!this.networkEnabled&&s.networkEnabled,l=!this.inForeground&&s.inForeground,d=this.networkEnabled===s.networkEnabled;if(a||l&&d)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&te(Hi,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.ci=!1,this.us(),this.Li&&(this.Li.cancel(),this.Li=null),this.cs(),this.ls(),await this.$i.runTransaction("shutdown","readwrite",[Hu,Va],(e=>{const t=new pm(e,jn.ue);return this.Yi(t).next((()=>this.es(t)))})),this.$i.close(),this.hs()}rs(e,t){return e.filter((r=>this.ns(r.updateTimeMs,t)&&!this._s(r.clientId)))}Ps(){return this.runTransaction("getActiveClients","readonly",(e=>kd(e).j().next((t=>this.rs(t,Hp).map((r=>r.clientId))))))}get started(){return this.ci}getGlobalsCache(){return this.li}getMutationQueue(e,t){return Bh.yt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new sC(e,this.serializer.gt.databaseId)}getDocumentOverlayCache(e){return Uh.yt(this.serializer,e)}getBundleCache(){return this.Ti}runTransaction(e,t,r){te(Hi,"Starting transaction:",e);const s=t==="readonly"?"readonly":"readwrite",a=(function(f){return f===18?iR:f===17?ZE:f===16?rR:f===15?ig:f===14?JE:f===13?YE:f===12?nR:f===11?XE:void me(60245)})(this.Oi);let l;return this.$i.runTransaction(e,s,a,(d=>(l=new pm(d,this.ui?this.ui.next():jn.ue),t==="readwrite-primary"?this.Ji(l).next((f=>!!f||this.Hi(l))).next((f=>{if(!f)throw tn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Fi.enqueueRetryable((()=>this.qi(!1))),new se(Q.FAILED_PRECONDITION,BE);return r(l)})).next((f=>this.Zi(l).next((()=>f)))):this.Ts(l).next((()=>r(l)))))).then((d=>(l.raiseOnCommittedEvent(),d)))}Ts(e){return au(e).get(pa).next((t=>{if(t!==null&&this.ns(t.leaseTimestampMs,Wp)&&!this._s(t.ownerId)&&!this.Xi(t)&&!(this.xi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new se(Q.FAILED_PRECONDITION,Gp)}))}Zi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return au(e).put(pa,t)}static C(){return ns.C()}Yi(e){const t=au(e);return t.get(pa).next((r=>this.Xi(r)?(te(Hi,"Releasing primary lease."),t.delete(pa)):z.resolve()))}ns(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(tn(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Wi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Bi=()=>{this.Fi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Ki())))},this.document.addEventListener("visibilitychange",this.Bi),this.inForeground=this.document.visibilityState==="visible")}cs(){this.Bi&&(this.document.removeEventListener("visibilitychange",this.Bi),this.Bi=null)}Gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Ni=()=>{this.us();const t=/(?:Version|Mobile)\/1[456]/;_E()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.Fi.enterRestrictedMode(!0),this.Fi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Ni))}ls(){this.Ni&&(this.window.removeEventListener("pagehide",this.Ni),this.Ni=null)}_s(e){var t;try{const r=((t=this.Ui)===null||t===void 0?void 0:t.getItem(this.ss(e)))!==null;return te(Hi,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return tn(Hi,"Failed to get zombied client id.",r),!1}}us(){if(this.Ui)try{this.Ui.setItem(this.ss(this.clientId),String(Date.now()))}catch(e){tn("Failed to set zombie client id.",e)}}hs(){if(this.Ui)try{this.Ui.removeItem(this.ss(this.clientId))}catch{}}ss(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function au(n){return Rt(n,Hu)}function kd(n){return Rt(n,Va)}function TC(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wg{constructor(e,t,r,s){this.targetId=e,this.fromCache=t,this.Is=r,this.ds=s}static Es(e,t){let r=Ce(),s=Ce();for(const a of t.docChanges)switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:s=s.add(a.doc.key)}return new wg(e,t.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SC{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ox{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=(function(){return _E()?8:$E(At())>0?6:4})()}initialize(e,t){this.gs=e,this.indexManager=t,this.As=!0}getDocumentsMatchingQuery(e,t,r,s){const a={result:null};return this.ps(e,t).next((l=>{a.result=l})).next((()=>{if(!a.result)return this.ys(e,t,s,r).next((l=>{a.result=l}))})).next((()=>{if(a.result)return;const l=new SC;return this.ws(e,t,l).next((d=>{if(a.result=d,this.Rs)return this.Ss(e,t,l,d.size)}))})).next((()=>a.result))}Ss(e,t,r,s){return r.documentReadCount<this.Vs?(wa()<=De.DEBUG&&te("QueryEngine","SDK will not create cache indexes for query:",Ea(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),z.resolve()):(wa()<=De.DEBUG&&te("QueryEngine","Query:",Ea(t),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.fs*s?(wa()<=De.DEBUG&&te("QueryEngine","The SDK decides to create cache indexes for query:",Ea(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Un(t))):z.resolve())}ps(e,t){if(_w(t))return z.resolve(null);let r=Un(t);return this.indexManager.getIndexType(e,r).next((s=>s===0?null:(t.limit!==null&&s===1&&(t=rh(t,null,"F"),r=Un(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((a=>{const l=Ce(...a);return this.gs.getDocuments(e,l).next((d=>this.indexManager.getMinOffset(e,r).next((f=>{const m=this.bs(t,d);return this.Ds(t,m,l,f.readTime)?this.ps(e,rh(t,null,"F")):this.vs(e,m,t,f)}))))})))))}ys(e,t,r,s){return _w(t)||s.isEqual(we.min())?z.resolve(null):this.gs.getDocuments(e,r).next((a=>{const l=this.bs(t,a);return this.Ds(t,l,r,s)?z.resolve(null):(wa()<=De.DEBUG&&te("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Ea(t)),this.vs(e,l,t,bA(s,ku)).next((d=>d)))}))}bs(e,t){let r=new Ge(_I(e));return t.forEach(((s,a)=>{Ku(e,a)&&(r=r.add(a))})),r}Ds(e,t,r,s){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const a=e.limitType==="F"?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(s)>0)}ws(e,t,r){return wa()<=De.DEBUG&&te("QueryEngine","Using full collection scan to execute query:",Ea(t)),this.gs.getDocumentsMatchingQuery(e,t,Sn.min(),r)}vs(e,t,r,s){return this.gs.getDocumentsMatchingQuery(e,r,s).next((a=>(t.forEach((l=>{a=a.insert(l.key,l)})),a)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Eg="LocalStore",kC=3e8;class bC{constructor(e,t,r,s){this.persistence=e,this.Cs=t,this.serializer=s,this.Fs=new at(Te),this.Ms=new pi((a=>ao(a)),Wu),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(r)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new sx(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Fs)))}}function ax(n,e,t,r){return new bC(n,e,t,r)}async function lx(n,e){const t=be(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next((a=>(s=a,t.Ns(e),t.mutationQueue.getAllMutationBatches(r)))).next((a=>{const l=[],d=[];let f=Ce();for(const m of s){l.push(m.batchId);for(const v of m.mutations)f=f.add(v.key)}for(const m of a){d.push(m.batchId);for(const v of m.mutations)f=f.add(v.key)}return t.localDocuments.getDocuments(r,f).next((m=>({Bs:m,removedBatchIds:l,addedBatchIds:d})))}))}))}function AC(n,e){const t=be(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const s=e.batch.keys(),a=t.Os.newChangeBuffer({trackRemovals:!0});return(function(d,f,m,v){const _=m.batch,x=_.keys();let S=z.resolve();return x.forEach((D=>{S=S.next((()=>v.getEntry(f,D))).next((U=>{const L=m.docVersions.get(D);ve(L!==null,48541),U.version.compareTo(L)<0&&(_.applyToRemoteDocument(U,m),U.isValidDocument()&&(U.setReadTime(m.commitVersion),v.addEntry(U)))}))})),S.next((()=>d.mutationQueue.removeMutationBatch(f,_)))})(t,r,e,a).next((()=>a.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(d){let f=Ce();for(let m=0;m<d.mutationResults.length;++m)d.mutationResults[m].transformResults.length>0&&(f=f.add(d.batch.mutations[m].key));return f})(e)))).next((()=>t.localDocuments.getDocuments(r,s)))}))}function ux(n){const e=be(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.hi.getLastRemoteSnapshotVersion(t)))}function RC(n,e){const t=be(n),r=e.snapshotVersion;let s=t.Fs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(a=>{const l=t.Os.newChangeBuffer({trackRemovals:!0});s=t.Fs;const d=[];e.targetChanges.forEach(((v,_)=>{const x=s.get(_);if(!x)return;d.push(t.hi.removeMatchingKeys(a,v.removedDocuments,_).next((()=>t.hi.addMatchingKeys(a,v.addedDocuments,_))));let S=x.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(_)!==null?S=S.withResumeToken(It.EMPTY_BYTE_STRING,we.min()).withLastLimboFreeSnapshotVersion(we.min()):v.resumeToken.approximateByteSize()>0&&(S=S.withResumeToken(v.resumeToken,r)),s=s.insert(_,S),(function(U,L,K){return U.resumeToken.approximateByteSize()===0||L.snapshotVersion.toMicroseconds()-U.snapshotVersion.toMicroseconds()>=kC?!0:K.addedDocuments.size+K.modifiedDocuments.size+K.removedDocuments.size>0})(x,S,v)&&d.push(t.hi.updateTargetData(a,S))}));let f=xn(),m=Ce();if(e.documentUpdates.forEach((v=>{e.resolvedLimboDocuments.has(v)&&d.push(t.persistence.referenceDelegate.updateLimboDocument(a,v))})),d.push(CC(a,l,e.documentUpdates).next((v=>{f=v.Ls,m=v.ks}))),!r.isEqual(we.min())){const v=t.hi.getLastRemoteSnapshotVersion(a).next((_=>t.hi.setTargetsMetadata(a,a.currentSequenceNumber,r)));d.push(v)}return z.waitFor(d).next((()=>l.apply(a))).next((()=>t.localDocuments.getLocalViewOfDocuments(a,f,m))).next((()=>f))})).then((a=>(t.Fs=s,a)))}function CC(n,e,t){let r=Ce(),s=Ce();return t.forEach((a=>r=r.add(a))),e.getEntries(n,r).next((a=>{let l=xn();return t.forEach(((d,f)=>{const m=a.get(d);f.isFoundDocument()!==m.isFoundDocument()&&(s=s.add(d)),f.isNoDocument()&&f.version.isEqual(we.min())?(e.removeEntry(d,f.readTime),l=l.insert(d,f)):!m.isValidDocument()||f.version.compareTo(m.version)>0||f.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(f),l=l.insert(d,f)):te(Eg,"Ignoring outdated watch update for ",d,". Current version:",m.version," Watch version:",f.version)})),{Ls:l,ks:s}}))}function PC(n,e){const t=be(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=Zs),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function NC(n,e){const t=be(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let s;return t.hi.getTargetData(r,e).next((a=>a?(s=a,z.resolve(s)):t.hi.allocateTargetId(r).next((l=>(s=new si(e,l,"TargetPurposeListen",r.currentSequenceNumber),t.hi.addTargetData(r,s).next((()=>s)))))))})).then((r=>{const s=t.Fs.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.Fs=t.Fs.insert(r.targetId,r),t.Ms.set(e,r.targetId)),r}))}async function Am(n,e,t){const r=be(n),s=r.Fs.get(e),a=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",a,(l=>r.persistence.referenceDelegate.removeTarget(l,s)))}catch(l){if(!hs(l))throw l;te(Eg,`Failed to update sequence numbers for target ${e}: ${l}`)}r.Fs=r.Fs.remove(e),r.Ms.delete(s.target)}function Xw(n,e,t){const r=be(n);let s=we.min(),a=Ce();return r.persistence.runTransaction("Execute query","readwrite",(l=>(function(f,m,v){const _=be(f),x=_.Ms.get(v);return x!==void 0?z.resolve(_.Fs.get(x)):_.hi.getTargetData(m,v)})(r,l,Un(e)).next((d=>{if(d)return s=d.lastLimboFreeSnapshotVersion,r.hi.getMatchingKeysForTargetId(l,d.targetId).next((f=>{a=f}))})).next((()=>r.Cs.getDocumentsMatchingQuery(l,e,t?s:we.min(),t?a:Ce()))).next((d=>(DC(r,_R(e),d),{documents:d,qs:a})))))}function DC(n,e,t){let r=n.xs.get(e)||we.min();t.forEach(((s,a)=>{a.readTime.compareTo(r)>0&&(r=a.readTime)})),n.xs.set(e,r)}class Yw{constructor(){this.activeTargetIds=SR()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class cx{constructor(){this.Fo=new Yw,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,t,r){this.Mo[e]=t}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new Yw,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VC{xo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jw="ConnectivityMonitor";class Zw{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){te(Jw,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){te(Jw,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let bd=null;function Rm(){return bd===null?bd=(function(){return 268435456+Math.round(2147483648*Math.random())})():bd++,"0x"+bd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kp="RestConnection",OC={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class LC{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.$o=t+"://"+e.host,this.Uo=`projects/${r}/databases/${s}`,this.Ko=this.databaseId.database===eh?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Wo(e,t,r,s,a){const l=Rm(),d=this.Go(e,t.toUriEncodedString());te(Kp,`Sending RPC '${e}' ${l}:`,d,r);const f={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(f,s,a);const{host:m}=new URL(d),v=Xa(m);return this.jo(e,d,f,r,v).then((_=>(te(Kp,`Received RPC '${e}' ${l}: `,_),_)),(_=>{throw Or(Kp,`RPC '${e}' ${l} failed with error: `,_,"url: ",d,"request:",r),_}))}Jo(e,t,r,s,a,l){return this.Wo(e,t,r,s,a)}zo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Ja})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((s,a)=>e[a]=s)),r&&r.headers.forEach(((s,a)=>e[a]=s))}Go(e,t){const r=OC[e];return`${this.$o}/v1/${t}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MC{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wt="WebChannelConnection";class jC extends LC{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,t,r,s,a){const l=Rm();return new Promise(((d,f)=>{const m=new RE;m.setWithCredentials(!0),m.listenOnce(CE.COMPLETE,(()=>{try{switch(m.getLastErrorCode()){case Pd.NO_ERROR:const _=m.getResponseJson();te(Wt,`XHR for RPC '${e}' ${l} received:`,JSON.stringify(_)),d(_);break;case Pd.TIMEOUT:te(Wt,`RPC '${e}' ${l} timed out`),f(new se(Q.DEADLINE_EXCEEDED,"Request time out"));break;case Pd.HTTP_ERROR:const x=m.getStatus();if(te(Wt,`RPC '${e}' ${l} failed with status:`,x,"response text:",m.getResponseText()),x>0){let S=m.getResponseJson();Array.isArray(S)&&(S=S[0]);const D=S==null?void 0:S.error;if(D&&D.status&&D.message){const U=(function(K){const X=K.toLowerCase().replace(/_/g,"-");return Object.values(Q).indexOf(X)>=0?X:Q.UNKNOWN})(D.status);f(new se(U,D.message))}else f(new se(Q.UNKNOWN,"Server responded with status "+m.getStatus()))}else f(new se(Q.UNAVAILABLE,"Connection failed."));break;default:me(9055,{c_:e,streamId:l,l_:m.getLastErrorCode(),h_:m.getLastError()})}}finally{te(Wt,`RPC '${e}' ${l} completed.`)}}));const v=JSON.stringify(s);te(Wt,`RPC '${e}' ${l} sending request:`,s),m.send(t,"POST",v,r,15)}))}P_(e,t,r){const s=Rm(),a=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],l=DE(),d=NE(),f={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;m!==void 0&&(f.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(f.useFetchStreams=!0),this.zo(f.initMessageHeaders,t,r),f.encodeInitMessageHeaders=!0;const v=a.join("");te(Wt,`Creating RPC '${e}' stream ${s}: ${v}`,f);const _=l.createWebChannel(v,f);this.T_(_);let x=!1,S=!1;const D=new MC({Ho:L=>{S?te(Wt,`Not sending because RPC '${e}' stream ${s} is closed:`,L):(x||(te(Wt,`Opening RPC '${e}' stream ${s} transport.`),_.open(),x=!0),te(Wt,`RPC '${e}' stream ${s} sending:`,L),_.send(L))},Yo:()=>_.close()}),U=(L,K,X)=>{L.listen(K,(q=>{try{X(q)}catch(ne){setTimeout((()=>{throw ne}),0)}}))};return U(_,lu.EventType.OPEN,(()=>{S||(te(Wt,`RPC '${e}' stream ${s} transport opened.`),D.s_())})),U(_,lu.EventType.CLOSE,(()=>{S||(S=!0,te(Wt,`RPC '${e}' stream ${s} transport closed`),D.__(),this.I_(_))})),U(_,lu.EventType.ERROR,(L=>{S||(S=!0,Or(Wt,`RPC '${e}' stream ${s} transport errored. Name:`,L.name,"Message:",L.message),D.__(new se(Q.UNAVAILABLE,"The operation could not be completed")))})),U(_,lu.EventType.MESSAGE,(L=>{var K;if(!S){const X=L.data[0];ve(!!X,16349);const q=X,ne=(q==null?void 0:q.error)||((K=q[0])===null||K===void 0?void 0:K.error);if(ne){te(Wt,`RPC '${e}' stream ${s} received error:`,ne);const ue=ne.status;let ce=(function(R){const P=vt[R];if(P!==void 0)return NI(P)})(ue),C=ne.message;ce===void 0&&(ce=Q.INTERNAL,C="Unknown error status: "+ue+" with message "+ne.message),S=!0,D.__(new se(ce,C)),_.close()}else te(Wt,`RPC '${e}' stream ${s} received:`,X),D.a_(X)}})),U(d,PE.STAT_EVENT,(L=>{L.stat===lm.PROXY?te(Wt,`RPC '${e}' stream ${s} detected buffering proxy`):L.stat===lm.NOPROXY&&te(Wt,`RPC '${e}' stream ${s} detected no buffering proxy`)})),setTimeout((()=>{D.o_()}),0),D}terminate(){this.u_.forEach((e=>e.close())),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter((t=>t===e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FC(){return typeof window<"u"?window:null}function Bd(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $h(n){return new UR(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dx{constructor(e,t,r=1e3,s=1.5,a=6e4){this.Fi=e,this.timerId=t,this.d_=r,this.E_=s,this.A_=a,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const t=Math.floor(this.R_+this.p_()),r=Math.max(0,Date.now()-this.m_),s=Math.max(0,t-r);s>0&&te("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.R_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,s,(()=>(this.m_=Date.now(),e()))),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e0="PersistentStream";class hx{constructor(e,t,r,s,a,l,d,f){this.Fi=e,this.w_=r,this.S_=s,this.connection=a,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=d,this.listener=f,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new dx(e,t)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,(()=>this.L_())))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():t&&t.code===Q.RESOURCE_EXHAUSTED?(tn(t.toString()),tn("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):t&&t.code===Q.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(t)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),t=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,s])=>{this.b_===t&&this.W_(r,s)}),(r=>{e((()=>{const s=new se(Q.UNKNOWN,"Fetching auth token failed: "+r.message);return this.G_(s)}))}))}W_(e,t){const r=this.K_(this.b_);this.stream=this.z_(e,t),this.stream.Zo((()=>{r((()=>this.listener.Zo()))})),this.stream.e_((()=>{r((()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,(()=>(this.x_()&&(this.state=3),Promise.resolve()))),this.listener.e_())))})),this.stream.n_((s=>{r((()=>this.G_(s)))})),this.stream.onMessage((s=>{r((()=>++this.C_==1?this.j_(s):this.onNext(s)))}))}O_(){this.state=5,this.F_.g_((async()=>{this.state=0,this.start()}))}G_(e){return te(e0,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return t=>{this.Fi.enqueueAndForget((()=>this.b_===e?t():(te(e0,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class UC extends hx{constructor(e,t,r,s,a,l){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,s,l),this.serializer=a}z_(e,t){return this.connection.P_("Listen",e,t)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const t=$R(this.serializer,e),r=(function(a){if(!("targetChange"in a))return we.min();const l=a.targetChange;return l.targetIds&&l.targetIds.length?we.min():l.readTime?rn(l.readTime):we.min()})(e);return this.listener.J_(t,r)}H_(e){const t={};t.database=xm(this.serializer),t.addTarget=(function(a,l){let d;const f=l.target;if(d=th(f)?{documents:UI(a,f)}:{query:BI(a,f).Vt},d.targetId=l.targetId,l.resumeToken.approximateByteSize()>0){d.resumeToken=OI(a,l.resumeToken);const m=Em(a,l.expectedCount);m!==null&&(d.expectedCount=m)}else if(l.snapshotVersion.compareTo(we.min())>0){d.readTime=za(a,l.snapshotVersion.toTimestamp());const m=Em(a,l.expectedCount);m!==null&&(d.expectedCount=m)}return d})(this.serializer,e);const r=HR(this.serializer,e);r&&(t.labels=r),this.k_(t)}Y_(e){const t={};t.database=xm(this.serializer),t.removeTarget=e,this.k_(t)}}class BC extends hx{constructor(e,t,r,s,a,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,s,l),this.serializer=a}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,t){return this.connection.P_("Write",e,t)}j_(e){return ve(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ve(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){ve(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const t=qR(e.writeResults,e.commitTime),r=rn(e.commitTime);return this.listener.ta(r,t)}na(){const e={};e.database=xm(this.serializer),this.k_(e)}X_(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>sh(this.serializer,r)))};this.k_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zC{}class $C extends zC{constructor(e,t,r,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=s,this.ra=!1}ia(){if(this.ra)throw new se(Q.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,r,s){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,l])=>this.connection.Wo(e,Im(t,r),s,a,l))).catch((a=>{throw a.name==="FirebaseError"?(a.code===Q.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new se(Q.UNKNOWN,a.toString())}))}Jo(e,t,r,s,a){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,d])=>this.connection.Jo(e,Im(t,r),s,l,d,a))).catch((l=>{throw l.name==="FirebaseError"?(l.code===Q.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new se(Q.UNKNOWN,l.toString())}))}terminate(){this.ra=!0,this.connection.terminate()}}class qC{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve()))))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(tn(t),this._a=!1):te("OnlineStateTracker",t)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ho="RemoteStore";class HC{constructor(e,t,r,s,a){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=a,this.Ea.xo((l=>{r.enqueueAndForget((async()=>{wo(this)&&(te(ho,"Restarting streams for network reachability change."),await(async function(f){const m=be(f);m.Ia.add(4),await Xu(m),m.Aa.set("Unknown"),m.Ia.delete(4),await qh(m)})(this))}))})),this.Aa=new qC(r,s)}}async function qh(n){if(wo(n))for(const e of n.da)await e(!0)}async function Xu(n){for(const e of n.da)await e(!1)}function fx(n,e){const t=be(n);t.Ta.has(e.targetId)||(t.Ta.set(e.targetId,e),Sg(t)?Tg(t):tl(t).x_()&&xg(t,e))}function Ig(n,e){const t=be(n),r=tl(t);t.Ta.delete(e),r.x_()&&px(t,e),t.Ta.size===0&&(r.x_()?r.B_():wo(t)&&t.Aa.set("Unknown"))}function xg(n,e){if(n.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(we.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}tl(n).H_(e)}function px(n,e){n.Ra.$e(e),tl(n).Y_(e)}function Tg(n){n.Ra=new LR({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>n.Ta.get(e)||null,lt:()=>n.datastore.serializer.databaseId}),tl(n).start(),n.Aa.aa()}function Sg(n){return wo(n)&&!tl(n).M_()&&n.Ta.size>0}function wo(n){return be(n).Ia.size===0}function mx(n){n.Ra=void 0}async function WC(n){n.Aa.set("Online")}async function GC(n){n.Ta.forEach(((e,t)=>{xg(n,e)}))}async function KC(n,e){mx(n),Sg(n)?(n.Aa.la(e),Tg(n)):n.Aa.set("Unknown")}async function QC(n,e,t){if(n.Aa.set("Online"),e instanceof VI&&e.state===2&&e.cause)try{await(async function(s,a){const l=a.cause;for(const d of a.targetIds)s.Ta.has(d)&&(await s.remoteSyncer.rejectListen(d,l),s.Ta.delete(d),s.Ra.removeTarget(d))})(n,e)}catch(r){te(ho,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await ch(n,r)}else if(e instanceof Fd?n.Ra.Ye(e):e instanceof DI?n.Ra.it(e):n.Ra.et(e),!t.isEqual(we.min()))try{const r=await ux(n.localStore);t.compareTo(r)>=0&&await(function(a,l){const d=a.Ra.Pt(l);return d.targetChanges.forEach(((f,m)=>{if(f.resumeToken.approximateByteSize()>0){const v=a.Ta.get(m);v&&a.Ta.set(m,v.withResumeToken(f.resumeToken,l))}})),d.targetMismatches.forEach(((f,m)=>{const v=a.Ta.get(f);if(!v)return;a.Ta.set(f,v.withResumeToken(It.EMPTY_BYTE_STRING,v.snapshotVersion)),px(a,f);const _=new si(v.target,f,m,v.sequenceNumber);xg(a,_)})),a.remoteSyncer.applyRemoteEvent(d)})(n,t)}catch(r){te(ho,"Failed to raise snapshot:",r),await ch(n,r)}}async function ch(n,e,t){if(!hs(e))throw e;n.Ia.add(1),await Xu(n),n.Aa.set("Offline"),t||(t=()=>ux(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{te(ho,"Retrying IndexedDB access"),await t(),n.Ia.delete(1),await qh(n)}))}function gx(n,e){return e().catch((t=>ch(n,t,e)))}async function Yu(n){const e=be(n),t=ls(e);let r=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:Zs;for(;XC(e);)try{const s=await PC(e.localStore,r);if(s===null){e.Pa.length===0&&t.B_();break}r=s.batchId,YC(e,s)}catch(s){await ch(e,s)}yx(e)&&vx(e)}function XC(n){return wo(n)&&n.Pa.length<10}function YC(n,e){n.Pa.push(e);const t=ls(n);t.x_()&&t.Z_&&t.X_(e.mutations)}function yx(n){return wo(n)&&!ls(n).M_()&&n.Pa.length>0}function vx(n){ls(n).start()}async function JC(n){ls(n).na()}async function ZC(n){const e=ls(n);for(const t of n.Pa)e.X_(t.mutations)}async function eP(n,e,t){const r=n.Pa.shift(),s=dg.from(r,e,t);await gx(n,(()=>n.remoteSyncer.applySuccessfulWrite(s))),await Yu(n)}async function tP(n,e){e&&ls(n).Z_&&await(async function(r,s){if((function(l){return VR(l)&&l!==Q.ABORTED})(s.code)){const a=r.Pa.shift();ls(r).N_(),await gx(r,(()=>r.remoteSyncer.rejectFailedWrite(a.batchId,s))),await Yu(r)}})(n,e),yx(n)&&vx(n)}async function t0(n,e){const t=be(n);t.asyncQueue.verifyOperationInProgress(),te(ho,"RemoteStore received new credentials");const r=wo(t);t.Ia.add(3),await Xu(t),r&&t.Aa.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ia.delete(3),await qh(t)}async function nP(n,e){const t=be(n);e?(t.Ia.delete(2),await qh(t)):e||(t.Ia.add(2),await Xu(t),t.Aa.set("Unknown"))}function tl(n){return n.Va||(n.Va=(function(t,r,s){const a=be(t);return a.ia(),new UC(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)})(n.datastore,n.asyncQueue,{Zo:WC.bind(null,n),e_:GC.bind(null,n),n_:KC.bind(null,n),J_:QC.bind(null,n)}),n.da.push((async e=>{e?(n.Va.N_(),Sg(n)?Tg(n):n.Aa.set("Unknown")):(await n.Va.stop(),mx(n))}))),n.Va}function ls(n){return n.ma||(n.ma=(function(t,r,s){const a=be(t);return a.ia(),new BC(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),e_:JC.bind(null,n),n_:tP.bind(null,n),ea:ZC.bind(null,n),ta:eP.bind(null,n)}),n.da.push((async e=>{e?(n.ma.N_(),await Yu(n)):(await n.ma.stop(),n.Pa.length>0&&(te(ho,`Stopping write stream with ${n.Pa.length} pending writes`),n.Pa=[]))}))),n.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kg{constructor(e,t,r,s,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=s,this.removalCallback=a,this.deferred=new Cr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((l=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,s,a){const l=Date.now()+r,d=new kg(e,t,l,s,a);return d.start(r),d}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new se(Q.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function bg(n,e){if(tn("AsyncQueue",`${e}: ${n}`),hs(n))return new se(Q.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ka{static emptySet(e){return new ka(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||le.comparator(t.key,r.key):(t,r)=>le.comparator(t.key,r.key),this.keyedMap=uu(),this.sortedSet=new at(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof ka)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,a=r.getNext().key;if(!s.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new ka;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n0{constructor(){this.fa=new at(le.comparator)}track(e){const t=e.doc.key,r=this.fa.get(t);r?e.type!==0&&r.type===3?this.fa=this.fa.insert(t,e):e.type===3&&r.type!==1?this.fa=this.fa.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.fa=this.fa.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.fa=this.fa.remove(t):e.type===1&&r.type===2?this.fa=this.fa.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):me(63341,{At:e,ga:r}):this.fa=this.fa.insert(t,e)}pa(){const e=[];return this.fa.inorderTraversal(((t,r)=>{e.push(r)})),e}}class $a{constructor(e,t,r,s,a,l,d,f,m){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=a,this.fromCache=l,this.syncStateChanged=d,this.excludesMetadataChanges=f,this.hasCachedResults=m}static fromInitialDocuments(e,t,r,s,a){const l=[];return t.forEach((d=>{l.push({type:0,doc:d})})),new $a(e,t,ka.emptySet(t),l,r,s,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Oh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==r[s].type||!t[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rP{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some((e=>e.ba()))}}class iP{constructor(){this.queries=r0(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(t,r){const s=be(t),a=s.queries;s.queries=r0(),a.forEach(((l,d)=>{for(const f of d.wa)f.onError(r)}))})(this,new se(Q.ABORTED,"Firestore shutting down"))}}function r0(){return new pi((n=>vI(n)),Oh)}async function Ag(n,e){const t=be(n);let r=3;const s=e.query;let a=t.queries.get(s);a?!a.Sa()&&e.ba()&&(r=2):(a=new rP,r=e.ba()?0:1);try{switch(r){case 0:a.ya=await t.onListen(s,!0);break;case 1:a.ya=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(l){const d=bg(l,`Initialization of query '${Ea(e.query)}' failed`);return void e.onError(d)}t.queries.set(s,a),a.wa.push(e),e.va(t.onlineState),a.ya&&e.Ca(a.ya)&&Cg(t)}async function Rg(n,e){const t=be(n),r=e.query;let s=3;const a=t.queries.get(r);if(a){const l=a.wa.indexOf(e);l>=0&&(a.wa.splice(l,1),a.wa.length===0?s=e.ba()?0:1:!a.Sa()&&e.ba()&&(s=2))}switch(s){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function sP(n,e){const t=be(n);let r=!1;for(const s of e){const a=s.query,l=t.queries.get(a);if(l){for(const d of l.wa)d.Ca(s)&&(r=!0);l.ya=s}}r&&Cg(t)}function oP(n,e,t){const r=be(n),s=r.queries.get(e);if(s)for(const a of s.wa)a.onError(t);r.queries.delete(e)}function Cg(n){n.Da.forEach((e=>{e.next()}))}var Cm,i0;(i0=Cm||(Cm={})).Fa="default",i0.Cache="cache";class Pg{constructor(e,t,r){this.query=e,this.Ma=t,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=r||{}}Ca(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new $a(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),t=!0):this.Ba(e,this.onlineState)&&(this.La(e),t=!0),this.Oa=e,t}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let t=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),t=!0),t}Ba(e,t){if(!e.fromCache||!this.ba())return!0;const r=t!=="Offline";return(!this.options.ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Na(e){if(e.docChanges.length>0)return!0;const t=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}La(e){e=$a.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==Cm.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _x{constructor(e){this.key=e}}class wx{constructor(e){this.key=e}}class aP{constructor(e,t){this.query=e,this.Ha=t,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=Ce(),this.mutatedKeys=Ce(),this.Xa=_I(e),this.eu=new ka(this.Xa)}get tu(){return this.Ha}nu(e,t){const r=t?t.ru:new n0,s=t?t.eu:this.eu;let a=t?t.mutatedKeys:this.mutatedKeys,l=s,d=!1;const f=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,m=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal(((v,_)=>{const x=s.get(v),S=Ku(this.query,_)?_:null,D=!!x&&this.mutatedKeys.has(x.key),U=!!S&&(S.hasLocalMutations||this.mutatedKeys.has(S.key)&&S.hasCommittedMutations);let L=!1;x&&S?x.data.isEqual(S.data)?D!==U&&(r.track({type:3,doc:S}),L=!0):this.iu(x,S)||(r.track({type:2,doc:S}),L=!0,(f&&this.Xa(S,f)>0||m&&this.Xa(S,m)<0)&&(d=!0)):!x&&S?(r.track({type:0,doc:S}),L=!0):x&&!S&&(r.track({type:1,doc:x}),L=!0,(f||m)&&(d=!0)),L&&(S?(l=l.add(S),a=U?a.add(v):a.delete(v)):(l=l.delete(v),a=a.delete(v)))})),this.query.limit!==null)for(;l.size>this.query.limit;){const v=this.query.limitType==="F"?l.last():l.first();l=l.delete(v.key),a=a.delete(v.key),r.track({type:1,doc:v})}return{eu:l,ru:r,Ds:d,mutatedKeys:a}}iu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,s){const a=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const l=e.ru.pa();l.sort(((v,_)=>(function(S,D){const U=L=>{switch(L){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return me(20277,{At:L})}};return U(S)-U(D)})(v.type,_.type)||this.Xa(v.doc,_.doc))),this.su(r),s=s!=null&&s;const d=t&&!s?this.ou():[],f=this.Za.size===0&&this.current&&!s?1:0,m=f!==this.Ya;return this.Ya=f,l.length!==0||m?{snapshot:new $a(this.query,e.eu,a,l,e.mutatedKeys,f===0,m,!1,!!r&&r.resumeToken.approximateByteSize()>0),_u:d}:{_u:d}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new n0,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach((t=>this.Ha=this.Ha.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ha=this.Ha.delete(t))),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=Ce(),this.eu.forEach((r=>{this.au(r.key)&&(this.Za=this.Za.add(r.key))}));const t=[];return e.forEach((r=>{this.Za.has(r)||t.push(new wx(r))})),this.Za.forEach((r=>{e.has(r)||t.push(new _x(r))})),t}uu(e){this.Ha=e.qs,this.Za=Ce();const t=this.nu(e.documents);return this.applyChanges(t,!0)}cu(){return $a.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const Ng="SyncEngine";class lP{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class uP{constructor(e){this.key=e,this.lu=!1}}class cP{constructor(e,t,r,s,a,l){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=s,this.currentUser=a,this.maxConcurrentLimboResolutions=l,this.hu={},this.Pu=new pi((d=>vI(d)),Oh),this.Tu=new Map,this.Iu=new Set,this.du=new at(le.comparator),this.Eu=new Map,this.Au=new yg,this.Ru={},this.Vu=new Map,this.mu=co.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function dP(n,e,t=!0){const r=kx(n);let s;const a=r.Pu.get(e);return a?(r.sharedClientState.addLocalQueryTarget(a.targetId),s=a.view.cu()):s=await Ex(r,e,t,!0),s}async function hP(n,e){const t=kx(n);await Ex(t,e,!0,!1)}async function Ex(n,e,t,r){const s=await NC(n.localStore,Un(e)),a=s.targetId,l=n.sharedClientState.addLocalQueryTarget(a,t);let d;return r&&(d=await fP(n,e,a,l==="current",s.resumeToken)),n.isPrimaryClient&&t&&fx(n.remoteStore,s),d}async function fP(n,e,t,r,s){n.gu=(_,x,S)=>(async function(U,L,K,X){let q=L.view.nu(K);q.Ds&&(q=await Xw(U.localStore,L.query,!1).then((({documents:C})=>L.view.nu(C,q))));const ne=X&&X.targetChanges.get(L.targetId),ue=X&&X.targetMismatches.get(L.targetId)!=null,ce=L.view.applyChanges(q,U.isPrimaryClient,ne,ue);return o0(U,L.targetId,ce._u),ce.snapshot})(n,_,x,S);const a=await Xw(n.localStore,e,!0),l=new aP(e,a.qs),d=l.nu(a.documents),f=Qu.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",s),m=l.applyChanges(d,n.isPrimaryClient,f);o0(n,t,m._u);const v=new lP(e,t,l);return n.Pu.set(e,v),n.Tu.has(t)?n.Tu.get(t).push(e):n.Tu.set(t,[e]),m.snapshot}async function pP(n,e,t){const r=be(n),s=r.Pu.get(e),a=r.Tu.get(s.targetId);if(a.length>1)return r.Tu.set(s.targetId,a.filter((l=>!Oh(l,e)))),void r.Pu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Am(r.localStore,s.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(s.targetId),t&&Ig(r.remoteStore,s.targetId),Pm(r,s.targetId)})).catch(_o)):(Pm(r,s.targetId),await Am(r.localStore,s.targetId,!0))}async function mP(n,e){const t=be(n),r=t.Pu.get(e),s=t.Tu.get(r.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Ig(t.remoteStore,r.targetId))}async function gP(n,e,t){const r=bx(n);try{const s=await(function(l,d){const f=be(l),m=He.now(),v=d.reduce(((S,D)=>S.add(D.key)),Ce());let _,x;return f.persistence.runTransaction("Locally write mutations","readwrite",(S=>{let D=xn(),U=Ce();return f.Os.getEntries(S,v).next((L=>{D=L,D.forEach(((K,X)=>{X.isValidDocument()||(U=U.add(K))}))})).next((()=>f.localDocuments.getOverlayedDocuments(S,D))).next((L=>{_=L;const K=[];for(const X of d){const q=NR(X,_.get(X.key).overlayedDocument);q!=null&&K.push(new mi(X.key,q,uI(q.value.mapValue),Qt.exists(!0)))}return f.mutationQueue.addMutationBatch(S,m,K,d)})).next((L=>{x=L;const K=L.applyToLocalDocumentSet(_,U);return f.documentOverlayCache.saveOverlays(S,L.batchId,K)}))})).then((()=>({batchId:x.batchId,changes:EI(_)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),(function(l,d,f){let m=l.Ru[l.currentUser.toKey()];m||(m=new at(Te)),m=m.insert(d,f),l.Ru[l.currentUser.toKey()]=m})(r,s.batchId,t),await Ju(r,s.changes),await Yu(r.remoteStore)}catch(s){const a=bg(s,"Failed to persist write");t.reject(a)}}async function Ix(n,e){const t=be(n);try{const r=await RC(t.localStore,e);e.targetChanges.forEach(((s,a)=>{const l=t.Eu.get(a);l&&(ve(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?l.lu=!0:s.modifiedDocuments.size>0?ve(l.lu,14607):s.removedDocuments.size>0&&(ve(l.lu,42227),l.lu=!1))})),await Ju(t,r,e)}catch(r){await _o(r)}}function s0(n,e,t){const r=be(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const s=[];r.Pu.forEach(((a,l)=>{const d=l.view.va(e);d.snapshot&&s.push(d.snapshot)})),(function(l,d){const f=be(l);f.onlineState=d;let m=!1;f.queries.forEach(((v,_)=>{for(const x of _.wa)x.va(d)&&(m=!0)})),m&&Cg(f)})(r.eventManager,e),s.length&&r.hu.J_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function yP(n,e,t){const r=be(n);r.sharedClientState.updateQueryState(e,"rejected",t);const s=r.Eu.get(e),a=s&&s.key;if(a){let l=new at(le.comparator);l=l.insert(a,ht.newNoDocument(a,we.min()));const d=Ce().add(a),f=new Fh(we.min(),new Map,new at(Te),l,d);await Ix(r,f),r.du=r.du.remove(a),r.Eu.delete(e),Dg(r)}else await Am(r.localStore,e,!1).then((()=>Pm(r,e,t))).catch(_o)}async function vP(n,e){const t=be(n),r=e.batch.batchId;try{const s=await AC(t.localStore,e);Tx(t,r,null),xx(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Ju(t,s)}catch(s){await _o(s)}}async function _P(n,e,t){const r=be(n);try{const s=await(function(l,d){const f=be(l);return f.persistence.runTransaction("Reject batch","readwrite-primary",(m=>{let v;return f.mutationQueue.lookupMutationBatch(m,d).next((_=>(ve(_!==null,37113),v=_.keys(),f.mutationQueue.removeMutationBatch(m,_)))).next((()=>f.mutationQueue.performConsistencyCheck(m))).next((()=>f.documentOverlayCache.removeOverlaysForBatchId(m,v,d))).next((()=>f.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,v))).next((()=>f.localDocuments.getDocuments(m,v)))}))})(r.localStore,e);Tx(r,e,t),xx(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Ju(r,s)}catch(s){await _o(s)}}function xx(n,e){(n.Vu.get(e)||[]).forEach((t=>{t.resolve()})),n.Vu.delete(e)}function Tx(n,e,t){const r=be(n);let s=r.Ru[r.currentUser.toKey()];if(s){const a=s.get(e);a&&(t?a.reject(t):a.resolve(),s=s.remove(e)),r.Ru[r.currentUser.toKey()]=s}}function Pm(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Tu.get(e))n.Pu.delete(r),t&&n.hu.pu(r,t);n.Tu.delete(e),n.isPrimaryClient&&n.Au.zr(e).forEach((r=>{n.Au.containsKey(r)||Sx(n,r)}))}function Sx(n,e){n.Iu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(Ig(n.remoteStore,t),n.du=n.du.remove(e),n.Eu.delete(t),Dg(n))}function o0(n,e,t){for(const r of t)r instanceof _x?(n.Au.addReference(r.key,e),wP(n,r)):r instanceof wx?(te(Ng,"Document no longer in limbo: "+r.key),n.Au.removeReference(r.key,e),n.Au.containsKey(r.key)||Sx(n,r.key)):me(19791,{yu:r})}function wP(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Iu.has(r)||(te(Ng,"New document in limbo: "+t),n.Iu.add(r),Dg(n))}function Dg(n){for(;n.Iu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Iu.values().next().value;n.Iu.delete(e);const t=new le($e.fromString(e)),r=n.mu.next();n.Eu.set(r,new uP(t)),n.du=n.du.insert(t,r),fx(n.remoteStore,new si(Un(Gu(t.path)),r,"TargetPurposeLimboResolution",jn.ue))}}async function Ju(n,e,t){const r=be(n),s=[],a=[],l=[];r.Pu.isEmpty()||(r.Pu.forEach(((d,f)=>{l.push(r.gu(f,e,t).then((m=>{var v;if((m||t)&&r.isPrimaryClient){const _=m?!m.fromCache:(v=t==null?void 0:t.targetChanges.get(f.targetId))===null||v===void 0?void 0:v.current;r.sharedClientState.updateQueryState(f.targetId,_?"current":"not-current")}if(m){s.push(m);const _=wg.Es(f.targetId,m);a.push(_)}})))})),await Promise.all(l),r.hu.J_(s),await(async function(f,m){const v=be(f);try{await v.persistence.runTransaction("notifyLocalViewChanges","readwrite",(_=>z.forEach(m,(x=>z.forEach(x.Is,(S=>v.persistence.referenceDelegate.addReference(_,x.targetId,S))).next((()=>z.forEach(x.ds,(S=>v.persistence.referenceDelegate.removeReference(_,x.targetId,S)))))))))}catch(_){if(!hs(_))throw _;te(Eg,"Failed to update sequence numbers: "+_)}for(const _ of m){const x=_.targetId;if(!_.fromCache){const S=v.Fs.get(x),D=S.snapshotVersion,U=S.withLastLimboFreeSnapshotVersion(D);v.Fs=v.Fs.insert(x,U)}}})(r.localStore,a))}async function EP(n,e){const t=be(n);if(!t.currentUser.isEqual(e)){te(Ng,"User change. New user:",e.toKey());const r=await lx(t.localStore,e);t.currentUser=e,(function(a,l){a.Vu.forEach((d=>{d.forEach((f=>{f.reject(new se(Q.CANCELLED,l))}))})),a.Vu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Ju(t,r.Bs)}}function IP(n,e){const t=be(n),r=t.Eu.get(e);if(r&&r.lu)return Ce().add(r.key);{let s=Ce();const a=t.Tu.get(e);if(!a)return s;for(const l of a){const d=t.Pu.get(l);s=s.unionWith(d.view.tu)}return s}}function kx(n){const e=be(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Ix.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=IP.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=yP.bind(null,e),e.hu.J_=sP.bind(null,e.eventManager),e.hu.pu=oP.bind(null,e.eventManager),e}function bx(n){const e=be(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=vP.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=_P.bind(null,e),e}class ju{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=$h(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,t){return null}Fu(e,t){return null}vu(e){return ax(this.persistence,new ox,e.initialUser,this.serializer)}Du(e){return new vg(zh.Vi,this.serializer)}bu(e){return new cx}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}ju.provider={build:()=>new ju};class xP extends ju{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,t){ve(this.persistence.referenceDelegate instanceof uh,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new tx(r,e.asyncQueue,t)}Du(e){const t=this.cacheSizeBytes!==void 0?Gt.withCacheSize(this.cacheSizeBytes):Gt.DEFAULT;return new vg((r=>uh.Vi(r,t)),this.serializer)}}class TP extends ju{constructor(e,t,r){super(),this.Mu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Mu.initialize(this,e),await bx(this.Mu.syncEngine),await Yu(this.Mu.remoteStore),await this.persistence.ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return ax(this.persistence,new ox,e.initialUser,this.serializer)}Cu(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new tx(r,e.asyncQueue,t)}Fu(e,t){const r=new PA(t,this.persistence);return new CA(e.asyncQueue,r)}Du(e){const t=TC(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Gt.withCacheSize(this.cacheSizeBytes):Gt.DEFAULT;return new _g(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,FC(),Bd(),this.serializer,this.sharedClientState,!!this.forceOwnership)}bu(e){return new cx}}class dh{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>s0(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=EP.bind(null,this.syncEngine),await nP(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new iP})()}createDatastore(e){const t=$h(e.databaseInfo.databaseId),r=(function(a){return new jC(a)})(e.databaseInfo);return(function(a,l,d,f){return new $C(a,l,d,f)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,s,a,l,d){return new HC(r,s,a,l,d)})(this.localStore,this.datastore,e.asyncQueue,(t=>s0(this.syncEngine,t,0)),(function(){return Zw.C()?new Zw:new VC})())}createSyncEngine(e,t){return(function(s,a,l,d,f,m,v){const _=new cP(s,a,l,d,f,m);return v&&(_.fu=!0),_})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(s){const a=be(s);te(ho,"RemoteStore shutting down."),a.Ia.add(5),await Xu(a),a.Ea.shutdown(),a.Aa.set("Unknown")})(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}dh.provider={build:()=>new dh};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vg{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):tn("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const us="FirestoreClient";class SP{constructor(e,t,r,s,a){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=s,this.user=Ut.UNAUTHENTICATED,this.clientId=Jm.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(r,(async l=>{te(us,"Received user=",l.uid),await this.authCredentialListener(l),this.user=l})),this.appCheckCredentials.start(r,(l=>(te(us,"Received new app check token=",l),this.appCheckCredentialListener(l,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Cr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=bg(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function Qp(n,e){n.asyncQueue.verifyOperationInProgress(),te(us,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async s=>{r.isEqual(s)||(await lx(e.localStore,s),r=s)})),e.persistence.setDatabaseDeletedListener((()=>{Or("Terminating Firestore due to IndexedDb database deletion"),n.terminate().then((()=>{te("Terminating Firestore due to IndexedDb database deletion completed successfully")})).catch((s=>{Or("Terminating Firestore due to IndexedDb database deletion failed",s)}))})),n._offlineComponents=e}async function a0(n,e){n.asyncQueue.verifyOperationInProgress();const t=await kP(n);te(us,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>t0(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,s)=>t0(e.remoteStore,s))),n._onlineComponents=e}async function kP(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){te(us,"Using user provided OfflineComponentProvider");try{await Qp(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(s){return s.name==="FirebaseError"?s.code===Q.FAILED_PRECONDITION||s.code===Q.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11})(t))throw t;Or("Error using user provided cache. Falling back to memory cache: "+t),await Qp(n,new ju)}}else te(us,"Using default OfflineComponentProvider"),await Qp(n,new xP(void 0));return n._offlineComponents}async function Ax(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(te(us,"Using user provided OnlineComponentProvider"),await a0(n,n._uninitializedComponentsProvider._online)):(te(us,"Using default OnlineComponentProvider"),await a0(n,new dh))),n._onlineComponents}function bP(n){return Ax(n).then((e=>e.syncEngine))}async function hh(n){const e=await Ax(n),t=e.eventManager;return t.onListen=dP.bind(null,e.syncEngine),t.onUnlisten=pP.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=hP.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=mP.bind(null,e.syncEngine),t}function AP(n,e,t={}){const r=new Cr;return n.asyncQueue.enqueueAndForget((async()=>(function(a,l,d,f,m){const v=new Vg({next:x=>{v.Ou(),l.enqueueAndForget((()=>Rg(a,_)));const S=x.docs.has(d);!S&&x.fromCache?m.reject(new se(Q.UNAVAILABLE,"Failed to get document because the client is offline.")):S&&x.fromCache&&f&&f.source==="server"?m.reject(new se(Q.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(x)},error:x=>m.reject(x)}),_=new Pg(Gu(d.path),v,{includeMetadataChanges:!0,ka:!0});return Ag(a,_)})(await hh(n),n.asyncQueue,e,t,r))),r.promise}function RP(n,e,t={}){const r=new Cr;return n.asyncQueue.enqueueAndForget((async()=>(function(a,l,d,f,m){const v=new Vg({next:x=>{v.Ou(),l.enqueueAndForget((()=>Rg(a,_))),x.fromCache&&f.source==="server"?m.reject(new se(Q.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(x)},error:x=>m.reject(x)}),_=new Pg(d,v,{includeMetadataChanges:!0,ka:!0});return Ag(a,_)})(await hh(n),n.asyncQueue,e,t,r))),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rx(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l0=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cx="firestore.googleapis.com",u0=!0;class c0{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new se(Q.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Cx,this.ssl=u0}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:u0;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=YI;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<aC)throw new se(Q.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}SA("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Rx((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),(function(a){if(a.timeoutSeconds!==void 0){if(isNaN(a.timeoutSeconds))throw new se(Q.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (must not be NaN)`);if(a.timeoutSeconds<5)throw new se(Q.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (minimum allowed value is 5)`);if(a.timeoutSeconds>30)throw new se(Q.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,s){return r.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Hh{constructor(e,t,r,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new c0({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new se(Q.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new se(Q.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new c0(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new gA;switch(r.type){case"firstParty":return new wA(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new se(Q.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=l0.get(t);r&&(te("ComponentProvider","Removing Datastore"),l0.delete(t),r.terminate())})(this),Promise.resolve()}}function CP(n,e,t,r={}){var s;n=nn(n,Hh);const a=Xa(e),l=n._getSettings(),d=Object.assign(Object.assign({},l),{emulatorOptions:n._getEmulatorOptions()}),f=`${e}:${t}`;a&&(gE(`https://${f}`),yE("Firestore",!0)),l.host!==Cx&&l.host!==f&&Or("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const m=Object.assign(Object.assign({},l),{host:f,ssl:a,emulatorOptions:r});if(!ss(m,d)&&(n._setSettings(m),r.mockUserToken)){let v,_;if(typeof r.mockUserToken=="string")v=r.mockUserToken,_=Ut.MOCK_USER;else{v=H1(r.mockUserToken,(s=n._app)===null||s===void 0?void 0:s.options.projectId);const x=r.mockUserToken.sub||r.mockUserToken.user_id;if(!x)throw new se(Q.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");_=new Ut(x)}n._authCredentials=new yA(new OE(v,_))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gi{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new gi(this.firestore,e,this._query)}}class ft{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new rs(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ft(this.firestore,e,this._key)}toJSON(){return{type:ft._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(qu(t,ft._jsonSchema))return new ft(e,r||null,new le($e.fromString(t.referencePath)))}}ft._jsonSchemaVersion="firestore/documentReference/1.0",ft._jsonSchema={type:_t("string",ft._jsonSchemaVersion),referencePath:_t("string")};class rs extends gi{constructor(e,t,r){super(e,t,Gu(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ft(this.firestore,null,new le(e))}withConverter(e){return new rs(this.firestore,e,this._path)}}function kn(n,e,...t){if(n=Et(n),jE("collection","path",e),n instanceof Hh){const r=$e.fromString(e,...t);return ew(r),new rs(n,null,r)}{if(!(n instanceof ft||n instanceof rs))throw new se(Q.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child($e.fromString(e,...t));return ew(r),new rs(n.firestore,null,r)}}function cr(n,e,...t){if(n=Et(n),arguments.length===1&&(e=Jm.newId()),jE("doc","path",e),n instanceof Hh){const r=$e.fromString(e,...t);return Z_(r),new ft(n,null,new le(r))}{if(!(n instanceof ft||n instanceof rs))throw new se(Q.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child($e.fromString(e,...t));return Z_(r),new ft(n.firestore,n instanceof rs?n.converter:null,new le(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d0="AsyncQueue";class h0{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new dx(this,"async_queue_retry"),this.oc=()=>{const r=Bd();r&&te(d0,"Visibility state changed to "+r.visibilityState),this.F_.y_()},this._c=e;const t=Bd();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const t=Bd();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise((()=>{}));const t=new Cr;return this.uc((()=>this.Xu&&this.rc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Zu.push(e),this.cc())))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!hs(e))throw e;te(d0,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_((()=>this.cc()))}}uc(e){const t=this._c.then((()=>(this.nc=!0,e().catch((r=>{throw this.tc=r,this.nc=!1,tn("INTERNAL UNHANDLED ERROR: ",f0(r)),r})).then((r=>(this.nc=!1,r))))));return this._c=t,t}enqueueAfterDelay(e,t,r){this.ac(),this.sc.indexOf(e)>-1&&(t=0);const s=kg.createAndSchedule(this,e,t,r,(a=>this.lc(a)));return this.ec.push(s),s}ac(){this.tc&&me(47125,{hc:f0(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(const t of this.ec)if(t.timerId===e)return!0;return!1}Ic(e){return this.Pc().then((()=>{this.ec.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.ec)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Pc()}))}dc(e){this.sc.push(e)}lc(e){const t=this.ec.indexOf(e);this.ec.splice(t,1)}}function f0(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p0(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;const s=t;for(const a of r)if(a in s&&typeof s[a]=="function")return!0;return!1})(n,["next","error","complete"])}class Mr extends Hh{constructor(e,t,r,s){super(e,t,r,s),this.type="firestore",this._queue=new h0,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new h0(e),this._firestoreClient=void 0,await e}}}function PP(n,e){const t=typeof n=="object"?n:Xm(),r=typeof n=="string"?n:eh,s=vo(t,"firestore").getImmediate({identifier:r});if(!s._initialized){const a=$1("firestore");a&&CP(s,...a)}return s}function Wh(n){if(n._terminated)throw new se(Q.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||Px(n),n._firestoreClient}function Px(n){var e,t,r;const s=n._freezeSettings(),a=(function(d,f,m,v){return new oR(d,f,m,v.host,v.ssl,v.experimentalForceLongPolling,v.experimentalAutoDetectLongPolling,Rx(v.experimentalLongPollingOptions),v.useFetchStreams,v.isUsingEmulator)})(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,s);n._componentsProvider||!((t=s.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),n._firestoreClient=new SP(n._authCredentials,n._appCheckCredentials,n._queue,a,n._componentsProvider&&(function(d){const f=d==null?void 0:d._online.build();return{_offline:d==null?void 0:d._offline.build(f),_online:f}})(n._componentsProvider))}function NP(n,e){Or("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return DP(n,dh.provider,{build:r=>new TP(r,t.cacheSizeBytes,void 0)}),Promise.resolve()}function DP(n,e,t){if((n=nn(n,Mr))._firestoreClient||n._terminated)throw new se(Q.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new se(Q.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},Px(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Mn(It.fromBase64String(e))}catch(t){throw new se(Q.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Mn(It.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Mn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(qu(e,Mn._jsonSchema))return Mn.fromBase64String(e.bytes)}}Mn._jsonSchemaVersion="firestore/bytes/1.0",Mn._jsonSchema={type:_t("string",Mn._jsonSchemaVersion),bytes:_t("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gh{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new se(Q.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ct(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kh{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pr{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new se(Q.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new se(Q.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Te(this._lat,e._lat)||Te(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Pr._jsonSchemaVersion}}static fromJSON(e){if(qu(e,Pr._jsonSchema))return new Pr(e.latitude,e.longitude)}}Pr._jsonSchemaVersion="firestore/geoPoint/1.0",Pr._jsonSchema={type:_t("string",Pr._jsonSchemaVersion),latitude:_t("number"),longitude:_t("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nr{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,s){if(r.length!==s.length)return!1;for(let a=0;a<r.length;++a)if(r[a]!==s[a])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Nr._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(qu(e,Nr._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Nr(e.vectorValues);throw new se(Q.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Nr._jsonSchemaVersion="firestore/vectorValue/1.0",Nr._jsonSchema={type:_t("string",Nr._jsonSchemaVersion),vectorValues:_t("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VP=/^__.*__$/;class OP{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new mi(e,this.data,this.fieldMask,t,this.fieldTransforms):new el(e,this.data,t,this.fieldTransforms)}}class Nx{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new mi(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Dx(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw me(40011,{Ec:n})}}class Og{constructor(e,t,r,s,a,l){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=s,a===void 0&&this.Ac(),this.fieldTransforms=a||[],this.fieldMask=l||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new Og(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Rc({path:r,mc:!1});return s.fc(e),s}gc(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Rc({path:r,mc:!1});return s.Ac(),s}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return fh(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(Dx(this.Ec)&&VP.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class LP{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||$h(e)}Dc(e,t,r,s=!1){return new Og({Ec:e,methodName:t,bc:r,path:ct.emptyPath(),mc:!1,Sc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Qh(n){const e=n._freezeSettings(),t=$h(n._databaseId);return new LP(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Vx(n,e,t,r,s,a={}){const l=n.Dc(a.merge||a.mergeFields?2:0,e,t,s);Mg("Data must be an object, but it was:",l,r);const d=Ox(r,l);let f,m;if(a.merge)f=new fn(l.fieldMask),m=l.fieldTransforms;else if(a.mergeFields){const v=[];for(const _ of a.mergeFields){const x=Nm(e,_,t);if(!l.contains(x))throw new se(Q.INVALID_ARGUMENT,`Field '${x}' is specified in your field mask but missing from your input data.`);Mx(v,x)||v.push(x)}f=new fn(v),m=l.fieldTransforms.filter((_=>f.covers(_.field)))}else f=null,m=l.fieldTransforms;return new OP(new Kt(d),f,m)}class Xh extends Kh{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Xh}}class Lg extends Kh{_toFieldTransform(e){return new AI(e.path,new Fa)}isEqual(e){return e instanceof Lg}}function MP(n,e,t,r){const s=n.Dc(1,e,t);Mg("Data must be an object, but it was:",s,r);const a=[],l=Kt.empty();fs(r,((f,m)=>{const v=jg(e,f,t);m=Et(m);const _=s.gc(v);if(m instanceof Xh)a.push(v);else{const x=Zu(m,_);x!=null&&(a.push(v),l.set(v,x))}}));const d=new fn(a);return new Nx(l,d,s.fieldTransforms)}function jP(n,e,t,r,s,a){const l=n.Dc(1,e,t),d=[Nm(e,r,t)],f=[s];if(a.length%2!=0)throw new se(Q.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let x=0;x<a.length;x+=2)d.push(Nm(e,a[x])),f.push(a[x+1]);const m=[],v=Kt.empty();for(let x=d.length-1;x>=0;--x)if(!Mx(m,d[x])){const S=d[x];let D=f[x];D=Et(D);const U=l.gc(S);if(D instanceof Xh)m.push(S);else{const L=Zu(D,U);L!=null&&(m.push(S),v.set(S,L))}}const _=new fn(m);return new Nx(v,_,l.fieldTransforms)}function FP(n,e,t,r=!1){return Zu(t,n.Dc(r?4:3,e))}function Zu(n,e){if(Lx(n=Et(n)))return Mg("Unsupported field value:",e,n),Ox(n,e);if(n instanceof Kh)return(function(r,s){if(!Dx(s.Ec))throw s.wc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.wc(`${r._methodName}() is not currently supported inside arrays`);const a=r._toFieldTransform(s);a&&s.fieldTransforms.push(a)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return(function(r,s){const a=[];let l=0;for(const d of r){let f=Zu(d,s.yc(l));f==null&&(f={nullValue:"NULL_VALUE"}),a.push(f),l++}return{arrayValue:{values:a}}})(n,e)}return(function(r,s){if((r=Et(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return kR(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const a=He.fromDate(r);return{timestampValue:za(s.serializer,a)}}if(r instanceof He){const a=new He(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:za(s.serializer,a)}}if(r instanceof Pr)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Mn)return{bytesValue:OI(s.serializer,r._byteString)};if(r instanceof ft){const a=s.databaseId,l=r.firestore._databaseId;if(!l.isEqual(a))throw s.wc(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:pg(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Nr)return(function(l,d){return{mapValue:{fields:{[og]:{stringValue:ag},[Oa]:{arrayValue:{values:l.toArray().map((m=>{if(typeof m!="number")throw d.wc("VectorValues must only contain numeric values.");return ug(d.serializer,m)}))}}}}}})(r,s);throw s.wc(`Unsupported field value: ${bh(r)}`)})(n,e)}function Ox(n,e){const t={};return eI(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):fs(n,((r,s)=>{const a=Zu(s,e.Vc(r));a!=null&&(t[r]=a)})),{mapValue:{fields:t}}}function Lx(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof He||n instanceof Pr||n instanceof Mn||n instanceof ft||n instanceof Kh||n instanceof Nr)}function Mg(n,e,t){if(!Lx(t)||!FE(t)){const r=bh(t);throw r==="an object"?e.wc(n+" a custom object"):e.wc(n+" "+r)}}function Nm(n,e,t){if((e=Et(e))instanceof Gh)return e._internalPath;if(typeof e=="string")return jg(n,e);throw fh("Field path arguments must be of type string or ",n,!1,void 0,t)}const UP=new RegExp("[~\\*/\\[\\]]");function jg(n,e,t){if(e.search(UP)>=0)throw fh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Gh(...e.split("."))._internalPath}catch{throw fh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function fh(n,e,t,r,s){const a=r&&!r.isEmpty(),l=s!==void 0;let d=`Function ${e}() called with invalid data`;t&&(d+=" (via `toFirestore()`)"),d+=". ";let f="";return(a||l)&&(f+=" (found",a&&(f+=` in field ${r}`),l&&(f+=` in document ${s}`),f+=")"),new se(Q.INVALID_ARGUMENT,d+n+f)}function Mx(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jx{constructor(e,t,r,s,a){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=s,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new ft(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new BP(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Yh("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class BP extends jx{data(){return super.data()}}function Yh(n,e){return typeof e=="string"?jg(n,e):e instanceof Gh?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fx(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new se(Q.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Fg{}class Ug extends Fg{}function fr(n,e,...t){let r=[];e instanceof Fg&&r.push(e),r=r.concat(t),(function(a){const l=a.filter((f=>f instanceof Bg)).length,d=a.filter((f=>f instanceof Jh)).length;if(l>1||l>0&&d>0)throw new se(Q.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const s of r)n=s._apply(n);return n}class Jh extends Ug{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new Jh(e,t,r)}_apply(e){const t=this._parse(e);return Ux(e._query,t),new gi(e.firestore,e.converter,wm(e._query,t))}_parse(e){const t=Qh(e.firestore);return(function(a,l,d,f,m,v,_){let x;if(m.isKeyField()){if(v==="array-contains"||v==="array-contains-any")throw new se(Q.INVALID_ARGUMENT,`Invalid Query. You can't perform '${v}' queries on documentId().`);if(v==="in"||v==="not-in"){g0(_,v);const D=[];for(const U of _)D.push(m0(f,a,U));x={arrayValue:{values:D}}}else x=m0(f,a,_)}else v!=="in"&&v!=="not-in"&&v!=="array-contains-any"||g0(_,v),x=FP(d,l,_,v==="in"||v==="not-in");return Ve.create(m,v,x)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function wt(n,e,t){const r=e,s=Yh("where",n);return Jh._create(s,r,t)}class Bg extends Fg{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Bg(e,t)}_parse(e){const t=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return t.length===1?t[0]:We.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(s,a){let l=s;const d=a.getFlattenedFilters();for(const f of d)Ux(l,f),l=wm(l,f)})(e._query,t),new gi(e.firestore,e.converter,wm(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class zg extends Ug{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new zg(e,t)}_apply(e){const t=(function(s,a,l){if(s.startAt!==null)throw new se(Q.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new se(Q.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Lu(a,l)})(e._query,this._field,this._direction);return new gi(e.firestore,e.converter,(function(s,a){const l=s.explicitOrderBy.concat([a]);return new Za(s.path,s.collectionGroup,l,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)})(e._query,t))}}function nl(n,e="asc"){const t=e,r=Yh("orderBy",n);return zg._create(r,t)}class $g extends Ug{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new $g(e,t,r)}_apply(e){return new gi(e.firestore,e.converter,rh(e._query,this._limit,this._limitType))}}function zP(n){return kA("limit",n),$g._create("limit",n,"F")}function m0(n,e,t){if(typeof(t=Et(t))=="string"){if(t==="")throw new se(Q.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!yI(e)&&t.indexOf("/")!==-1)throw new se(Q.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child($e.fromString(t));if(!le.isDocumentKey(r))throw new se(Q.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Vu(n,new le(r))}if(t instanceof ft)return Vu(n,t._key);throw new se(Q.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${bh(t)}.`)}function g0(n,e){if(!Array.isArray(n)||n.length===0)throw new se(Q.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Ux(n,e){const t=(function(s,a){for(const l of s)for(const d of l.getFlattenedFilters())if(a.indexOf(d.op)>=0)return d.op;return null})(n.filters,(function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new se(Q.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new se(Q.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class $P{convertValue(e,t="none"){switch(os(e)){case 0:return null;case 1:return e.booleanValue;case 2:return it(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(hi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw me(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return fs(e,((s,a)=>{r[s]=this.convertValue(a,t)})),r}convertVectorValue(e){var t,r,s;const a=(s=(r=(t=e.fields)===null||t===void 0?void 0:t[Oa].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map((l=>it(l.doubleValue)));return new Nr(a)}convertGeoPoint(e){return new Pr(it(e.latitude),it(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Dh(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Nu(e));default:return null}}convertTimestamp(e){const t=di(e);return new He(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=$e.fromString(e);ve(HI(r),9688,{name:e});const s=new oo(r.get(1),r.get(3)),a=new le(r.popFirst(5));return s.isEqual(t)||tn(`Document ${a} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bx(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class hu{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class no extends jx{constructor(e,t,r,s,a,l){super(e,t,r,s,l),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new zd(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Yh("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new se(Q.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=no._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}no._jsonSchemaVersion="firestore/documentSnapshot/1.0",no._jsonSchema={type:_t("string",no._jsonSchemaVersion),bundleSource:_t("string","DocumentSnapshot"),bundleName:_t("string"),bundle:_t("string")};class zd extends no{data(e={}){return super.data(e)}}class ro{constructor(e,t,r,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new hu(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new zd(this._firestore,this._userDataWriter,r.key,r,new hu(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new se(Q.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(s,a){if(s._snapshot.oldDocs.isEmpty()){let l=0;return s._snapshot.docChanges.map((d=>{const f=new zd(s._firestore,s._userDataWriter,d.doc.key,d.doc,new hu(s._snapshot.mutatedKeys.has(d.doc.key),s._snapshot.fromCache),s.query.converter);return d.doc,{type:"added",doc:f,oldIndex:-1,newIndex:l++}}))}{let l=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((d=>a||d.type!==3)).map((d=>{const f=new zd(s._firestore,s._userDataWriter,d.doc.key,d.doc,new hu(s._snapshot.mutatedKeys.has(d.doc.key),s._snapshot.fromCache),s.query.converter);let m=-1,v=-1;return d.type!==0&&(m=l.indexOf(d.doc.key),l=l.delete(d.doc.key)),d.type!==1&&(l=l.add(d.doc),v=l.indexOf(d.doc.key)),{type:qP(d.type),doc:f,oldIndex:m,newIndex:v}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new se(Q.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ro._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Jm.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],s=[];return this.docs.forEach((a=>{a._document!==null&&(t.push(a._document),r.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),s.push(a.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function qP(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return me(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qa(n){n=nn(n,ft);const e=nn(n.firestore,Mr);return AP(Wh(e),n._key).then((t=>qx(e,n,t)))}ro._jsonSchemaVersion="firestore/querySnapshot/1.0",ro._jsonSchema={type:_t("string",ro._jsonSchemaVersion),bundleSource:_t("string","QuerySnapshot"),bundleName:_t("string"),bundle:_t("string")};class qg extends $P{constructor(e){super(),this.firestore=e}convertBytes(e){return new Mn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ft(this.firestore,null,t)}}function yi(n){n=nn(n,gi);const e=nn(n.firestore,Mr),t=Wh(e),r=new qg(e);return Fx(n._query),RP(t,n._query).then((s=>new ro(e,r,n,s)))}function Hg(n,e,t){n=nn(n,ft);const r=nn(n.firestore,Mr),s=Bx(n.converter,e,t);return Zh(r,[Vx(Qh(r),"setDoc",n._key,s,n.converter!==null,t).toMutation(n._key,Qt.none())])}function HP(n,e,t,...r){n=nn(n,ft);const s=nn(n.firestore,Mr),a=Qh(s);let l;return l=typeof(e=Et(e))=="string"||e instanceof Gh?jP(a,"updateDoc",n._key,e,t,r):MP(a,"updateDoc",n._key,e),Zh(s,[l.toMutation(n._key,Qt.exists(!0))])}function Wg(n){return Zh(nn(n.firestore,Mr),[new jh(n._key,Qt.none())])}function zx(n,e){const t=nn(n.firestore,Mr),r=cr(n),s=Bx(n.converter,e);return Zh(t,[Vx(Qh(n.firestore),"addDoc",r._key,s,n.converter!==null,{}).toMutation(r._key,Qt.exists(!1))]).then((()=>r))}function $x(n,...e){var t,r,s;n=Et(n);let a={includeMetadataChanges:!1,source:"default"},l=0;typeof e[l]!="object"||p0(e[l])||(a=e[l++]);const d={includeMetadataChanges:a.includeMetadataChanges,source:a.source};if(p0(e[l])){const _=e[l];e[l]=(t=_.next)===null||t===void 0?void 0:t.bind(_),e[l+1]=(r=_.error)===null||r===void 0?void 0:r.bind(_),e[l+2]=(s=_.complete)===null||s===void 0?void 0:s.bind(_)}let f,m,v;if(n instanceof ft)m=nn(n.firestore,Mr),v=Gu(n._key.path),f={next:_=>{e[l]&&e[l](qx(m,n,_))},error:e[l+1],complete:e[l+2]};else{const _=nn(n,gi);m=nn(_.firestore,Mr),v=_._query;const x=new qg(m);f={next:S=>{e[l]&&e[l](new ro(m,x,_,S))},error:e[l+1],complete:e[l+2]},Fx(n._query)}return(function(x,S,D,U){const L=new Vg(U),K=new Pg(S,L,D);return x.asyncQueue.enqueueAndForget((async()=>Ag(await hh(x),K))),()=>{L.Ou(),x.asyncQueue.enqueueAndForget((async()=>Rg(await hh(x),K)))}})(Wh(m),v,d,f)}function Zh(n,e){return(function(r,s){const a=new Cr;return r.asyncQueue.enqueueAndForget((async()=>gP(await bP(r),s,a))),a.promise})(Wh(n),e)}function qx(n,e,t){const r=t.docs.get(e._key),s=new qg(n);return new no(n,s,e._key,r,new hu(t.hasPendingWrites,t.fromCache),e.converter)}function Fu(){return new Lg("serverTimestamp")}(function(e,t=!0){(function(s){Ja=s})(Ya),Vr(new ur("firestore",((r,{instanceIdentifier:s,options:a})=>{const l=r.getProvider("app").getImmediate(),d=new Mr(new vA(r.getProvider("auth-internal")),new EA(l,r.getProvider("app-check-internal")),(function(m,v){if(!Object.prototype.hasOwnProperty.apply(m.options,["projectId"]))throw new se(Q.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new oo(m.options.projectId,v)})(l,s),l);return a=Object.assign({useFetchStreams:t},a),d._setSettings(a),d}),"PUBLIC").setMultipleInstances(!0)),Fn(K_,Q_,e),Fn(K_,Q_,"esm2017")})();var WP="firebase",GP="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Fn(WP,GP,"app");function Gg(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t}function Hx(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const KP=Hx,Wx=new yo("auth","Firebase",Hx());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ph=new kh("@firebase/auth");function QP(n,...e){ph.logLevel<=De.WARN&&ph.warn(`Auth (${Ya}): ${n}`,...e)}function $d(n,...e){ph.logLevel<=De.ERROR&&ph.error(`Auth (${Ya}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jr(n,...e){throw Qg(n,...e)}function lr(n,...e){return Qg(n,...e)}function Kg(n,e,t){const r=Object.assign(Object.assign({},KP()),{[e]:t});return new yo("auth","Firebase",r).create(e,{appName:n.name})}function io(n){return Kg(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function XP(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&jr(n,"argument-error"),Kg(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Qg(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return Wx.create(n,...e)}function ke(n,e,...t){if(!n)throw Qg(e,...t)}function oi(n){const e="INTERNAL ASSERTION FAILED: "+n;throw $d(e),new Error(e)}function fi(n,e){n||oi(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dm(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function YP(){return y0()==="http:"||y0()==="https:"}function y0(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function JP(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(YP()||Gm()||"connection"in navigator)?navigator.onLine:!0}function ZP(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ec{constructor(e,t){this.shortDelay=e,this.longDelay=t,fi(t>e,"Short delay should be less than long delay!"),this.isMobile=K1()||X1()}get(){return JP()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xg(n,e){fi(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gx{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;oi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;oi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;oi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eN={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tN=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],nN=new ec(3e4,6e4);function Yg(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function rl(n,e,t,r,s={}){return Kx(n,s,async()=>{let a={},l={};r&&(e==="GET"?l=r:a={body:JSON.stringify(r)});const d=$u(Object.assign({key:n.config.apiKey},l)).slice(1),f=await n._getAdditionalHeaders();f["Content-Type"]="application/json",n.languageCode&&(f["X-Firebase-Locale"]=n.languageCode);const m=Object.assign({method:e,headers:f},a);return Q1()||(m.referrerPolicy="no-referrer"),n.emulatorConfig&&Xa(n.emulatorConfig.host)&&(m.credentials="include"),Gx.fetch()(await Qx(n,n.config.apiHost,t,d),m)})}async function Kx(n,e,t){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},eN),e);try{const s=new iN(n),a=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const l=await a.json();if("needConfirmation"in l)throw Ad(n,"account-exists-with-different-credential",l);if(a.ok&&!("errorMessage"in l))return l;{const d=a.ok?l.errorMessage:l.error.message,[f,m]=d.split(" : ");if(f==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ad(n,"credential-already-in-use",l);if(f==="EMAIL_EXISTS")throw Ad(n,"email-already-in-use",l);if(f==="USER_DISABLED")throw Ad(n,"user-disabled",l);const v=r[f]||f.toLowerCase().replace(/[_\s]+/g,"-");if(m)throw Kg(n,v,m);jr(n,v)}}catch(s){if(s instanceof hr)throw s;jr(n,"network-request-failed",{message:String(s)})}}async function rN(n,e,t,r,s={}){const a=await rl(n,e,t,r,s);return"mfaPendingCredential"in a&&jr(n,"multi-factor-auth-required",{_serverResponse:a}),a}async function Qx(n,e,t,r){const s=`${e}${t}?${r}`,a=n,l=a.config.emulator?Xg(n.config,s):`${n.config.apiScheme}://${s}`;return tN.includes(t)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(l).toString():l}class iN{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(lr(this.auth,"network-request-failed")),nN.get())})}}function Ad(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const s=lr(n,e,r);return s.customData._tokenResponse=t,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sN(n,e){return rl(n,"POST","/v1/accounts:delete",e)}async function mh(n,e){return rl(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iu(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function oN(n,e=!1){const t=Et(n),r=await t.getIdToken(e),s=Jg(r);ke(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const a=typeof s.firebase=="object"?s.firebase:void 0,l=a==null?void 0:a.sign_in_provider;return{claims:s,token:r,authTime:Iu(Xp(s.auth_time)),issuedAtTime:Iu(Xp(s.iat)),expirationTime:Iu(Xp(s.exp)),signInProvider:l||null,signInSecondFactor:(a==null?void 0:a.sign_in_second_factor)||null}}function Xp(n){return Number(n)*1e3}function Jg(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return $d("JWT malformed, contained fewer than 3 sections"),null;try{const s=dE(t);return s?JSON.parse(s):($d("Failed to decode base64 JWT payload"),null)}catch(s){return $d("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function v0(n){const e=Jg(n);return ke(e,"internal-error"),ke(typeof e.exp<"u","internal-error"),ke(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Uu(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof hr&&aN(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function aN({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lN{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vm{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Iu(this.lastLoginAt),this.creationTime=Iu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gh(n){var e;const t=n.auth,r=await n.getIdToken(),s=await Uu(n,mh(t,{idToken:r}));ke(s==null?void 0:s.users.length,t,"internal-error");const a=s.users[0];n._notifyReloadListener(a);const l=!((e=a.providerUserInfo)===null||e===void 0)&&e.length?Xx(a.providerUserInfo):[],d=cN(n.providerData,l),f=n.isAnonymous,m=!(n.email&&a.passwordHash)&&!(d!=null&&d.length),v=f?m:!1,_={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:d,metadata:new Vm(a.createdAt,a.lastLoginAt),isAnonymous:v};Object.assign(n,_)}async function uN(n){const e=Et(n);await gh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function cN(n,e){return[...n.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function Xx(n){return n.map(e=>{var{providerId:t}=e,r=Gg(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dN(n,e){const t=await Kx(n,{},async()=>{const r=$u({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:a}=n.config,l=await Qx(n,s,"/v1/token",`key=${a}`),d=await n._getAdditionalHeaders();d["Content-Type"]="application/x-www-form-urlencoded";const f={method:"POST",headers:d,body:r};return n.emulatorConfig&&Xa(n.emulatorConfig.host)&&(f.credentials="include"),Gx.fetch()(l,f)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function hN(n,e){return rl(n,"POST","/v2/accounts:revokeToken",Yg(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ba{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ke(e.idToken,"internal-error"),ke(typeof e.idToken<"u","internal-error"),ke(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):v0(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){ke(e.length!==0,"internal-error");const t=v0(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(ke(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:s,expiresIn:a}=await dN(e,t);this.updateTokensAndExpiration(r,s,Number(a))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:s,expirationTime:a}=t,l=new ba;return r&&(ke(typeof r=="string","internal-error",{appName:e}),l.refreshToken=r),s&&(ke(typeof s=="string","internal-error",{appName:e}),l.accessToken=s),a&&(ke(typeof a=="number","internal-error",{appName:e}),l.expirationTime=a),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ba,this.toJSON())}_performRefresh(){return oi("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wi(n,e){ke(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class ar{constructor(e){var{uid:t,auth:r,stsTokenManager:s}=e,a=Gg(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new lN(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new Vm(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const t=await Uu(this,this.stsTokenManager.getToken(this.auth,e));return ke(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return oN(this,e)}reload(){return uN(this)}_assign(e){this!==e&&(ke(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new ar(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){ke(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await gh(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(or(this.auth.app))return Promise.reject(io(this.auth));const e=await this.getIdToken();return await Uu(this,sN(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,s,a,l,d,f,m,v;const _=(r=t.displayName)!==null&&r!==void 0?r:void 0,x=(s=t.email)!==null&&s!==void 0?s:void 0,S=(a=t.phoneNumber)!==null&&a!==void 0?a:void 0,D=(l=t.photoURL)!==null&&l!==void 0?l:void 0,U=(d=t.tenantId)!==null&&d!==void 0?d:void 0,L=(f=t._redirectEventId)!==null&&f!==void 0?f:void 0,K=(m=t.createdAt)!==null&&m!==void 0?m:void 0,X=(v=t.lastLoginAt)!==null&&v!==void 0?v:void 0,{uid:q,emailVerified:ne,isAnonymous:ue,providerData:ce,stsTokenManager:C}=t;ke(q&&C,e,"internal-error");const k=ba.fromJSON(this.name,C);ke(typeof q=="string",e,"internal-error"),Wi(_,e.name),Wi(x,e.name),ke(typeof ne=="boolean",e,"internal-error"),ke(typeof ue=="boolean",e,"internal-error"),Wi(S,e.name),Wi(D,e.name),Wi(U,e.name),Wi(L,e.name),Wi(K,e.name),Wi(X,e.name);const R=new ar({uid:q,auth:e,email:x,emailVerified:ne,displayName:_,isAnonymous:ue,photoURL:D,phoneNumber:S,tenantId:U,stsTokenManager:k,createdAt:K,lastLoginAt:X});return ce&&Array.isArray(ce)&&(R.providerData=ce.map(P=>Object.assign({},P))),L&&(R._redirectEventId=L),R}static async _fromIdTokenResponse(e,t,r=!1){const s=new ba;s.updateFromServerResponse(t);const a=new ar({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await gh(a),a}static async _fromGetAccountInfoResponse(e,t,r){const s=t.users[0];ke(s.localId!==void 0,"internal-error");const a=s.providerUserInfo!==void 0?Xx(s.providerUserInfo):[],l=!(s.email&&s.passwordHash)&&!(a!=null&&a.length),d=new ba;d.updateFromIdToken(r);const f=new ar({uid:s.localId,auth:e,stsTokenManager:d,isAnonymous:l}),m={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Vm(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(a!=null&&a.length)};return Object.assign(f,m),f}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _0=new Map;function ai(n){fi(n instanceof Function,"Expected a class definition");let e=_0.get(n);return e?(fi(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,_0.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yx{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Yx.type="NONE";const w0=Yx;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qd(n,e,t){return`firebase:${n}:${e}:${t}`}class Aa{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:s,name:a}=this.auth;this.fullUserKey=qd(this.userKey,s.apiKey,a),this.fullPersistenceKey=qd("persistence",s.apiKey,a),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await mh(this.auth,{idToken:e}).catch(()=>{});return t?ar._fromGetAccountInfoResponse(this.auth,t,e):null}return ar._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Aa(ai(w0),e,r);const s=(await Promise.all(t.map(async m=>{if(await m._isAvailable())return m}))).filter(m=>m);let a=s[0]||ai(w0);const l=qd(r,e.config.apiKey,e.name);let d=null;for(const m of t)try{const v=await m._get(l);if(v){let _;if(typeof v=="string"){const x=await mh(e,{idToken:v}).catch(()=>{});if(!x)break;_=await ar._fromGetAccountInfoResponse(e,x,v)}else _=ar._fromJSON(e,v);m!==a&&(d=_),a=m;break}}catch{}const f=s.filter(m=>m._shouldAllowMigration);return!a._shouldAllowMigration||!f.length?new Aa(a,e,r):(a=f[0],d&&await a._set(l,d.toJSON()),await Promise.all(t.map(async m=>{if(m!==a)try{await m._remove(l)}catch{}})),new Aa(a,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E0(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(tT(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Jx(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(rT(e))return"Blackberry";if(iT(e))return"Webos";if(Zx(e))return"Safari";if((e.includes("chrome/")||eT(e))&&!e.includes("edge/"))return"Chrome";if(nT(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function Jx(n=At()){return/firefox\//i.test(n)}function Zx(n=At()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function eT(n=At()){return/crios\//i.test(n)}function tT(n=At()){return/iemobile/i.test(n)}function nT(n=At()){return/android/i.test(n)}function rT(n=At()){return/blackberry/i.test(n)}function iT(n=At()){return/webos/i.test(n)}function Zg(n=At()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function fN(n=At()){var e;return Zg(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function pN(){return Y1()&&document.documentMode===10}function sT(n=At()){return Zg(n)||nT(n)||iT(n)||rT(n)||/windows phone/i.test(n)||tT(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oT(n,e=[]){let t;switch(n){case"Browser":t=E0(At());break;case"Worker":t=`${E0(At())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Ya}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mN{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=a=>new Promise((l,d)=>{try{const f=e(a);l(f)}catch(f){d(f)}});r.onAbort=t,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gN(n,e={}){return rl(n,"GET","/v2/passwordPolicy",Yg(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yN=6;class vN{constructor(e){var t,r,s,a;const l=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=l.minPasswordLength)!==null&&t!==void 0?t:yN,l.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=l.maxPasswordLength),l.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=l.containsLowercaseCharacter),l.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=l.containsUppercaseCharacter),l.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=l.containsNumericCharacter),l.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=l.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(a=e.forceUpgradeOnSignin)!==null&&a!==void 0?a:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,s,a,l,d;const f={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,f),this.validatePasswordCharacterOptions(e,f),f.isValid&&(f.isValid=(t=f.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),f.isValid&&(f.isValid=(r=f.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),f.isValid&&(f.isValid=(s=f.containsLowercaseLetter)!==null&&s!==void 0?s:!0),f.isValid&&(f.isValid=(a=f.containsUppercaseLetter)!==null&&a!==void 0?a:!0),f.isValid&&(f.isValid=(l=f.containsNumericCharacter)!==null&&l!==void 0?l:!0),f.isValid&&(f.isValid=(d=f.containsNonAlphanumericCharacter)!==null&&d!==void 0?d:!0),f}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,s,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _N{constructor(e,t,r,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new I0(this),this.idTokenSubscription=new I0(this),this.beforeStateQueue=new mN(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Wx,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ai(t)),this._initializationPromise=this.queue(async()=>{var r,s,a;if(!this._deleted&&(this.persistenceManager=await Aa.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((s=this._popupRedirectResolver)===null||s===void 0)&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((a=this.currentUser)===null||a===void 0?void 0:a.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await mh(this,{idToken:e}),r=await ar._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(or(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(d,d))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,d=s==null?void 0:s._redirectEventId,f=await this.tryRedirectSignIn(e);(!l||l===d)&&(f!=null&&f.user)&&(s=f.user,a=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(s)}catch(l){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return ke(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await gh(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=ZP()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(or(this.app))return Promise.reject(io(this));const t=e?Et(e):null;return t&&ke(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&ke(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return or(this.app)?Promise.reject(io(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return or(this.app)?Promise.reject(io(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ai(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await gN(this),t=new vN(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new yo("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await hN(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&ai(e)||this._popupRedirectResolver;ke(t,this,"argument-error"),this.redirectPersistenceManager=await Aa.create(this,[ai(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,s){if(this._deleted)return()=>{};const a=typeof t=="function"?t:t.next.bind(t);let l=!1;const d=this._isInitialized?Promise.resolve():this._initializationPromise;if(ke(d,this,"internal-error"),d.then(()=>{l||a(this.currentUser)}),typeof t=="function"){const f=e.addObserver(t,r,s);return()=>{l=!0,f()}}else{const f=e.addObserver(t);return()=>{l=!0,f()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ke(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=oT(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(t["X-Firebase-AppCheck"]=s),t}async _getAppCheckToken(){var e;if(or(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&QP(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function ef(n){return Et(n)}class I0{constructor(e){this.auth=e,this.observer=null,this.addObserver=nb(t=>this.observer=t)}get next(){return ke(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ey={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function wN(n){ey=n}function EN(n){return ey.loadJS(n)}function IN(){return ey.gapiScript}function xN(n){return`__${n}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TN(n,e){const t=vo(n,"auth");if(t.isInitialized()){const s=t.getImmediate(),a=t.getOptions();if(ss(a,e??{}))return s;jr(s,"already-initialized")}return t.initialize({options:e})}function SN(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(ai);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function kN(n,e,t){const r=ef(n);ke(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,a=aT(e),{host:l,port:d}=bN(e),f=d===null?"":`:${d}`,m={url:`${a}//${l}${f}/`},v=Object.freeze({host:l,port:d,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){ke(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),ke(ss(m,r.config.emulator)&&ss(v,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=m,r.emulatorConfig=v,r.settings.appVerificationDisabledForTesting=!0,Xa(l)?(gE(`${a}//${l}${f}`),yE("Auth",!0)):AN()}function aT(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function bN(n){const e=aT(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const a=s[1];return{host:a,port:x0(r.substr(a.length+1))}}else{const[a,l]=r.split(":");return{host:a,port:x0(l)}}}function x0(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function AN(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lT{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return oi("not implemented")}_getIdTokenResponse(e){return oi("not implemented")}_linkToIdToken(e,t){return oi("not implemented")}_getReauthenticationResolver(e){return oi("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ra(n,e){return rN(n,"POST","/v1/accounts:signInWithIdp",Yg(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RN="http://localhost";class fo extends lT{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new fo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):jr("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=t,a=Gg(t,["providerId","signInMethod"]);if(!r||!s)return null;const l=new fo(r,s);return l.idToken=a.idToken||void 0,l.accessToken=a.accessToken||void 0,l.secret=a.secret,l.nonce=a.nonce,l.pendingToken=a.pendingToken||null,l}_getIdTokenResponse(e){const t=this.buildRequest();return Ra(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Ra(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Ra(e,t)}buildRequest(){const e={requestUri:RN,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=$u(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ty{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tc extends ty{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qi extends tc{constructor(){super("facebook.com")}static credential(e){return fo._fromParams({providerId:Qi.PROVIDER_ID,signInMethod:Qi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Qi.credentialFromTaggedObject(e)}static credentialFromError(e){return Qi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Qi.credential(e.oauthAccessToken)}catch{return null}}}Qi.FACEBOOK_SIGN_IN_METHOD="facebook.com";Qi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ii extends tc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return fo._fromParams({providerId:ii.PROVIDER_ID,signInMethod:ii.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return ii.credentialFromTaggedObject(e)}static credentialFromError(e){return ii.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return ii.credential(t,r)}catch{return null}}}ii.GOOGLE_SIGN_IN_METHOD="google.com";ii.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xi extends tc{constructor(){super("github.com")}static credential(e){return fo._fromParams({providerId:Xi.PROVIDER_ID,signInMethod:Xi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Xi.credentialFromTaggedObject(e)}static credentialFromError(e){return Xi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Xi.credential(e.oauthAccessToken)}catch{return null}}}Xi.GITHUB_SIGN_IN_METHOD="github.com";Xi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yi extends tc{constructor(){super("twitter.com")}static credential(e,t){return fo._fromParams({providerId:Yi.PROVIDER_ID,signInMethod:Yi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Yi.credentialFromTaggedObject(e)}static credentialFromError(e){return Yi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return Yi.credential(t,r)}catch{return null}}}Yi.TWITTER_SIGN_IN_METHOD="twitter.com";Yi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ha{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,s=!1){const a=await ar._fromIdTokenResponse(e,r,s),l=T0(r);return new Ha({user:a,providerId:l,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const s=T0(r);return new Ha({user:e,providerId:s,_tokenResponse:r,operationType:t})}}function T0(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yh extends hr{constructor(e,t,r,s){var a;super(t.code,t.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,yh.prototype),this.customData={appName:e.name,tenantId:(a=e.tenantId)!==null&&a!==void 0?a:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,s){return new yh(e,t,r,s)}}function uT(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?yh._fromErrorAndOperation(n,a,e,r):a})}async function CN(n,e,t=!1){const r=await Uu(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Ha._forOperation(n,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function PN(n,e,t=!1){const{auth:r}=n;if(or(r.app))return Promise.reject(io(r));const s="reauthenticate";try{const a=await Uu(n,uT(r,s,e,n),t);ke(a.idToken,r,"internal-error");const l=Jg(a.idToken);ke(l,r,"internal-error");const{sub:d}=l;return ke(n.uid===d,r,"user-mismatch"),Ha._forOperation(n,s,a)}catch(a){throw(a==null?void 0:a.code)==="auth/user-not-found"&&jr(r,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NN(n,e,t=!1){if(or(n.app))return Promise.reject(io(n));const r="signIn",s=await uT(n,r,e),a=await Ha._fromIdTokenResponse(n,r,s);return t||await n._updateCurrentUser(a.user),a}function DN(n,e,t,r){return Et(n).onIdTokenChanged(e,t,r)}function VN(n,e,t){return Et(n).beforeAuthStateChanged(e,t)}function ON(n,e,t,r){return Et(n).onAuthStateChanged(e,t,r)}function LN(n){return Et(n).signOut()}const vh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cT{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(vh,"1"),this.storage.removeItem(vh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MN=1e3,jN=10;class dT extends cT{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=sT(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),s=this.localCache[t];r!==s&&e(t,s,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((l,d,f)=>{this.notifyListeners(l,f)});return}const r=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const l=this.storage.getItem(r);!t&&this.localCache[r]===l||this.notifyListeners(r,l)},a=this.storage.getItem(r);pN()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,jN):s()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},MN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}dT.type="LOCAL";const FN=dT;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hT extends cT{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}hT.type="SESSION";const fT=hT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UN(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const r=new tf(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:s,data:a}=t.data,l=this.handlersMap[s];if(!(l!=null&&l.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const d=Array.from(l).map(async m=>m(t.origin,a)),f=await UN(d);t.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:f})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}tf.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ny(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BN{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let a,l;return new Promise((d,f)=>{const m=ny("",20);s.port1.start();const v=setTimeout(()=>{f(new Error("unsupported_event"))},r);l={messageChannel:s,onMessage(_){const x=_;if(x.data.eventId===m)switch(x.data.status){case"ack":clearTimeout(v),a=setTimeout(()=>{f(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),d(x.data.response);break;default:clearTimeout(v),clearTimeout(a),f(new Error("invalid_response"));break}}},this.handlers.add(l),s.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:e,eventId:m,data:t},[s.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dr(){return window}function zN(n){Dr().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pT(){return typeof Dr().WorkerGlobalScope<"u"&&typeof Dr().importScripts=="function"}async function $N(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function qN(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function HN(){return pT()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mT="firebaseLocalStorageDb",WN=1,_h="firebaseLocalStorage",gT="fbase_key";class nc{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function nf(n,e){return n.transaction([_h],e?"readwrite":"readonly").objectStore(_h)}function GN(){const n=indexedDB.deleteDatabase(mT);return new nc(n).toPromise()}function Om(){const n=indexedDB.open(mT,WN);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(_h,{keyPath:gT})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(_h)?e(r):(r.close(),await GN(),e(await Om()))})})}async function S0(n,e,t){const r=nf(n,!0).put({[gT]:e,value:t});return new nc(r).toPromise()}async function KN(n,e){const t=nf(n,!1).get(e),r=await new nc(t).toPromise();return r===void 0?null:r.value}function k0(n,e){const t=nf(n,!0).delete(e);return new nc(t).toPromise()}const QN=800,XN=3;class yT{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Om(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>XN)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return pT()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=tf._getInstance(HN()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await $N(),!this.activeServiceWorker)return;this.sender=new BN(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((t=r[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||qN()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Om();return await S0(e,vh,"1"),await k0(e,vh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>S0(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>KN(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>k0(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const a=nf(s,!1).getAll();return new nc(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:a}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(a)&&(this.notifyListeners(s,a),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),QN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}yT.type="LOCAL";const YN=yT;new ec(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vT(n,e){return e?ai(e):(ke(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ry extends lT{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ra(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Ra(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Ra(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function JN(n){return NN(n.auth,new ry(n),n.bypassAuthState)}function ZN(n){const{auth:e,user:t}=n;return ke(t,e,"internal-error"),PN(t,new ry(n),n.bypassAuthState)}async function eD(n){const{auth:e,user:t}=n;return ke(t,e,"internal-error"),CN(t,new ry(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _T{constructor(e,t,r,s,a=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:s,tenantId:a,error:l,type:d}=e;if(l){this.reject(l);return}const f={auth:this.auth,requestUri:t,sessionId:r,tenantId:a||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(d)(f))}catch(m){this.reject(m)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return JN;case"linkViaPopup":case"linkViaRedirect":return eD;case"reauthViaPopup":case"reauthViaRedirect":return ZN;default:jr(this.auth,"internal-error")}}resolve(e){fi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){fi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tD=new ec(2e3,1e4);async function nD(n,e,t){if(or(n.app))return Promise.reject(lr(n,"operation-not-supported-in-this-environment"));const r=ef(n);XP(n,e,ty);const s=vT(r,t);return new Ys(r,"signInViaPopup",e,s).executeNotNull()}class Ys extends _T{constructor(e,t,r,s,a){super(e,t,s,a),this.provider=r,this.authWindow=null,this.pollId=null,Ys.currentPopupAction&&Ys.currentPopupAction.cancel(),Ys.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ke(e,this.auth,"internal-error"),e}async onExecution(){fi(this.filter.length===1,"Popup operations only handle one event");const e=ny();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(lr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(lr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Ys.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if(!((r=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(lr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,tD.get())};e()}}Ys.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rD="pendingRedirect",Hd=new Map;class iD extends _T{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Hd.get(this.auth._key());if(!e){try{const r=await sD(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Hd.set(this.auth._key(),e)}return this.bypassAuthState||Hd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function sD(n,e){const t=lD(e),r=aD(n);if(!await r._isAvailable())return!1;const s=await r._get(t)==="true";return await r._remove(t),s}function oD(n,e){Hd.set(n._key(),e)}function aD(n){return ai(n._redirectPersistence)}function lD(n){return qd(rD,n.config.apiKey,n.name)}async function uD(n,e,t=!1){if(or(n.app))return Promise.reject(io(n));const r=ef(n),s=vT(r,e),l=await new iD(r,s,t).execute();return l&&!t&&(delete l.user._redirectEventId,await r._persistUserIfCurrent(l.user),await r._setRedirectUser(null,e)),l}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cD=600*1e3;class dD{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!hD(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!wT(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(lr(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=cD&&this.cachedEventUids.clear(),this.cachedEventUids.has(b0(e))}saveEventToCache(e){this.cachedEventUids.add(b0(e)),this.lastProcessedEventTime=Date.now()}}function b0(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function wT({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function hD(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return wT(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fD(n,e={}){return rl(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pD=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,mD=/^https?/;async function gD(n){if(n.config.emulator)return;const{authorizedDomains:e}=await fD(n);for(const t of e)try{if(yD(t))return}catch{}jr(n,"unauthorized-domain")}function yD(n){const e=Dm(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const l=new URL(n);return l.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&l.hostname===r}if(!mD.test(t))return!1;if(pD.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vD=new ec(3e4,6e4);function A0(){const n=Dr().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function _D(n){return new Promise((e,t)=>{var r,s,a;function l(){A0(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{A0(),t(lr(n,"network-request-failed"))},timeout:vD.get()})}if(!((s=(r=Dr().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((a=Dr().gapi)===null||a===void 0)&&a.load)l();else{const d=xN("iframefcb");return Dr()[d]=()=>{gapi.load?l():t(lr(n,"network-request-failed"))},EN(`${IN()}?onload=${d}`).catch(f=>t(f))}}).catch(e=>{throw Wd=null,e})}let Wd=null;function wD(n){return Wd=Wd||_D(n),Wd}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ED=new ec(5e3,15e3),ID="__/auth/iframe",xD="emulator/auth/iframe",TD={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},SD=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function kD(n){const e=n.config;ke(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Xg(e,xD):`https://${n.config.authDomain}/${ID}`,r={apiKey:e.apiKey,appName:n.name,v:Ya},s=SD.get(n.config.apiHost);s&&(r.eid=s);const a=n._getFrameworks();return a.length&&(r.fw=a.join(",")),`${t}?${$u(r).slice(1)}`}async function bD(n){const e=await wD(n),t=Dr().gapi;return ke(t,n,"internal-error"),e.open({where:document.body,url:kD(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:TD,dontclear:!0},r=>new Promise(async(s,a)=>{await r.restyle({setHideOnLeave:!1});const l=lr(n,"network-request-failed"),d=Dr().setTimeout(()=>{a(l)},ED.get());function f(){Dr().clearTimeout(d),s(r)}r.ping(f).then(f,()=>{a(l)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AD={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},RD=500,CD=600,PD="_blank",ND="http://localhost";class R0{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function DD(n,e,t,r=RD,s=CD){const a=Math.max((window.screen.availHeight-s)/2,0).toString(),l=Math.max((window.screen.availWidth-r)/2,0).toString();let d="";const f=Object.assign(Object.assign({},AD),{width:r.toString(),height:s.toString(),top:a,left:l}),m=At().toLowerCase();t&&(d=eT(m)?PD:t),Jx(m)&&(e=e||ND,f.scrollbars="yes");const v=Object.entries(f).reduce((x,[S,D])=>`${x}${S}=${D},`,"");if(fN(m)&&d!=="_self")return VD(e||"",d),new R0(null);const _=window.open(e||"",d,v);ke(_,n,"popup-blocked");try{_.focus()}catch{}return new R0(_)}function VD(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OD="__/auth/handler",LD="emulator/auth/handler",MD=encodeURIComponent("fac");async function C0(n,e,t,r,s,a){ke(n.config.authDomain,n,"auth-domain-config-required"),ke(n.config.apiKey,n,"invalid-api-key");const l={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Ya,eventId:s};if(e instanceof ty){e.setDefaultLanguage(n.languageCode),l.providerId=e.providerId||"",tb(e.getCustomParameters())||(l.customParameters=JSON.stringify(e.getCustomParameters()));for(const[v,_]of Object.entries({}))l[v]=_}if(e instanceof tc){const v=e.getScopes().filter(_=>_!=="");v.length>0&&(l.scopes=v.join(","))}n.tenantId&&(l.tid=n.tenantId);const d=l;for(const v of Object.keys(d))d[v]===void 0&&delete d[v];const f=await n._getAppCheckToken(),m=f?`#${MD}=${encodeURIComponent(f)}`:"";return`${jD(n)}?${$u(d).slice(1)}${m}`}function jD({config:n}){return n.emulator?Xg(n,LD):`https://${n.authDomain}/${OD}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yp="webStorageSupport";class FD{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=fT,this._completeRedirectFn=uD,this._overrideRedirectResult=oD}async _openPopup(e,t,r,s){var a;fi((a=this.eventManagers[e._key()])===null||a===void 0?void 0:a.manager,"_initialize() not called before _openPopup()");const l=await C0(e,t,r,Dm(),s);return DD(e,l,ny())}async _openRedirect(e,t,r,s){await this._originValidation(e);const a=await C0(e,t,r,Dm(),s);return zN(a),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:a}=this.eventManagers[t];return s?Promise.resolve(s):(fi(a,"If manager is not set, promise should be"),a)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await bD(e),r=new dD(e);return t.register("authEvent",s=>(ke(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Yp,{type:Yp},s=>{var a;const l=(a=s==null?void 0:s[0])===null||a===void 0?void 0:a[Yp];l!==void 0&&t(!!l),jr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=gD(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return sT()||Zx()||Zg()}}const UD=FD;var P0="@firebase/auth",N0="1.10.8";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BD{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ke(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zD(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function $D(n){Vr(new ur("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:l,authDomain:d}=r.options;ke(l&&!l.includes(":"),"invalid-api-key",{appName:r.name});const f={apiKey:l,authDomain:d,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:oT(n)},m=new _N(r,s,a,f);return SN(m,t),m},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Vr(new ur("auth-internal",e=>{const t=ef(e.getProvider("auth").getImmediate());return(r=>new BD(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Fn(P0,N0,zD(n)),Fn(P0,N0,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qD=300,HD=mE("authIdTokenMaxAge")||qD;let D0=null;const WD=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>HD)return;const s=t==null?void 0:t.token;D0!==s&&(D0=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function GD(n=Xm()){const e=vo(n,"auth");if(e.isInitialized())return e.getImmediate();const t=TN(n,{popupRedirectResolver:UD,persistence:[YN,FN,fT]}),r=mE("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(r,location.origin);if(location.origin===a.origin){const l=WD(a.toString());VN(t,l,()=>l(t.currentUser)),DN(t,d=>l(d))}}const s=fE("auth");return s&&kN(t,`http://${s}`),t}function KD(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}wN({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=s=>{const a=lr("internal-error");a.customData=s,t(a)},r.type="text/javascript",r.charset="UTF-8",KD().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});$D("Browser");const ET="@firebase/installations",iy="0.6.18";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IT=1e4,xT=`w:${iy}`,TT="FIS_v2",QD="https://firebaseinstallations.googleapis.com/v1",XD=3600*1e3,YD="installations",JD="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZD={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},po=new yo(YD,JD,ZD);function ST(n){return n instanceof hr&&n.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kT({projectId:n}){return`${QD}/projects/${n}/installations`}function bT(n){return{token:n.token,requestStatus:2,expiresIn:t2(n.expiresIn),creationTime:Date.now()}}async function AT(n,e){const r=(await e.json()).error;return po.create("request-failed",{requestName:n,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function RT({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function e2(n,{refreshToken:e}){const t=RT(n);return t.append("Authorization",n2(e)),t}async function CT(n){const e=await n();return e.status>=500&&e.status<600?n():e}function t2(n){return Number(n.replace("s","000"))}function n2(n){return`${TT} ${n}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function r2({appConfig:n,heartbeatServiceProvider:e},{fid:t}){const r=kT(n),s=RT(n),a=e.getImmediate({optional:!0});if(a){const m=await a.getHeartbeatsHeader();m&&s.append("x-firebase-client",m)}const l={fid:t,authVersion:TT,appId:n.appId,sdkVersion:xT},d={method:"POST",headers:s,body:JSON.stringify(l)},f=await CT(()=>fetch(r,d));if(f.ok){const m=await f.json();return{fid:m.fid||t,registrationStatus:2,refreshToken:m.refreshToken,authToken:bT(m.authToken)}}else throw await AT("Create Installation",f)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PT(n){return new Promise(e=>{setTimeout(e,n)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i2(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s2=/^[cdef][\w-]{21}$/,Lm="";function o2(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const t=a2(n);return s2.test(t)?t:Lm}catch{return Lm}}function a2(n){return i2(n).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rf(n){return`${n.appName}!${n.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NT=new Map;function DT(n,e){const t=rf(n);VT(t,e),l2(t,e)}function VT(n,e){const t=NT.get(n);if(t)for(const r of t)r(e)}function l2(n,e){const t=u2();t&&t.postMessage({key:n,fid:e}),c2()}let Js=null;function u2(){return!Js&&"BroadcastChannel"in self&&(Js=new BroadcastChannel("[Firebase] FID Change"),Js.onmessage=n=>{VT(n.data.key,n.data.fid)}),Js}function c2(){NT.size===0&&Js&&(Js.close(),Js=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d2="firebase-installations-database",h2=1,mo="firebase-installations-store";let Jp=null;function sy(){return Jp||(Jp=TE(d2,h2,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(mo)}}})),Jp}async function wh(n,e){const t=rf(n),s=(await sy()).transaction(mo,"readwrite"),a=s.objectStore(mo),l=await a.get(t);return await a.put(e,t),await s.done,(!l||l.fid!==e.fid)&&DT(n,e.fid),e}async function OT(n){const e=rf(n),r=(await sy()).transaction(mo,"readwrite");await r.objectStore(mo).delete(e),await r.done}async function sf(n,e){const t=rf(n),s=(await sy()).transaction(mo,"readwrite"),a=s.objectStore(mo),l=await a.get(t),d=e(l);return d===void 0?await a.delete(t):await a.put(d,t),await s.done,d&&(!l||l.fid!==d.fid)&&DT(n,d.fid),d}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oy(n){let e;const t=await sf(n.appConfig,r=>{const s=f2(r),a=p2(n,s);return e=a.registrationPromise,a.installationEntry});return t.fid===Lm?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function f2(n){const e=n||{fid:o2(),registrationStatus:0};return LT(e)}function p2(n,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(po.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=m2(n,t);return{installationEntry:t,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:g2(n)}:{installationEntry:e}}async function m2(n,e){try{const t=await r2(n,e);return wh(n.appConfig,t)}catch(t){throw ST(t)&&t.customData.serverCode===409?await OT(n.appConfig):await wh(n.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function g2(n){let e=await V0(n.appConfig);for(;e.registrationStatus===1;)await PT(100),e=await V0(n.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:r}=await oy(n);return r||t}return e}function V0(n){return sf(n,e=>{if(!e)throw po.create("installation-not-found");return LT(e)})}function LT(n){return y2(n)?{fid:n.fid,registrationStatus:0}:n}function y2(n){return n.registrationStatus===1&&n.registrationTime+IT<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function v2({appConfig:n,heartbeatServiceProvider:e},t){const r=_2(n,t),s=e2(n,t),a=e.getImmediate({optional:!0});if(a){const m=await a.getHeartbeatsHeader();m&&s.append("x-firebase-client",m)}const l={installation:{sdkVersion:xT,appId:n.appId}},d={method:"POST",headers:s,body:JSON.stringify(l)},f=await CT(()=>fetch(r,d));if(f.ok){const m=await f.json();return bT(m)}else throw await AT("Generate Auth Token",f)}function _2(n,{fid:e}){return`${kT(n)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ay(n,e=!1){let t;const r=await sf(n.appConfig,a=>{if(!MT(a))throw po.create("not-registered");const l=a.authToken;if(!e&&I2(l))return a;if(l.requestStatus===1)return t=w2(n,e),a;{if(!navigator.onLine)throw po.create("app-offline");const d=T2(a);return t=E2(n,d),d}});return t?await t:r.authToken}async function w2(n,e){let t=await O0(n.appConfig);for(;t.authToken.requestStatus===1;)await PT(100),t=await O0(n.appConfig);const r=t.authToken;return r.requestStatus===0?ay(n,e):r}function O0(n){return sf(n,e=>{if(!MT(e))throw po.create("not-registered");const t=e.authToken;return S2(t)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function E2(n,e){try{const t=await v2(n,e),r=Object.assign(Object.assign({},e),{authToken:t});return await wh(n.appConfig,r),t}catch(t){if(ST(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await OT(n.appConfig);else{const r=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await wh(n.appConfig,r)}throw t}}function MT(n){return n!==void 0&&n.registrationStatus===2}function I2(n){return n.requestStatus===2&&!x2(n)}function x2(n){const e=Date.now();return e<n.creationTime||n.creationTime+n.expiresIn<e+XD}function T2(n){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},n),{authToken:e})}function S2(n){return n.requestStatus===1&&n.requestTime+IT<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function k2(n){const e=n,{installationEntry:t,registrationPromise:r}=await oy(e);return r?r.catch(console.error):ay(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function b2(n,e=!1){const t=n;return await A2(t),(await ay(t,e)).token}async function A2(n){const{registrationPromise:e}=await oy(n);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R2(n){if(!n||!n.options)throw Zp("App Configuration");if(!n.name)throw Zp("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!n.options[t])throw Zp(t);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}function Zp(n){return po.create("missing-app-config-values",{valueName:n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jT="installations",C2="installations-internal",P2=n=>{const e=n.getProvider("app").getImmediate(),t=R2(e),r=vo(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},N2=n=>{const e=n.getProvider("app").getImmediate(),t=vo(e,jT).getImmediate();return{getId:()=>k2(t),getToken:s=>b2(t,s)}};function D2(){Vr(new ur(jT,P2,"PUBLIC")),Vr(new ur(C2,N2,"PRIVATE"))}D2();Fn(ET,iy);Fn(ET,iy,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Eh="analytics",V2="firebase_id",O2="origin",L2=60*1e3,M2="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",ly="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pn=new kh("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j2={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Tn=new yo("analytics","Analytics",j2);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F2(n){if(!n.startsWith(ly)){const e=Tn.create("invalid-gtag-resource",{gtagURL:n});return pn.warn(e.message),""}return n}function FT(n){return Promise.all(n.map(e=>e.catch(t=>t)))}function U2(n,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(n,e)),t}function B2(n,e){const t=U2("firebase-js-sdk-policy",{createScriptURL:F2}),r=document.createElement("script"),s=`${ly}?l=${n}&id=${e}`;r.src=t?t==null?void 0:t.createScriptURL(s):s,r.async=!0,document.head.appendChild(r)}function z2(n){let e=[];return Array.isArray(window[n])?e=window[n]:window[n]=e,e}async function $2(n,e,t,r,s,a){const l=r[s];try{if(l)await e[l];else{const f=(await FT(t)).find(m=>m.measurementId===s);f&&await e[f.appId]}}catch(d){pn.error(d)}n("config",s,a)}async function q2(n,e,t,r,s){try{let a=[];if(s&&s.send_to){let l=s.send_to;Array.isArray(l)||(l=[l]);const d=await FT(t);for(const f of l){const m=d.find(_=>_.measurementId===f),v=m&&e[m.appId];if(v)a.push(v);else{a=[];break}}}a.length===0&&(a=Object.values(e)),await Promise.all(a),n("event",r,s||{})}catch(a){pn.error(a)}}function H2(n,e,t,r){async function s(a,...l){try{if(a==="event"){const[d,f]=l;await q2(n,e,t,d,f)}else if(a==="config"){const[d,f]=l;await $2(n,e,t,r,d,f)}else if(a==="consent"){const[d,f]=l;n("consent",d,f)}else if(a==="get"){const[d,f,m]=l;n("get",d,f,m)}else if(a==="set"){const[d]=l;n("set",d)}else n(a,...l)}catch(d){pn.error(d)}}return s}function W2(n,e,t,r,s){let a=function(...l){window[r].push(arguments)};return window[s]&&typeof window[s]=="function"&&(a=window[s]),window[s]=H2(a,n,e,t),{gtagCore:a,wrappedGtag:window[s]}}function G2(n){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(ly)&&t.src.includes(n))return t;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K2=30,Q2=1e3;class X2{constructor(e={},t=Q2){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const UT=new X2;function Y2(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}async function J2(n){var e;const{appId:t,apiKey:r}=n,s={method:"GET",headers:Y2(r)},a=M2.replace("{app-id}",t),l=await fetch(a,s);if(l.status!==200&&l.status!==304){let d="";try{const f=await l.json();!((e=f.error)===null||e===void 0)&&e.message&&(d=f.error.message)}catch{}throw Tn.create("config-fetch-failed",{httpStatus:l.status,responseMessage:d})}return l.json()}async function Z2(n,e=UT,t){const{appId:r,apiKey:s,measurementId:a}=n.options;if(!r)throw Tn.create("no-app-id");if(!s){if(a)return{measurementId:a,appId:r};throw Tn.create("no-api-key")}const l=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},d=new nV;return setTimeout(async()=>{d.abort()},L2),BT({appId:r,apiKey:s,measurementId:a},l,d,e)}async function BT(n,{throttleEndTimeMillis:e,backoffCount:t},r,s=UT){var a;const{appId:l,measurementId:d}=n;try{await eV(r,e)}catch(f){if(d)return pn.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${d} provided in the "measurementId" field in the local Firebase config. [${f==null?void 0:f.message}]`),{appId:l,measurementId:d};throw f}try{const f=await J2(n);return s.deleteThrottleMetadata(l),f}catch(f){const m=f;if(!tV(m)){if(s.deleteThrottleMetadata(l),d)return pn.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${d} provided in the "measurementId" field in the local Firebase config. [${m==null?void 0:m.message}]`),{appId:l,measurementId:d};throw f}const v=Number((a=m==null?void 0:m.customData)===null||a===void 0?void 0:a.httpStatus)===503?j_(t,s.intervalMillis,K2):j_(t,s.intervalMillis),_={throttleEndTimeMillis:Date.now()+v,backoffCount:t+1};return s.setThrottleMetadata(l,_),pn.debug(`Calling attemptFetch again in ${v} millis`),BT(n,_,r,s)}}function eV(n,e){return new Promise((t,r)=>{const s=Math.max(e-Date.now(),0),a=setTimeout(t,s);n.addEventListener(()=>{clearTimeout(a),r(Tn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function tV(n){if(!(n instanceof hr)||!n.customData)return!1;const e=Number(n.customData.httpStatus);return e===429||e===500||e===503||e===504}class nV{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function rV(n,e,t,r,s){if(s&&s.global){n("event",t,r);return}else{const a=await e,l=Object.assign(Object.assign({},r),{send_to:a});n("event",t,l)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iV(){if(Sh())try{await Km()}catch(n){return pn.warn(Tn.create("indexeddb-unavailable",{errorInfo:n==null?void 0:n.toString()}).message),!1}else return pn.warn(Tn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function sV(n,e,t,r,s,a,l){var d;const f=Z2(n);f.then(S=>{t[S.measurementId]=S.appId,n.options.measurementId&&S.measurementId!==n.options.measurementId&&pn.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${S.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(S=>pn.error(S)),e.push(f);const m=iV().then(S=>{if(S)return r.getId()}),[v,_]=await Promise.all([f,m]);G2(a)||B2(a,v.measurementId),s("js",new Date);const x=(d=l==null?void 0:l.config)!==null&&d!==void 0?d:{};return x[O2]="firebase",x.update=!0,_!=null&&(x[V2]=_),s("config",v.measurementId,x),v.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oV{constructor(e){this.app=e}_delete(){return delete xu[this.app.options.appId],Promise.resolve()}}let xu={},L0=[];const M0={};let em="dataLayer",aV="gtag",j0,zT,F0=!1;function lV(){const n=[];if(Gm()&&n.push("This is a browser extension environment."),EE()||n.push("Cookies are not available."),n.length>0){const e=n.map((r,s)=>`(${s+1}) ${r}`).join(" "),t=Tn.create("invalid-analytics-context",{errorInfo:e});pn.warn(t.message)}}function uV(n,e,t){lV();const r=n.options.appId;if(!r)throw Tn.create("no-app-id");if(!n.options.apiKey)if(n.options.measurementId)pn.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Tn.create("no-api-key");if(xu[r]!=null)throw Tn.create("already-exists",{id:r});if(!F0){z2(em);const{wrappedGtag:a,gtagCore:l}=W2(xu,L0,M0,em,aV);zT=a,j0=l,F0=!0}return xu[r]=sV(n,L0,M0,e,j0,em,t),new oV(n)}function cV(n=Xm()){n=Et(n);const e=vo(n,Eh);return e.isInitialized()?e.getImmediate():dV(n)}function dV(n,e={}){const t=vo(n,Eh);if(t.isInitialized()){const s=t.getImmediate();if(ss(e,t.getOptions()))return s;throw Tn.create("already-initialized")}return t.initialize({options:e})}async function hV(){if(Gm()||!EE()||!Sh())return!1;try{return await Km()}catch{return!1}}function fV(n,e,t,r){n=Et(n),rV(zT,xu[n.app.options.appId],e,t,r).catch(s=>pn.error(s))}const U0="@firebase/analytics",B0="0.10.17";function pV(){Vr(new ur(Eh,(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("installations-internal").getImmediate();return uV(r,s,t)},"PUBLIC")),Vr(new ur("analytics-internal",n,"PRIVATE")),Fn(U0,B0),Fn(U0,B0,"esm2017");function n(e){try{const t=e.getProvider(Eh).getImmediate();return{logEvent:(r,s,a)=>fV(t,r,s,a)}}catch(t){throw Tn.create("interop-component-reg-failed",{reason:t})}}}pV();const mV={apiKey:"AIzaSyD2bnfNTNjJ4XyVFlM_1PzvGMmnc69VqX8",authDomain:"habit-tracker-pwa-e5a97.firebaseapp.com",projectId:"habit-tracker-pwa-e5a97",storageBucket:"habit-tracker-pwa-e5a97.firebasestorage.app",messagingSenderId:"600484609036",appId:"1:600484609036:web:0650ca5337d57f1b02c229",measurementId:"G-M990KPRLXC"},uy=SE(mV);hV().then(n=>{n&&cV(uy)});const cy=GD(uy),ot=PP(uy);NP(ot).catch(n=>{n.code=="failed-precondition"?console.warn("Persistence failed: Multiple tabs open"):n.code=="unimplemented"&&console.warn("Persistence failed: Browser not supported")});const il="habits";async function gV(n,e){try{const t=kn(ot,il);return{id:(await zx(t,{...e,userId:n,currentStreak:0,createdAt:Fu(),updatedAt:Fu()})).id,...e,userId:n,currentStreak:0}}catch(t){throw console.error("Error creating habit:",t),t}}async function yV(n){try{const e=kn(ot,il),t=fr(e,wt("userId","==",n),nl("createdAt","desc"));return(await yi(t)).docs.map(s=>({id:s.id,...s.data()}))}catch(e){throw console.error("Error getting habits:",e),e}}async function z0(n,e){try{const t=cr(ot,il,n);return await HP(t,{...e,updatedAt:Fu()}),{id:n,...e}}catch(t){throw console.error("Error updating habit:",t),t}}async function vV(n){try{const e=cr(ot,il,n);return await Wg(e),n}catch(e){throw console.error("Error deleting habit:",e),e}}function _V(n,e){const t=kn(ot,il),r=fr(t,wt("userId","==",n),nl("createdAt","desc"));return $x(r,s=>{const a=s.docs.map(l=>({id:l.id,...l.data()}));e(a)},s=>{console.error("Error in habits subscription:",s)})}async function wV(n){try{const e=kn(ot,il),t=fr(e,wt("userId","==",n),wt("isPublic","==",!0),nl("createdAt","desc"));return(await yi(t)).docs.map(s=>({id:s.id,...s.data()}))}catch(e){throw console.error("Error getting user public habits:",e),e}}function ri(n){const e=new Date(n),t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");return`${t}-${r}-${s}`}function $0(n=new Date){const e=new Date(n);e.setDate(e.getDate()-e.getDay()),e.setHours(0,0,0,0);const t=new Date(e);return t.setDate(t.getDate()+6),t.setHours(23,59,59,999),{start:e,end:t}}const sl="completions";async function Mm(n,e,t,r=!0){try{const s=kn(ot,sl);return{id:(await zx(s,{habitId:n,userId:e,date:t,value:r,timestamp:Fu()})).id,habitId:n,userId:e,date:t,value:r}}catch(s){throw console.error("Error adding completion:",s),s}}async function $T(n,e,t){try{const r=kn(ot,sl),s=fr(r,wt("habitId","==",n),wt("userId","==",e),wt("date","==",t)),l=(await yi(s)).docs.map(d=>Wg(d.ref));return await Promise.all(l),{habitId:n,userId:e,date:t}}catch(r){throw console.error("Error removing completion:",r),r}}async function EV(n,e,t,r=!0){try{const s=kn(ot,sl),a=fr(s,wt("habitId","==",n),wt("userId","==",e),wt("date","==",t));return(await yi(a)).empty?await Mm(n,e,t,r):(await $T(n,e,t),null)}catch(s){throw console.error("Error toggling completion:",s),s}}async function IV(n,e,t,r){try{if(r<=0)return await $T(n,e,t),null;const s=kn(ot,sl),a=fr(s,wt("habitId","==",n),wt("userId","==",e),wt("date","==",t)),l=await yi(a);if(l.empty)return await Mm(n,e,t,r);{const d=l.docs[0].ref;return await Wg(d),await Mm(n,e,t,r)}}catch(s){throw console.error("Error updating completion value:",s),s}}async function xV(n,e){try{const t=kn(ot,sl),r=fr(t,wt("userId","==",n),wt("date","==",e));return(await yi(r)).docs.map(a=>({id:a.id,...a.data()}))}catch(t){throw console.error("Error getting completions:",t),t}}async function TV(n,e,t){try{const r=kn(ot,sl),s=fr(r,wt("userId","==",n),wt("date",">=",e),wt("date","<=",t));return(await yi(s)).docs.map(l=>({id:l.id,...l.data()}))}catch(r){throw console.error("Error getting completions range:",r),r}}const dy="weeklyStats",qT="users";function rc(n=new Date){const e=new Date(n);e.setHours(0,0,0,0),e.setDate(e.getDate()+3-(e.getDay()+6)%7);const t=new Date(e.getFullYear(),0,4),r=Math.ceil(((e.getTime()-t.getTime())/864e5+t.getDay()+1)/7);return`${e.getFullYear()}-W${String(r).padStart(2,"0")}`}async function SV(n,e,t){try{const r=rc(),s=e>0?Math.round(t/e*100):0,a=cr(ot,dy,`${r}_${n}`);return await Hg(a,{weekId:r,userId:n,totalScheduled:e,totalCompleted:t,percentage:s,lastUpdated:new Date().toISOString()},{merge:!0}),{weekId:r,userId:n,percentage:s}}catch(r){throw console.error("Error updating weekly stats:",r),r}}async function kV(n=null){try{const e=n||rc(),t=kn(ot,dy),r=fr(t,wt("weekId","==",e),nl("percentage","desc")),a=(await yi(r)).docs.map(d=>({id:d.id,...d.data()}));return await Promise.all(a.map(async(d,f)=>{try{const m=cr(ot,qT,d.userId),v=await qa(m),_=v.exists()?v.data():{};return{...d,rank:f+1,displayName:_.displayName||"Anonymous",photoURL:_.photoURL||null,email:_.email||null}}catch{return{...d,rank:f+1,displayName:"Anonymous",photoURL:null}}}))}catch(e){throw console.error("Error getting leaderboard:",e),e}}async function bV(n,e=null){try{const t=await kV(e);return t.find(s=>s.userId===n)||{rank:t.length+1,percentage:0}}catch(t){return console.error("Error getting user rank:",t),{rank:0,percentage:0}}}function AV(){const n=new Date;return n.setDate(n.getDate()-7),rc(n)}function RV(n,e){const t=n||rc(),r=kn(ot,dy),s=fr(r,wt("weekId","==",t),nl("percentage","desc"));return $x(s,async a=>{const l=a.docs.map(f=>({id:f.id,...f.data()})),d=await Promise.all(l.map(async(f,m)=>{try{const v=cr(ot,qT,f.userId),_=await qa(v),x=_.exists()?_.data():{};return{...f,rank:m+1,displayName:x.displayName||"Anonymous",photoURL:x.photoURL||null}}catch{return{...f,rank:m+1,displayName:"Anonymous",photoURL:null}}}));e(d)},a=>{console.error("Error in leaderboard subscription:",a)})}const cs=lE((n,e)=>({habits:[],completions:{},isLoading:!1,error:null,setHabits:t=>n({habits:t}),setLoading:t=>n({isLoading:t}),setError:t=>n({error:t}),addHabit:async(t,r)=>{const s="temp_"+Date.now(),a={id:s,...r,userId:t,currentStreak:0,createdAt:new Date,updatedAt:new Date,isTemp:!0};return n(l=>({habits:[a,...l.habits],isLoading:!1})),gV(t,r).then(l=>{n(d=>({habits:d.habits.map(f=>f.id===s?l:f)}))}).catch(l=>{console.error("Background create failed:",l),n(d=>({error:"Failed to sync new habit. It may disappear on reload.",habits:d.habits.map(f=>f.id===s?{...f,syncError:!0}:f)}))}),a},updateHabit:async(t,r)=>{n(s=>({habits:s.habits.map(a=>a.id===t?{...a,...r}:a)}));try{await z0(t,r)}catch(s){console.error("Error in updateHabit:",s),n({error:s.message})}},deleteHabit:async t=>{n(r=>({habits:r.habits.filter(s=>s.id!==t)}));try{await vV(t)}catch(r){console.error("Error in deleteHabit:",r)}},loadHabits:async t=>{n({isLoading:!0,error:null});try{const r=await yV(t);return n({habits:r,isLoading:!1}),r}catch(r){throw console.error("Error in loadHabits:",r),n({error:r.message,isLoading:!1,habits:[]}),r}},subscribeToHabits:t=>(e().habits.length===0&&n({isLoading:!0}),_V(t,r=>{n({habits:r,isLoading:!1})})),setCompletions:(t,r)=>n(s=>({completions:{...s.completions,[t]:r}})),loadCompletionsForWeek:async t=>{try{const{start:r,end:s}=$0(new Date),a=ri(s),l=ri(r),d=await TV(t,l,a),f={};return d.forEach(m=>{f[m.date]||(f[m.date]=[]),f[m.date].push(m)}),n(m=>({completions:{...m.completions,...f}})),f}catch(r){return console.error("Error loading completions:",r),{}}},loadCompletionsForDate:async(t,r)=>{try{const s=await xV(t,r);return n(a=>({completions:{...a.completions,[r]:s}})),s}catch(s){return console.error("Error loading completions:",s),[]}},toggleCompletion:async(t,r,s)=>{const{completions:a,habits:l}=e(),d=a[s]||[],f=l.find(S=>S.id===t),m=ri(new Date);if(s>m){console.warn("Cannot mark future habits as done");return}const _=!d.find(S=>S.habitId===t);let x;if(_?x=[...d,{habitId:t,userId:r,date:s,value:!0,isOptimistic:!0}]:x=d.filter(S=>S.habitId!==t),n(S=>({completions:{...S.completions,[s]:x}})),f){let S=f.currentStreak;_?S=(f.currentStreak||0)+1:S=Math.max(0,(f.currentStreak||0)-1),n(D=>({habits:D.habits.map(U=>U.id===t?{...U,currentStreak:S}:U)})),z0(t,{currentStreak:S}).catch(D=>console.error("Background streak update failed:",D))}try{const{start:S,end:D}=$0(new Date);let U=0,L=0;const K=new Date(S),X=e().completions;for(;K<=D;){const q=ri(K),ne=e().getTodaysHabits(K);U+=ne.length;const ue=X[q]||[];L+=ue.length,K.setDate(K.getDate()+1)}SV(r,U,L).catch(q=>console.error("Background leaderboard update failed:",q))}catch(S){console.error("Error updating weekly stats:",S)}try{await EV(t,r,s,_)}catch(S){throw console.error("Error toggling completion in Firestore:",S),S}},updateHabitProgress:async(t,r,s,a)=>{const{completions:l,habits:d}=e(),f=l[s]||[];d.find(x=>x.id===t);const m=ri(new Date);if(s>m)return;const v=f.find(x=>x.habitId===t);let _;a>0?v?_=f.map(x=>x.habitId===t?{...x,value:a}:x):_=[...f,{habitId:t,userId:r,date:s,value:a,isOptimistic:!0}]:_=f.filter(x=>x.habitId!==t),n(x=>({completions:{...x.completions,[s]:_}}));try{await IV(t,r,s,a)}catch(x){console.error("Error updating progress:",x)}},isHabitCompleted:(t,r)=>{const{completions:s,habits:a}=e(),d=(s[r]||[]).find(m=>m.habitId===t),f=a.find(m=>m.id===t);return d?(f==null?void 0:f.completionType)==="numerical"&&f.targetValue?(d.value||0)>=f.targetValue:!0:!1},getHabitValue:(t,r)=>{const{completions:s}=e(),l=(s[r]||[]).find(d=>d.habitId===t);return(l==null?void 0:l.value)||0},getTodaysHabits:(t=null)=>{const{habits:r}=e(),s=t?new Date(t):new Date,a=s.getDay();return r.filter(l=>{var d,f;if(l.frequency==="daily")return!0;if(l.frequency==="custom"&&l.customDays)return l.customDays.includes(a);if(l.frequency==="one-time"){const m=ri(s);return l.targetDate===m}return l.frequency==="weekly"?(((f=(d=l.createdAt)==null?void 0:d.toDate)==null?void 0:f.call(d))||new Date(l.createdAt)).getDay()===a:!1})},getStatsForDate:t=>{const{completions:r,habits:s}=e(),a=e().getTodaysHabits(t),l=typeof t=="string"?t:ri(t),d=r[l]||[],f=a.reduce((_,x)=>{const S=d.find(D=>D.habitId===x.id);if(!S)return _;if(x.completionType==="numerical"&&x.targetValue){if((S.value||0)>=x.targetValue)return _+1}else return _+1;return _},0),m=a.length,v=m>0?Math.round(f/m*100):0;return{completed:f,total:m,percentage:v}},clearAll:()=>n({habits:[],completions:{},isLoading:!1,error:null})}));async function CV(){return"Notification"in window?Notification.permission==="granted"?!0:Notification.permission!=="denied"?await Notification.requestPermission()==="granted":!1:(console.warn("This browser does not support desktop notification"),!1)}function HT(n,e,t="/pwa-192x192.png"){if(Notification.permission==="granted"){const r=new Notification(n,{body:e,icon:t,badge:"/pwa-192x192.png",vibrate:[100,50,100],tag:n});r.onclick=function(s){s.preventDefault(),window.focus(),r.close()}}}function q0(){PV(),NV()}function PV(){const n=JSON.parse(localStorage.getItem("habitParams"))||{},{notificationsEnabled:e,reminderTime:t}=n;if(!e||!t)return;const r=new Date,s=localStorage.getItem("lastReminderDate"),a=r.toDateString();if(s===a)return;const[l,d]=t.split(":").map(Number),f=new Date;f.setHours(l,d,0,0),r>=f&&(HT("Time to check your habits!","Don't forget to log your progress for today."),localStorage.setItem("lastReminderDate",a))}function NV(){const n=new Date,e=cs.getState(),t=e.getTodaysHabits?e.getTodaysHabits(n):[],r=n.toISOString().split("T")[0],s=JSON.parse(localStorage.getItem("notifiedHabits"))||{};let l=[...s[r]||[]],d=!1;t.forEach(f=>{if(!f.hasReminder||!f.reminderTime||f.isCompleted||l.includes(f.id))return;const[m,v]=f.reminderTime.split(":").map(Number),_=new Date;_.setHours(m,v,0,0);const x=new Date(_.getTime()-10*6e4);n>=x&&n<_&&(HT(`Upcoming Habit: ${f.title}`,`Your habit is scheduled for ${f.reminderTime}. Get ready!`),l.push(f.id),d=!0)}),d&&localStorage.setItem("notifiedHabits",JSON.stringify({...s,[r]:l}))}const WT="users";async function DV(n,e){try{const t=cr(ot,WT,n);return await Hg(t,e,{merge:!0}),!0}catch(t){throw console.error("Error updating user settings:",t),t}}async function GT(n){try{const e=cr(ot,WT,n),t=await qa(e);return t.exists()?{id:t.id,...t.data()}:null}catch(e){throw console.error("Error getting user profile:",e),e}}const VV=new ii;async function OV(){try{const e=(await nD(cy,VV)).user,t=cr(ot,"users",e.uid);return(await qa(t)).exists()||await Hg(t,{displayName:e.displayName,email:e.email,photoURL:e.photoURL,createdAt:Fu()}),e}catch(n){throw console.error("Error signing in with Google:",n),n}}async function LV(){try{await LN(cy)}catch(n){throw console.error("Error signing out:",n),n}}function Eo({size:n="md",className:e=""}){const t={sm:"h-4 w-4",md:"h-6 w-6",lg:"h-10 w-10"};return E.jsxs("svg",{className:`animate-spin text-primary ${t[n]} ${e}`,fill:"none",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[E.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),E.jsx("path",{className:"opacity-75",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",fill:"currentColor"})]})}const MV={primary:"bg-primary text-text-light-primary shadow-[0_4px_14px_rgba(19,236,91,0.3)] hover:shadow-[0_4px_20px_rgba(19,236,91,0.4)]",secondary:"bg-transparent text-text-light-primary dark:text-text-dark-primary border border-border-light dark:border-border-dark hover:bg-gray-100 dark:hover:bg-gray-800",danger:"bg-transparent text-danger hover:bg-danger/10",google:"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50 shadow-sm"},jV={sm:"h-10 px-4 text-sm",md:"h-12 px-6 text-base",lg:"h-14 px-8 text-base"};function is({children:n,variant:e="primary",size:t="md",fullWidth:r=!1,isLoading:s=!1,disabled:a=!1,icon:l,className:d="",...f}){return E.jsx("button",{className:`
        flex items-center justify-center gap-2.5 rounded-xl font-bold
        transition-all duration-200 ease-out
        disabled:opacity-50 disabled:cursor-not-allowed
        ${MV[e]}
        ${jV[t]}
        ${r?"w-full":""}
        ${d}
      `,disabled:a||s,...f,children:s?E.jsx(Eo,{size:"sm"}):E.jsxs(E.Fragment,{children:[l&&E.jsx("span",{className:"material-symbols-outlined text-xl",children:l}),n]})})}function FV(){const[n,e]=F.useState(!1),[t,r]=F.useState(null),s=$n(),{isAuthenticated:a}=go();F.useEffect(()=>{a&&s("/dashboard",{replace:!0})},[a,s]);const l=async()=>{e(!0),r(null);try{await OV(),s("/dashboard")}catch(f){console.error("Sign in error:",f),r("Failed to sign in. Please try again.")}finally{e(!1)}},d=[{icon:"local_fire_department",title:"Track Streaks",description:"Never miss a day and watch your streaks grow."},{icon:"leaderboard",title:"Join Leaderboards",description:"Compete weekly and celebrate wins."},{icon:"share",title:"Share Progress",description:"Share your journey or keep it private."}];return a?null:E.jsx("div",{className:"relative flex h-auto min-h-screen w-full flex-col bg-background-light dark:bg-background-dark font-display overflow-x-hidden",children:E.jsxs("div",{className:"flex flex-col grow justify-between",children:[E.jsxs("div",{className:"flex flex-col",children:[E.jsx("div",{className:"p-4",children:E.jsx("div",{className:"w-full bg-center bg-no-repeat bg-cover flex flex-col justify-end overflow-hidden rounded-xl min-h-80",style:{backgroundImage:`linear-gradient(135deg, 
                  rgba(19, 236, 91, 0.3) 0%, 
                  rgba(16, 34, 22, 0.5) 50%, 
                  rgba(19, 236, 91, 0.2) 100%),
                  url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 400 300'%3E%3Cdefs%3E%3ClinearGradient id='grad' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' style='stop-color:%2313ec5b;stop-opacity:0.3'/%3E%3Cstop offset='100%25' style='stop-color:%23102216;stop-opacity:0.8'/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect fill='url(%23grad)' width='400' height='300'/%3E%3Ccircle cx='100' cy='150' r='60' fill='%2313ec5b' opacity='0.2'/%3E%3Ccircle cx='300' cy='100' r='80' fill='%2313ec5b' opacity='0.15'/%3E%3Ccircle cx='250' cy='220' r='50' fill='%2313ec5b' opacity='0.25'/%3E%3C/svg%3E")`},children:E.jsx("div",{className:"p-6 flex items-center justify-center",children:E.jsx("span",{className:"material-symbols-outlined text-primary text-6xl",children:"eco"})})})}),E.jsx("h1",{className:"text-text-light-primary dark:text-gray-100 tracking-tight text-[32px] font-bold leading-tight px-4 text-center pb-3 pt-6",children:"Build Better Habits, Together."}),E.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-base font-normal leading-normal pb-3 pt-1 px-4 text-center",children:"Track your progress, compete with friends, and stay motivated every day."}),E.jsx("div",{className:"flex overflow-x-auto no-scrollbar",children:E.jsx("div",{className:"flex items-stretch p-4 gap-4 w-full",children:d.map(f=>E.jsxs("div",{className:"flex h-full flex-1 flex-col items-center gap-2 text-center rounded-lg min-w-32 pt-4",children:[E.jsx("div",{className:"flex items-center justify-center bg-primary/20 dark:bg-primary/30 h-14 w-14 rounded-full",children:E.jsx("span",{className:"material-symbols-outlined text-primary text-3xl",children:f.icon})}),E.jsxs("div",{children:[E.jsx("p",{className:"text-text-light-primary dark:text-gray-100 text-base font-medium leading-normal",children:f.title}),E.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm font-normal leading-normal",children:f.description})]})]},f.title))})}),E.jsxs("div",{className:"flex w-full flex-row items-center justify-center gap-3 py-5",children:[E.jsx("div",{className:"h-2 w-2 rounded-full bg-primary"}),E.jsx("div",{className:"h-2 w-2 rounded-full bg-gray-300 dark:bg-gray-600"}),E.jsx("div",{className:"h-2 w-2 rounded-full bg-gray-300 dark:bg-gray-600"})]})]}),E.jsxs("div",{className:"p-4 flex flex-col gap-4",children:[t&&E.jsx("p",{className:"text-danger text-sm text-center",children:t}),E.jsx("button",{onClick:l,disabled:n,className:"flex h-12 w-full items-center justify-center gap-2.5 rounded-lg bg-primary px-6 text-base font-bold text-gray-900 dark:text-black disabled:opacity-50 transition-all hover:shadow-lg",children:n?E.jsx("span",{className:"animate-spin",children:""}):E.jsxs(E.Fragment,{children:[E.jsxs("svg",{"aria-hidden":"true",className:"h-6 w-6",fill:"none",height:"24",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",children:[E.jsx("path",{d:"M22.56 12.25C22.56 11.45 22.49 10.68 22.36 9.92H12V14.3H18.05C17.78 15.68 17.06 16.85 15.96 17.65V20.12H19.64C21.55 18.35 22.56 15.54 22.56 12.25Z",fill:"#4285F4"}),E.jsx("path",{d:"M12 23C14.97 23 17.52 22.02 19.64 20.12L15.96 17.65C14.99 18.31 13.62 18.72 12 18.72C9.09 18.72 6.6 16.83 5.75 14.15H1.97V16.7C3.86 20.48 7.64 23 12 23Z",fill:"#34A853"}),E.jsx("path",{d:"M5.75 14.15C5.55 13.59 5.45 12.98 5.45 12.35C5.45 11.72 5.55 11.11 5.75 10.55V7.98H1.97C1.22 9.38 0.77 10.83 0.77 12.35C0.77 13.87 1.22 15.32 1.97 16.7L5.75 14.15Z",fill:"#FBBC05"}),E.jsx("path",{d:"M12 5.98C13.72 5.98 15.14 6.58 16.22 7.59L19.71 4.1C17.52 2.19 14.97 1 12 1C7.64 1 3.86 3.52 1.97 7.98L5.75 10.55C6.6 7.87 9.09 5.98 12 5.98Z",fill:"#EA4335"})]}),"Continue with Google"]})})]})]})})}const UV=[{path:"/dashboard",icon:"home",label:"Dashboard"},{path:"/leaderboard",icon:"leaderboard",label:"Leaderboard"},{path:"/feed",icon:"feed",label:"Feed"},{path:"/settings",icon:"settings",label:"Settings"}];function ol(){return E.jsx("nav",{className:"fixed bottom-0 left-0 right-0 h-20 bg-content-light/80 dark:bg-content-dark/80 backdrop-blur-lg border-t border-border-light dark:border-border-dark z-20",children:E.jsx("div",{className:"flex justify-around items-center h-full max-w-md mx-auto",children:UV.map(n=>E.jsx(oE,{to:n.path,className:({isActive:e})=>`flex flex-col items-center justify-center gap-1 transition-colors ${e?"text-primary":"text-text-light-secondary dark:text-text-dark-secondary"}`,children:({isActive:e})=>E.jsxs(E.Fragment,{children:[E.jsx("span",{className:`material-symbols-outlined ${e?"filled":""}`,style:e?{fontVariationSettings:"'FILL' 1, 'wght' 400"}:{},children:n.icon}),E.jsx("span",{className:`text-xs ${e?"font-bold":""}`,children:n.label})]})},n.path))})})}const BV=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];function zV({selectedDate:n,onDateSelect:e,completionsByDate:t={}}){const r=new Date;r.setHours(0,0,0,0);const s=F.useMemo(()=>{const v=[],_=new Date(r),x=r.getDay();_.setDate(r.getDate()-x);for(let S=0;S<7;S++){const D=new Date(_);D.setDate(_.getDate()+S),v.push(D)}return v},[]),a=v=>v.toDateString()===r.toDateString(),l=v=>n?v.toDateString()===new Date(n).toDateString():a(v),d=v=>v.toISOString().split("T")[0],f=v=>{const _=d(v);return t[_]&&t[_].length>0},m=v=>v<r&&!a(v);return E.jsx("div",{className:"flex overflow-x-auto no-scrollbar pt-2 pb-4 px-4",children:E.jsx("div",{className:"flex space-x-3",children:s.map(v=>{const _=l(v),x=f(v),S=m(v);return E.jsxs("button",{onClick:()=>e==null?void 0:e(v),className:`
                flex flex-col items-center justify-center w-14 h-24 rounded-xl flex-shrink-0 transition-all
                ${_?"bg-primary":"bg-content-light dark:bg-content-dark border border-border-light dark:border-border-dark"}
              `,children:[E.jsx("p",{className:`text-sm font-medium ${_?"text-text-light-primary":"text-text-light-secondary dark:text-text-dark-secondary"}`,children:BV[v.getDay()]}),E.jsx("p",{className:`text-lg font-bold mt-1 ${_?"text-text-light-primary":"text-text-light-primary dark:text-text-dark-primary"}`,children:v.getDate()}),E.jsx("div",{className:`w-2 h-2 rounded-full mt-2 ${_?"bg-text-light-primary":x?"bg-primary":S?"bg-text-light-secondary/30 dark:bg-text-dark-secondary/30":"bg-text-light-secondary dark:bg-text-dark-secondary/50"}`})]},v.toISOString())})})})}function $V({streak:n,size:e="md"}){if(!n||n===0)return null;const t={sm:"text-xs",md:"text-sm",lg:"text-base"};return E.jsxs("span",{className:`text-text-light-secondary dark:text-text-dark-secondary ${t[e]}`,children:[" ",n," ",n===1?"day":"days"]})}function KT({habit:n,isCompleted:e,onToggle:t,currentValue:r,onUpdateProgress:s,showCheckbox:a=!0,disabled:l=!1}){const d=$n(),f=()=>{d(`/habit/${n.id}`)},m=v=>{v.stopPropagation(),!l&&t(n.id)};return E.jsxs("div",{className:`flex items-center gap-x-4 p-4 rounded-lg bg-content-light dark:bg-content-dark cursor-pointer transition-colors ${l?"opacity-70 cursor-not-allowed":"hover:bg-gray-50 dark:hover:bg-gray-800/50"}`,onClick:l?void 0:f,children:[E.jsx("div",{className:"flex-grow",children:E.jsxs("p",{className:"text-text-light-primary dark:text-text-dark-primary text-base font-normal leading-normal",children:[n.title," ",n.currentStreak>0&&E.jsx($V,{streak:n.currentStreak})]})}),E.jsx("span",{className:"material-symbols-outlined text-text-light-secondary dark:text-text-dark-secondary text-base",children:n.isPublic?"public":"lock"}),a&&(n.completionType==="numerical"?E.jsxs("div",{className:"flex items-center gap-2",onClick:v=>v.stopPropagation(),children:[E.jsx("button",{onClick:()=>!l&&s(n.id,Math.max(0,(r||0)-1)),disabled:l||(r||0)<=0,className:`size-8 rounded-full bg-gray-100 dark:bg-gray-800 flex items-center justify-center text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors ${l?"opacity-50 cursor-not-allowed":""}`,children:E.jsx("span",{className:"material-symbols-outlined text-lg",children:"remove"})}),E.jsxs("div",{className:"flex flex-col items-center min-w-[60px]",children:[E.jsx("span",{className:"text-sm font-bold text-gray-900 dark:text-white",children:r||0}),E.jsxs("span",{className:"text-[10px] text-gray-500 uppercase",children:["/ ",n.targetValue," ",n.unit]})]}),E.jsx("button",{onClick:()=>!l&&s(n.id,(r||0)+1),disabled:l,className:`size-8 rounded-full bg-primary/10 flex items-center justify-center text-primary hover:bg-primary/20 transition-colors ${l?"opacity-50 cursor-not-allowed":""}`,children:E.jsx("span",{className:"material-symbols-outlined text-lg",children:"add"})})]}):E.jsx("input",{type:"checkbox",checked:e,onChange:m,onClick:v=>v.stopPropagation(),disabled:l,className:`h-6 w-6 rounded-md border-border-light dark:border-border-dark border-2 bg-transparent text-primary checked:bg-primary checked:border-primary focus:ring-0 focus:ring-offset-0 focus:border-border-light dark:focus:border-border-dark focus:outline-none ${l?"cursor-not-allowed opacity-50":"cursor-pointer"}`}))]})}function qV(){var A;const n=$n(),{user:e}=go(),{habits:t,completions:r,isLoading:s,getTodaysHabits:a,getStatsForDate:l,isHabitCompleted:d,toggleCompletion:f,updateHabitProgress:m,getHabitValue:v,loadCompletionsForDate:_,subscribeToHabits:x}=cs(),[S,D]=F.useState(new Date),L=ri(new Date),K=ri(S),X=K===L,q=K>L,ne=a(S),{completed:ue,total:ce,percentage:C}=l(K);F.useEffect(()=>{e!=null&&e.uid&&_(e.uid,K)},[K,e==null?void 0:e.uid,_]),F.useEffect(()=>{if(e!=null&&e.uid){const Ae=x(e.uid);return()=>Ae()}},[e==null?void 0:e.uid,x]);const k=()=>{const Ae=new Date().getHours();return Ae<12?"Good Morning":Ae<18?"Good Afternoon":"Good Evening"},R=((A=e==null?void 0:e.displayName)==null?void 0:A.split(" ")[0])||"there",P=async Ae=>{if(e!=null&&e.uid)try{await f(Ae,e.uid,K)}catch(Xe){console.error("Error toggling completion:",Xe)}},V=async(Ae,Xe)=>{if(e!=null&&e.uid)try{await m(Ae,e.uid,K,Xe)}catch(ie){console.error("Error updating progress:",ie)}},M=Ae=>{D(Ae)};return E.jsxs("div",{className:"relative flex h-auto min-h-screen w-full flex-col overflow-x-hidden",children:[E.jsxs("div",{className:"flex-grow pb-40",children:[E.jsxs("div",{className:"md:min-h-[50vh] md:flex md:flex-col md:justify-center md:bg-gray-50/50 md:dark:bg-gray-900/50",children:[E.jsxs("div",{className:"flex items-center bg-background-light dark:bg-background-dark md:bg-transparent p-4 pb-2 justify-between sticky top-0 z-10 md:static",children:[E.jsxs("div",{className:"flex items-center gap-3",children:[E.jsx("div",{className:"flex size-12 shrink-0 items-center justify-center",children:e!=null&&e.photoURL?E.jsx("img",{src:e.photoURL,alt:"Profile",className:"rounded-full size-10 object-cover",referrerPolicy:"no-referrer"}):E.jsx("div",{className:"rounded-full size-10 bg-primary/20 flex items-center justify-center",children:E.jsx("span",{className:"material-symbols-outlined text-primary",children:"person"})})}),E.jsxs("h2",{className:"text-text-light-primary dark:text-text-dark-primary text-lg font-bold leading-tight tracking-[-0.015em] flex-1",children:[k(),", ",R,"!"]})]}),E.jsx("div",{className:"flex w-12 items-center justify-end",children:E.jsx("button",{className:"flex max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-12 bg-transparent text-text-light-primary dark:text-text-dark-primary gap-2 text-base font-bold leading-normal tracking-[0.015em] min-w-0 p-0",children:E.jsx("span",{className:"material-symbols-outlined",children:"calendar_today"})})})]}),E.jsxs("div",{className:"flex flex-col gap-3 p-4",children:[E.jsxs("div",{className:"flex gap-6 justify-between items-center",children:[E.jsxs("p",{className:"text-text-light-primary dark:text-text-dark-primary text-base font-medium leading-normal",children:[X?"You've completed":"Completed"," ",ue," of ",ce," habits",X?" today":"","!"]}),E.jsxs("p",{className:"text-text-light-secondary dark:text-text-dark-secondary text-sm font-normal leading-normal",children:[C,"%"]})]}),E.jsx("div",{className:"rounded-full bg-border-light dark:bg-border-dark/50",children:E.jsx("div",{className:"h-2 rounded-full bg-primary transition-all duration-500 ease-out",style:{width:`${C}%`}})}),E.jsx("p",{className:"text-text-light-secondary dark:text-text-dark-secondary text-sm font-normal leading-normal",children:C>=100?" All done!":C>0?"Keep it up!":ce===0?"No habits scheduled":"Start completing your habits!"})]}),E.jsx(zV,{selectedDate:S,onDateSelect:M,completionsByDate:r})]}),E.jsx("h3",{className:"text-text-light-primary dark:text-text-dark-primary text-lg font-bold leading-tight tracking-[-0.015em] px-4 pb-2 pt-2",children:X?"Today's Habits":`Habits for ${S.toLocaleDateString("en-US",{weekday:"long"})}`}),E.jsx("div",{className:"px-4 flex flex-col gap-2",children:s?E.jsx("div",{className:"flex justify-center py-12",children:E.jsx(Eo,{})}):ne.length===0?E.jsxs("div",{className:"text-center py-12",children:[E.jsx("span",{className:"material-symbols-outlined text-4xl text-gray-400 mb-2 block",children:"checklist"}),E.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:t.length===0?"No habits yet":"No habits scheduled for this day"}),t.length===0&&E.jsx("button",{onClick:()=>n("/new-habit"),className:"text-primary font-medium hover:underline",children:"Create your first habit"})]}):ne.map(Ae=>E.jsx(KT,{habit:Ae,isCompleted:d(Ae.id,K),currentValue:v(Ae.id,K),onToggle:P,onUpdateProgress:V,disabled:q},Ae.id))})]}),E.jsx("div",{className:"fixed bottom-24 right-4 z-20",children:E.jsx("button",{onClick:()=>n("/new-habit"),className:"flex items-center justify-center size-14 cursor-pointer overflow-hidden rounded-full bg-primary text-text-light-primary shadow-lg hover:shadow-xl transition-shadow animate-pulse-glow",children:E.jsx("span",{className:"material-symbols-outlined text-3xl",children:"add"})})}),E.jsx(ol,{})]})}function br({label:n,id:e,error:t,className:r="",...s}){return E.jsxs("div",{className:"flex flex-col",children:[n&&E.jsx("label",{htmlFor:e,className:"text-base font-medium leading-normal pb-2 text-gray-800 dark:text-gray-400 uppercase tracking-wide",children:n}),E.jsx("input",{id:e,className:`
          form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden 
          rounded-lg border border-gray-200 dark:border-gray-700 
          bg-white dark:bg-gray-800 
          h-14 p-4 
          text-base font-normal leading-normal 
          text-text-light-primary dark:text-white 
          placeholder:text-gray-400 dark:placeholder:text-gray-500 
          focus:border-primary focus:ring-primary/50 focus:ring-2 focus:outline-none
          transition-colors
          ${t?"border-danger focus:border-danger focus:ring-danger/50":""}
          ${r}
        `,...s}),t&&E.jsx("p",{className:"mt-1 text-sm text-danger",children:t})]})}function Wa({checked:n,onChange:e,label:t,description:r}){return E.jsxs("div",{className:"flex flex-col",children:[E.jsxs("div",{className:"flex items-center justify-between",children:[t&&E.jsx("h3",{className:"text-base font-medium leading-tight tracking-[-0.015em] text-gray-800 dark:text-gray-400 uppercase",children:t}),E.jsxs("label",{className:"relative inline-flex cursor-pointer items-center",children:[E.jsx("input",{type:"checkbox",checked:n,onChange:s=>e(s.target.checked),className:"peer sr-only"}),E.jsx("div",{className:"peer h-6 w-11 rounded-full bg-gray-200 dark:bg-gray-700 after:absolute after:top-[2px] after:left-[2px] after:h-5 after:w-5 after:rounded-full after:border after:border-gray-300 dark:after:border-gray-600 after:bg-white after:transition-all peer-checked:bg-primary peer-checked:after:translate-x-full peer-checked:after:border-white"})]})]}),r&&E.jsx("p",{className:"pt-2 text-sm text-gray-500 dark:text-gray-400",children:r})]})}const HV=[{key:0,label:"S",name:"Sunday"},{key:1,label:"M",name:"Monday"},{key:2,label:"T",name:"Tuesday"},{key:3,label:"W",name:"Wednesday"},{key:4,label:"T",name:"Thursday"},{key:5,label:"F",name:"Friday"},{key:6,label:"S",name:"Saturday"}];function QT({isOpen:n,onClose:e,selectedDays:t=[],onSave:r}){const[s,a]=F.useState(t),l=f=>{a(m=>m.includes(f)?m.filter(v=>v!==f):[...m,f])},d=()=>{r(s),e()};return n?E.jsx("div",{className:"fixed inset-0 z-50 flex items-end bg-black/50 backdrop-blur-sm animate-fade-in",children:E.jsxs("div",{className:"flex h-auto w-full flex-col rounded-t-xl bg-background-light dark:bg-gray-800 animate-slide-up",children:[E.jsxs("div",{className:"relative flex items-center justify-center border-b border-gray-200 p-4 dark:border-gray-700",children:[E.jsx("h2",{className:"text-lg font-bold text-text-light-primary dark:text-text-dark-primary",children:"Select Days"}),E.jsx("button",{onClick:e,className:"absolute right-4 top-1/2 -translate-y-1/2",children:E.jsx("span",{className:"material-symbols-outlined !text-2xl text-gray-500 dark:text-gray-400",children:"close"})})]}),E.jsxs("div",{className:"p-4",children:[E.jsx("p",{className:"mb-4 text-center text-sm text-gray-500 dark:text-gray-400",children:"Choose the specific days of the week you want to track this habit."}),E.jsx("div",{className:"flex justify-center gap-2",children:HV.map(f=>{const m=s.includes(f.key);return E.jsx("button",{onClick:()=>l(f.key),className:`
                    relative flex h-12 w-12 cursor-pointer flex-col items-center justify-center rounded-full border transition-all
                    ${m?"border-primary bg-primary text-black":"border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-800 text-text-light-primary dark:text-text-dark-primary hover:border-primary/50"}
                  `,title:f.name,children:E.jsx("span",{className:"font-bold",children:f.label})},f.key)})})]}),E.jsx("div",{className:"p-4 pt-2 pb-6",children:E.jsx(is,{fullWidth:!0,onClick:d,disabled:s.length===0,children:"Save"})})]})}):null}const WV=[{value:"checkbox",icon:"check_box",label:"Checkbox"},{value:"numerical",icon:"pin",label:"Numerical"}];function GV(){const n=$n(),{user:e}=go(),{addHabit:t}=cs(),[r,s]=F.useState(""),[a,l]=F.useState("daily"),[d,f]=F.useState([]),[m,v]=F.useState("checkbox"),[_,x]=F.useState(""),[S,D]=F.useState(""),[U,L]=F.useState(new Date().toISOString().split("T")[0]),[K,X]=F.useState(""),[q,ne]=F.useState(!1),[ue,ce]=F.useState(!1),[C,k]=F.useState(!1),[R,P]=F.useState(!1),[V,M]=F.useState(null),A=r.trim().length>0&&(m==="checkbox"||_>0&&S.trim().length>0)&&(a!=="one-time"||U),Ae=ie=>{l(ie),ie==="custom"&&k(!0)},Xe=async()=>{if(!(!A||R||!(e!=null&&e.uid))){P(!0),M(null);try{const ie={title:r.trim(),description:"",frequency:a,customDays:a==="custom"?d:[],targetDate:a==="one-time"?U:null,reminderTime:K||null,hasReminder:q&&!!K,completionType:m,targetValue:m==="numerical"?Number(_):null,unit:m==="numerical"?S.trim():null,isPublic:!ue};await t(e.uid,ie),n("/dashboard")}catch(ie){console.error("Failed to create habit:",ie),M("Failed to create habit. Please try again.")}finally{P(!1)}}};return E.jsxs("div",{className:"relative flex h-auto min-h-screen w-full flex-col bg-background-light dark:bg-background-dark overflow-x-hidden",children:[E.jsxs("header",{className:"flex items-center p-4",children:[E.jsx("button",{onClick:()=>n(-1),className:"flex size-12 shrink-0 items-center justify-start text-text-light-primary dark:text-gray-200",children:E.jsx("span",{className:"material-symbols-outlined !text-2xl",children:"arrow_back_ios_new"})}),E.jsx("h1",{className:"flex-1 text-center text-lg font-bold leading-tight tracking-[-0.015em] text-text-light-primary dark:text-gray-200",children:"New Habit"}),E.jsx("div",{className:"flex w-12 items-center justify-end",children:E.jsx("button",{onClick:Xe,disabled:!A||R,className:`text-base font-bold leading-normal tracking-[0.015em] shrink-0 ${A&&!R?"text-primary":"text-primary/50 dark:text-primary/70"}`,children:"Save"})})]}),E.jsxs("main",{className:"flex flex-col gap-6 px-4 pt-4 pb-6",children:[V&&E.jsx("div",{className:"p-3 rounded-lg bg-danger/10 text-danger text-sm",children:V}),E.jsx(br,{label:"Name",id:"habitName",placeholder:"e.g., Read for 15 minutes",value:r,onChange:ie=>s(ie.target.value)}),E.jsxs("div",{className:"flex flex-col",children:[E.jsx("h3",{className:"text-base font-medium leading-tight tracking-[-0.015em] pb-2 text-gray-800 dark:text-gray-400 uppercase",children:"Frequency"}),E.jsx("div",{className:"flex h-12 flex-1 items-center justify-center rounded-lg bg-gray-200/60 dark:bg-gray-800 p-1",children:[{value:"daily",label:"Daily"},{value:"weekly",label:"Weekly"},{value:"one-time",label:"One Time"},{value:"custom",label:"More"}].map(ie=>E.jsxs("label",{className:`
                  flex h-full flex-1 cursor-pointer items-center justify-center overflow-hidden rounded-md px-1 
                  text-xs font-medium leading-normal transition-all
                  ${a===ie.value?"bg-white dark:bg-gray-900 text-text-light-primary dark:text-white shadow-sm":"text-gray-600 dark:text-gray-400"}
                `,children:[E.jsxs("span",{className:"flex items-center gap-1",children:[ie.label,ie.value==="custom"&&E.jsx("span",{className:"material-symbols-outlined !text-base",children:"expand_more"})]}),E.jsx("input",{type:"radio",name:"frequency",value:ie.value,checked:a===ie.value,onChange:()=>Ae(ie.value),className:"invisible w-0"})]},ie.value))}),a==="one-time"&&E.jsx("div",{className:"mt-3 animation-slide-down",children:E.jsx(br,{label:"Valid only on",type:"date",value:U,onChange:ie=>L(ie.target.value),min:new Date().toISOString().split("T")[0]})}),a==="custom"&&d.length>0&&E.jsxs("button",{onClick:()=>k(!0),className:"mt-2 text-sm text-primary hover:underline text-left",children:[d.length," days selected - tap to edit"]}),a==="custom"&&d.length===0&&E.jsx("button",{onClick:()=>k(!0),className:"mt-2 text-sm text-gray-500 hover:text-primary text-left",children:"Click to select days"})]}),E.jsxs("div",{className:"flex flex-col gap-2",children:[E.jsx("h3",{className:"text-base font-medium leading-tight tracking-[-0.015em] text-gray-800 dark:text-gray-400 uppercase",children:"Schedule"}),E.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[E.jsx(br,{label:"Time (Optional)",type:"time",value:K,onChange:ie=>{X(ie.target.value),ie.target.value&&!q&&ne(!0)}}),E.jsx("div",{className:"flex items-end pb-2",children:E.jsx(Wa,{label:"Remind 10m before",checked:q,onChange:ne,disabled:!K})})]}),q&&!K&&E.jsx("p",{className:"text-xs text-danger",children:"Please set a time to enable reminders."})]}),E.jsxs("div",{className:"flex flex-col",children:[E.jsx("h3",{className:"text-base font-medium leading-tight tracking-[-0.015em] pb-2 text-gray-800 dark:text-gray-400 uppercase",children:"How will you track it?"}),E.jsx("div",{className:"grid grid-cols-2 gap-3 mb-4",children:WV.map(ie=>E.jsxs("label",{className:`
                  flex cursor-pointer flex-col items-center justify-center gap-2 rounded-lg border-2 p-4 py-6 text-center transition-all
                  ${m===ie.value?"border-primary bg-primary/10 dark:bg-primary/20 text-primary":"border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300"}
                `,children:[E.jsx("span",{className:"material-symbols-outlined !text-3xl",children:ie.icon}),E.jsx("span",{className:"font-medium",children:ie.label}),E.jsx("input",{type:"radio",name:"tracking_type",value:ie.value,checked:m===ie.value,onChange:()=>v(ie.value),className:"invisible w-0"})]},ie.value))}),m==="numerical"&&E.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4 animation-slide-down",children:[E.jsx(br,{label:"Target Goal",type:"number",placeholder:"e.g. 5",value:_,onChange:ie=>x(ie.target.value),min:"1"}),E.jsx(br,{label:"Unit",type:"text",placeholder:"e.g. cups",value:S,onChange:ie=>D(ie.target.value)})]})]}),E.jsx(Wa,{label:"Make it private?",description:"Private habits will not appear on the community feed or your profile.",checked:ue,onChange:ce})]}),E.jsx("footer",{className:"mt-auto px-4 pb-6 pt-4",children:E.jsx(is,{fullWidth:!0,onClick:Xe,isLoading:R,disabled:!A,children:"Add Habit"})}),E.jsx(QT,{isOpen:C,onClose:()=>k(!1),selectedDays:d,onSave:f})]})}const KV=[{value:"daily",label:"Daily"},{value:"weekly",label:"Weekly"},{value:"one-time",label:"One Time"},{value:"custom",label:"More"}],QV=[{value:"checkbox",icon:"check_box",label:"Checkbox"},{value:"numerical",icon:"pin",label:"Numerical"}];function XV(){const{habitId:n}=zm(),e=$n(),{habits:t,updateHabit:r}=cs(),s=t.find(ie=>ie.id===n),[a,l]=F.useState(""),[d,f]=F.useState("daily"),[m,v]=F.useState([]),[_,x]=F.useState("checkbox"),[S,D]=F.useState(""),[U,L]=F.useState(""),[K,X]=F.useState(new Date().toISOString().split("T")[0]),[q,ne]=F.useState(""),[ue,ce]=F.useState(!1),[C,k]=F.useState(!1),[R,P]=F.useState(!1),[V,M]=F.useState(!1);if(F.useEffect(()=>{s&&(l(s.title||""),f(s.frequency||"daily"),v(s.customDays||[]),x(s.completionType||"checkbox"),D(s.targetValue||""),L(s.unit||""),X(s.targetDate||new Date().toISOString().split("T")[0]),ne(s.reminderTime||""),ce(s.hasReminder||!1),k(!s.isPublic))},[s]),!s)return E.jsx("div",{className:"min-h-screen bg-background-light dark:bg-background-dark flex items-center justify-center",children:E.jsxs("div",{className:"text-center",children:[E.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"Habit not found"}),E.jsx(is,{onClick:()=>e("/dashboard"),children:"Back to Dashboard"})]})});const A=a.trim().length>0&&(_==="checkbox"||S>0&&U.trim().length>0)&&(d!=="one-time"||K),Ae=ie=>{f(ie),ie==="custom"&&P(!0)},Xe=async()=>{if(!(!A||V)){M(!0);try{await r(n,{title:a.trim(),frequency:d,customDays:d==="custom"?m:[],targetDate:d==="one-time"?K:null,reminderTime:q||null,hasReminder:ue&&!!q,completionType:_,targetValue:_==="numerical"?Number(S):null,unit:_==="numerical"?U.trim():null,isPublic:!C}),e(`/habit/${n}`)}catch(ie){console.error("Failed to update habit:",ie)}finally{M(!1)}}};return E.jsxs("div",{className:"relative flex h-auto min-h-screen w-full flex-col bg-background-light dark:bg-background-dark overflow-x-hidden",children:[E.jsxs("header",{className:"flex items-center p-4",children:[E.jsx("button",{onClick:()=>e("/dashboard"),className:"flex size-12 shrink-0 items-center justify-start text-text-light-primary dark:text-gray-200",children:E.jsx("span",{className:"material-symbols-outlined !text-2xl",children:"arrow_back_ios_new"})}),E.jsx("h1",{className:"flex-1 text-center text-lg font-bold leading-tight tracking-[-0.015em] text-text-light-primary dark:text-gray-200",children:"Edit Habit"}),E.jsx("div",{className:"flex w-12 items-center justify-end",children:E.jsx("button",{onClick:Xe,disabled:!A||V,className:`text-base font-bold leading-normal tracking-[0.015em] shrink-0 ${A&&!V?"text-primary":"text-primary/50 dark:text-primary/70"}`,children:"Save"})})]}),E.jsxs("main",{className:"flex flex-col gap-6 px-4 pt-4 pb-6",children:[E.jsx(br,{label:"Name",id:"habitName",placeholder:"e.g., Read for 15 minutes",value:a,onChange:ie=>l(ie.target.value)}),E.jsxs("div",{className:"flex flex-col",children:[E.jsx("h3",{className:"text-base font-medium leading-tight tracking-[-0.015em] pb-2 text-gray-800 dark:text-gray-400 uppercase",children:"Frequency"}),E.jsx("div",{className:"flex h-12 flex-1 items-center justify-center rounded-lg bg-gray-200/60 dark:bg-gray-800 p-1",children:KV.map(ie=>E.jsxs("label",{className:`
                  flex h-full flex-1 cursor-pointer items-center justify-center overflow-hidden rounded-md px-1 
                  text-xs font-medium leading-normal transition-all
                  ${d===ie.value?"bg-white dark:bg-gray-900 text-text-light-primary dark:text-white shadow-sm":"text-gray-600 dark:text-gray-400"}
                `,children:[E.jsxs("span",{className:"flex items-center gap-1",children:[ie.label,ie.value==="custom"&&E.jsx("span",{className:"material-symbols-outlined !text-base",children:"expand_more"})]}),E.jsx("input",{type:"radio",name:"frequency",value:ie.value,checked:d===ie.value,onChange:()=>Ae(ie.value),className:"invisible w-0"})]},ie.value))}),d==="one-time"&&E.jsx("div",{className:"mt-3 animation-slide-down",children:E.jsx(br,{label:"Valid only on",type:"date",value:K,onChange:ie=>X(ie.target.value),min:new Date().toISOString().split("T")[0]})}),d==="custom"&&m.length>0&&E.jsxs("button",{onClick:()=>P(!0),className:"mt-2 text-sm text-primary hover:underline text-left",children:[m.length," days selected - tap to edit"]}),d==="custom"&&m.length===0&&E.jsx("button",{onClick:()=>P(!0),className:"mt-2 text-sm text-gray-500 hover:text-primary text-left",children:"Click to select days"})]}),E.jsxs("div",{className:"flex flex-col gap-2",children:[E.jsx("h3",{className:"text-base font-medium leading-tight tracking-[-0.015em] text-gray-800 dark:text-gray-400 uppercase",children:"Schedule"}),E.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[E.jsx(br,{label:"Time (Optional)",type:"time",value:q,onChange:ie=>{ne(ie.target.value),ie.target.value&&!ue&&ce(!0)}}),E.jsx("div",{className:"flex items-end pb-2",children:E.jsx(Wa,{label:"Remind 10m before",checked:ue,onChange:ce,disabled:!q})})]}),ue&&!q&&E.jsx("p",{className:"text-xs text-danger",children:"Please set a time to enable reminders."})]}),E.jsxs("div",{className:"flex flex-col",children:[E.jsx("h3",{className:"text-base font-medium leading-tight tracking-[-0.015em] pb-2 text-gray-800 dark:text-gray-400 uppercase",children:"How will you track it?"}),E.jsx("div",{className:"grid grid-cols-2 gap-3 mb-4",children:QV.map(ie=>E.jsxs("label",{className:`
                  flex cursor-pointer flex-col items-center justify-center gap-2 rounded-lg border-2 p-4 py-6 text-center transition-all
                  ${_===ie.value?"border-primary bg-primary/10 dark:bg-primary/20 text-primary":"border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300"}
                `,children:[E.jsx("span",{className:"material-symbols-outlined !text-3xl",children:ie.icon}),E.jsx("span",{className:"font-medium",children:ie.label}),E.jsx("input",{type:"radio",name:"tracking_type",value:ie.value,checked:_===ie.value,onChange:()=>x(ie.value),className:"invisible w-0"})]},ie.value))}),_==="numerical"&&E.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4 animation-slide-down",children:[E.jsx(br,{label:"Target Goal",type:"number",placeholder:"e.g. 5",value:S,onChange:ie=>D(ie.target.value),min:"1"}),E.jsx(br,{label:"Unit",type:"text",placeholder:"e.g. cups",value:U,onChange:ie=>L(ie.target.value)})]})]}),E.jsx(Wa,{label:"Make it private?",description:"Private habits will not appear on the community feed or your profile.",checked:C,onChange:k})]}),E.jsx("footer",{className:"mt-auto px-4 pb-6 pt-4",children:E.jsx(is,{fullWidth:!0,onClick:Xe,isLoading:V,disabled:!A,children:"Save Changes"})}),E.jsx(QT,{isOpen:R,onClose:()=>P(!1),selectedDays:m,onSave:v})]})}const YV={daily:"Daily",weekly:"Weekly",custom:"Custom Days"},JV={checkbox:"Check-off",numerical:"Numerical"},ZV=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];function eO(){const{habitId:n}=zm(),e=$n(),{habits:t,deleteHabit:r,isLoading:s}=cs(),a=t.find(m=>m.id===n),l=async()=>{if(window.confirm("Are you sure you want to delete this habit? This action cannot be undone."))try{await r(n),e("/dashboard")}catch(m){console.error("Error deleting habit:",m),alert("Failed to delete habit. Please try again.")}};if(s)return E.jsx("div",{className:"min-h-screen bg-background-light dark:bg-background-dark flex items-center justify-center",children:E.jsx(Eo,{size:"lg"})});if(!a)return E.jsx("div",{className:"min-h-screen bg-background-light dark:bg-background-dark flex items-center justify-center",children:E.jsxs("div",{className:"text-center",children:[E.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"Habit not found"}),E.jsx(is,{onClick:()=>e("/dashboard"),children:"Back to Dashboard"})]})});const d=()=>{var m;return a.frequency!=="custom"||!((m=a.customDays)!=null&&m.length)?null:a.customDays.map(v=>ZV[v]).join(", ")},f=[{icon:"event_repeat",label:"Frequency",value:a.frequency==="custom"?d():YV[a.frequency]||a.frequency},{icon:"task_alt",label:"Completion Type",value:JV[a.completionType]||a.completionType||"Check-off"},{icon:a.isPublic?"public":"lock",label:"Visibility",value:a.isPublic?"Public":"Private"}];return E.jsxs("div",{className:"relative flex h-auto min-h-screen w-full flex-col overflow-x-hidden font-display bg-background-light dark:bg-background-dark",children:[E.jsxs("div",{className:"flex-grow pb-28",children:[E.jsxs("header",{className:"flex items-center bg-background-light dark:bg-background-dark p-4 justify-between sticky top-0 z-10 border-b border-border-light dark:border-border-dark",children:[E.jsx("div",{className:"flex w-12 items-center justify-start",children:E.jsx("button",{onClick:()=>e(-1),className:"flex max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-12 bg-transparent text-text-light-primary dark:text-text-dark-primary gap-2 text-base font-bold leading-normal tracking-[0.015em] min-w-0 p-0",children:E.jsx("span",{className:"material-symbols-outlined",children:"arrow_back_ios_new"})})}),E.jsx("h1",{className:"text-text-light-primary dark:text-text-dark-primary text-lg font-bold leading-tight tracking-[-0.015em] text-center",children:"Habit Details"}),E.jsx("div",{className:"flex w-12 items-center justify-end",children:E.jsx("button",{className:"flex max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-12 bg-transparent text-text-light-primary dark:text-text-dark-primary gap-2 text-base font-bold leading-normal tracking-[0.015em] min-w-0 p-0",children:E.jsx("span",{className:"material-symbols-outlined",children:"more_vert"})})})]}),E.jsxs("main",{className:"p-4",children:[E.jsxs("div",{className:"bg-content-light dark:bg-content-dark rounded-xl p-6 flex flex-col items-center",children:[E.jsx("h2",{className:"text-2xl font-bold text-text-light-primary dark:text-text-dark-primary text-center",children:a.title}),(a.currentStreak||0)>0&&E.jsxs("div",{className:"mt-4 py-2 px-4 rounded-full bg-primary/20 text-primary flex items-center gap-2",children:[E.jsx("span",{className:"material-symbols-outlined text-base",style:{fontVariationSettings:"'FILL' 1, 'wght' 700"},children:"local_fire_department"}),E.jsxs("p",{className:"font-bold text-sm",children:["Current Streak: ",a.currentStreak," ",a.currentStreak===1?"day":"days"]})]})]}),E.jsx("div",{className:"mt-4 grid grid-cols-1 gap-4",children:f.map(m=>E.jsxs("div",{className:"bg-content-light dark:bg-content-dark rounded-xl p-4 flex items-center gap-4",children:[E.jsx("div",{className:"flex items-center justify-center size-10 rounded-lg bg-primary/20 text-primary",children:E.jsx("span",{className:"material-symbols-outlined",children:m.icon})}),E.jsxs("div",{children:[E.jsx("p",{className:"text-sm text-text-light-secondary dark:text-text-dark-secondary",children:m.label}),E.jsx("p",{className:"text-base font-medium text-text-light-primary dark:text-text-dark-primary",children:m.value})]})]},m.label))}),E.jsxs("div",{className:"mt-8 flex flex-col gap-3",children:[E.jsx(is,{fullWidth:!0,icon:"edit",onClick:()=>e(`/edit-habit/${a.id}`),children:"Edit Habit"}),E.jsx(is,{fullWidth:!0,variant:"danger",icon:"delete",onClick:l,children:"Delete Habit"})]})]})]}),E.jsx(ol,{})]})}function tO(){const n=$n(),{user:e}=go(),[t,r]=F.useState("thisWeek"),[s,a]=F.useState([]),[l,d]=F.useState({rank:0,percentage:0}),[f,m]=F.useState(!0);F.useEffect(()=>{let D=()=>{};m(!0);try{const U=t==="thisWeek"?rc():AV();D=RV(U,L=>{if(a(L),e!=null&&e.uid){const K=L.find(X=>X.userId===e.uid);d(K?{rank:K.rank,percentage:K.percentage}:{rank:L.length+1,percentage:0})}m(!1)})}catch(U){console.error("Error in leaderboard subscription:",U),m(!1)}return()=>{D&&D()}},[t,e==null?void 0:e.uid]);const v=s.slice(0,3),_=s,x=D=>{switch(D){case 1:return"border-yellow-400";case 2:return"border-slate-300";case 3:return"border-amber-600";default:return"border-gray-300"}},S=D=>{switch(D){case 1:return"bg-yellow-400 text-yellow-900";case 2:return"bg-slate-300 text-slate-700";case 3:return"bg-amber-600 text-amber-100";default:return"bg-gray-300 text-gray-700"}};return E.jsxs("div",{className:"relative flex h-auto min-h-screen w-full flex-col overflow-x-hidden bg-background-light dark:bg-background-dark font-display text-slate-800 dark:text-slate-200",children:[E.jsxs("div",{className:"flex items-center p-4 pb-2 bg-background-light dark:bg-background-dark sticky top-0 z-10",children:[E.jsx("button",{onClick:()=>n(-1),className:"flex size-12 shrink-0 items-center justify-start",children:E.jsx("span",{className:"material-symbols-outlined",children:"arrow_back_ios_new"})}),E.jsx("h2",{className:"flex-1 text-center text-lg font-bold leading-tight tracking-[-0.015em]",children:"Weekly Leaderboard"}),E.jsx("div",{className:"flex w-12 items-center justify-end",children:E.jsx("button",{className:"flex h-12 cursor-pointer items-center justify-center gap-2 overflow-hidden rounded-lg bg-transparent min-w-0 p-0 text-base font-bold leading-normal tracking-[0.015em]",children:E.jsx("span",{className:"material-symbols-outlined",children:"ios_share"})})})]}),E.jsx("div",{className:"flex px-4 py-3",children:E.jsxs("div",{className:"flex h-10 flex-1 items-center justify-center rounded-lg bg-black/5 dark:bg-white/5 p-1",children:[E.jsxs("label",{className:`flex h-full grow cursor-pointer items-center justify-center overflow-hidden rounded-lg px-2 text-sm font-medium leading-normal transition-all ${t==="thisWeek"?"bg-background-light dark:bg-background-dark text-slate-900 dark:text-slate-100 shadow-sm":"text-slate-500 dark:text-slate-400"}`,children:[E.jsx("span",{className:"truncate",children:"This Week"}),E.jsx("input",{type:"radio",name:"time-period",value:"thisWeek",checked:t==="thisWeek",onChange:()=>r("thisWeek"),className:"invisible w-0"})]}),E.jsxs("label",{className:`flex h-full grow cursor-pointer items-center justify-center overflow-hidden rounded-lg px-2 text-sm font-medium leading-normal transition-all ${t==="lastWeek"?"bg-background-light dark:bg-background-dark text-slate-900 dark:text-slate-100 shadow-sm":"text-slate-500 dark:text-slate-400"}`,children:[E.jsx("span",{className:"truncate",children:"Last Week"}),E.jsx("input",{type:"radio",name:"time-period",value:"lastWeek",checked:t==="lastWeek",onChange:()=>r("lastWeek"),className:"invisible w-0"})]})]})}),f?E.jsx("div",{className:"flex-1 flex items-center justify-center py-12",children:E.jsx(Eo,{size:"lg"})}):s.length===0?E.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center py-12 px-4",children:[E.jsx("span",{className:"material-symbols-outlined text-5xl text-gray-400 mb-4",children:"leaderboard"}),E.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center",children:"No leaderboard data yet."}),E.jsx("p",{className:"text-gray-400 dark:text-gray-500 text-sm text-center mt-2",children:"Complete habits to appear on the leaderboard!"})]}):E.jsxs(E.Fragment,{children:[E.jsxs("div",{className:"flex items-end justify-center gap-4 px-4 py-6",children:[v[1]&&E.jsxs("div",{className:"flex flex-col items-center gap-2 cursor-pointer transition-transform active:scale-95",onClick:()=>n(`/profile/${v[1].userId}`),children:[E.jsxs("div",{className:"relative",children:[v[1].photoURL?E.jsx("img",{src:v[1].photoURL,alt:v[1].displayName,className:`aspect-square w-16 rounded-full bg-cover bg-center border-2 ${x(2)} object-cover`,referrerPolicy:"no-referrer"}):E.jsx("div",{className:`aspect-square w-16 rounded-full border-2 ${x(2)} bg-primary/20 flex items-center justify-center`,children:E.jsx("span",{className:"material-symbols-outlined text-primary text-2xl",children:"person"})}),E.jsx("div",{className:`absolute -bottom-2 left-1/2 -translate-x-1/2 flex h-6 w-6 items-center justify-center rounded-full ${S(2)} text-sm font-bold`,children:"2"})]}),E.jsx("p",{className:"text-sm font-bold",children:v[1].displayName}),E.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:[v[1].percentage,"%"]})]}),v[0]&&E.jsxs("div",{className:"flex flex-col items-center gap-2 cursor-pointer transition-transform active:scale-95",onClick:()=>n(`/profile/${v[0].userId}`),children:[E.jsxs("div",{className:"relative",children:[v[0].photoURL?E.jsx("img",{src:v[0].photoURL,alt:v[0].displayName,className:`aspect-square w-24 rounded-full bg-cover bg-center border-4 ${x(1)} object-cover`,referrerPolicy:"no-referrer"}):E.jsx("div",{className:`aspect-square w-24 rounded-full border-4 ${x(1)} bg-primary/20 flex items-center justify-center`,children:E.jsx("span",{className:"material-symbols-outlined text-primary text-3xl",children:"person"})}),E.jsx("div",{className:`absolute -bottom-2 left-1/2 -translate-x-1/2 flex h-8 w-8 items-center justify-center rounded-full ${S(1)} text-base font-bold`,children:"1"})]}),E.jsx("p",{className:"text-base font-bold",children:v[0].displayName}),E.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:[v[0].percentage,"%"]})]}),v[2]&&E.jsxs("div",{className:"flex flex-col items-center gap-2 cursor-pointer transition-transform active:scale-95",onClick:()=>n(`/profile/${v[2].userId}`),children:[E.jsxs("div",{className:"relative",children:[v[2].photoURL?E.jsx("img",{src:v[2].photoURL,alt:v[2].displayName,className:`aspect-square w-16 rounded-full bg-cover bg-center border-2 ${x(3)} object-cover`,referrerPolicy:"no-referrer"}):E.jsx("div",{className:`aspect-square w-16 rounded-full border-2 ${x(3)} bg-primary/20 flex items-center justify-center`,children:E.jsx("span",{className:"material-symbols-outlined text-primary text-2xl",children:"person"})}),E.jsx("div",{className:`absolute -bottom-2 left-1/2 -translate-x-1/2 flex h-6 w-6 items-center justify-center rounded-full ${S(3)} text-sm font-bold`,children:"3"})]}),E.jsx("p",{className:"text-sm font-bold",children:v[2].displayName}),E.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:[v[2].percentage,"%"]})]})]}),e&&E.jsx("div",{className:"p-4",children:E.jsxs("div",{className:"flex items-center justify-between gap-4 rounded-xl bg-primary/20 dark:bg-primary/30 p-4 border border-primary",children:[E.jsxs("div",{className:"flex items-center gap-4",children:[E.jsx("p",{className:"text-lg font-bold w-6 text-center",children:l.rank||"-"}),e.photoURL?E.jsx("img",{src:e.photoURL,alt:"Your avatar",className:"w-12 h-12 rounded-full object-cover flex-shrink-0",referrerPolicy:"no-referrer"}):E.jsx("div",{className:"w-12 h-12 rounded-full bg-primary/30 flex items-center justify-center flex-shrink-0",children:E.jsx("span",{className:"material-symbols-outlined text-primary",children:"person"})}),E.jsxs("div",{className:"flex flex-col",children:[E.jsx("p",{className:"text-base font-bold leading-tight",children:"You"}),E.jsxs("p",{className:"text-sm font-normal leading-normal text-slate-600 dark:text-slate-300",children:[l.percentage||0,"% complete"]})]})]}),E.jsx("span",{className:"material-symbols-outlined text-primary",children:"workspace_premium"})]})}),E.jsx("div",{className:"flex flex-col gap-2 px-4 pb-24",children:_.map(D=>E.jsxs("div",{onClick:()=>n(`/profile/${D.userId}`),className:`flex items-center gap-4 rounded-xl p-3 shadow-sm cursor-pointer transition-colors hover:bg-black/5 dark:hover:bg-white/5 ${D.userId===(e==null?void 0:e.uid)?"bg-primary/10 dark:bg-primary/20 border border-primary/50":"bg-white dark:bg-background-dark"}`,children:[E.jsx("p",{className:"w-6 text-center font-semibold text-slate-500 dark:text-slate-400",children:D.rank}),D.photoURL?E.jsx("img",{src:D.photoURL,alt:D.displayName,className:"h-10 w-10 flex-shrink-0 rounded-full object-cover",referrerPolicy:"no-referrer"}):E.jsx("div",{className:"h-10 w-10 flex-shrink-0 rounded-full bg-primary/20 flex items-center justify-center",children:E.jsx("span",{className:"material-symbols-outlined text-primary text-xl",children:"person"})}),E.jsxs("div",{className:"flex-grow",children:[E.jsx("p",{className:"font-bold",children:D.displayName}),E.jsx("div",{className:"mt-1 h-1.5 w-full rounded-full bg-slate-200 dark:bg-slate-700",children:E.jsx("div",{className:"h-1.5 rounded-full bg-primary transition-all",style:{width:`${D.percentage}%`}})})]}),E.jsxs("p",{className:"font-bold text-sm",children:[D.percentage,"%"]})]},D.id))})]}),E.jsx(ol,{})]})}function nO(){const{userId:n}=zm(),e=$n(),[t,r]=F.useState(null),[s,a]=F.useState([]),[l,d]=F.useState(null),[f,m]=F.useState(!0);return F.useEffect(()=>{(async()=>{if(n){m(!0);try{const[_,x,S]=await Promise.all([GT(n),wV(n),bV(n)]);r(_),a(x),d(S)}catch(_){console.error("Failed to load user profile",_)}finally{m(!1)}}})()},[n]),f?E.jsx("div",{className:"flex h-screen items-center justify-center bg-background-light dark:bg-background-dark",children:E.jsx(Eo,{})}):t?E.jsxs("div",{className:"relative flex h-auto min-h-screen w-full flex-col bg-background-light dark:bg-background-dark pb-24 font-display",children:[E.jsxs("header",{className:"flex items-center p-4 sticky top-0 bg-background-light dark:bg-background-dark z-10 transition-shadow",children:[E.jsx("button",{onClick:()=>e(-1),className:"flex size-12 shrink-0 items-center justify-start text-text-light-primary dark:text-gray-200",children:E.jsx("span",{className:"material-symbols-outlined !text-2xl",children:"arrow_back_ios_new"})}),E.jsx("h1",{className:"flex-1 text-center text-lg font-bold leading-tight tracking-[-0.015em] text-text-light-primary dark:text-gray-200",children:"Profile"}),E.jsx("div",{className:"w-12"})]}),E.jsxs("div",{className:"flex flex-col items-center p-6 gap-4",children:[E.jsx("div",{className:"size-24 rounded-full overflow-hidden border-4 border-primary/20",children:t.photoURL?E.jsx("img",{src:t.photoURL,alt:t.displayName,className:"size-full object-cover",referrerPolicy:"no-referrer"}):E.jsx("div",{className:"size-full bg-primary/20 flex items-center justify-center",children:E.jsx("span",{className:"material-symbols-outlined text-4xl text-primary",children:"person"})})}),E.jsxs("div",{className:"text-center",children:[E.jsx("h2",{className:"text-xl font-bold text-text-light-primary dark:text-white",children:t.displayName||"Anonymous User"}),l&&E.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:["Current Rank: #",l.rank,"  ",l.percentage,"% Completion"]})]})]}),E.jsxs("div",{className:"px-4 flex flex-col gap-4 mt-2",children:[E.jsx("h3",{className:"text-lg font-bold text-text-light-primary dark:text-white",children:"Public Habits"}),s.length===0?E.jsx("div",{className:"text-center py-8 text-gray-500",children:"No public habits shared."}):E.jsx("div",{className:"flex flex-col gap-3",children:s.map(v=>E.jsx(KT,{habit:v,isCompleted:!1,disabled:!0,showCheckbox:!1},v.id))})]}),E.jsx(ol,{})]}):E.jsxs("div",{className:"flex h-screen flex-col items-center justify-center bg-background-light dark:bg-background-dark text-text-light-primary dark:text-white gap-4",children:[E.jsx("p",{children:"User not found"}),E.jsx("button",{onClick:()=>e(-1),className:"text-primary hover:underline",children:"Go Back"})]})}const rO="completions",iO="habits",sO="users";async function oO(n=50){try{const e=kn(ot,rO),t=fr(e,nl("timestamp","desc"),zP(n*2)),s=(await yi(t)).docs.map(d=>({id:d.id,...d.data()})),a=[],l=new Set;for(const d of s){if(a.length>=n)break;if(!l.has(`${d.habitId}_${d.date}`))try{const f=cr(ot,iO,d.habitId),m=await qa(f);if(!m.exists())continue;const v=m.data();if(!v.isPublic)continue;const _=cr(ot,sO,d.userId),x=await qa(_),S=x.exists()?x.data():{};a.push({id:d.id,habitId:d.habitId,habitTitle:v.title,userId:d.userId,username:S.displayName||"Anonymous",photoURL:S.photoURL||null,streak:v.currentStreak||0,timestamp:d.timestamp,date:d.date,type:"completion"}),l.add(`${d.habitId}_${d.date}`)}catch(f){console.error("Error processing completion:",f);continue}}return a}catch(e){throw console.error("Error getting public feed:",e),e}}function aO(n){if(!n)return"";const e=n.toDate?n.toDate():new Date(n),r=new Date().getTime()-e.getTime(),s=Math.floor(r/6e4),a=Math.floor(r/36e5),l=Math.floor(r/864e5);return s<1?"just now":s<60?`${s}m ago`:a<24?`${a}h ago`:l<7?`${l}d ago`:e.toLocaleDateString()}function lO(){const n=$n(),[e,t]=F.useState([]),[r,s]=F.useState(!0);return F.useEffect(()=>{(async()=>{s(!0);try{const l=await oO(50);t(l)}catch(l){console.error("Error loading feed:",l)}finally{s(!1)}})()},[]),E.jsxs("div",{className:"relative flex h-auto min-h-screen w-full flex-col overflow-x-hidden bg-background-light dark:bg-background-dark font-display",children:[E.jsxs("header",{className:"sticky top-0 z-10 flex items-center justify-between border-b border-gray-200/80 bg-background-light/80 p-4 pb-3 backdrop-blur-sm dark:border-gray-800/80 dark:bg-background-dark/80",children:[E.jsx("button",{onClick:()=>n(-1),className:"flex size-12 shrink-0 items-center justify-start",children:E.jsx("span",{className:"material-symbols-outlined text-text-light-primary dark:text-text-dark-primary",children:"arrow_back_ios_new"})}),E.jsx("h1",{className:"flex-1 text-center text-lg font-bold leading-tight tracking-[-0.015em] text-text-light-primary dark:text-text-dark-primary",children:"Progress Feed"}),E.jsx("div",{className:"flex w-12 items-center justify-end",children:E.jsx("button",{className:"flex h-12 cursor-pointer items-center justify-center gap-2 overflow-hidden rounded-lg bg-transparent text-base font-bold leading-normal tracking-[0.015em] text-text-light-primary dark:text-text-dark-primary",children:E.jsx("span",{className:"material-symbols-outlined",children:"search"})})})]}),E.jsx("main",{className:"flex-grow pb-24",children:r?E.jsx("div",{className:"flex justify-center py-12",children:E.jsx(Eo,{size:"lg"})}):e.length===0?E.jsxs("div",{className:"flex flex-col items-center justify-center py-12 px-4",children:[E.jsx("span",{className:"material-symbols-outlined text-5xl text-gray-400 mb-4",children:"feed"}),E.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center",children:"No public activity yet."}),E.jsx("p",{className:"text-gray-400 dark:text-gray-500 text-sm text-center mt-2",children:"Complete public habits to appear in the feed!"})]}):e.map(a=>E.jsx("div",{className:"border-b border-gray-200/80 p-4 dark:border-gray-800/80",children:E.jsxs("div",{className:"flex items-start gap-3",children:[a.photoURL?E.jsx("img",{className:"h-10 w-10 rounded-full object-cover flex-shrink-0",alt:`${a.username}'s avatar`,src:a.photoURL,referrerPolicy:"no-referrer"}):E.jsx("div",{className:"h-10 w-10 rounded-full bg-primary/20 flex items-center justify-center flex-shrink-0",children:E.jsx("span",{className:"material-symbols-outlined text-primary text-xl",children:"person"})}),E.jsxs("div",{className:"flex flex-1 flex-col gap-2",children:[E.jsxs("div",{className:"flex items-center gap-2",children:[E.jsx("p",{className:"font-bold text-text-light-primary dark:text-text-dark-primary",children:a.username}),E.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[" ",aO(a.timestamp)]})]}),E.jsxs("p",{className:"text-base text-text-light-primary dark:text-text-dark-primary",children:["Completed: ",a.habitTitle]}),a.streak>0&&E.jsx("div",{className:"mt-2 flex items-center",children:E.jsxs("div",{className:"flex items-center gap-1 rounded-full bg-primary/20 px-3 py-1 text-sm font-medium",children:[E.jsx("span",{className:"material-symbols-outlined !text-[18px] !font-bold text-primary",children:"local_fire_department"}),E.jsx("span",{className:"font-bold text-text-light-primary dark:text-text-dark-primary",children:a.streak})]})})]})]})},a.id))}),E.jsx(ol,{})]})}function uO(){const n=$n(),{user:e,clearUser:t}=go(),{habits:r,clearAll:s}=cs(),[a,l]=F.useState(document.documentElement.classList.contains("dark")),[d,f]=F.useState(!1),[m,v]=F.useState(()=>(JSON.parse(localStorage.getItem("habitParams"))||{}).notificationsEnabled||!1),[_,x]=F.useState(()=>(JSON.parse(localStorage.getItem("habitParams"))||{}).reminderTime||"09:00"),S=async q=>{const ue={...JSON.parse(localStorage.getItem("habitParams"))||{},...q};if(localStorage.setItem("habitParams",JSON.stringify(ue)),e!=null&&e.uid)try{await DV(e.uid,{settings:ue})}catch(ce){console.error("Failed to sync settings to cloud:",ce)}},D=q=>{l(q),q?(document.documentElement.classList.add("dark"),localStorage.setItem("theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("theme","light"))},U=async q=>{q?await CV()?(v(!0),S({notificationsEnabled:!0})):(v(!1),alert("Notification permission denied. Please enable it in your browser settings.")):(v(!1),S({notificationsEnabled:!1}))},L=q=>{const ne=q.target.value;x(ne),S({reminderTime:ne})},K=async()=>{f(!0);try{await LV(),t(),s(),n("/")}catch(q){console.error("Logout error:",q),alert("Failed to sign out. Please try again.")}finally{f(!1)}},X={totalHabits:r.length,publicHabits:r.filter(q=>q.isPublic).length,privateHabits:r.filter(q=>!q.isPublic).length,totalStreak:r.reduce((q,ne)=>q+(ne.currentStreak||0),0)};return E.jsxs("div",{className:"relative flex h-auto min-h-screen w-full flex-col overflow-x-hidden bg-background-light dark:bg-background-dark font-display",children:[E.jsxs("div",{className:"flex-grow pb-28",children:[E.jsxs("header",{className:"flex items-center bg-background-light dark:bg-background-dark p-4 pb-2 sticky top-0 z-10",children:[E.jsx("button",{onClick:()=>n(-1),className:"flex size-12 shrink-0 items-center justify-start text-text-light-primary dark:text-text-dark-primary",children:E.jsx("span",{className:"material-symbols-outlined",children:"arrow_back_ios_new"})}),E.jsx("h1",{className:"flex-1 text-center text-lg font-bold leading-tight tracking-[-0.015em] text-text-light-primary dark:text-text-dark-primary",children:"Settings"}),E.jsx("div",{className:"w-12"})]}),E.jsxs("main",{className:"p-4 flex flex-col gap-6",children:[E.jsx("section",{className:"bg-content-light dark:bg-content-dark rounded-xl p-4",children:E.jsxs("div",{className:"flex items-center gap-4",children:[e!=null&&e.photoURL?E.jsx("img",{src:e.photoURL,alt:"Profile",className:"w-16 h-16 rounded-full object-cover",referrerPolicy:"no-referrer"}):E.jsx("div",{className:"w-16 h-16 rounded-full bg-primary/20 flex items-center justify-center",children:E.jsx("span",{className:"material-symbols-outlined text-primary text-3xl",children:"person"})}),E.jsxs("div",{children:[E.jsx("h2",{className:"text-lg font-bold text-text-light-primary dark:text-text-dark-primary",children:(e==null?void 0:e.displayName)||"User"}),E.jsx("p",{className:"text-sm text-text-light-secondary dark:text-text-dark-secondary",children:e==null?void 0:e.email})]})]})}),E.jsxs("section",{className:"bg-content-light dark:bg-content-dark rounded-xl p-4",children:[E.jsx("h3",{className:"text-sm font-medium text-text-light-secondary dark:text-text-dark-secondary uppercase mb-4",children:"Your Stats"}),E.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[E.jsxs("div",{className:"text-center p-3 bg-primary/10 dark:bg-primary/20 rounded-lg",children:[E.jsx("p",{className:"text-2xl font-bold text-primary",children:X.totalHabits}),E.jsx("p",{className:"text-xs text-text-light-secondary dark:text-text-dark-secondary",children:"Total Habits"})]}),E.jsxs("div",{className:"text-center p-3 bg-primary/10 dark:bg-primary/20 rounded-lg",children:[E.jsxs("p",{className:"text-2xl font-bold text-primary",children:[" ",X.totalStreak]}),E.jsx("p",{className:"text-xs text-text-light-secondary dark:text-text-dark-secondary",children:"Total Streak Days"})]}),E.jsxs("div",{className:"text-center",children:[E.jsx("p",{className:"text-xl font-bold text-primary",children:X.publicHabits}),E.jsx("p",{className:"text-xs text-text-light-secondary dark:text-text-dark-secondary",children:"Public"})]}),E.jsxs("div",{className:"text-center",children:[E.jsx("p",{className:"text-xl font-bold text-primary",children:X.privateHabits}),E.jsx("p",{className:"text-xs text-text-light-secondary dark:text-text-dark-secondary",children:"Private"})]})]})]}),E.jsxs("section",{className:"bg-content-light dark:bg-content-dark rounded-xl p-4",children:[E.jsx("h3",{className:"text-sm font-medium text-text-light-secondary dark:text-text-dark-secondary uppercase mb-4",children:"Preferences"}),E.jsx(Wa,{label:"Dark Mode",checked:a,onChange:D}),E.jsx("div",{className:"my-4 h-px bg-border-light dark:bg-border-dark/50"}),E.jsxs("div",{className:"flex flex-col gap-4",children:[E.jsx(Wa,{label:"Daily Reminders",checked:m,onChange:U}),m&&E.jsxs("div",{className:"flex items-center justify-between animation-slide-down",children:[E.jsx("span",{className:"text-text-light-primary dark:text-text-dark-primary",children:"Reminder Time"}),E.jsx("input",{type:"time",value:_,onChange:L,className:"bg-gray-100 dark:bg-gray-800 border-none rounded-lg p-2 text-text-light-primary dark:text-white focus:ring-2 focus:ring-primary"})]})]})]}),E.jsxs("section",{className:"bg-content-light dark:bg-content-dark rounded-xl p-4",children:[E.jsx("h3",{className:"text-sm font-medium text-text-light-secondary dark:text-text-dark-secondary uppercase mb-4",children:"About"}),E.jsxs("div",{className:"space-y-3",children:[E.jsxs("div",{className:"flex justify-between",children:[E.jsx("span",{className:"text-text-light-primary dark:text-text-dark-primary",children:"Version"}),E.jsx("span",{className:"text-text-light-secondary dark:text-text-dark-secondary",children:"1.3.0"})]}),E.jsxs("div",{className:"flex justify-between",children:[E.jsx("span",{className:"text-text-light-primary dark:text-text-dark-primary",children:"Build"}),E.jsx("span",{className:"text-text-light-secondary dark:text-text-dark-secondary",children:"PWA"})]})]})]}),E.jsx(is,{fullWidth:!0,variant:"danger",onClick:K,isLoading:d,icon:"logout",children:"Sign Out"})]})]}),E.jsx(ol,{})]})}function Gi({children:n}){const{isAuthenticated:e,isLoading:t}=go();return F.useEffect(()=>{try{q0()}catch(s){console.error("Notification check failed",s)}const r=setInterval(()=>{try{q0()}catch(s){console.error("Notification interval failed",s)}},6e4);return()=>clearInterval(r)},[]),t?E.jsx("div",{className:"min-h-screen bg-background-light dark:bg-background-dark flex items-center justify-center",children:E.jsx(Eo,{size:"lg"})}):e?n:E.jsx(Zk,{to:"/",replace:!0})}function cO(){const{user:n,setUser:e,setLoading:t}=go(),{loadHabits:r,loadCompletionsForDate:s,subscribeToHabits:a,clearAll:l}=cs();return F.useEffect(()=>{let d=null;const f=ON(cy,async m=>{if(m){e({uid:m.uid,displayName:m.displayName,email:m.email,photoURL:m.photoURL});try{const v=await GT(m.uid);v!=null&&v.settings&&localStorage.setItem("habitParams",JSON.stringify(v.settings));const{loadCompletionsForWeek:_,subscribeToHabits:x}=cs.getState();await _(m.uid),d=x(m.uid)}catch(v){console.error("Error loading user data:",v)}}else e(null),l(),d&&(d(),d=null);t(!1)});return()=>{f(),d&&d()}},[e,t,r,s,a,l]),F.useEffect(()=>{localStorage.getItem("theme")==="dark"&&document.documentElement.classList.add("dark")},[]),E.jsx(T1,{basename:"/habit-tracker-pwa/",children:E.jsx("div",{className:"min-h-screen bg-background-light dark:bg-background-dark font-display",children:E.jsxs(t1,{children:[E.jsx(Sr,{path:"/",element:E.jsx(FV,{})}),E.jsx(Sr,{path:"/dashboard",element:E.jsx(Gi,{children:E.jsx(qV,{})})}),E.jsx(Sr,{path:"/new-habit",element:E.jsx(Gi,{children:E.jsx(GV,{})})}),E.jsx(Sr,{path:"/edit-habit/:habitId",element:E.jsx(Gi,{children:E.jsx(XV,{})})}),E.jsx(Sr,{path:"/habit/:habitId",element:E.jsx(Gi,{children:E.jsx(eO,{})})}),E.jsx(Sr,{path:"/leaderboard",element:E.jsx(Gi,{children:E.jsx(tO,{})})}),E.jsx(Sr,{path:"/profile/:userId",element:E.jsx(Gi,{children:E.jsx(nO,{})})}),E.jsx(Sr,{path:"/feed",element:E.jsx(Gi,{children:E.jsx(lO,{})})}),E.jsx(Sr,{path:"/settings",element:E.jsx(Gi,{children:E.jsx(uO,{})})})]})})})}class dO extends Sa.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("Uncaught error:",e,t),this.setState({errorInfo:t})}render(){return this.state.hasError?E.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center p-4 bg-gray-50 text-gray-900",children:[E.jsx("h1",{className:"text-2xl font-bold mb-4 text-red-600",children:"Something went wrong"}),E.jsx("p",{className:"mb-4 text-gray-700",children:"The application encountered an error."}),E.jsxs("div",{className:"bg-gray-100 p-4 rounded overflow-auto max-w-full text-left font-mono text-sm border border-gray-300",children:[E.jsx("p",{className:"font-bold text-red-500 mb-2",children:this.state.error&&this.state.error.toString()}),E.jsx("pre",{className:"text-xs text-gray-500 whitespace-pre-wrap",children:this.state.errorInfo&&this.state.errorInfo.componentStack})]}),E.jsx("button",{onClick:()=>window.location.reload(),className:"mt-6 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Reload Application"})]}):this.props.children}}const hO=["habits-storage","auth-storage"];hO.forEach(n=>{localStorage.getItem(n)&&(localStorage.removeItem(n),console.log(`[Init] Cleared old localStorage: ${n}`))});lk.createRoot(document.getElementById("root")).render(E.jsx(Sa.StrictMode,{children:E.jsx(dO,{children:E.jsx(cO,{})})}));
