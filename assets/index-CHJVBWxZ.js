(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function t(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=t(s);fetch(s.href,a)}})();function q0(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Np={exports:{}},Jl={},Dp={exports:{}},Ce={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var y_;function XS(){if(y_)return Ce;y_=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),w=Symbol.iterator;function x(j){return j===null||typeof j!="object"?null:(j=w&&j[w]||j["@@iterator"],typeof j=="function"?j:null)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},D=Object.assign,F={};function O(j,Y,ve){this.props=j,this.context=Y,this.refs=F,this.updater=ve||S}O.prototype.isReactComponent={},O.prototype.setState=function(j,Y){if(typeof j!="object"&&typeof j!="function"&&j!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,j,Y,"setState")},O.prototype.forceUpdate=function(j){this.updater.enqueueForceUpdate(this,j,"forceUpdate")};function K(){}K.prototype=O.prototype;function X(j,Y,ve){this.props=j,this.context=Y,this.refs=F,this.updater=ve||S}var q=X.prototype=new K;q.constructor=X,D(q,O.prototype),q.isPureReactComponent=!0;var re=Array.isArray,de=Object.prototype.hasOwnProperty,ne={current:null},P={key:!0,ref:!0,__self:!0,__source:!0};function k(j,Y,ve){var be,Re={},Oe=null,Ue=null;if(Y!=null)for(be in Y.ref!==void 0&&(Ue=Y.ref),Y.key!==void 0&&(Oe=""+Y.key),Y)de.call(Y,be)&&!P.hasOwnProperty(be)&&(Re[be]=Y[be]);var Be=arguments.length-2;if(Be===1)Re.children=ve;else if(1<Be){for(var Qe=Array(Be),Ct=0;Ct<Be;Ct++)Qe[Ct]=arguments[Ct+2];Re.children=Qe}if(j&&j.defaultProps)for(be in Be=j.defaultProps,Be)Re[be]===void 0&&(Re[be]=Be[be]);return{$$typeof:n,type:j,key:Oe,ref:Ue,props:Re,_owner:ne.current}}function R(j,Y){return{$$typeof:n,type:j.type,key:Y,ref:j.ref,props:j.props,_owner:j._owner}}function A(j){return typeof j=="object"&&j!==null&&j.$$typeof===n}function L(j){var Y={"=":"=0",":":"=2"};return"$"+j.replace(/[=:]/g,function(ve){return Y[ve]})}var M=/\/+/g;function C(j,Y){return typeof j=="object"&&j!==null&&j.key!=null?L(""+j.key):Y.toString(36)}function Pe(j,Y,ve,be,Re){var Oe=typeof j;(Oe==="undefined"||Oe==="boolean")&&(j=null);var Ue=!1;if(j===null)Ue=!0;else switch(Oe){case"string":case"number":Ue=!0;break;case"object":switch(j.$$typeof){case n:case e:Ue=!0}}if(Ue)return Ue=j,Re=Re(Ue),j=be===""?"."+C(Ue,0):be,re(Re)?(ve="",j!=null&&(ve=j.replace(M,"$&/")+"/"),Pe(Re,Y,ve,"",function(Ct){return Ct})):Re!=null&&(A(Re)&&(Re=R(Re,ve+(!Re.key||Ue&&Ue.key===Re.key?"":(""+Re.key).replace(M,"$&/")+"/")+j)),Y.push(Re)),1;if(Ue=0,be=be===""?".":be+":",re(j))for(var Be=0;Be<j.length;Be++){Oe=j[Be];var Qe=be+C(Oe,Be);Ue+=Pe(Oe,Y,ve,Qe,Re)}else if(Qe=x(j),typeof Qe=="function")for(j=Qe.call(j),Be=0;!(Oe=j.next()).done;)Oe=Oe.value,Qe=be+C(Oe,Be++),Ue+=Pe(Oe,Y,ve,Qe,Re);else if(Oe==="object")throw Y=String(j),Error("Objects are not valid as a React child (found: "+(Y==="[object Object]"?"object with keys {"+Object.keys(j).join(", ")+"}":Y)+"). If you meant to render a collection of children, use an array instead.");return Ue}function pt(j,Y,ve){if(j==null)return j;var be=[],Re=0;return Pe(j,be,"","",function(Oe){return Y.call(ve,Oe,Re++)}),be}function Rt(j){if(j._status===-1){var Y=j._result;Y=Y(),Y.then(function(ve){(j._status===0||j._status===-1)&&(j._status=1,j._result=ve)},function(ve){(j._status===0||j._status===-1)&&(j._status=2,j._result=ve)}),j._status===-1&&(j._status=0,j._result=Y)}if(j._status===1)return j._result.default;throw j._result}var Ge={current:null},ae={transition:null},we={ReactCurrentDispatcher:Ge,ReactCurrentBatchConfig:ae,ReactCurrentOwner:ne};function ce(){throw Error("act(...) is not supported in production builds of React.")}return Ce.Children={map:pt,forEach:function(j,Y,ve){pt(j,function(){Y.apply(this,arguments)},ve)},count:function(j){var Y=0;return pt(j,function(){Y++}),Y},toArray:function(j){return pt(j,function(Y){return Y})||[]},only:function(j){if(!A(j))throw Error("React.Children.only expected to receive a single React element child.");return j}},Ce.Component=O,Ce.Fragment=t,Ce.Profiler=s,Ce.PureComponent=X,Ce.StrictMode=r,Ce.Suspense=f,Ce.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=we,Ce.act=ce,Ce.cloneElement=function(j,Y,ve){if(j==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+j+".");var be=D({},j.props),Re=j.key,Oe=j.ref,Ue=j._owner;if(Y!=null){if(Y.ref!==void 0&&(Oe=Y.ref,Ue=ne.current),Y.key!==void 0&&(Re=""+Y.key),j.type&&j.type.defaultProps)var Be=j.type.defaultProps;for(Qe in Y)de.call(Y,Qe)&&!P.hasOwnProperty(Qe)&&(be[Qe]=Y[Qe]===void 0&&Be!==void 0?Be[Qe]:Y[Qe])}var Qe=arguments.length-2;if(Qe===1)be.children=ve;else if(1<Qe){Be=Array(Qe);for(var Ct=0;Ct<Qe;Ct++)Be[Ct]=arguments[Ct+2];be.children=Be}return{$$typeof:n,type:j.type,key:Re,ref:Oe,props:be,_owner:Ue}},Ce.createContext=function(j){return j={$$typeof:l,_currentValue:j,_currentValue2:j,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},j.Provider={$$typeof:a,_context:j},j.Consumer=j},Ce.createElement=k,Ce.createFactory=function(j){var Y=k.bind(null,j);return Y.type=j,Y},Ce.createRef=function(){return{current:null}},Ce.forwardRef=function(j){return{$$typeof:d,render:j}},Ce.isValidElement=A,Ce.lazy=function(j){return{$$typeof:v,_payload:{_status:-1,_result:j},_init:Rt}},Ce.memo=function(j,Y){return{$$typeof:m,type:j,compare:Y===void 0?null:Y}},Ce.startTransition=function(j){var Y=ae.transition;ae.transition={};try{j()}finally{ae.transition=Y}},Ce.unstable_act=ce,Ce.useCallback=function(j,Y){return Ge.current.useCallback(j,Y)},Ce.useContext=function(j){return Ge.current.useContext(j)},Ce.useDebugValue=function(){},Ce.useDeferredValue=function(j){return Ge.current.useDeferredValue(j)},Ce.useEffect=function(j,Y){return Ge.current.useEffect(j,Y)},Ce.useId=function(){return Ge.current.useId()},Ce.useImperativeHandle=function(j,Y,ve){return Ge.current.useImperativeHandle(j,Y,ve)},Ce.useInsertionEffect=function(j,Y){return Ge.current.useInsertionEffect(j,Y)},Ce.useLayoutEffect=function(j,Y){return Ge.current.useLayoutEffect(j,Y)},Ce.useMemo=function(j,Y){return Ge.current.useMemo(j,Y)},Ce.useReducer=function(j,Y,ve){return Ge.current.useReducer(j,Y,ve)},Ce.useRef=function(j){return Ge.current.useRef(j)},Ce.useState=function(j){return Ge.current.useState(j)},Ce.useSyncExternalStore=function(j,Y,ve){return Ge.current.useSyncExternalStore(j,Y,ve)},Ce.useTransition=function(){return Ge.current.useTransition()},Ce.version="18.3.1",Ce}var v_;function jm(){return v_||(v_=1,Dp.exports=XS()),Dp.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var __;function YS(){if(__)return Jl;__=1;var n=jm(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function l(d,f,m){var v,w={},x=null,S=null;m!==void 0&&(x=""+m),f.key!==void 0&&(x=""+f.key),f.ref!==void 0&&(S=f.ref);for(v in f)r.call(f,v)&&!a.hasOwnProperty(v)&&(w[v]=f[v]);if(d&&d.defaultProps)for(v in f=d.defaultProps,f)w[v]===void 0&&(w[v]=f[v]);return{$$typeof:e,type:d,key:x,ref:S,props:w,_owner:s.current}}return Jl.Fragment=t,Jl.jsx=l,Jl.jsxs=l,Jl}var w_;function JS(){return w_||(w_=1,Np.exports=YS()),Np.exports}var E=JS(),$=jm();const su=q0($);var yd={},Vp={exports:{}},hn={},Op={exports:{}},Lp={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var E_;function ZS(){return E_||(E_=1,(function(n){function e(ae,we){var ce=ae.length;ae.push(we);e:for(;0<ce;){var j=ce-1>>>1,Y=ae[j];if(0<s(Y,we))ae[j]=we,ae[ce]=Y,ce=j;else break e}}function t(ae){return ae.length===0?null:ae[0]}function r(ae){if(ae.length===0)return null;var we=ae[0],ce=ae.pop();if(ce!==we){ae[0]=ce;e:for(var j=0,Y=ae.length,ve=Y>>>1;j<ve;){var be=2*(j+1)-1,Re=ae[be],Oe=be+1,Ue=ae[Oe];if(0>s(Re,ce))Oe<Y&&0>s(Ue,Re)?(ae[j]=Ue,ae[Oe]=ce,j=Oe):(ae[j]=Re,ae[be]=ce,j=be);else if(Oe<Y&&0>s(Ue,ce))ae[j]=Ue,ae[Oe]=ce,j=Oe;else break e}}return we}function s(ae,we){var ce=ae.sortIndex-we.sortIndex;return ce!==0?ce:ae.id-we.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var l=Date,d=l.now();n.unstable_now=function(){return l.now()-d}}var f=[],m=[],v=1,w=null,x=3,S=!1,D=!1,F=!1,O=typeof setTimeout=="function"?setTimeout:null,K=typeof clearTimeout=="function"?clearTimeout:null,X=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function q(ae){for(var we=t(m);we!==null;){if(we.callback===null)r(m);else if(we.startTime<=ae)r(m),we.sortIndex=we.expirationTime,e(f,we);else break;we=t(m)}}function re(ae){if(F=!1,q(ae),!D)if(t(f)!==null)D=!0,Rt(de);else{var we=t(m);we!==null&&Ge(re,we.startTime-ae)}}function de(ae,we){D=!1,F&&(F=!1,K(k),k=-1),S=!0;var ce=x;try{for(q(we),w=t(f);w!==null&&(!(w.expirationTime>we)||ae&&!L());){var j=w.callback;if(typeof j=="function"){w.callback=null,x=w.priorityLevel;var Y=j(w.expirationTime<=we);we=n.unstable_now(),typeof Y=="function"?w.callback=Y:w===t(f)&&r(f),q(we)}else r(f);w=t(f)}if(w!==null)var ve=!0;else{var be=t(m);be!==null&&Ge(re,be.startTime-we),ve=!1}return ve}finally{w=null,x=ce,S=!1}}var ne=!1,P=null,k=-1,R=5,A=-1;function L(){return!(n.unstable_now()-A<R)}function M(){if(P!==null){var ae=n.unstable_now();A=ae;var we=!0;try{we=P(!0,ae)}finally{we?C():(ne=!1,P=null)}}else ne=!1}var C;if(typeof X=="function")C=function(){X(M)};else if(typeof MessageChannel<"u"){var Pe=new MessageChannel,pt=Pe.port2;Pe.port1.onmessage=M,C=function(){pt.postMessage(null)}}else C=function(){O(M,0)};function Rt(ae){P=ae,ne||(ne=!0,C())}function Ge(ae,we){k=O(function(){ae(n.unstable_now())},we)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ae){ae.callback=null},n.unstable_continueExecution=function(){D||S||(D=!0,Rt(de))},n.unstable_forceFrameRate=function(ae){0>ae||125<ae?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):R=0<ae?Math.floor(1e3/ae):5},n.unstable_getCurrentPriorityLevel=function(){return x},n.unstable_getFirstCallbackNode=function(){return t(f)},n.unstable_next=function(ae){switch(x){case 1:case 2:case 3:var we=3;break;default:we=x}var ce=x;x=we;try{return ae()}finally{x=ce}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(ae,we){switch(ae){case 1:case 2:case 3:case 4:case 5:break;default:ae=3}var ce=x;x=ae;try{return we()}finally{x=ce}},n.unstable_scheduleCallback=function(ae,we,ce){var j=n.unstable_now();switch(typeof ce=="object"&&ce!==null?(ce=ce.delay,ce=typeof ce=="number"&&0<ce?j+ce:j):ce=j,ae){case 1:var Y=-1;break;case 2:Y=250;break;case 5:Y=1073741823;break;case 4:Y=1e4;break;default:Y=5e3}return Y=ce+Y,ae={id:v++,callback:we,priorityLevel:ae,startTime:ce,expirationTime:Y,sortIndex:-1},ce>j?(ae.sortIndex=ce,e(m,ae),t(f)===null&&ae===t(m)&&(F?(K(k),k=-1):F=!0,Ge(re,ce-j))):(ae.sortIndex=Y,e(f,ae),D||S||(D=!0,Rt(de))),ae},n.unstable_shouldYield=L,n.unstable_wrapCallback=function(ae){var we=x;return function(){var ce=x;x=we;try{return ae.apply(this,arguments)}finally{x=ce}}}})(Lp)),Lp}var I_;function ek(){return I_||(I_=1,Op.exports=ZS()),Op.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var x_;function tk(){if(x_)return hn;x_=1;var n=jm(),e=ek();function t(i){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+i,u=1;u<arguments.length;u++)o+="&args[]="+encodeURIComponent(arguments[u]);return"Minified React error #"+i+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,s={};function a(i,o){l(i,o),l(i+"Capture",o)}function l(i,o){for(s[i]=o,i=0;i<o.length;i++)r.add(o[i])}var d=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),f=Object.prototype.hasOwnProperty,m=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,v={},w={};function x(i){return f.call(w,i)?!0:f.call(v,i)?!1:m.test(i)?w[i]=!0:(v[i]=!0,!1)}function S(i,o,u,h){if(u!==null&&u.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return h?!1:u!==null?!u.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function D(i,o,u,h){if(o===null||typeof o>"u"||S(i,o,u,h))return!0;if(h)return!1;if(u!==null)switch(u.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function F(i,o,u,h,p,y,I){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=h,this.attributeNamespace=p,this.mustUseProperty=u,this.propertyName=i,this.type=o,this.sanitizeURL=y,this.removeEmptyString=I}var O={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){O[i]=new F(i,0,!1,i,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var o=i[0];O[o]=new F(o,1,!1,i[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(i){O[i]=new F(i,2,!1,i.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){O[i]=new F(i,2,!1,i,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){O[i]=new F(i,3,!1,i.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(i){O[i]=new F(i,3,!0,i,null,!1,!1)}),["capture","download"].forEach(function(i){O[i]=new F(i,4,!1,i,null,!1,!1)}),["cols","rows","size","span"].forEach(function(i){O[i]=new F(i,6,!1,i,null,!1,!1)}),["rowSpan","start"].forEach(function(i){O[i]=new F(i,5,!1,i.toLowerCase(),null,!1,!1)});var K=/[\-:]([a-z])/g;function X(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var o=i.replace(K,X);O[o]=new F(o,1,!1,i,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var o=i.replace(K,X);O[o]=new F(o,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(i){var o=i.replace(K,X);O[o]=new F(o,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(i){O[i]=new F(i,1,!1,i.toLowerCase(),null,!1,!1)}),O.xlinkHref=new F("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(i){O[i]=new F(i,1,!1,i.toLowerCase(),null,!0,!0)});function q(i,o,u,h){var p=O.hasOwnProperty(o)?O[o]:null;(p!==null?p.type!==0:h||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(D(o,u,p,h)&&(u=null),h||p===null?x(o)&&(u===null?i.removeAttribute(o):i.setAttribute(o,""+u)):p.mustUseProperty?i[p.propertyName]=u===null?p.type===3?!1:"":u:(o=p.attributeName,h=p.attributeNamespace,u===null?i.removeAttribute(o):(p=p.type,u=p===3||p===4&&u===!0?"":""+u,h?i.setAttributeNS(h,o,u):i.setAttribute(o,u))))}var re=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,de=Symbol.for("react.element"),ne=Symbol.for("react.portal"),P=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),R=Symbol.for("react.profiler"),A=Symbol.for("react.provider"),L=Symbol.for("react.context"),M=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),Pe=Symbol.for("react.suspense_list"),pt=Symbol.for("react.memo"),Rt=Symbol.for("react.lazy"),Ge=Symbol.for("react.offscreen"),ae=Symbol.iterator;function we(i){return i===null||typeof i!="object"?null:(i=ae&&i[ae]||i["@@iterator"],typeof i=="function"?i:null)}var ce=Object.assign,j;function Y(i){if(j===void 0)try{throw Error()}catch(u){var o=u.stack.trim().match(/\n( *(at )?)/);j=o&&o[1]||""}return`
`+j+i}var ve=!1;function be(i,o){if(!i||ve)return"";ve=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(W){var h=W}Reflect.construct(i,[],o)}else{try{o.call()}catch(W){h=W}i.call(o.prototype)}else{try{throw Error()}catch(W){h=W}i()}}catch(W){if(W&&h&&typeof W.stack=="string"){for(var p=W.stack.split(`
`),y=h.stack.split(`
`),I=p.length-1,b=y.length-1;1<=I&&0<=b&&p[I]!==y[b];)b--;for(;1<=I&&0<=b;I--,b--)if(p[I]!==y[b]){if(I!==1||b!==1)do if(I--,b--,0>b||p[I]!==y[b]){var N=`
`+p[I].replace(" at new "," at ");return i.displayName&&N.includes("<anonymous>")&&(N=N.replace("<anonymous>",i.displayName)),N}while(1<=I&&0<=b);break}}}finally{ve=!1,Error.prepareStackTrace=u}return(i=i?i.displayName||i.name:"")?Y(i):""}function Re(i){switch(i.tag){case 5:return Y(i.type);case 16:return Y("Lazy");case 13:return Y("Suspense");case 19:return Y("SuspenseList");case 0:case 2:case 15:return i=be(i.type,!1),i;case 11:return i=be(i.type.render,!1),i;case 1:return i=be(i.type,!0),i;default:return""}}function Oe(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case P:return"Fragment";case ne:return"Portal";case R:return"Profiler";case k:return"StrictMode";case C:return"Suspense";case Pe:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case L:return(i.displayName||"Context")+".Consumer";case A:return(i._context.displayName||"Context")+".Provider";case M:var o=i.render;return i=i.displayName,i||(i=o.displayName||o.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case pt:return o=i.displayName||null,o!==null?o:Oe(i.type)||"Memo";case Rt:o=i._payload,i=i._init;try{return Oe(i(o))}catch{}}return null}function Ue(i){var o=i.type;switch(i.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=o.render,i=i.displayName||i.name||"",o.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Oe(o);case 8:return o===k?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function Be(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Qe(i){var o=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function Ct(i){var o=Qe(i)?"checked":"value",u=Object.getOwnPropertyDescriptor(i.constructor.prototype,o),h=""+i[o];if(!i.hasOwnProperty(o)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var p=u.get,y=u.set;return Object.defineProperty(i,o,{configurable:!0,get:function(){return p.call(this)},set:function(I){h=""+I,y.call(this,I)}}),Object.defineProperty(i,o,{enumerable:u.enumerable}),{getValue:function(){return h},setValue:function(I){h=""+I},stopTracking:function(){i._valueTracker=null,delete i[o]}}}}function jr(i){i._valueTracker||(i._valueTracker=Ct(i))}function Eo(i){if(!i)return!1;var o=i._valueTracker;if(!o)return!0;var u=o.getValue(),h="";return i&&(h=Qe(i)?i.checked?"true":"false":i.value),i=h,i!==u?(o.setValue(i),!0):!1}function gi(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function hs(i,o){var u=o.checked;return ce({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:u??i._wrapperState.initialChecked})}function Io(i,o){var u=o.defaultValue==null?"":o.defaultValue,h=o.checked!=null?o.checked:o.defaultChecked;u=Be(o.value!=null?o.value:u),i._wrapperState={initialChecked:h,initialValue:u,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function il(i,o){o=o.checked,o!=null&&q(i,"checked",o,!1)}function sl(i,o){il(i,o);var u=Be(o.value),h=o.type;if(u!=null)h==="number"?(u===0&&i.value===""||i.value!=u)&&(i.value=""+u):i.value!==""+u&&(i.value=""+u);else if(h==="submit"||h==="reset"){i.removeAttribute("value");return}o.hasOwnProperty("value")?xo(i,o.type,u):o.hasOwnProperty("defaultValue")&&xo(i,o.type,Be(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(i.defaultChecked=!!o.defaultChecked)}function nc(i,o,u){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var h=o.type;if(!(h!=="submit"&&h!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+i._wrapperState.initialValue,u||o===i.value||(i.value=o),i.defaultValue=o}u=i.name,u!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,u!==""&&(i.name=u)}function xo(i,o,u){(o!=="number"||gi(i.ownerDocument)!==i)&&(u==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+u&&(i.defaultValue=""+u))}var Fr=Array.isArray;function Ur(i,o,u,h){if(i=i.options,o){o={};for(var p=0;p<u.length;p++)o["$"+u[p]]=!0;for(u=0;u<i.length;u++)p=o.hasOwnProperty("$"+i[u].value),i[u].selected!==p&&(i[u].selected=p),p&&h&&(i[u].defaultSelected=!0)}else{for(u=""+Be(u),o=null,p=0;p<i.length;p++){if(i[p].value===u){i[p].selected=!0,h&&(i[p].defaultSelected=!0);return}o!==null||i[p].disabled||(o=i[p])}o!==null&&(o.selected=!0)}}function ol(i,o){if(o.dangerouslySetInnerHTML!=null)throw Error(t(91));return ce({},o,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function To(i,o){var u=o.value;if(u==null){if(u=o.children,o=o.defaultValue,u!=null){if(o!=null)throw Error(t(92));if(Fr(u)){if(1<u.length)throw Error(t(93));u=u[0]}o=u}o==null&&(o=""),u=o}i._wrapperState={initialValue:Be(u)}}function So(i,o){var u=Be(o.value),h=Be(o.defaultValue);u!=null&&(u=""+u,u!==i.value&&(i.value=u),o.defaultValue==null&&i.defaultValue!==u&&(i.defaultValue=u)),h!=null&&(i.defaultValue=""+h)}function al(i){var o=i.textContent;o===i._wrapperState.initialValue&&o!==""&&o!==null&&(i.value=o)}function It(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function xt(i,o){return i==null||i==="http://www.w3.org/1999/xhtml"?It(o):i==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var Br,ll=(function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,u,h,p){MSApp.execUnsafeLocalFunction(function(){return i(o,u,h,p)})}:i})(function(i,o){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=o;else{for(Br=Br||document.createElement("div"),Br.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=Br.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;o.firstChild;)i.appendChild(o.firstChild)}});function yi(i,o){if(o){var u=i.firstChild;if(u&&u===i.lastChild&&u.nodeType===3){u.nodeValue=o;return}}i.textContent=o}var fs={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ps=["Webkit","ms","Moz","O"];Object.keys(fs).forEach(function(i){ps.forEach(function(o){o=o+i.charAt(0).toUpperCase()+i.substring(1),fs[o]=fs[i]})});function ul(i,o,u){return o==null||typeof o=="boolean"||o===""?"":u||typeof o!="number"||o===0||fs.hasOwnProperty(i)&&fs[i]?(""+o).trim():o+"px"}function cl(i,o){i=i.style;for(var u in o)if(o.hasOwnProperty(u)){var h=u.indexOf("--")===0,p=ul(u,o[u],h);u==="float"&&(u="cssFloat"),h?i.setProperty(u,p):i[u]=p}}var dl=ce({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function hl(i,o){if(o){if(dl[i]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(t(137,i));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(t(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(t(61))}if(o.style!=null&&typeof o.style!="object")throw Error(t(62))}}function fl(i,o){if(i.indexOf("-")===-1)return typeof o.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ms=null;function ko(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var bo=null,bn=null,fr=null;function Ao(i){if(i=Ml(i)){if(typeof bo!="function")throw Error(t(280));var o=i.stateNode;o&&(o=Nc(o),bo(i.stateNode,i.type,o))}}function pr(i){bn?fr?fr.push(i):fr=[i]:bn=i}function pl(){if(bn){var i=bn,o=fr;if(fr=bn=null,Ao(i),o)for(i=0;i<o.length;i++)Ao(o[i])}}function gs(i,o){return i(o)}function ml(){}var zr=!1;function gl(i,o,u){if(zr)return i(o,u);zr=!0;try{return gs(i,o,u)}finally{zr=!1,(bn!==null||fr!==null)&&(ml(),pl())}}function ht(i,o){var u=i.stateNode;if(u===null)return null;var h=Nc(u);if(h===null)return null;u=h[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(i=i.type,h=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!h;break e;default:i=!1}if(i)return null;if(u&&typeof u!="function")throw Error(t(231,o,typeof u));return u}var Ro=!1;if(d)try{var qn={};Object.defineProperty(qn,"passive",{get:function(){Ro=!0}}),window.addEventListener("test",qn,qn),window.removeEventListener("test",qn,qn)}catch{Ro=!1}function ys(i,o,u,h,p,y,I,b,N){var W=Array.prototype.slice.call(arguments,3);try{o.apply(u,W)}catch(Z){this.onError(Z)}}var vs=!1,Co=null,Hn=!1,yl=null,of={onError:function(i){vs=!0,Co=i}};function Po(i,o,u,h,p,y,I,b,N){vs=!1,Co=null,ys.apply(of,arguments)}function rc(i,o,u,h,p,y,I,b,N){if(Po.apply(this,arguments),vs){if(vs){var W=Co;vs=!1,Co=null}else throw Error(t(198));Hn||(Hn=!0,yl=W)}}function Wn(i){var o=i,u=i;if(i.alternate)for(;o.return;)o=o.return;else{i=o;do o=i,(o.flags&4098)!==0&&(u=o.return),i=o.return;while(i)}return o.tag===3?u:null}function _s(i){if(i.tag===13){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function Gn(i){if(Wn(i)!==i)throw Error(t(188))}function ic(i){var o=i.alternate;if(!o){if(o=Wn(i),o===null)throw Error(t(188));return o!==i?null:i}for(var u=i,h=o;;){var p=u.return;if(p===null)break;var y=p.alternate;if(y===null){if(h=p.return,h!==null){u=h;continue}break}if(p.child===y.child){for(y=p.child;y;){if(y===u)return Gn(p),i;if(y===h)return Gn(p),o;y=y.sibling}throw Error(t(188))}if(u.return!==h.return)u=p,h=y;else{for(var I=!1,b=p.child;b;){if(b===u){I=!0,u=p,h=y;break}if(b===h){I=!0,h=p,u=y;break}b=b.sibling}if(!I){for(b=y.child;b;){if(b===u){I=!0,u=y,h=p;break}if(b===h){I=!0,h=y,u=p;break}b=b.sibling}if(!I)throw Error(t(189))}}if(u.alternate!==h)throw Error(t(190))}if(u.tag!==3)throw Error(t(188));return u.stateNode.current===u?i:o}function vl(i){return i=ic(i),i!==null?No(i):null}function No(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var o=No(i);if(o!==null)return o;i=i.sibling}return null}var Do=e.unstable_scheduleCallback,_l=e.unstable_cancelCallback,sc=e.unstable_shouldYield,af=e.unstable_requestPaint,Xe=e.unstable_now,oc=e.unstable_getCurrentPriorityLevel,ws=e.unstable_ImmediatePriority,vi=e.unstable_UserBlockingPriority,An=e.unstable_NormalPriority,wl=e.unstable_LowPriority,ac=e.unstable_IdlePriority,Es=null,mn=null;function lc(i){if(mn&&typeof mn.onCommitFiberRoot=="function")try{mn.onCommitFiberRoot(Es,i,void 0,(i.current.flags&128)===128)}catch{}}var Yt=Math.clz32?Math.clz32:cc,El=Math.log,uc=Math.LN2;function cc(i){return i>>>=0,i===0?32:31-(El(i)/uc|0)|0}var Vo=64,Oo=4194304;function _i(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function Is(i,o){var u=i.pendingLanes;if(u===0)return 0;var h=0,p=i.suspendedLanes,y=i.pingedLanes,I=u&268435455;if(I!==0){var b=I&~p;b!==0?h=_i(b):(y&=I,y!==0&&(h=_i(y)))}else I=u&~p,I!==0?h=_i(I):y!==0&&(h=_i(y));if(h===0)return 0;if(o!==0&&o!==h&&(o&p)===0&&(p=h&-h,y=o&-o,p>=y||p===16&&(y&4194240)!==0))return o;if((h&4)!==0&&(h|=u&16),o=i.entangledLanes,o!==0)for(i=i.entanglements,o&=h;0<o;)u=31-Yt(o),p=1<<u,h|=i[u],o&=~p;return h}function lf(i,o){switch(i){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function $r(i,o){for(var u=i.suspendedLanes,h=i.pingedLanes,p=i.expirationTimes,y=i.pendingLanes;0<y;){var I=31-Yt(y),b=1<<I,N=p[I];N===-1?((b&u)===0||(b&h)!==0)&&(p[I]=lf(b,o)):N<=o&&(i.expiredLanes|=b),y&=~b}}function gn(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function xs(){var i=Vo;return Vo<<=1,(Vo&4194240)===0&&(Vo=64),i}function wi(i){for(var o=[],u=0;31>u;u++)o.push(i);return o}function Ei(i,o,u){i.pendingLanes|=o,o!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,o=31-Yt(o),i[o]=u}function Ke(i,o){var u=i.pendingLanes&~o;i.pendingLanes=o,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=o,i.mutableReadLanes&=o,i.entangledLanes&=o,o=i.entanglements;var h=i.eventTimes;for(i=i.expirationTimes;0<u;){var p=31-Yt(u),y=1<<p;o[p]=0,h[p]=-1,i[p]=-1,u&=~y}}function Ii(i,o){var u=i.entangledLanes|=o;for(i=i.entanglements;u;){var h=31-Yt(u),p=1<<h;p&o|i[h]&o&&(i[h]|=o),u&=~p}}var Ve=0;function xi(i){return i&=-i,1<i?4<i?(i&268435455)!==0?16:536870912:4:1}var dc,Lo,hc,fc,pc,Il=!1,mr=[],Lt=null,Kn=null,Qn=null,Ti=new Map,Rn=new Map,gr=[],uf="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function mc(i,o){switch(i){case"focusin":case"focusout":Lt=null;break;case"dragenter":case"dragleave":Kn=null;break;case"mouseover":case"mouseout":Qn=null;break;case"pointerover":case"pointerout":Ti.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rn.delete(o.pointerId)}}function sn(i,o,u,h,p,y){return i===null||i.nativeEvent!==y?(i={blockedOn:o,domEventName:u,eventSystemFlags:h,nativeEvent:y,targetContainers:[p]},o!==null&&(o=Ml(o),o!==null&&Lo(o)),i):(i.eventSystemFlags|=h,o=i.targetContainers,p!==null&&o.indexOf(p)===-1&&o.push(p),i)}function cf(i,o,u,h,p){switch(o){case"focusin":return Lt=sn(Lt,i,o,u,h,p),!0;case"dragenter":return Kn=sn(Kn,i,o,u,h,p),!0;case"mouseover":return Qn=sn(Qn,i,o,u,h,p),!0;case"pointerover":var y=p.pointerId;return Ti.set(y,sn(Ti.get(y)||null,i,o,u,h,p)),!0;case"gotpointercapture":return y=p.pointerId,Rn.set(y,sn(Rn.get(y)||null,i,o,u,h,p)),!0}return!1}function gc(i){var o=As(i.target);if(o!==null){var u=Wn(o);if(u!==null){if(o=u.tag,o===13){if(o=_s(u),o!==null){i.blockedOn=o,pc(i.priority,function(){hc(u)});return}}else if(o===3&&u.stateNode.current.memoizedState.isDehydrated){i.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}i.blockedOn=null}function qr(i){if(i.blockedOn!==null)return!1;for(var o=i.targetContainers;0<o.length;){var u=Mo(i.domEventName,i.eventSystemFlags,o[0],i.nativeEvent);if(u===null){u=i.nativeEvent;var h=new u.constructor(u.type,u);ms=h,u.target.dispatchEvent(h),ms=null}else return o=Ml(u),o!==null&&Lo(o),i.blockedOn=u,!1;o.shift()}return!0}function Ts(i,o,u){qr(i)&&u.delete(o)}function yc(){Il=!1,Lt!==null&&qr(Lt)&&(Lt=null),Kn!==null&&qr(Kn)&&(Kn=null),Qn!==null&&qr(Qn)&&(Qn=null),Ti.forEach(Ts),Rn.forEach(Ts)}function Xn(i,o){i.blockedOn===o&&(i.blockedOn=null,Il||(Il=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,yc)))}function Yn(i){function o(p){return Xn(p,i)}if(0<mr.length){Xn(mr[0],i);for(var u=1;u<mr.length;u++){var h=mr[u];h.blockedOn===i&&(h.blockedOn=null)}}for(Lt!==null&&Xn(Lt,i),Kn!==null&&Xn(Kn,i),Qn!==null&&Xn(Qn,i),Ti.forEach(o),Rn.forEach(o),u=0;u<gr.length;u++)h=gr[u],h.blockedOn===i&&(h.blockedOn=null);for(;0<gr.length&&(u=gr[0],u.blockedOn===null);)gc(u),u.blockedOn===null&&gr.shift()}var Hr=re.ReactCurrentBatchConfig,Si=!0;function et(i,o,u,h){var p=Ve,y=Hr.transition;Hr.transition=null;try{Ve=1,xl(i,o,u,h)}finally{Ve=p,Hr.transition=y}}function df(i,o,u,h){var p=Ve,y=Hr.transition;Hr.transition=null;try{Ve=4,xl(i,o,u,h)}finally{Ve=p,Hr.transition=y}}function xl(i,o,u,h){if(Si){var p=Mo(i,o,u,h);if(p===null)If(i,o,h,Ss,u),mc(i,h);else if(cf(p,i,o,u,h))h.stopPropagation();else if(mc(i,h),o&4&&-1<uf.indexOf(i)){for(;p!==null;){var y=Ml(p);if(y!==null&&dc(y),y=Mo(i,o,u,h),y===null&&If(i,o,h,Ss,u),y===p)break;p=y}p!==null&&h.stopPropagation()}else If(i,o,h,null,u)}}var Ss=null;function Mo(i,o,u,h){if(Ss=null,i=ko(h),i=As(i),i!==null)if(o=Wn(i),o===null)i=null;else if(u=o.tag,u===13){if(i=_s(o),i!==null)return i;i=null}else if(u===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;i=null}else o!==i&&(i=null);return Ss=i,null}function Tl(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(oc()){case ws:return 1;case vi:return 4;case An:case wl:return 16;case ac:return 536870912;default:return 16}default:return 16}}var yn=null,jo=null,on=null;function Sl(){if(on)return on;var i,o=jo,u=o.length,h,p="value"in yn?yn.value:yn.textContent,y=p.length;for(i=0;i<u&&o[i]===p[i];i++);var I=u-i;for(h=1;h<=I&&o[u-h]===p[y-h];h++);return on=p.slice(i,1<h?1-h:void 0)}function Fo(i){var o=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&o===13&&(i=13)):i=o,i===10&&(i=13),32<=i||i===13?i:0}function yr(){return!0}function kl(){return!1}function Mt(i){function o(u,h,p,y,I){this._reactName=u,this._targetInst=p,this.type=h,this.nativeEvent=y,this.target=I,this.currentTarget=null;for(var b in i)i.hasOwnProperty(b)&&(u=i[b],this[b]=u?u(y):y[b]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?yr:kl,this.isPropagationStopped=kl,this}return ce(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=yr)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=yr)},persist:function(){},isPersistent:yr}),o}var Jn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Uo=Mt(Jn),vr=ce({},Jn,{view:0,detail:0}),hf=Mt(vr),Bo,Wr,ki,ks=ce({},vr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:_r,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==ki&&(ki&&i.type==="mousemove"?(Bo=i.screenX-ki.screenX,Wr=i.screenY-ki.screenY):Wr=Bo=0,ki=i),Bo)},movementY:function(i){return"movementY"in i?i.movementY:Wr}}),zo=Mt(ks),bl=ce({},ks,{dataTransfer:0}),vc=Mt(bl),$o=ce({},vr,{relatedTarget:0}),qo=Mt($o),_c=ce({},Jn,{animationName:0,elapsedTime:0,pseudoElement:0}),Gr=Mt(_c),wc=ce({},Jn,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),Ec=Mt(wc),Ic=ce({},Jn,{data:0}),Al=Mt(Ic),Ho={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Jt={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},xc={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Tc(i){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(i):(i=xc[i])?!!o[i]:!1}function _r(){return Tc}var c=ce({},vr,{key:function(i){if(i.key){var o=Ho[i.key]||i.key;if(o!=="Unidentified")return o}return i.type==="keypress"?(i=Fo(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?Jt[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:_r,charCode:function(i){return i.type==="keypress"?Fo(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Fo(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),g=Mt(c),_=ce({},ks,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),T=Mt(_),U=ce({},vr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:_r}),G=Mt(U),oe=ce({},Jn,{propertyName:0,elapsedTime:0,pseudoElement:0}),$e=Mt(oe),Tt=ce({},ks,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Le=Mt(Tt),Pt=[9,13,27,32],mt=d&&"CompositionEvent"in window,Cn=null;d&&"documentMode"in document&&(Cn=document.documentMode);var vn=d&&"TextEvent"in window&&!Cn,bs=d&&(!mt||Cn&&8<Cn&&11>=Cn),Wo=" ",dy=!1;function hy(i,o){switch(i){case"keyup":return Pt.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function fy(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Go=!1;function GT(i,o){switch(i){case"compositionend":return fy(o);case"keypress":return o.which!==32?null:(dy=!0,Wo);case"textInput":return i=o.data,i===Wo&&dy?null:i;default:return null}}function KT(i,o){if(Go)return i==="compositionend"||!mt&&hy(i,o)?(i=Sl(),on=jo=yn=null,Go=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return bs&&o.locale!=="ko"?null:o.data;default:return null}}var QT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function py(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o==="input"?!!QT[i.type]:o==="textarea"}function my(i,o,u,h){pr(h),o=Rc(o,"onChange"),0<o.length&&(u=new Uo("onChange","change",null,u,h),i.push({event:u,listeners:o}))}var Rl=null,Cl=null;function XT(i){Dy(i,0)}function Sc(i){var o=Jo(i);if(Eo(o))return i}function YT(i,o){if(i==="change")return o}var gy=!1;if(d){var ff;if(d){var pf="oninput"in document;if(!pf){var yy=document.createElement("div");yy.setAttribute("oninput","return;"),pf=typeof yy.oninput=="function"}ff=pf}else ff=!1;gy=ff&&(!document.documentMode||9<document.documentMode)}function vy(){Rl&&(Rl.detachEvent("onpropertychange",_y),Cl=Rl=null)}function _y(i){if(i.propertyName==="value"&&Sc(Cl)){var o=[];my(o,Cl,i,ko(i)),gl(XT,o)}}function JT(i,o,u){i==="focusin"?(vy(),Rl=o,Cl=u,Rl.attachEvent("onpropertychange",_y)):i==="focusout"&&vy()}function ZT(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Sc(Cl)}function eS(i,o){if(i==="click")return Sc(o)}function tS(i,o){if(i==="input"||i==="change")return Sc(o)}function nS(i,o){return i===o&&(i!==0||1/i===1/o)||i!==i&&o!==o}var Zn=typeof Object.is=="function"?Object.is:nS;function Pl(i,o){if(Zn(i,o))return!0;if(typeof i!="object"||i===null||typeof o!="object"||o===null)return!1;var u=Object.keys(i),h=Object.keys(o);if(u.length!==h.length)return!1;for(h=0;h<u.length;h++){var p=u[h];if(!f.call(o,p)||!Zn(i[p],o[p]))return!1}return!0}function wy(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function Ey(i,o){var u=wy(i);i=0;for(var h;u;){if(u.nodeType===3){if(h=i+u.textContent.length,i<=o&&h>=o)return{node:u,offset:o-i};i=h}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=wy(u)}}function Iy(i,o){return i&&o?i===o?!0:i&&i.nodeType===3?!1:o&&o.nodeType===3?Iy(i,o.parentNode):"contains"in i?i.contains(o):i.compareDocumentPosition?!!(i.compareDocumentPosition(o)&16):!1:!1}function xy(){for(var i=window,o=gi();o instanceof i.HTMLIFrameElement;){try{var u=typeof o.contentWindow.location.href=="string"}catch{u=!1}if(u)i=o.contentWindow;else break;o=gi(i.document)}return o}function mf(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o&&(o==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||o==="textarea"||i.contentEditable==="true")}function rS(i){var o=xy(),u=i.focusedElem,h=i.selectionRange;if(o!==u&&u&&u.ownerDocument&&Iy(u.ownerDocument.documentElement,u)){if(h!==null&&mf(u)){if(o=h.start,i=h.end,i===void 0&&(i=o),"selectionStart"in u)u.selectionStart=o,u.selectionEnd=Math.min(i,u.value.length);else if(i=(o=u.ownerDocument||document)&&o.defaultView||window,i.getSelection){i=i.getSelection();var p=u.textContent.length,y=Math.min(h.start,p);h=h.end===void 0?y:Math.min(h.end,p),!i.extend&&y>h&&(p=h,h=y,y=p),p=Ey(u,y);var I=Ey(u,h);p&&I&&(i.rangeCount!==1||i.anchorNode!==p.node||i.anchorOffset!==p.offset||i.focusNode!==I.node||i.focusOffset!==I.offset)&&(o=o.createRange(),o.setStart(p.node,p.offset),i.removeAllRanges(),y>h?(i.addRange(o),i.extend(I.node,I.offset)):(o.setEnd(I.node,I.offset),i.addRange(o)))}}for(o=[],i=u;i=i.parentNode;)i.nodeType===1&&o.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof u.focus=="function"&&u.focus(),u=0;u<o.length;u++)i=o[u],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var iS=d&&"documentMode"in document&&11>=document.documentMode,Ko=null,gf=null,Nl=null,yf=!1;function Ty(i,o,u){var h=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;yf||Ko==null||Ko!==gi(h)||(h=Ko,"selectionStart"in h&&mf(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),Nl&&Pl(Nl,h)||(Nl=h,h=Rc(gf,"onSelect"),0<h.length&&(o=new Uo("onSelect","select",null,o,u),i.push({event:o,listeners:h}),o.target=Ko)))}function kc(i,o){var u={};return u[i.toLowerCase()]=o.toLowerCase(),u["Webkit"+i]="webkit"+o,u["Moz"+i]="moz"+o,u}var Qo={animationend:kc("Animation","AnimationEnd"),animationiteration:kc("Animation","AnimationIteration"),animationstart:kc("Animation","AnimationStart"),transitionend:kc("Transition","TransitionEnd")},vf={},Sy={};d&&(Sy=document.createElement("div").style,"AnimationEvent"in window||(delete Qo.animationend.animation,delete Qo.animationiteration.animation,delete Qo.animationstart.animation),"TransitionEvent"in window||delete Qo.transitionend.transition);function bc(i){if(vf[i])return vf[i];if(!Qo[i])return i;var o=Qo[i],u;for(u in o)if(o.hasOwnProperty(u)&&u in Sy)return vf[i]=o[u];return i}var ky=bc("animationend"),by=bc("animationiteration"),Ay=bc("animationstart"),Ry=bc("transitionend"),Cy=new Map,Py="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function bi(i,o){Cy.set(i,o),a(o,[i])}for(var _f=0;_f<Py.length;_f++){var wf=Py[_f],sS=wf.toLowerCase(),oS=wf[0].toUpperCase()+wf.slice(1);bi(sS,"on"+oS)}bi(ky,"onAnimationEnd"),bi(by,"onAnimationIteration"),bi(Ay,"onAnimationStart"),bi("dblclick","onDoubleClick"),bi("focusin","onFocus"),bi("focusout","onBlur"),bi(Ry,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Dl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),aS=new Set("cancel close invalid load scroll toggle".split(" ").concat(Dl));function Ny(i,o,u){var h=i.type||"unknown-event";i.currentTarget=u,rc(h,o,void 0,i),i.currentTarget=null}function Dy(i,o){o=(o&4)!==0;for(var u=0;u<i.length;u++){var h=i[u],p=h.event;h=h.listeners;e:{var y=void 0;if(o)for(var I=h.length-1;0<=I;I--){var b=h[I],N=b.instance,W=b.currentTarget;if(b=b.listener,N!==y&&p.isPropagationStopped())break e;Ny(p,b,W),y=N}else for(I=0;I<h.length;I++){if(b=h[I],N=b.instance,W=b.currentTarget,b=b.listener,N!==y&&p.isPropagationStopped())break e;Ny(p,b,W),y=N}}}if(Hn)throw i=yl,Hn=!1,yl=null,i}function Je(i,o){var u=o[Af];u===void 0&&(u=o[Af]=new Set);var h=i+"__bubble";u.has(h)||(Vy(o,i,2,!1),u.add(h))}function Ef(i,o,u){var h=0;o&&(h|=4),Vy(u,i,h,o)}var Ac="_reactListening"+Math.random().toString(36).slice(2);function Vl(i){if(!i[Ac]){i[Ac]=!0,r.forEach(function(u){u!=="selectionchange"&&(aS.has(u)||Ef(u,!1,i),Ef(u,!0,i))});var o=i.nodeType===9?i:i.ownerDocument;o===null||o[Ac]||(o[Ac]=!0,Ef("selectionchange",!1,o))}}function Vy(i,o,u,h){switch(Tl(o)){case 1:var p=et;break;case 4:p=df;break;default:p=xl}u=p.bind(null,o,u,i),p=void 0,!Ro||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(p=!0),h?p!==void 0?i.addEventListener(o,u,{capture:!0,passive:p}):i.addEventListener(o,u,!0):p!==void 0?i.addEventListener(o,u,{passive:p}):i.addEventListener(o,u,!1)}function If(i,o,u,h,p){var y=h;if((o&1)===0&&(o&2)===0&&h!==null)e:for(;;){if(h===null)return;var I=h.tag;if(I===3||I===4){var b=h.stateNode.containerInfo;if(b===p||b.nodeType===8&&b.parentNode===p)break;if(I===4)for(I=h.return;I!==null;){var N=I.tag;if((N===3||N===4)&&(N=I.stateNode.containerInfo,N===p||N.nodeType===8&&N.parentNode===p))return;I=I.return}for(;b!==null;){if(I=As(b),I===null)return;if(N=I.tag,N===5||N===6){h=y=I;continue e}b=b.parentNode}}h=h.return}gl(function(){var W=y,Z=ko(u),ee=[];e:{var J=Cy.get(i);if(J!==void 0){var ue=Uo,fe=i;switch(i){case"keypress":if(Fo(u)===0)break e;case"keydown":case"keyup":ue=g;break;case"focusin":fe="focus",ue=qo;break;case"focusout":fe="blur",ue=qo;break;case"beforeblur":case"afterblur":ue=qo;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ue=zo;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ue=vc;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ue=G;break;case ky:case by:case Ay:ue=Gr;break;case Ry:ue=$e;break;case"scroll":ue=hf;break;case"wheel":ue=Le;break;case"copy":case"cut":case"paste":ue=Ec;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ue=T}var me=(o&4)!==0,ft=!me&&i==="scroll",z=me?J!==null?J+"Capture":null:J;me=[];for(var V=W,H;V!==null;){H=V;var ie=H.stateNode;if(H.tag===5&&ie!==null&&(H=ie,z!==null&&(ie=ht(V,z),ie!=null&&me.push(Ol(V,ie,H)))),ft)break;V=V.return}0<me.length&&(J=new ue(J,fe,null,u,Z),ee.push({event:J,listeners:me}))}}if((o&7)===0){e:{if(J=i==="mouseover"||i==="pointerover",ue=i==="mouseout"||i==="pointerout",J&&u!==ms&&(fe=u.relatedTarget||u.fromElement)&&(As(fe)||fe[Kr]))break e;if((ue||J)&&(J=Z.window===Z?Z:(J=Z.ownerDocument)?J.defaultView||J.parentWindow:window,ue?(fe=u.relatedTarget||u.toElement,ue=W,fe=fe?As(fe):null,fe!==null&&(ft=Wn(fe),fe!==ft||fe.tag!==5&&fe.tag!==6)&&(fe=null)):(ue=null,fe=W),ue!==fe)){if(me=zo,ie="onMouseLeave",z="onMouseEnter",V="mouse",(i==="pointerout"||i==="pointerover")&&(me=T,ie="onPointerLeave",z="onPointerEnter",V="pointer"),ft=ue==null?J:Jo(ue),H=fe==null?J:Jo(fe),J=new me(ie,V+"leave",ue,u,Z),J.target=ft,J.relatedTarget=H,ie=null,As(Z)===W&&(me=new me(z,V+"enter",fe,u,Z),me.target=H,me.relatedTarget=ft,ie=me),ft=ie,ue&&fe)t:{for(me=ue,z=fe,V=0,H=me;H;H=Xo(H))V++;for(H=0,ie=z;ie;ie=Xo(ie))H++;for(;0<V-H;)me=Xo(me),V--;for(;0<H-V;)z=Xo(z),H--;for(;V--;){if(me===z||z!==null&&me===z.alternate)break t;me=Xo(me),z=Xo(z)}me=null}else me=null;ue!==null&&Oy(ee,J,ue,me,!1),fe!==null&&ft!==null&&Oy(ee,ft,fe,me,!0)}}e:{if(J=W?Jo(W):window,ue=J.nodeName&&J.nodeName.toLowerCase(),ue==="select"||ue==="input"&&J.type==="file")var ge=YT;else if(py(J))if(gy)ge=tS;else{ge=ZT;var Ee=JT}else(ue=J.nodeName)&&ue.toLowerCase()==="input"&&(J.type==="checkbox"||J.type==="radio")&&(ge=eS);if(ge&&(ge=ge(i,W))){my(ee,ge,u,Z);break e}Ee&&Ee(i,J,W),i==="focusout"&&(Ee=J._wrapperState)&&Ee.controlled&&J.type==="number"&&xo(J,"number",J.value)}switch(Ee=W?Jo(W):window,i){case"focusin":(py(Ee)||Ee.contentEditable==="true")&&(Ko=Ee,gf=W,Nl=null);break;case"focusout":Nl=gf=Ko=null;break;case"mousedown":yf=!0;break;case"contextmenu":case"mouseup":case"dragend":yf=!1,Ty(ee,u,Z);break;case"selectionchange":if(iS)break;case"keydown":case"keyup":Ty(ee,u,Z)}var Ie;if(mt)e:{switch(i){case"compositionstart":var Te="onCompositionStart";break e;case"compositionend":Te="onCompositionEnd";break e;case"compositionupdate":Te="onCompositionUpdate";break e}Te=void 0}else Go?hy(i,u)&&(Te="onCompositionEnd"):i==="keydown"&&u.keyCode===229&&(Te="onCompositionStart");Te&&(bs&&u.locale!=="ko"&&(Go||Te!=="onCompositionStart"?Te==="onCompositionEnd"&&Go&&(Ie=Sl()):(yn=Z,jo="value"in yn?yn.value:yn.textContent,Go=!0)),Ee=Rc(W,Te),0<Ee.length&&(Te=new Al(Te,i,null,u,Z),ee.push({event:Te,listeners:Ee}),Ie?Te.data=Ie:(Ie=fy(u),Ie!==null&&(Te.data=Ie)))),(Ie=vn?GT(i,u):KT(i,u))&&(W=Rc(W,"onBeforeInput"),0<W.length&&(Z=new Al("onBeforeInput","beforeinput",null,u,Z),ee.push({event:Z,listeners:W}),Z.data=Ie))}Dy(ee,o)})}function Ol(i,o,u){return{instance:i,listener:o,currentTarget:u}}function Rc(i,o){for(var u=o+"Capture",h=[];i!==null;){var p=i,y=p.stateNode;p.tag===5&&y!==null&&(p=y,y=ht(i,u),y!=null&&h.unshift(Ol(i,y,p)),y=ht(i,o),y!=null&&h.push(Ol(i,y,p))),i=i.return}return h}function Xo(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function Oy(i,o,u,h,p){for(var y=o._reactName,I=[];u!==null&&u!==h;){var b=u,N=b.alternate,W=b.stateNode;if(N!==null&&N===h)break;b.tag===5&&W!==null&&(b=W,p?(N=ht(u,y),N!=null&&I.unshift(Ol(u,N,b))):p||(N=ht(u,y),N!=null&&I.push(Ol(u,N,b)))),u=u.return}I.length!==0&&i.push({event:o,listeners:I})}var lS=/\r\n?/g,uS=/\u0000|\uFFFD/g;function Ly(i){return(typeof i=="string"?i:""+i).replace(lS,`
`).replace(uS,"")}function Cc(i,o,u){if(o=Ly(o),Ly(i)!==o&&u)throw Error(t(425))}function Pc(){}var xf=null,Tf=null;function Sf(i,o){return i==="textarea"||i==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var kf=typeof setTimeout=="function"?setTimeout:void 0,cS=typeof clearTimeout=="function"?clearTimeout:void 0,My=typeof Promise=="function"?Promise:void 0,dS=typeof queueMicrotask=="function"?queueMicrotask:typeof My<"u"?function(i){return My.resolve(null).then(i).catch(hS)}:kf;function hS(i){setTimeout(function(){throw i})}function bf(i,o){var u=o,h=0;do{var p=u.nextSibling;if(i.removeChild(u),p&&p.nodeType===8)if(u=p.data,u==="/$"){if(h===0){i.removeChild(p),Yn(o);return}h--}else u!=="$"&&u!=="$?"&&u!=="$!"||h++;u=p}while(u);Yn(o)}function Ai(i){for(;i!=null;i=i.nextSibling){var o=i.nodeType;if(o===1||o===3)break;if(o===8){if(o=i.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return i}function jy(i){i=i.previousSibling;for(var o=0;i;){if(i.nodeType===8){var u=i.data;if(u==="$"||u==="$!"||u==="$?"){if(o===0)return i;o--}else u==="/$"&&o++}i=i.previousSibling}return null}var Yo=Math.random().toString(36).slice(2),wr="__reactFiber$"+Yo,Ll="__reactProps$"+Yo,Kr="__reactContainer$"+Yo,Af="__reactEvents$"+Yo,fS="__reactListeners$"+Yo,pS="__reactHandles$"+Yo;function As(i){var o=i[wr];if(o)return o;for(var u=i.parentNode;u;){if(o=u[Kr]||u[wr]){if(u=o.alternate,o.child!==null||u!==null&&u.child!==null)for(i=jy(i);i!==null;){if(u=i[wr])return u;i=jy(i)}return o}i=u,u=i.parentNode}return null}function Ml(i){return i=i[wr]||i[Kr],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function Jo(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(t(33))}function Nc(i){return i[Ll]||null}var Rf=[],Zo=-1;function Ri(i){return{current:i}}function Ze(i){0>Zo||(i.current=Rf[Zo],Rf[Zo]=null,Zo--)}function Ye(i,o){Zo++,Rf[Zo]=i.current,i.current=o}var Ci={},zt=Ri(Ci),an=Ri(!1),Rs=Ci;function ea(i,o){var u=i.type.contextTypes;if(!u)return Ci;var h=i.stateNode;if(h&&h.__reactInternalMemoizedUnmaskedChildContext===o)return h.__reactInternalMemoizedMaskedChildContext;var p={},y;for(y in u)p[y]=o[y];return h&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=o,i.__reactInternalMemoizedMaskedChildContext=p),p}function ln(i){return i=i.childContextTypes,i!=null}function Dc(){Ze(an),Ze(zt)}function Fy(i,o,u){if(zt.current!==Ci)throw Error(t(168));Ye(zt,o),Ye(an,u)}function Uy(i,o,u){var h=i.stateNode;if(o=o.childContextTypes,typeof h.getChildContext!="function")return u;h=h.getChildContext();for(var p in h)if(!(p in o))throw Error(t(108,Ue(i)||"Unknown",p));return ce({},u,h)}function Vc(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||Ci,Rs=zt.current,Ye(zt,i),Ye(an,an.current),!0}function By(i,o,u){var h=i.stateNode;if(!h)throw Error(t(169));u?(i=Uy(i,o,Rs),h.__reactInternalMemoizedMergedChildContext=i,Ze(an),Ze(zt),Ye(zt,i)):Ze(an),Ye(an,u)}var Qr=null,Oc=!1,Cf=!1;function zy(i){Qr===null?Qr=[i]:Qr.push(i)}function mS(i){Oc=!0,zy(i)}function Pi(){if(!Cf&&Qr!==null){Cf=!0;var i=0,o=Ve;try{var u=Qr;for(Ve=1;i<u.length;i++){var h=u[i];do h=h(!0);while(h!==null)}Qr=null,Oc=!1}catch(p){throw Qr!==null&&(Qr=Qr.slice(i+1)),Do(ws,Pi),p}finally{Ve=o,Cf=!1}}return null}var ta=[],na=0,Lc=null,Mc=0,Pn=[],Nn=0,Cs=null,Xr=1,Yr="";function Ps(i,o){ta[na++]=Mc,ta[na++]=Lc,Lc=i,Mc=o}function $y(i,o,u){Pn[Nn++]=Xr,Pn[Nn++]=Yr,Pn[Nn++]=Cs,Cs=i;var h=Xr;i=Yr;var p=32-Yt(h)-1;h&=~(1<<p),u+=1;var y=32-Yt(o)+p;if(30<y){var I=p-p%5;y=(h&(1<<I)-1).toString(32),h>>=I,p-=I,Xr=1<<32-Yt(o)+p|u<<p|h,Yr=y+i}else Xr=1<<y|u<<p|h,Yr=i}function Pf(i){i.return!==null&&(Ps(i,1),$y(i,1,0))}function Nf(i){for(;i===Lc;)Lc=ta[--na],ta[na]=null,Mc=ta[--na],ta[na]=null;for(;i===Cs;)Cs=Pn[--Nn],Pn[Nn]=null,Yr=Pn[--Nn],Pn[Nn]=null,Xr=Pn[--Nn],Pn[Nn]=null}var _n=null,wn=null,tt=!1,er=null;function qy(i,o){var u=Ln(5,null,null,0);u.elementType="DELETED",u.stateNode=o,u.return=i,o=i.deletions,o===null?(i.deletions=[u],i.flags|=16):o.push(u)}function Hy(i,o){switch(i.tag){case 5:var u=i.type;return o=o.nodeType!==1||u.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(i.stateNode=o,_n=i,wn=Ai(o.firstChild),!0):!1;case 6:return o=i.pendingProps===""||o.nodeType!==3?null:o,o!==null?(i.stateNode=o,_n=i,wn=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(u=Cs!==null?{id:Xr,overflow:Yr}:null,i.memoizedState={dehydrated:o,treeContext:u,retryLane:1073741824},u=Ln(18,null,null,0),u.stateNode=o,u.return=i,i.child=u,_n=i,wn=null,!0):!1;default:return!1}}function Df(i){return(i.mode&1)!==0&&(i.flags&128)===0}function Vf(i){if(tt){var o=wn;if(o){var u=o;if(!Hy(i,o)){if(Df(i))throw Error(t(418));o=Ai(u.nextSibling);var h=_n;o&&Hy(i,o)?qy(h,u):(i.flags=i.flags&-4097|2,tt=!1,_n=i)}}else{if(Df(i))throw Error(t(418));i.flags=i.flags&-4097|2,tt=!1,_n=i}}}function Wy(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;_n=i}function jc(i){if(i!==_n)return!1;if(!tt)return Wy(i),tt=!0,!1;var o;if((o=i.tag!==3)&&!(o=i.tag!==5)&&(o=i.type,o=o!=="head"&&o!=="body"&&!Sf(i.type,i.memoizedProps)),o&&(o=wn)){if(Df(i))throw Gy(),Error(t(418));for(;o;)qy(i,o),o=Ai(o.nextSibling)}if(Wy(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(t(317));e:{for(i=i.nextSibling,o=0;i;){if(i.nodeType===8){var u=i.data;if(u==="/$"){if(o===0){wn=Ai(i.nextSibling);break e}o--}else u!=="$"&&u!=="$!"&&u!=="$?"||o++}i=i.nextSibling}wn=null}}else wn=_n?Ai(i.stateNode.nextSibling):null;return!0}function Gy(){for(var i=wn;i;)i=Ai(i.nextSibling)}function ra(){wn=_n=null,tt=!1}function Of(i){er===null?er=[i]:er.push(i)}var gS=re.ReactCurrentBatchConfig;function jl(i,o,u){if(i=u.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(u._owner){if(u=u._owner,u){if(u.tag!==1)throw Error(t(309));var h=u.stateNode}if(!h)throw Error(t(147,i));var p=h,y=""+i;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===y?o.ref:(o=function(I){var b=p.refs;I===null?delete b[y]:b[y]=I},o._stringRef=y,o)}if(typeof i!="string")throw Error(t(284));if(!u._owner)throw Error(t(290,i))}return i}function Fc(i,o){throw i=Object.prototype.toString.call(o),Error(t(31,i==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":i))}function Ky(i){var o=i._init;return o(i._payload)}function Qy(i){function o(z,V){if(i){var H=z.deletions;H===null?(z.deletions=[V],z.flags|=16):H.push(V)}}function u(z,V){if(!i)return null;for(;V!==null;)o(z,V),V=V.sibling;return null}function h(z,V){for(z=new Map;V!==null;)V.key!==null?z.set(V.key,V):z.set(V.index,V),V=V.sibling;return z}function p(z,V){return z=Fi(z,V),z.index=0,z.sibling=null,z}function y(z,V,H){return z.index=H,i?(H=z.alternate,H!==null?(H=H.index,H<V?(z.flags|=2,V):H):(z.flags|=2,V)):(z.flags|=1048576,V)}function I(z){return i&&z.alternate===null&&(z.flags|=2),z}function b(z,V,H,ie){return V===null||V.tag!==6?(V=kp(H,z.mode,ie),V.return=z,V):(V=p(V,H),V.return=z,V)}function N(z,V,H,ie){var ge=H.type;return ge===P?Z(z,V,H.props.children,ie,H.key):V!==null&&(V.elementType===ge||typeof ge=="object"&&ge!==null&&ge.$$typeof===Rt&&Ky(ge)===V.type)?(ie=p(V,H.props),ie.ref=jl(z,V,H),ie.return=z,ie):(ie=ud(H.type,H.key,H.props,null,z.mode,ie),ie.ref=jl(z,V,H),ie.return=z,ie)}function W(z,V,H,ie){return V===null||V.tag!==4||V.stateNode.containerInfo!==H.containerInfo||V.stateNode.implementation!==H.implementation?(V=bp(H,z.mode,ie),V.return=z,V):(V=p(V,H.children||[]),V.return=z,V)}function Z(z,V,H,ie,ge){return V===null||V.tag!==7?(V=Fs(H,z.mode,ie,ge),V.return=z,V):(V=p(V,H),V.return=z,V)}function ee(z,V,H){if(typeof V=="string"&&V!==""||typeof V=="number")return V=kp(""+V,z.mode,H),V.return=z,V;if(typeof V=="object"&&V!==null){switch(V.$$typeof){case de:return H=ud(V.type,V.key,V.props,null,z.mode,H),H.ref=jl(z,null,V),H.return=z,H;case ne:return V=bp(V,z.mode,H),V.return=z,V;case Rt:var ie=V._init;return ee(z,ie(V._payload),H)}if(Fr(V)||we(V))return V=Fs(V,z.mode,H,null),V.return=z,V;Fc(z,V)}return null}function J(z,V,H,ie){var ge=V!==null?V.key:null;if(typeof H=="string"&&H!==""||typeof H=="number")return ge!==null?null:b(z,V,""+H,ie);if(typeof H=="object"&&H!==null){switch(H.$$typeof){case de:return H.key===ge?N(z,V,H,ie):null;case ne:return H.key===ge?W(z,V,H,ie):null;case Rt:return ge=H._init,J(z,V,ge(H._payload),ie)}if(Fr(H)||we(H))return ge!==null?null:Z(z,V,H,ie,null);Fc(z,H)}return null}function ue(z,V,H,ie,ge){if(typeof ie=="string"&&ie!==""||typeof ie=="number")return z=z.get(H)||null,b(V,z,""+ie,ge);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case de:return z=z.get(ie.key===null?H:ie.key)||null,N(V,z,ie,ge);case ne:return z=z.get(ie.key===null?H:ie.key)||null,W(V,z,ie,ge);case Rt:var Ee=ie._init;return ue(z,V,H,Ee(ie._payload),ge)}if(Fr(ie)||we(ie))return z=z.get(H)||null,Z(V,z,ie,ge,null);Fc(V,ie)}return null}function fe(z,V,H,ie){for(var ge=null,Ee=null,Ie=V,Te=V=0,Vt=null;Ie!==null&&Te<H.length;Te++){Ie.index>Te?(Vt=Ie,Ie=null):Vt=Ie.sibling;var Fe=J(z,Ie,H[Te],ie);if(Fe===null){Ie===null&&(Ie=Vt);break}i&&Ie&&Fe.alternate===null&&o(z,Ie),V=y(Fe,V,Te),Ee===null?ge=Fe:Ee.sibling=Fe,Ee=Fe,Ie=Vt}if(Te===H.length)return u(z,Ie),tt&&Ps(z,Te),ge;if(Ie===null){for(;Te<H.length;Te++)Ie=ee(z,H[Te],ie),Ie!==null&&(V=y(Ie,V,Te),Ee===null?ge=Ie:Ee.sibling=Ie,Ee=Ie);return tt&&Ps(z,Te),ge}for(Ie=h(z,Ie);Te<H.length;Te++)Vt=ue(Ie,z,Te,H[Te],ie),Vt!==null&&(i&&Vt.alternate!==null&&Ie.delete(Vt.key===null?Te:Vt.key),V=y(Vt,V,Te),Ee===null?ge=Vt:Ee.sibling=Vt,Ee=Vt);return i&&Ie.forEach(function(Ui){return o(z,Ui)}),tt&&Ps(z,Te),ge}function me(z,V,H,ie){var ge=we(H);if(typeof ge!="function")throw Error(t(150));if(H=ge.call(H),H==null)throw Error(t(151));for(var Ee=ge=null,Ie=V,Te=V=0,Vt=null,Fe=H.next();Ie!==null&&!Fe.done;Te++,Fe=H.next()){Ie.index>Te?(Vt=Ie,Ie=null):Vt=Ie.sibling;var Ui=J(z,Ie,Fe.value,ie);if(Ui===null){Ie===null&&(Ie=Vt);break}i&&Ie&&Ui.alternate===null&&o(z,Ie),V=y(Ui,V,Te),Ee===null?ge=Ui:Ee.sibling=Ui,Ee=Ui,Ie=Vt}if(Fe.done)return u(z,Ie),tt&&Ps(z,Te),ge;if(Ie===null){for(;!Fe.done;Te++,Fe=H.next())Fe=ee(z,Fe.value,ie),Fe!==null&&(V=y(Fe,V,Te),Ee===null?ge=Fe:Ee.sibling=Fe,Ee=Fe);return tt&&Ps(z,Te),ge}for(Ie=h(z,Ie);!Fe.done;Te++,Fe=H.next())Fe=ue(Ie,z,Te,Fe.value,ie),Fe!==null&&(i&&Fe.alternate!==null&&Ie.delete(Fe.key===null?Te:Fe.key),V=y(Fe,V,Te),Ee===null?ge=Fe:Ee.sibling=Fe,Ee=Fe);return i&&Ie.forEach(function(QS){return o(z,QS)}),tt&&Ps(z,Te),ge}function ft(z,V,H,ie){if(typeof H=="object"&&H!==null&&H.type===P&&H.key===null&&(H=H.props.children),typeof H=="object"&&H!==null){switch(H.$$typeof){case de:e:{for(var ge=H.key,Ee=V;Ee!==null;){if(Ee.key===ge){if(ge=H.type,ge===P){if(Ee.tag===7){u(z,Ee.sibling),V=p(Ee,H.props.children),V.return=z,z=V;break e}}else if(Ee.elementType===ge||typeof ge=="object"&&ge!==null&&ge.$$typeof===Rt&&Ky(ge)===Ee.type){u(z,Ee.sibling),V=p(Ee,H.props),V.ref=jl(z,Ee,H),V.return=z,z=V;break e}u(z,Ee);break}else o(z,Ee);Ee=Ee.sibling}H.type===P?(V=Fs(H.props.children,z.mode,ie,H.key),V.return=z,z=V):(ie=ud(H.type,H.key,H.props,null,z.mode,ie),ie.ref=jl(z,V,H),ie.return=z,z=ie)}return I(z);case ne:e:{for(Ee=H.key;V!==null;){if(V.key===Ee)if(V.tag===4&&V.stateNode.containerInfo===H.containerInfo&&V.stateNode.implementation===H.implementation){u(z,V.sibling),V=p(V,H.children||[]),V.return=z,z=V;break e}else{u(z,V);break}else o(z,V);V=V.sibling}V=bp(H,z.mode,ie),V.return=z,z=V}return I(z);case Rt:return Ee=H._init,ft(z,V,Ee(H._payload),ie)}if(Fr(H))return fe(z,V,H,ie);if(we(H))return me(z,V,H,ie);Fc(z,H)}return typeof H=="string"&&H!==""||typeof H=="number"?(H=""+H,V!==null&&V.tag===6?(u(z,V.sibling),V=p(V,H),V.return=z,z=V):(u(z,V),V=kp(H,z.mode,ie),V.return=z,z=V),I(z)):u(z,V)}return ft}var ia=Qy(!0),Xy=Qy(!1),Uc=Ri(null),Bc=null,sa=null,Lf=null;function Mf(){Lf=sa=Bc=null}function jf(i){var o=Uc.current;Ze(Uc),i._currentValue=o}function Ff(i,o,u){for(;i!==null;){var h=i.alternate;if((i.childLanes&o)!==o?(i.childLanes|=o,h!==null&&(h.childLanes|=o)):h!==null&&(h.childLanes&o)!==o&&(h.childLanes|=o),i===u)break;i=i.return}}function oa(i,o){Bc=i,Lf=sa=null,i=i.dependencies,i!==null&&i.firstContext!==null&&((i.lanes&o)!==0&&(un=!0),i.firstContext=null)}function Dn(i){var o=i._currentValue;if(Lf!==i)if(i={context:i,memoizedValue:o,next:null},sa===null){if(Bc===null)throw Error(t(308));sa=i,Bc.dependencies={lanes:0,firstContext:i}}else sa=sa.next=i;return o}var Ns=null;function Uf(i){Ns===null?Ns=[i]:Ns.push(i)}function Yy(i,o,u,h){var p=o.interleaved;return p===null?(u.next=u,Uf(o)):(u.next=p.next,p.next=u),o.interleaved=u,Jr(i,h)}function Jr(i,o){i.lanes|=o;var u=i.alternate;for(u!==null&&(u.lanes|=o),u=i,i=i.return;i!==null;)i.childLanes|=o,u=i.alternate,u!==null&&(u.childLanes|=o),u=i,i=i.return;return u.tag===3?u.stateNode:null}var Ni=!1;function Bf(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Jy(i,o){i=i.updateQueue,o.updateQueue===i&&(o.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function Zr(i,o){return{eventTime:i,lane:o,tag:0,payload:null,callback:null,next:null}}function Di(i,o,u){var h=i.updateQueue;if(h===null)return null;if(h=h.shared,(je&2)!==0){var p=h.pending;return p===null?o.next=o:(o.next=p.next,p.next=o),h.pending=o,Jr(i,u)}return p=h.interleaved,p===null?(o.next=o,Uf(h)):(o.next=p.next,p.next=o),h.interleaved=o,Jr(i,u)}function zc(i,o,u){if(o=o.updateQueue,o!==null&&(o=o.shared,(u&4194240)!==0)){var h=o.lanes;h&=i.pendingLanes,u|=h,o.lanes=u,Ii(i,u)}}function Zy(i,o){var u=i.updateQueue,h=i.alternate;if(h!==null&&(h=h.updateQueue,u===h)){var p=null,y=null;if(u=u.firstBaseUpdate,u!==null){do{var I={eventTime:u.eventTime,lane:u.lane,tag:u.tag,payload:u.payload,callback:u.callback,next:null};y===null?p=y=I:y=y.next=I,u=u.next}while(u!==null);y===null?p=y=o:y=y.next=o}else p=y=o;u={baseState:h.baseState,firstBaseUpdate:p,lastBaseUpdate:y,shared:h.shared,effects:h.effects},i.updateQueue=u;return}i=u.lastBaseUpdate,i===null?u.firstBaseUpdate=o:i.next=o,u.lastBaseUpdate=o}function $c(i,o,u,h){var p=i.updateQueue;Ni=!1;var y=p.firstBaseUpdate,I=p.lastBaseUpdate,b=p.shared.pending;if(b!==null){p.shared.pending=null;var N=b,W=N.next;N.next=null,I===null?y=W:I.next=W,I=N;var Z=i.alternate;Z!==null&&(Z=Z.updateQueue,b=Z.lastBaseUpdate,b!==I&&(b===null?Z.firstBaseUpdate=W:b.next=W,Z.lastBaseUpdate=N))}if(y!==null){var ee=p.baseState;I=0,Z=W=N=null,b=y;do{var J=b.lane,ue=b.eventTime;if((h&J)===J){Z!==null&&(Z=Z.next={eventTime:ue,lane:0,tag:b.tag,payload:b.payload,callback:b.callback,next:null});e:{var fe=i,me=b;switch(J=o,ue=u,me.tag){case 1:if(fe=me.payload,typeof fe=="function"){ee=fe.call(ue,ee,J);break e}ee=fe;break e;case 3:fe.flags=fe.flags&-65537|128;case 0:if(fe=me.payload,J=typeof fe=="function"?fe.call(ue,ee,J):fe,J==null)break e;ee=ce({},ee,J);break e;case 2:Ni=!0}}b.callback!==null&&b.lane!==0&&(i.flags|=64,J=p.effects,J===null?p.effects=[b]:J.push(b))}else ue={eventTime:ue,lane:J,tag:b.tag,payload:b.payload,callback:b.callback,next:null},Z===null?(W=Z=ue,N=ee):Z=Z.next=ue,I|=J;if(b=b.next,b===null){if(b=p.shared.pending,b===null)break;J=b,b=J.next,J.next=null,p.lastBaseUpdate=J,p.shared.pending=null}}while(!0);if(Z===null&&(N=ee),p.baseState=N,p.firstBaseUpdate=W,p.lastBaseUpdate=Z,o=p.shared.interleaved,o!==null){p=o;do I|=p.lane,p=p.next;while(p!==o)}else y===null&&(p.shared.lanes=0);Os|=I,i.lanes=I,i.memoizedState=ee}}function ev(i,o,u){if(i=o.effects,o.effects=null,i!==null)for(o=0;o<i.length;o++){var h=i[o],p=h.callback;if(p!==null){if(h.callback=null,h=u,typeof p!="function")throw Error(t(191,p));p.call(h)}}}var Fl={},Er=Ri(Fl),Ul=Ri(Fl),Bl=Ri(Fl);function Ds(i){if(i===Fl)throw Error(t(174));return i}function zf(i,o){switch(Ye(Bl,o),Ye(Ul,i),Ye(Er,Fl),i=o.nodeType,i){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:xt(null,"");break;default:i=i===8?o.parentNode:o,o=i.namespaceURI||null,i=i.tagName,o=xt(o,i)}Ze(Er),Ye(Er,o)}function aa(){Ze(Er),Ze(Ul),Ze(Bl)}function tv(i){Ds(Bl.current);var o=Ds(Er.current),u=xt(o,i.type);o!==u&&(Ye(Ul,i),Ye(Er,u))}function $f(i){Ul.current===i&&(Ze(Er),Ze(Ul))}var st=Ri(0);function qc(i){for(var o=i;o!==null;){if(o.tag===13){var u=o.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||u.data==="$?"||u.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var qf=[];function Hf(){for(var i=0;i<qf.length;i++)qf[i]._workInProgressVersionPrimary=null;qf.length=0}var Hc=re.ReactCurrentDispatcher,Wf=re.ReactCurrentBatchConfig,Vs=0,ot=null,St=null,Nt=null,Wc=!1,zl=!1,$l=0,yS=0;function $t(){throw Error(t(321))}function Gf(i,o){if(o===null)return!1;for(var u=0;u<o.length&&u<i.length;u++)if(!Zn(i[u],o[u]))return!1;return!0}function Kf(i,o,u,h,p,y){if(Vs=y,ot=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,Hc.current=i===null||i.memoizedState===null?ES:IS,i=u(h,p),zl){y=0;do{if(zl=!1,$l=0,25<=y)throw Error(t(301));y+=1,Nt=St=null,o.updateQueue=null,Hc.current=xS,i=u(h,p)}while(zl)}if(Hc.current=Qc,o=St!==null&&St.next!==null,Vs=0,Nt=St=ot=null,Wc=!1,o)throw Error(t(300));return i}function Qf(){var i=$l!==0;return $l=0,i}function Ir(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Nt===null?ot.memoizedState=Nt=i:Nt=Nt.next=i,Nt}function Vn(){if(St===null){var i=ot.alternate;i=i!==null?i.memoizedState:null}else i=St.next;var o=Nt===null?ot.memoizedState:Nt.next;if(o!==null)Nt=o,St=i;else{if(i===null)throw Error(t(310));St=i,i={memoizedState:St.memoizedState,baseState:St.baseState,baseQueue:St.baseQueue,queue:St.queue,next:null},Nt===null?ot.memoizedState=Nt=i:Nt=Nt.next=i}return Nt}function ql(i,o){return typeof o=="function"?o(i):o}function Xf(i){var o=Vn(),u=o.queue;if(u===null)throw Error(t(311));u.lastRenderedReducer=i;var h=St,p=h.baseQueue,y=u.pending;if(y!==null){if(p!==null){var I=p.next;p.next=y.next,y.next=I}h.baseQueue=p=y,u.pending=null}if(p!==null){y=p.next,h=h.baseState;var b=I=null,N=null,W=y;do{var Z=W.lane;if((Vs&Z)===Z)N!==null&&(N=N.next={lane:0,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null}),h=W.hasEagerState?W.eagerState:i(h,W.action);else{var ee={lane:Z,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null};N===null?(b=N=ee,I=h):N=N.next=ee,ot.lanes|=Z,Os|=Z}W=W.next}while(W!==null&&W!==y);N===null?I=h:N.next=b,Zn(h,o.memoizedState)||(un=!0),o.memoizedState=h,o.baseState=I,o.baseQueue=N,u.lastRenderedState=h}if(i=u.interleaved,i!==null){p=i;do y=p.lane,ot.lanes|=y,Os|=y,p=p.next;while(p!==i)}else p===null&&(u.lanes=0);return[o.memoizedState,u.dispatch]}function Yf(i){var o=Vn(),u=o.queue;if(u===null)throw Error(t(311));u.lastRenderedReducer=i;var h=u.dispatch,p=u.pending,y=o.memoizedState;if(p!==null){u.pending=null;var I=p=p.next;do y=i(y,I.action),I=I.next;while(I!==p);Zn(y,o.memoizedState)||(un=!0),o.memoizedState=y,o.baseQueue===null&&(o.baseState=y),u.lastRenderedState=y}return[y,h]}function nv(){}function rv(i,o){var u=ot,h=Vn(),p=o(),y=!Zn(h.memoizedState,p);if(y&&(h.memoizedState=p,un=!0),h=h.queue,Jf(ov.bind(null,u,h,i),[i]),h.getSnapshot!==o||y||Nt!==null&&Nt.memoizedState.tag&1){if(u.flags|=2048,Hl(9,sv.bind(null,u,h,p,o),void 0,null),Dt===null)throw Error(t(349));(Vs&30)!==0||iv(u,o,p)}return p}function iv(i,o,u){i.flags|=16384,i={getSnapshot:o,value:u},o=ot.updateQueue,o===null?(o={lastEffect:null,stores:null},ot.updateQueue=o,o.stores=[i]):(u=o.stores,u===null?o.stores=[i]:u.push(i))}function sv(i,o,u,h){o.value=u,o.getSnapshot=h,av(o)&&lv(i)}function ov(i,o,u){return u(function(){av(o)&&lv(i)})}function av(i){var o=i.getSnapshot;i=i.value;try{var u=o();return!Zn(i,u)}catch{return!0}}function lv(i){var o=Jr(i,1);o!==null&&ir(o,i,1,-1)}function uv(i){var o=Ir();return typeof i=="function"&&(i=i()),o.memoizedState=o.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ql,lastRenderedState:i},o.queue=i,i=i.dispatch=wS.bind(null,ot,i),[o.memoizedState,i]}function Hl(i,o,u,h){return i={tag:i,create:o,destroy:u,deps:h,next:null},o=ot.updateQueue,o===null?(o={lastEffect:null,stores:null},ot.updateQueue=o,o.lastEffect=i.next=i):(u=o.lastEffect,u===null?o.lastEffect=i.next=i:(h=u.next,u.next=i,i.next=h,o.lastEffect=i)),i}function cv(){return Vn().memoizedState}function Gc(i,o,u,h){var p=Ir();ot.flags|=i,p.memoizedState=Hl(1|o,u,void 0,h===void 0?null:h)}function Kc(i,o,u,h){var p=Vn();h=h===void 0?null:h;var y=void 0;if(St!==null){var I=St.memoizedState;if(y=I.destroy,h!==null&&Gf(h,I.deps)){p.memoizedState=Hl(o,u,y,h);return}}ot.flags|=i,p.memoizedState=Hl(1|o,u,y,h)}function dv(i,o){return Gc(8390656,8,i,o)}function Jf(i,o){return Kc(2048,8,i,o)}function hv(i,o){return Kc(4,2,i,o)}function fv(i,o){return Kc(4,4,i,o)}function pv(i,o){if(typeof o=="function")return i=i(),o(i),function(){o(null)};if(o!=null)return i=i(),o.current=i,function(){o.current=null}}function mv(i,o,u){return u=u!=null?u.concat([i]):null,Kc(4,4,pv.bind(null,o,i),u)}function Zf(){}function gv(i,o){var u=Vn();o=o===void 0?null:o;var h=u.memoizedState;return h!==null&&o!==null&&Gf(o,h[1])?h[0]:(u.memoizedState=[i,o],i)}function yv(i,o){var u=Vn();o=o===void 0?null:o;var h=u.memoizedState;return h!==null&&o!==null&&Gf(o,h[1])?h[0]:(i=i(),u.memoizedState=[i,o],i)}function vv(i,o,u){return(Vs&21)===0?(i.baseState&&(i.baseState=!1,un=!0),i.memoizedState=u):(Zn(u,o)||(u=xs(),ot.lanes|=u,Os|=u,i.baseState=!0),o)}function vS(i,o){var u=Ve;Ve=u!==0&&4>u?u:4,i(!0);var h=Wf.transition;Wf.transition={};try{i(!1),o()}finally{Ve=u,Wf.transition=h}}function _v(){return Vn().memoizedState}function _S(i,o,u){var h=Mi(i);if(u={lane:h,action:u,hasEagerState:!1,eagerState:null,next:null},wv(i))Ev(o,u);else if(u=Yy(i,o,u,h),u!==null){var p=en();ir(u,i,h,p),Iv(u,o,h)}}function wS(i,o,u){var h=Mi(i),p={lane:h,action:u,hasEagerState:!1,eagerState:null,next:null};if(wv(i))Ev(o,p);else{var y=i.alternate;if(i.lanes===0&&(y===null||y.lanes===0)&&(y=o.lastRenderedReducer,y!==null))try{var I=o.lastRenderedState,b=y(I,u);if(p.hasEagerState=!0,p.eagerState=b,Zn(b,I)){var N=o.interleaved;N===null?(p.next=p,Uf(o)):(p.next=N.next,N.next=p),o.interleaved=p;return}}catch{}finally{}u=Yy(i,o,p,h),u!==null&&(p=en(),ir(u,i,h,p),Iv(u,o,h))}}function wv(i){var o=i.alternate;return i===ot||o!==null&&o===ot}function Ev(i,o){zl=Wc=!0;var u=i.pending;u===null?o.next=o:(o.next=u.next,u.next=o),i.pending=o}function Iv(i,o,u){if((u&4194240)!==0){var h=o.lanes;h&=i.pendingLanes,u|=h,o.lanes=u,Ii(i,u)}}var Qc={readContext:Dn,useCallback:$t,useContext:$t,useEffect:$t,useImperativeHandle:$t,useInsertionEffect:$t,useLayoutEffect:$t,useMemo:$t,useReducer:$t,useRef:$t,useState:$t,useDebugValue:$t,useDeferredValue:$t,useTransition:$t,useMutableSource:$t,useSyncExternalStore:$t,useId:$t,unstable_isNewReconciler:!1},ES={readContext:Dn,useCallback:function(i,o){return Ir().memoizedState=[i,o===void 0?null:o],i},useContext:Dn,useEffect:dv,useImperativeHandle:function(i,o,u){return u=u!=null?u.concat([i]):null,Gc(4194308,4,pv.bind(null,o,i),u)},useLayoutEffect:function(i,o){return Gc(4194308,4,i,o)},useInsertionEffect:function(i,o){return Gc(4,2,i,o)},useMemo:function(i,o){var u=Ir();return o=o===void 0?null:o,i=i(),u.memoizedState=[i,o],i},useReducer:function(i,o,u){var h=Ir();return o=u!==void 0?u(o):o,h.memoizedState=h.baseState=o,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:o},h.queue=i,i=i.dispatch=_S.bind(null,ot,i),[h.memoizedState,i]},useRef:function(i){var o=Ir();return i={current:i},o.memoizedState=i},useState:uv,useDebugValue:Zf,useDeferredValue:function(i){return Ir().memoizedState=i},useTransition:function(){var i=uv(!1),o=i[0];return i=vS.bind(null,i[1]),Ir().memoizedState=i,[o,i]},useMutableSource:function(){},useSyncExternalStore:function(i,o,u){var h=ot,p=Ir();if(tt){if(u===void 0)throw Error(t(407));u=u()}else{if(u=o(),Dt===null)throw Error(t(349));(Vs&30)!==0||iv(h,o,u)}p.memoizedState=u;var y={value:u,getSnapshot:o};return p.queue=y,dv(ov.bind(null,h,y,i),[i]),h.flags|=2048,Hl(9,sv.bind(null,h,y,u,o),void 0,null),u},useId:function(){var i=Ir(),o=Dt.identifierPrefix;if(tt){var u=Yr,h=Xr;u=(h&~(1<<32-Yt(h)-1)).toString(32)+u,o=":"+o+"R"+u,u=$l++,0<u&&(o+="H"+u.toString(32)),o+=":"}else u=yS++,o=":"+o+"r"+u.toString(32)+":";return i.memoizedState=o},unstable_isNewReconciler:!1},IS={readContext:Dn,useCallback:gv,useContext:Dn,useEffect:Jf,useImperativeHandle:mv,useInsertionEffect:hv,useLayoutEffect:fv,useMemo:yv,useReducer:Xf,useRef:cv,useState:function(){return Xf(ql)},useDebugValue:Zf,useDeferredValue:function(i){var o=Vn();return vv(o,St.memoizedState,i)},useTransition:function(){var i=Xf(ql)[0],o=Vn().memoizedState;return[i,o]},useMutableSource:nv,useSyncExternalStore:rv,useId:_v,unstable_isNewReconciler:!1},xS={readContext:Dn,useCallback:gv,useContext:Dn,useEffect:Jf,useImperativeHandle:mv,useInsertionEffect:hv,useLayoutEffect:fv,useMemo:yv,useReducer:Yf,useRef:cv,useState:function(){return Yf(ql)},useDebugValue:Zf,useDeferredValue:function(i){var o=Vn();return St===null?o.memoizedState=i:vv(o,St.memoizedState,i)},useTransition:function(){var i=Yf(ql)[0],o=Vn().memoizedState;return[i,o]},useMutableSource:nv,useSyncExternalStore:rv,useId:_v,unstable_isNewReconciler:!1};function tr(i,o){if(i&&i.defaultProps){o=ce({},o),i=i.defaultProps;for(var u in i)o[u]===void 0&&(o[u]=i[u]);return o}return o}function ep(i,o,u,h){o=i.memoizedState,u=u(h,o),u=u==null?o:ce({},o,u),i.memoizedState=u,i.lanes===0&&(i.updateQueue.baseState=u)}var Xc={isMounted:function(i){return(i=i._reactInternals)?Wn(i)===i:!1},enqueueSetState:function(i,o,u){i=i._reactInternals;var h=en(),p=Mi(i),y=Zr(h,p);y.payload=o,u!=null&&(y.callback=u),o=Di(i,y,p),o!==null&&(ir(o,i,p,h),zc(o,i,p))},enqueueReplaceState:function(i,o,u){i=i._reactInternals;var h=en(),p=Mi(i),y=Zr(h,p);y.tag=1,y.payload=o,u!=null&&(y.callback=u),o=Di(i,y,p),o!==null&&(ir(o,i,p,h),zc(o,i,p))},enqueueForceUpdate:function(i,o){i=i._reactInternals;var u=en(),h=Mi(i),p=Zr(u,h);p.tag=2,o!=null&&(p.callback=o),o=Di(i,p,h),o!==null&&(ir(o,i,h,u),zc(o,i,h))}};function xv(i,o,u,h,p,y,I){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(h,y,I):o.prototype&&o.prototype.isPureReactComponent?!Pl(u,h)||!Pl(p,y):!0}function Tv(i,o,u){var h=!1,p=Ci,y=o.contextType;return typeof y=="object"&&y!==null?y=Dn(y):(p=ln(o)?Rs:zt.current,h=o.contextTypes,y=(h=h!=null)?ea(i,p):Ci),o=new o(u,y),i.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=Xc,i.stateNode=o,o._reactInternals=i,h&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=p,i.__reactInternalMemoizedMaskedChildContext=y),o}function Sv(i,o,u,h){i=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(u,h),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(u,h),o.state!==i&&Xc.enqueueReplaceState(o,o.state,null)}function tp(i,o,u,h){var p=i.stateNode;p.props=u,p.state=i.memoizedState,p.refs={},Bf(i);var y=o.contextType;typeof y=="object"&&y!==null?p.context=Dn(y):(y=ln(o)?Rs:zt.current,p.context=ea(i,y)),p.state=i.memoizedState,y=o.getDerivedStateFromProps,typeof y=="function"&&(ep(i,o,y,u),p.state=i.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof p.getSnapshotBeforeUpdate=="function"||typeof p.UNSAFE_componentWillMount!="function"&&typeof p.componentWillMount!="function"||(o=p.state,typeof p.componentWillMount=="function"&&p.componentWillMount(),typeof p.UNSAFE_componentWillMount=="function"&&p.UNSAFE_componentWillMount(),o!==p.state&&Xc.enqueueReplaceState(p,p.state,null),$c(i,u,p,h),p.state=i.memoizedState),typeof p.componentDidMount=="function"&&(i.flags|=4194308)}function la(i,o){try{var u="",h=o;do u+=Re(h),h=h.return;while(h);var p=u}catch(y){p=`
Error generating stack: `+y.message+`
`+y.stack}return{value:i,source:o,stack:p,digest:null}}function np(i,o,u){return{value:i,source:null,stack:u??null,digest:o??null}}function rp(i,o){try{console.error(o.value)}catch(u){setTimeout(function(){throw u})}}var TS=typeof WeakMap=="function"?WeakMap:Map;function kv(i,o,u){u=Zr(-1,u),u.tag=3,u.payload={element:null};var h=o.value;return u.callback=function(){rd||(rd=!0,vp=h),rp(i,o)},u}function bv(i,o,u){u=Zr(-1,u),u.tag=3;var h=i.type.getDerivedStateFromError;if(typeof h=="function"){var p=o.value;u.payload=function(){return h(p)},u.callback=function(){rp(i,o)}}var y=i.stateNode;return y!==null&&typeof y.componentDidCatch=="function"&&(u.callback=function(){rp(i,o),typeof h!="function"&&(Oi===null?Oi=new Set([this]):Oi.add(this));var I=o.stack;this.componentDidCatch(o.value,{componentStack:I!==null?I:""})}),u}function Av(i,o,u){var h=i.pingCache;if(h===null){h=i.pingCache=new TS;var p=new Set;h.set(o,p)}else p=h.get(o),p===void 0&&(p=new Set,h.set(o,p));p.has(u)||(p.add(u),i=jS.bind(null,i,o,u),o.then(i,i))}function Rv(i){do{var o;if((o=i.tag===13)&&(o=i.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return i;i=i.return}while(i!==null);return null}function Cv(i,o,u,h,p){return(i.mode&1)===0?(i===o?i.flags|=65536:(i.flags|=128,u.flags|=131072,u.flags&=-52805,u.tag===1&&(u.alternate===null?u.tag=17:(o=Zr(-1,1),o.tag=2,Di(u,o,1))),u.lanes|=1),i):(i.flags|=65536,i.lanes=p,i)}var SS=re.ReactCurrentOwner,un=!1;function Zt(i,o,u,h){o.child=i===null?Xy(o,null,u,h):ia(o,i.child,u,h)}function Pv(i,o,u,h,p){u=u.render;var y=o.ref;return oa(o,p),h=Kf(i,o,u,h,y,p),u=Qf(),i!==null&&!un?(o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~p,ei(i,o,p)):(tt&&u&&Pf(o),o.flags|=1,Zt(i,o,h,p),o.child)}function Nv(i,o,u,h,p){if(i===null){var y=u.type;return typeof y=="function"&&!Sp(y)&&y.defaultProps===void 0&&u.compare===null&&u.defaultProps===void 0?(o.tag=15,o.type=y,Dv(i,o,y,h,p)):(i=ud(u.type,null,h,o,o.mode,p),i.ref=o.ref,i.return=o,o.child=i)}if(y=i.child,(i.lanes&p)===0){var I=y.memoizedProps;if(u=u.compare,u=u!==null?u:Pl,u(I,h)&&i.ref===o.ref)return ei(i,o,p)}return o.flags|=1,i=Fi(y,h),i.ref=o.ref,i.return=o,o.child=i}function Dv(i,o,u,h,p){if(i!==null){var y=i.memoizedProps;if(Pl(y,h)&&i.ref===o.ref)if(un=!1,o.pendingProps=h=y,(i.lanes&p)!==0)(i.flags&131072)!==0&&(un=!0);else return o.lanes=i.lanes,ei(i,o,p)}return ip(i,o,u,h,p)}function Vv(i,o,u){var h=o.pendingProps,p=h.children,y=i!==null?i.memoizedState:null;if(h.mode==="hidden")if((o.mode&1)===0)o.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ye(ca,En),En|=u;else{if((u&1073741824)===0)return i=y!==null?y.baseLanes|u:u,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:i,cachePool:null,transitions:null},o.updateQueue=null,Ye(ca,En),En|=i,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},h=y!==null?y.baseLanes:u,Ye(ca,En),En|=h}else y!==null?(h=y.baseLanes|u,o.memoizedState=null):h=u,Ye(ca,En),En|=h;return Zt(i,o,p,u),o.child}function Ov(i,o){var u=o.ref;(i===null&&u!==null||i!==null&&i.ref!==u)&&(o.flags|=512,o.flags|=2097152)}function ip(i,o,u,h,p){var y=ln(u)?Rs:zt.current;return y=ea(o,y),oa(o,p),u=Kf(i,o,u,h,y,p),h=Qf(),i!==null&&!un?(o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~p,ei(i,o,p)):(tt&&h&&Pf(o),o.flags|=1,Zt(i,o,u,p),o.child)}function Lv(i,o,u,h,p){if(ln(u)){var y=!0;Vc(o)}else y=!1;if(oa(o,p),o.stateNode===null)Jc(i,o),Tv(o,u,h),tp(o,u,h,p),h=!0;else if(i===null){var I=o.stateNode,b=o.memoizedProps;I.props=b;var N=I.context,W=u.contextType;typeof W=="object"&&W!==null?W=Dn(W):(W=ln(u)?Rs:zt.current,W=ea(o,W));var Z=u.getDerivedStateFromProps,ee=typeof Z=="function"||typeof I.getSnapshotBeforeUpdate=="function";ee||typeof I.UNSAFE_componentWillReceiveProps!="function"&&typeof I.componentWillReceiveProps!="function"||(b!==h||N!==W)&&Sv(o,I,h,W),Ni=!1;var J=o.memoizedState;I.state=J,$c(o,h,I,p),N=o.memoizedState,b!==h||J!==N||an.current||Ni?(typeof Z=="function"&&(ep(o,u,Z,h),N=o.memoizedState),(b=Ni||xv(o,u,b,h,J,N,W))?(ee||typeof I.UNSAFE_componentWillMount!="function"&&typeof I.componentWillMount!="function"||(typeof I.componentWillMount=="function"&&I.componentWillMount(),typeof I.UNSAFE_componentWillMount=="function"&&I.UNSAFE_componentWillMount()),typeof I.componentDidMount=="function"&&(o.flags|=4194308)):(typeof I.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=h,o.memoizedState=N),I.props=h,I.state=N,I.context=W,h=b):(typeof I.componentDidMount=="function"&&(o.flags|=4194308),h=!1)}else{I=o.stateNode,Jy(i,o),b=o.memoizedProps,W=o.type===o.elementType?b:tr(o.type,b),I.props=W,ee=o.pendingProps,J=I.context,N=u.contextType,typeof N=="object"&&N!==null?N=Dn(N):(N=ln(u)?Rs:zt.current,N=ea(o,N));var ue=u.getDerivedStateFromProps;(Z=typeof ue=="function"||typeof I.getSnapshotBeforeUpdate=="function")||typeof I.UNSAFE_componentWillReceiveProps!="function"&&typeof I.componentWillReceiveProps!="function"||(b!==ee||J!==N)&&Sv(o,I,h,N),Ni=!1,J=o.memoizedState,I.state=J,$c(o,h,I,p);var fe=o.memoizedState;b!==ee||J!==fe||an.current||Ni?(typeof ue=="function"&&(ep(o,u,ue,h),fe=o.memoizedState),(W=Ni||xv(o,u,W,h,J,fe,N)||!1)?(Z||typeof I.UNSAFE_componentWillUpdate!="function"&&typeof I.componentWillUpdate!="function"||(typeof I.componentWillUpdate=="function"&&I.componentWillUpdate(h,fe,N),typeof I.UNSAFE_componentWillUpdate=="function"&&I.UNSAFE_componentWillUpdate(h,fe,N)),typeof I.componentDidUpdate=="function"&&(o.flags|=4),typeof I.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof I.componentDidUpdate!="function"||b===i.memoizedProps&&J===i.memoizedState||(o.flags|=4),typeof I.getSnapshotBeforeUpdate!="function"||b===i.memoizedProps&&J===i.memoizedState||(o.flags|=1024),o.memoizedProps=h,o.memoizedState=fe),I.props=h,I.state=fe,I.context=N,h=W):(typeof I.componentDidUpdate!="function"||b===i.memoizedProps&&J===i.memoizedState||(o.flags|=4),typeof I.getSnapshotBeforeUpdate!="function"||b===i.memoizedProps&&J===i.memoizedState||(o.flags|=1024),h=!1)}return sp(i,o,u,h,y,p)}function sp(i,o,u,h,p,y){Ov(i,o);var I=(o.flags&128)!==0;if(!h&&!I)return p&&By(o,u,!1),ei(i,o,y);h=o.stateNode,SS.current=o;var b=I&&typeof u.getDerivedStateFromError!="function"?null:h.render();return o.flags|=1,i!==null&&I?(o.child=ia(o,i.child,null,y),o.child=ia(o,null,b,y)):Zt(i,o,b,y),o.memoizedState=h.state,p&&By(o,u,!0),o.child}function Mv(i){var o=i.stateNode;o.pendingContext?Fy(i,o.pendingContext,o.pendingContext!==o.context):o.context&&Fy(i,o.context,!1),zf(i,o.containerInfo)}function jv(i,o,u,h,p){return ra(),Of(p),o.flags|=256,Zt(i,o,u,h),o.child}var op={dehydrated:null,treeContext:null,retryLane:0};function ap(i){return{baseLanes:i,cachePool:null,transitions:null}}function Fv(i,o,u){var h=o.pendingProps,p=st.current,y=!1,I=(o.flags&128)!==0,b;if((b=I)||(b=i!==null&&i.memoizedState===null?!1:(p&2)!==0),b?(y=!0,o.flags&=-129):(i===null||i.memoizedState!==null)&&(p|=1),Ye(st,p&1),i===null)return Vf(o),i=o.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?((o.mode&1)===0?o.lanes=1:i.data==="$!"?o.lanes=8:o.lanes=1073741824,null):(I=h.children,i=h.fallback,y?(h=o.mode,y=o.child,I={mode:"hidden",children:I},(h&1)===0&&y!==null?(y.childLanes=0,y.pendingProps=I):y=cd(I,h,0,null),i=Fs(i,h,u,null),y.return=o,i.return=o,y.sibling=i,o.child=y,o.child.memoizedState=ap(u),o.memoizedState=op,i):lp(o,I));if(p=i.memoizedState,p!==null&&(b=p.dehydrated,b!==null))return kS(i,o,I,h,b,p,u);if(y){y=h.fallback,I=o.mode,p=i.child,b=p.sibling;var N={mode:"hidden",children:h.children};return(I&1)===0&&o.child!==p?(h=o.child,h.childLanes=0,h.pendingProps=N,o.deletions=null):(h=Fi(p,N),h.subtreeFlags=p.subtreeFlags&14680064),b!==null?y=Fi(b,y):(y=Fs(y,I,u,null),y.flags|=2),y.return=o,h.return=o,h.sibling=y,o.child=h,h=y,y=o.child,I=i.child.memoizedState,I=I===null?ap(u):{baseLanes:I.baseLanes|u,cachePool:null,transitions:I.transitions},y.memoizedState=I,y.childLanes=i.childLanes&~u,o.memoizedState=op,h}return y=i.child,i=y.sibling,h=Fi(y,{mode:"visible",children:h.children}),(o.mode&1)===0&&(h.lanes=u),h.return=o,h.sibling=null,i!==null&&(u=o.deletions,u===null?(o.deletions=[i],o.flags|=16):u.push(i)),o.child=h,o.memoizedState=null,h}function lp(i,o){return o=cd({mode:"visible",children:o},i.mode,0,null),o.return=i,i.child=o}function Yc(i,o,u,h){return h!==null&&Of(h),ia(o,i.child,null,u),i=lp(o,o.pendingProps.children),i.flags|=2,o.memoizedState=null,i}function kS(i,o,u,h,p,y,I){if(u)return o.flags&256?(o.flags&=-257,h=np(Error(t(422))),Yc(i,o,I,h)):o.memoizedState!==null?(o.child=i.child,o.flags|=128,null):(y=h.fallback,p=o.mode,h=cd({mode:"visible",children:h.children},p,0,null),y=Fs(y,p,I,null),y.flags|=2,h.return=o,y.return=o,h.sibling=y,o.child=h,(o.mode&1)!==0&&ia(o,i.child,null,I),o.child.memoizedState=ap(I),o.memoizedState=op,y);if((o.mode&1)===0)return Yc(i,o,I,null);if(p.data==="$!"){if(h=p.nextSibling&&p.nextSibling.dataset,h)var b=h.dgst;return h=b,y=Error(t(419)),h=np(y,h,void 0),Yc(i,o,I,h)}if(b=(I&i.childLanes)!==0,un||b){if(h=Dt,h!==null){switch(I&-I){case 4:p=2;break;case 16:p=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:p=32;break;case 536870912:p=268435456;break;default:p=0}p=(p&(h.suspendedLanes|I))!==0?0:p,p!==0&&p!==y.retryLane&&(y.retryLane=p,Jr(i,p),ir(h,i,p,-1))}return Tp(),h=np(Error(t(421))),Yc(i,o,I,h)}return p.data==="$?"?(o.flags|=128,o.child=i.child,o=FS.bind(null,i),p._reactRetry=o,null):(i=y.treeContext,wn=Ai(p.nextSibling),_n=o,tt=!0,er=null,i!==null&&(Pn[Nn++]=Xr,Pn[Nn++]=Yr,Pn[Nn++]=Cs,Xr=i.id,Yr=i.overflow,Cs=o),o=lp(o,h.children),o.flags|=4096,o)}function Uv(i,o,u){i.lanes|=o;var h=i.alternate;h!==null&&(h.lanes|=o),Ff(i.return,o,u)}function up(i,o,u,h,p){var y=i.memoizedState;y===null?i.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:h,tail:u,tailMode:p}:(y.isBackwards=o,y.rendering=null,y.renderingStartTime=0,y.last=h,y.tail=u,y.tailMode=p)}function Bv(i,o,u){var h=o.pendingProps,p=h.revealOrder,y=h.tail;if(Zt(i,o,h.children,u),h=st.current,(h&2)!==0)h=h&1|2,o.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=o.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&Uv(i,u,o);else if(i.tag===19)Uv(i,u,o);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===o)break e;for(;i.sibling===null;){if(i.return===null||i.return===o)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}h&=1}if(Ye(st,h),(o.mode&1)===0)o.memoizedState=null;else switch(p){case"forwards":for(u=o.child,p=null;u!==null;)i=u.alternate,i!==null&&qc(i)===null&&(p=u),u=u.sibling;u=p,u===null?(p=o.child,o.child=null):(p=u.sibling,u.sibling=null),up(o,!1,p,u,y);break;case"backwards":for(u=null,p=o.child,o.child=null;p!==null;){if(i=p.alternate,i!==null&&qc(i)===null){o.child=p;break}i=p.sibling,p.sibling=u,u=p,p=i}up(o,!0,u,null,y);break;case"together":up(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function Jc(i,o){(o.mode&1)===0&&i!==null&&(i.alternate=null,o.alternate=null,o.flags|=2)}function ei(i,o,u){if(i!==null&&(o.dependencies=i.dependencies),Os|=o.lanes,(u&o.childLanes)===0)return null;if(i!==null&&o.child!==i.child)throw Error(t(153));if(o.child!==null){for(i=o.child,u=Fi(i,i.pendingProps),o.child=u,u.return=o;i.sibling!==null;)i=i.sibling,u=u.sibling=Fi(i,i.pendingProps),u.return=o;u.sibling=null}return o.child}function bS(i,o,u){switch(o.tag){case 3:Mv(o),ra();break;case 5:tv(o);break;case 1:ln(o.type)&&Vc(o);break;case 4:zf(o,o.stateNode.containerInfo);break;case 10:var h=o.type._context,p=o.memoizedProps.value;Ye(Uc,h._currentValue),h._currentValue=p;break;case 13:if(h=o.memoizedState,h!==null)return h.dehydrated!==null?(Ye(st,st.current&1),o.flags|=128,null):(u&o.child.childLanes)!==0?Fv(i,o,u):(Ye(st,st.current&1),i=ei(i,o,u),i!==null?i.sibling:null);Ye(st,st.current&1);break;case 19:if(h=(u&o.childLanes)!==0,(i.flags&128)!==0){if(h)return Bv(i,o,u);o.flags|=128}if(p=o.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),Ye(st,st.current),h)break;return null;case 22:case 23:return o.lanes=0,Vv(i,o,u)}return ei(i,o,u)}var zv,cp,$v,qv;zv=function(i,o){for(var u=o.child;u!==null;){if(u.tag===5||u.tag===6)i.appendChild(u.stateNode);else if(u.tag!==4&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===o)break;for(;u.sibling===null;){if(u.return===null||u.return===o)return;u=u.return}u.sibling.return=u.return,u=u.sibling}},cp=function(){},$v=function(i,o,u,h){var p=i.memoizedProps;if(p!==h){i=o.stateNode,Ds(Er.current);var y=null;switch(u){case"input":p=hs(i,p),h=hs(i,h),y=[];break;case"select":p=ce({},p,{value:void 0}),h=ce({},h,{value:void 0}),y=[];break;case"textarea":p=ol(i,p),h=ol(i,h),y=[];break;default:typeof p.onClick!="function"&&typeof h.onClick=="function"&&(i.onclick=Pc)}hl(u,h);var I;u=null;for(W in p)if(!h.hasOwnProperty(W)&&p.hasOwnProperty(W)&&p[W]!=null)if(W==="style"){var b=p[W];for(I in b)b.hasOwnProperty(I)&&(u||(u={}),u[I]="")}else W!=="dangerouslySetInnerHTML"&&W!=="children"&&W!=="suppressContentEditableWarning"&&W!=="suppressHydrationWarning"&&W!=="autoFocus"&&(s.hasOwnProperty(W)?y||(y=[]):(y=y||[]).push(W,null));for(W in h){var N=h[W];if(b=p!=null?p[W]:void 0,h.hasOwnProperty(W)&&N!==b&&(N!=null||b!=null))if(W==="style")if(b){for(I in b)!b.hasOwnProperty(I)||N&&N.hasOwnProperty(I)||(u||(u={}),u[I]="");for(I in N)N.hasOwnProperty(I)&&b[I]!==N[I]&&(u||(u={}),u[I]=N[I])}else u||(y||(y=[]),y.push(W,u)),u=N;else W==="dangerouslySetInnerHTML"?(N=N?N.__html:void 0,b=b?b.__html:void 0,N!=null&&b!==N&&(y=y||[]).push(W,N)):W==="children"?typeof N!="string"&&typeof N!="number"||(y=y||[]).push(W,""+N):W!=="suppressContentEditableWarning"&&W!=="suppressHydrationWarning"&&(s.hasOwnProperty(W)?(N!=null&&W==="onScroll"&&Je("scroll",i),y||b===N||(y=[])):(y=y||[]).push(W,N))}u&&(y=y||[]).push("style",u);var W=y;(o.updateQueue=W)&&(o.flags|=4)}},qv=function(i,o,u,h){u!==h&&(o.flags|=4)};function Wl(i,o){if(!tt)switch(i.tailMode){case"hidden":o=i.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?i.tail=null:u.sibling=null;break;case"collapsed":u=i.tail;for(var h=null;u!==null;)u.alternate!==null&&(h=u),u=u.sibling;h===null?o||i.tail===null?i.tail=null:i.tail.sibling=null:h.sibling=null}}function qt(i){var o=i.alternate!==null&&i.alternate.child===i.child,u=0,h=0;if(o)for(var p=i.child;p!==null;)u|=p.lanes|p.childLanes,h|=p.subtreeFlags&14680064,h|=p.flags&14680064,p.return=i,p=p.sibling;else for(p=i.child;p!==null;)u|=p.lanes|p.childLanes,h|=p.subtreeFlags,h|=p.flags,p.return=i,p=p.sibling;return i.subtreeFlags|=h,i.childLanes=u,o}function AS(i,o,u){var h=o.pendingProps;switch(Nf(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qt(o),null;case 1:return ln(o.type)&&Dc(),qt(o),null;case 3:return h=o.stateNode,aa(),Ze(an),Ze(zt),Hf(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(i===null||i.child===null)&&(jc(o)?o.flags|=4:i===null||i.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,er!==null&&(Ep(er),er=null))),cp(i,o),qt(o),null;case 5:$f(o);var p=Ds(Bl.current);if(u=o.type,i!==null&&o.stateNode!=null)$v(i,o,u,h,p),i.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!h){if(o.stateNode===null)throw Error(t(166));return qt(o),null}if(i=Ds(Er.current),jc(o)){h=o.stateNode,u=o.type;var y=o.memoizedProps;switch(h[wr]=o,h[Ll]=y,i=(o.mode&1)!==0,u){case"dialog":Je("cancel",h),Je("close",h);break;case"iframe":case"object":case"embed":Je("load",h);break;case"video":case"audio":for(p=0;p<Dl.length;p++)Je(Dl[p],h);break;case"source":Je("error",h);break;case"img":case"image":case"link":Je("error",h),Je("load",h);break;case"details":Je("toggle",h);break;case"input":Io(h,y),Je("invalid",h);break;case"select":h._wrapperState={wasMultiple:!!y.multiple},Je("invalid",h);break;case"textarea":To(h,y),Je("invalid",h)}hl(u,y),p=null;for(var I in y)if(y.hasOwnProperty(I)){var b=y[I];I==="children"?typeof b=="string"?h.textContent!==b&&(y.suppressHydrationWarning!==!0&&Cc(h.textContent,b,i),p=["children",b]):typeof b=="number"&&h.textContent!==""+b&&(y.suppressHydrationWarning!==!0&&Cc(h.textContent,b,i),p=["children",""+b]):s.hasOwnProperty(I)&&b!=null&&I==="onScroll"&&Je("scroll",h)}switch(u){case"input":jr(h),nc(h,y,!0);break;case"textarea":jr(h),al(h);break;case"select":case"option":break;default:typeof y.onClick=="function"&&(h.onclick=Pc)}h=p,o.updateQueue=h,h!==null&&(o.flags|=4)}else{I=p.nodeType===9?p:p.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=It(u)),i==="http://www.w3.org/1999/xhtml"?u==="script"?(i=I.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof h.is=="string"?i=I.createElement(u,{is:h.is}):(i=I.createElement(u),u==="select"&&(I=i,h.multiple?I.multiple=!0:h.size&&(I.size=h.size))):i=I.createElementNS(i,u),i[wr]=o,i[Ll]=h,zv(i,o,!1,!1),o.stateNode=i;e:{switch(I=fl(u,h),u){case"dialog":Je("cancel",i),Je("close",i),p=h;break;case"iframe":case"object":case"embed":Je("load",i),p=h;break;case"video":case"audio":for(p=0;p<Dl.length;p++)Je(Dl[p],i);p=h;break;case"source":Je("error",i),p=h;break;case"img":case"image":case"link":Je("error",i),Je("load",i),p=h;break;case"details":Je("toggle",i),p=h;break;case"input":Io(i,h),p=hs(i,h),Je("invalid",i);break;case"option":p=h;break;case"select":i._wrapperState={wasMultiple:!!h.multiple},p=ce({},h,{value:void 0}),Je("invalid",i);break;case"textarea":To(i,h),p=ol(i,h),Je("invalid",i);break;default:p=h}hl(u,p),b=p;for(y in b)if(b.hasOwnProperty(y)){var N=b[y];y==="style"?cl(i,N):y==="dangerouslySetInnerHTML"?(N=N?N.__html:void 0,N!=null&&ll(i,N)):y==="children"?typeof N=="string"?(u!=="textarea"||N!=="")&&yi(i,N):typeof N=="number"&&yi(i,""+N):y!=="suppressContentEditableWarning"&&y!=="suppressHydrationWarning"&&y!=="autoFocus"&&(s.hasOwnProperty(y)?N!=null&&y==="onScroll"&&Je("scroll",i):N!=null&&q(i,y,N,I))}switch(u){case"input":jr(i),nc(i,h,!1);break;case"textarea":jr(i),al(i);break;case"option":h.value!=null&&i.setAttribute("value",""+Be(h.value));break;case"select":i.multiple=!!h.multiple,y=h.value,y!=null?Ur(i,!!h.multiple,y,!1):h.defaultValue!=null&&Ur(i,!!h.multiple,h.defaultValue,!0);break;default:typeof p.onClick=="function"&&(i.onclick=Pc)}switch(u){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}}h&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return qt(o),null;case 6:if(i&&o.stateNode!=null)qv(i,o,i.memoizedProps,h);else{if(typeof h!="string"&&o.stateNode===null)throw Error(t(166));if(u=Ds(Bl.current),Ds(Er.current),jc(o)){if(h=o.stateNode,u=o.memoizedProps,h[wr]=o,(y=h.nodeValue!==u)&&(i=_n,i!==null))switch(i.tag){case 3:Cc(h.nodeValue,u,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&Cc(h.nodeValue,u,(i.mode&1)!==0)}y&&(o.flags|=4)}else h=(u.nodeType===9?u:u.ownerDocument).createTextNode(h),h[wr]=o,o.stateNode=h}return qt(o),null;case 13:if(Ze(st),h=o.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(tt&&wn!==null&&(o.mode&1)!==0&&(o.flags&128)===0)Gy(),ra(),o.flags|=98560,y=!1;else if(y=jc(o),h!==null&&h.dehydrated!==null){if(i===null){if(!y)throw Error(t(318));if(y=o.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(t(317));y[wr]=o}else ra(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;qt(o),y=!1}else er!==null&&(Ep(er),er=null),y=!0;if(!y)return o.flags&65536?o:null}return(o.flags&128)!==0?(o.lanes=u,o):(h=h!==null,h!==(i!==null&&i.memoizedState!==null)&&h&&(o.child.flags|=8192,(o.mode&1)!==0&&(i===null||(st.current&1)!==0?kt===0&&(kt=3):Tp())),o.updateQueue!==null&&(o.flags|=4),qt(o),null);case 4:return aa(),cp(i,o),i===null&&Vl(o.stateNode.containerInfo),qt(o),null;case 10:return jf(o.type._context),qt(o),null;case 17:return ln(o.type)&&Dc(),qt(o),null;case 19:if(Ze(st),y=o.memoizedState,y===null)return qt(o),null;if(h=(o.flags&128)!==0,I=y.rendering,I===null)if(h)Wl(y,!1);else{if(kt!==0||i!==null&&(i.flags&128)!==0)for(i=o.child;i!==null;){if(I=qc(i),I!==null){for(o.flags|=128,Wl(y,!1),h=I.updateQueue,h!==null&&(o.updateQueue=h,o.flags|=4),o.subtreeFlags=0,h=u,u=o.child;u!==null;)y=u,i=h,y.flags&=14680066,I=y.alternate,I===null?(y.childLanes=0,y.lanes=i,y.child=null,y.subtreeFlags=0,y.memoizedProps=null,y.memoizedState=null,y.updateQueue=null,y.dependencies=null,y.stateNode=null):(y.childLanes=I.childLanes,y.lanes=I.lanes,y.child=I.child,y.subtreeFlags=0,y.deletions=null,y.memoizedProps=I.memoizedProps,y.memoizedState=I.memoizedState,y.updateQueue=I.updateQueue,y.type=I.type,i=I.dependencies,y.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),u=u.sibling;return Ye(st,st.current&1|2),o.child}i=i.sibling}y.tail!==null&&Xe()>da&&(o.flags|=128,h=!0,Wl(y,!1),o.lanes=4194304)}else{if(!h)if(i=qc(I),i!==null){if(o.flags|=128,h=!0,u=i.updateQueue,u!==null&&(o.updateQueue=u,o.flags|=4),Wl(y,!0),y.tail===null&&y.tailMode==="hidden"&&!I.alternate&&!tt)return qt(o),null}else 2*Xe()-y.renderingStartTime>da&&u!==1073741824&&(o.flags|=128,h=!0,Wl(y,!1),o.lanes=4194304);y.isBackwards?(I.sibling=o.child,o.child=I):(u=y.last,u!==null?u.sibling=I:o.child=I,y.last=I)}return y.tail!==null?(o=y.tail,y.rendering=o,y.tail=o.sibling,y.renderingStartTime=Xe(),o.sibling=null,u=st.current,Ye(st,h?u&1|2:u&1),o):(qt(o),null);case 22:case 23:return xp(),h=o.memoizedState!==null,i!==null&&i.memoizedState!==null!==h&&(o.flags|=8192),h&&(o.mode&1)!==0?(En&1073741824)!==0&&(qt(o),o.subtreeFlags&6&&(o.flags|=8192)):qt(o),null;case 24:return null;case 25:return null}throw Error(t(156,o.tag))}function RS(i,o){switch(Nf(o),o.tag){case 1:return ln(o.type)&&Dc(),i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 3:return aa(),Ze(an),Ze(zt),Hf(),i=o.flags,(i&65536)!==0&&(i&128)===0?(o.flags=i&-65537|128,o):null;case 5:return $f(o),null;case 13:if(Ze(st),i=o.memoizedState,i!==null&&i.dehydrated!==null){if(o.alternate===null)throw Error(t(340));ra()}return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 19:return Ze(st),null;case 4:return aa(),null;case 10:return jf(o.type._context),null;case 22:case 23:return xp(),null;case 24:return null;default:return null}}var Zc=!1,Ht=!1,CS=typeof WeakSet=="function"?WeakSet:Set,he=null;function ua(i,o){var u=i.ref;if(u!==null)if(typeof u=="function")try{u(null)}catch(h){ut(i,o,h)}else u.current=null}function dp(i,o,u){try{u()}catch(h){ut(i,o,h)}}var Hv=!1;function PS(i,o){if(xf=Si,i=xy(),mf(i)){if("selectionStart"in i)var u={start:i.selectionStart,end:i.selectionEnd};else e:{u=(u=i.ownerDocument)&&u.defaultView||window;var h=u.getSelection&&u.getSelection();if(h&&h.rangeCount!==0){u=h.anchorNode;var p=h.anchorOffset,y=h.focusNode;h=h.focusOffset;try{u.nodeType,y.nodeType}catch{u=null;break e}var I=0,b=-1,N=-1,W=0,Z=0,ee=i,J=null;t:for(;;){for(var ue;ee!==u||p!==0&&ee.nodeType!==3||(b=I+p),ee!==y||h!==0&&ee.nodeType!==3||(N=I+h),ee.nodeType===3&&(I+=ee.nodeValue.length),(ue=ee.firstChild)!==null;)J=ee,ee=ue;for(;;){if(ee===i)break t;if(J===u&&++W===p&&(b=I),J===y&&++Z===h&&(N=I),(ue=ee.nextSibling)!==null)break;ee=J,J=ee.parentNode}ee=ue}u=b===-1||N===-1?null:{start:b,end:N}}else u=null}u=u||{start:0,end:0}}else u=null;for(Tf={focusedElem:i,selectionRange:u},Si=!1,he=o;he!==null;)if(o=he,i=o.child,(o.subtreeFlags&1028)!==0&&i!==null)i.return=o,he=i;else for(;he!==null;){o=he;try{var fe=o.alternate;if((o.flags&1024)!==0)switch(o.tag){case 0:case 11:case 15:break;case 1:if(fe!==null){var me=fe.memoizedProps,ft=fe.memoizedState,z=o.stateNode,V=z.getSnapshotBeforeUpdate(o.elementType===o.type?me:tr(o.type,me),ft);z.__reactInternalSnapshotBeforeUpdate=V}break;case 3:var H=o.stateNode.containerInfo;H.nodeType===1?H.textContent="":H.nodeType===9&&H.documentElement&&H.removeChild(H.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(ie){ut(o,o.return,ie)}if(i=o.sibling,i!==null){i.return=o.return,he=i;break}he=o.return}return fe=Hv,Hv=!1,fe}function Gl(i,o,u){var h=o.updateQueue;if(h=h!==null?h.lastEffect:null,h!==null){var p=h=h.next;do{if((p.tag&i)===i){var y=p.destroy;p.destroy=void 0,y!==void 0&&dp(o,u,y)}p=p.next}while(p!==h)}}function ed(i,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var u=o=o.next;do{if((u.tag&i)===i){var h=u.create;u.destroy=h()}u=u.next}while(u!==o)}}function hp(i){var o=i.ref;if(o!==null){var u=i.stateNode;switch(i.tag){case 5:i=u;break;default:i=u}typeof o=="function"?o(i):o.current=i}}function Wv(i){var o=i.alternate;o!==null&&(i.alternate=null,Wv(o)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(o=i.stateNode,o!==null&&(delete o[wr],delete o[Ll],delete o[Af],delete o[fS],delete o[pS])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function Gv(i){return i.tag===5||i.tag===3||i.tag===4}function Kv(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||Gv(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function fp(i,o,u){var h=i.tag;if(h===5||h===6)i=i.stateNode,o?u.nodeType===8?u.parentNode.insertBefore(i,o):u.insertBefore(i,o):(u.nodeType===8?(o=u.parentNode,o.insertBefore(i,u)):(o=u,o.appendChild(i)),u=u._reactRootContainer,u!=null||o.onclick!==null||(o.onclick=Pc));else if(h!==4&&(i=i.child,i!==null))for(fp(i,o,u),i=i.sibling;i!==null;)fp(i,o,u),i=i.sibling}function pp(i,o,u){var h=i.tag;if(h===5||h===6)i=i.stateNode,o?u.insertBefore(i,o):u.appendChild(i);else if(h!==4&&(i=i.child,i!==null))for(pp(i,o,u),i=i.sibling;i!==null;)pp(i,o,u),i=i.sibling}var jt=null,nr=!1;function Vi(i,o,u){for(u=u.child;u!==null;)Qv(i,o,u),u=u.sibling}function Qv(i,o,u){if(mn&&typeof mn.onCommitFiberUnmount=="function")try{mn.onCommitFiberUnmount(Es,u)}catch{}switch(u.tag){case 5:Ht||ua(u,o);case 6:var h=jt,p=nr;jt=null,Vi(i,o,u),jt=h,nr=p,jt!==null&&(nr?(i=jt,u=u.stateNode,i.nodeType===8?i.parentNode.removeChild(u):i.removeChild(u)):jt.removeChild(u.stateNode));break;case 18:jt!==null&&(nr?(i=jt,u=u.stateNode,i.nodeType===8?bf(i.parentNode,u):i.nodeType===1&&bf(i,u),Yn(i)):bf(jt,u.stateNode));break;case 4:h=jt,p=nr,jt=u.stateNode.containerInfo,nr=!0,Vi(i,o,u),jt=h,nr=p;break;case 0:case 11:case 14:case 15:if(!Ht&&(h=u.updateQueue,h!==null&&(h=h.lastEffect,h!==null))){p=h=h.next;do{var y=p,I=y.destroy;y=y.tag,I!==void 0&&((y&2)!==0||(y&4)!==0)&&dp(u,o,I),p=p.next}while(p!==h)}Vi(i,o,u);break;case 1:if(!Ht&&(ua(u,o),h=u.stateNode,typeof h.componentWillUnmount=="function"))try{h.props=u.memoizedProps,h.state=u.memoizedState,h.componentWillUnmount()}catch(b){ut(u,o,b)}Vi(i,o,u);break;case 21:Vi(i,o,u);break;case 22:u.mode&1?(Ht=(h=Ht)||u.memoizedState!==null,Vi(i,o,u),Ht=h):Vi(i,o,u);break;default:Vi(i,o,u)}}function Xv(i){var o=i.updateQueue;if(o!==null){i.updateQueue=null;var u=i.stateNode;u===null&&(u=i.stateNode=new CS),o.forEach(function(h){var p=US.bind(null,i,h);u.has(h)||(u.add(h),h.then(p,p))})}}function rr(i,o){var u=o.deletions;if(u!==null)for(var h=0;h<u.length;h++){var p=u[h];try{var y=i,I=o,b=I;e:for(;b!==null;){switch(b.tag){case 5:jt=b.stateNode,nr=!1;break e;case 3:jt=b.stateNode.containerInfo,nr=!0;break e;case 4:jt=b.stateNode.containerInfo,nr=!0;break e}b=b.return}if(jt===null)throw Error(t(160));Qv(y,I,p),jt=null,nr=!1;var N=p.alternate;N!==null&&(N.return=null),p.return=null}catch(W){ut(p,o,W)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)Yv(o,i),o=o.sibling}function Yv(i,o){var u=i.alternate,h=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(rr(o,i),xr(i),h&4){try{Gl(3,i,i.return),ed(3,i)}catch(me){ut(i,i.return,me)}try{Gl(5,i,i.return)}catch(me){ut(i,i.return,me)}}break;case 1:rr(o,i),xr(i),h&512&&u!==null&&ua(u,u.return);break;case 5:if(rr(o,i),xr(i),h&512&&u!==null&&ua(u,u.return),i.flags&32){var p=i.stateNode;try{yi(p,"")}catch(me){ut(i,i.return,me)}}if(h&4&&(p=i.stateNode,p!=null)){var y=i.memoizedProps,I=u!==null?u.memoizedProps:y,b=i.type,N=i.updateQueue;if(i.updateQueue=null,N!==null)try{b==="input"&&y.type==="radio"&&y.name!=null&&il(p,y),fl(b,I);var W=fl(b,y);for(I=0;I<N.length;I+=2){var Z=N[I],ee=N[I+1];Z==="style"?cl(p,ee):Z==="dangerouslySetInnerHTML"?ll(p,ee):Z==="children"?yi(p,ee):q(p,Z,ee,W)}switch(b){case"input":sl(p,y);break;case"textarea":So(p,y);break;case"select":var J=p._wrapperState.wasMultiple;p._wrapperState.wasMultiple=!!y.multiple;var ue=y.value;ue!=null?Ur(p,!!y.multiple,ue,!1):J!==!!y.multiple&&(y.defaultValue!=null?Ur(p,!!y.multiple,y.defaultValue,!0):Ur(p,!!y.multiple,y.multiple?[]:"",!1))}p[Ll]=y}catch(me){ut(i,i.return,me)}}break;case 6:if(rr(o,i),xr(i),h&4){if(i.stateNode===null)throw Error(t(162));p=i.stateNode,y=i.memoizedProps;try{p.nodeValue=y}catch(me){ut(i,i.return,me)}}break;case 3:if(rr(o,i),xr(i),h&4&&u!==null&&u.memoizedState.isDehydrated)try{Yn(o.containerInfo)}catch(me){ut(i,i.return,me)}break;case 4:rr(o,i),xr(i);break;case 13:rr(o,i),xr(i),p=i.child,p.flags&8192&&(y=p.memoizedState!==null,p.stateNode.isHidden=y,!y||p.alternate!==null&&p.alternate.memoizedState!==null||(yp=Xe())),h&4&&Xv(i);break;case 22:if(Z=u!==null&&u.memoizedState!==null,i.mode&1?(Ht=(W=Ht)||Z,rr(o,i),Ht=W):rr(o,i),xr(i),h&8192){if(W=i.memoizedState!==null,(i.stateNode.isHidden=W)&&!Z&&(i.mode&1)!==0)for(he=i,Z=i.child;Z!==null;){for(ee=he=Z;he!==null;){switch(J=he,ue=J.child,J.tag){case 0:case 11:case 14:case 15:Gl(4,J,J.return);break;case 1:ua(J,J.return);var fe=J.stateNode;if(typeof fe.componentWillUnmount=="function"){h=J,u=J.return;try{o=h,fe.props=o.memoizedProps,fe.state=o.memoizedState,fe.componentWillUnmount()}catch(me){ut(h,u,me)}}break;case 5:ua(J,J.return);break;case 22:if(J.memoizedState!==null){e_(ee);continue}}ue!==null?(ue.return=J,he=ue):e_(ee)}Z=Z.sibling}e:for(Z=null,ee=i;;){if(ee.tag===5){if(Z===null){Z=ee;try{p=ee.stateNode,W?(y=p.style,typeof y.setProperty=="function"?y.setProperty("display","none","important"):y.display="none"):(b=ee.stateNode,N=ee.memoizedProps.style,I=N!=null&&N.hasOwnProperty("display")?N.display:null,b.style.display=ul("display",I))}catch(me){ut(i,i.return,me)}}}else if(ee.tag===6){if(Z===null)try{ee.stateNode.nodeValue=W?"":ee.memoizedProps}catch(me){ut(i,i.return,me)}}else if((ee.tag!==22&&ee.tag!==23||ee.memoizedState===null||ee===i)&&ee.child!==null){ee.child.return=ee,ee=ee.child;continue}if(ee===i)break e;for(;ee.sibling===null;){if(ee.return===null||ee.return===i)break e;Z===ee&&(Z=null),ee=ee.return}Z===ee&&(Z=null),ee.sibling.return=ee.return,ee=ee.sibling}}break;case 19:rr(o,i),xr(i),h&4&&Xv(i);break;case 21:break;default:rr(o,i),xr(i)}}function xr(i){var o=i.flags;if(o&2){try{e:{for(var u=i.return;u!==null;){if(Gv(u)){var h=u;break e}u=u.return}throw Error(t(160))}switch(h.tag){case 5:var p=h.stateNode;h.flags&32&&(yi(p,""),h.flags&=-33);var y=Kv(i);pp(i,y,p);break;case 3:case 4:var I=h.stateNode.containerInfo,b=Kv(i);fp(i,b,I);break;default:throw Error(t(161))}}catch(N){ut(i,i.return,N)}i.flags&=-3}o&4096&&(i.flags&=-4097)}function NS(i,o,u){he=i,Jv(i)}function Jv(i,o,u){for(var h=(i.mode&1)!==0;he!==null;){var p=he,y=p.child;if(p.tag===22&&h){var I=p.memoizedState!==null||Zc;if(!I){var b=p.alternate,N=b!==null&&b.memoizedState!==null||Ht;b=Zc;var W=Ht;if(Zc=I,(Ht=N)&&!W)for(he=p;he!==null;)I=he,N=I.child,I.tag===22&&I.memoizedState!==null?t_(p):N!==null?(N.return=I,he=N):t_(p);for(;y!==null;)he=y,Jv(y),y=y.sibling;he=p,Zc=b,Ht=W}Zv(i)}else(p.subtreeFlags&8772)!==0&&y!==null?(y.return=p,he=y):Zv(i)}}function Zv(i){for(;he!==null;){var o=he;if((o.flags&8772)!==0){var u=o.alternate;try{if((o.flags&8772)!==0)switch(o.tag){case 0:case 11:case 15:Ht||ed(5,o);break;case 1:var h=o.stateNode;if(o.flags&4&&!Ht)if(u===null)h.componentDidMount();else{var p=o.elementType===o.type?u.memoizedProps:tr(o.type,u.memoizedProps);h.componentDidUpdate(p,u.memoizedState,h.__reactInternalSnapshotBeforeUpdate)}var y=o.updateQueue;y!==null&&ev(o,y,h);break;case 3:var I=o.updateQueue;if(I!==null){if(u=null,o.child!==null)switch(o.child.tag){case 5:u=o.child.stateNode;break;case 1:u=o.child.stateNode}ev(o,I,u)}break;case 5:var b=o.stateNode;if(u===null&&o.flags&4){u=b;var N=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":N.autoFocus&&u.focus();break;case"img":N.src&&(u.src=N.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var W=o.alternate;if(W!==null){var Z=W.memoizedState;if(Z!==null){var ee=Z.dehydrated;ee!==null&&Yn(ee)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Ht||o.flags&512&&hp(o)}catch(J){ut(o,o.return,J)}}if(o===i){he=null;break}if(u=o.sibling,u!==null){u.return=o.return,he=u;break}he=o.return}}function e_(i){for(;he!==null;){var o=he;if(o===i){he=null;break}var u=o.sibling;if(u!==null){u.return=o.return,he=u;break}he=o.return}}function t_(i){for(;he!==null;){var o=he;try{switch(o.tag){case 0:case 11:case 15:var u=o.return;try{ed(4,o)}catch(N){ut(o,u,N)}break;case 1:var h=o.stateNode;if(typeof h.componentDidMount=="function"){var p=o.return;try{h.componentDidMount()}catch(N){ut(o,p,N)}}var y=o.return;try{hp(o)}catch(N){ut(o,y,N)}break;case 5:var I=o.return;try{hp(o)}catch(N){ut(o,I,N)}}}catch(N){ut(o,o.return,N)}if(o===i){he=null;break}var b=o.sibling;if(b!==null){b.return=o.return,he=b;break}he=o.return}}var DS=Math.ceil,td=re.ReactCurrentDispatcher,mp=re.ReactCurrentOwner,On=re.ReactCurrentBatchConfig,je=0,Dt=null,gt=null,Ft=0,En=0,ca=Ri(0),kt=0,Kl=null,Os=0,nd=0,gp=0,Ql=null,cn=null,yp=0,da=1/0,ti=null,rd=!1,vp=null,Oi=null,id=!1,Li=null,sd=0,Xl=0,_p=null,od=-1,ad=0;function en(){return(je&6)!==0?Xe():od!==-1?od:od=Xe()}function Mi(i){return(i.mode&1)===0?1:(je&2)!==0&&Ft!==0?Ft&-Ft:gS.transition!==null?(ad===0&&(ad=xs()),ad):(i=Ve,i!==0||(i=window.event,i=i===void 0?16:Tl(i.type)),i)}function ir(i,o,u,h){if(50<Xl)throw Xl=0,_p=null,Error(t(185));Ei(i,u,h),((je&2)===0||i!==Dt)&&(i===Dt&&((je&2)===0&&(nd|=u),kt===4&&ji(i,Ft)),dn(i,h),u===1&&je===0&&(o.mode&1)===0&&(da=Xe()+500,Oc&&Pi()))}function dn(i,o){var u=i.callbackNode;$r(i,o);var h=Is(i,i===Dt?Ft:0);if(h===0)u!==null&&_l(u),i.callbackNode=null,i.callbackPriority=0;else if(o=h&-h,i.callbackPriority!==o){if(u!=null&&_l(u),o===1)i.tag===0?mS(r_.bind(null,i)):zy(r_.bind(null,i)),dS(function(){(je&6)===0&&Pi()}),u=null;else{switch(xi(h)){case 1:u=ws;break;case 4:u=vi;break;case 16:u=An;break;case 536870912:u=ac;break;default:u=An}u=d_(u,n_.bind(null,i))}i.callbackPriority=o,i.callbackNode=u}}function n_(i,o){if(od=-1,ad=0,(je&6)!==0)throw Error(t(327));var u=i.callbackNode;if(ha()&&i.callbackNode!==u)return null;var h=Is(i,i===Dt?Ft:0);if(h===0)return null;if((h&30)!==0||(h&i.expiredLanes)!==0||o)o=ld(i,h);else{o=h;var p=je;je|=2;var y=s_();(Dt!==i||Ft!==o)&&(ti=null,da=Xe()+500,Ms(i,o));do try{LS();break}catch(b){i_(i,b)}while(!0);Mf(),td.current=y,je=p,gt!==null?o=0:(Dt=null,Ft=0,o=kt)}if(o!==0){if(o===2&&(p=gn(i),p!==0&&(h=p,o=wp(i,p))),o===1)throw u=Kl,Ms(i,0),ji(i,h),dn(i,Xe()),u;if(o===6)ji(i,h);else{if(p=i.current.alternate,(h&30)===0&&!VS(p)&&(o=ld(i,h),o===2&&(y=gn(i),y!==0&&(h=y,o=wp(i,y))),o===1))throw u=Kl,Ms(i,0),ji(i,h),dn(i,Xe()),u;switch(i.finishedWork=p,i.finishedLanes=h,o){case 0:case 1:throw Error(t(345));case 2:js(i,cn,ti);break;case 3:if(ji(i,h),(h&130023424)===h&&(o=yp+500-Xe(),10<o)){if(Is(i,0)!==0)break;if(p=i.suspendedLanes,(p&h)!==h){en(),i.pingedLanes|=i.suspendedLanes&p;break}i.timeoutHandle=kf(js.bind(null,i,cn,ti),o);break}js(i,cn,ti);break;case 4:if(ji(i,h),(h&4194240)===h)break;for(o=i.eventTimes,p=-1;0<h;){var I=31-Yt(h);y=1<<I,I=o[I],I>p&&(p=I),h&=~y}if(h=p,h=Xe()-h,h=(120>h?120:480>h?480:1080>h?1080:1920>h?1920:3e3>h?3e3:4320>h?4320:1960*DS(h/1960))-h,10<h){i.timeoutHandle=kf(js.bind(null,i,cn,ti),h);break}js(i,cn,ti);break;case 5:js(i,cn,ti);break;default:throw Error(t(329))}}}return dn(i,Xe()),i.callbackNode===u?n_.bind(null,i):null}function wp(i,o){var u=Ql;return i.current.memoizedState.isDehydrated&&(Ms(i,o).flags|=256),i=ld(i,o),i!==2&&(o=cn,cn=u,o!==null&&Ep(o)),i}function Ep(i){cn===null?cn=i:cn.push.apply(cn,i)}function VS(i){for(var o=i;;){if(o.flags&16384){var u=o.updateQueue;if(u!==null&&(u=u.stores,u!==null))for(var h=0;h<u.length;h++){var p=u[h],y=p.getSnapshot;p=p.value;try{if(!Zn(y(),p))return!1}catch{return!1}}}if(u=o.child,o.subtreeFlags&16384&&u!==null)u.return=o,o=u;else{if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function ji(i,o){for(o&=~gp,o&=~nd,i.suspendedLanes|=o,i.pingedLanes&=~o,i=i.expirationTimes;0<o;){var u=31-Yt(o),h=1<<u;i[u]=-1,o&=~h}}function r_(i){if((je&6)!==0)throw Error(t(327));ha();var o=Is(i,0);if((o&1)===0)return dn(i,Xe()),null;var u=ld(i,o);if(i.tag!==0&&u===2){var h=gn(i);h!==0&&(o=h,u=wp(i,h))}if(u===1)throw u=Kl,Ms(i,0),ji(i,o),dn(i,Xe()),u;if(u===6)throw Error(t(345));return i.finishedWork=i.current.alternate,i.finishedLanes=o,js(i,cn,ti),dn(i,Xe()),null}function Ip(i,o){var u=je;je|=1;try{return i(o)}finally{je=u,je===0&&(da=Xe()+500,Oc&&Pi())}}function Ls(i){Li!==null&&Li.tag===0&&(je&6)===0&&ha();var o=je;je|=1;var u=On.transition,h=Ve;try{if(On.transition=null,Ve=1,i)return i()}finally{Ve=h,On.transition=u,je=o,(je&6)===0&&Pi()}}function xp(){En=ca.current,Ze(ca)}function Ms(i,o){i.finishedWork=null,i.finishedLanes=0;var u=i.timeoutHandle;if(u!==-1&&(i.timeoutHandle=-1,cS(u)),gt!==null)for(u=gt.return;u!==null;){var h=u;switch(Nf(h),h.tag){case 1:h=h.type.childContextTypes,h!=null&&Dc();break;case 3:aa(),Ze(an),Ze(zt),Hf();break;case 5:$f(h);break;case 4:aa();break;case 13:Ze(st);break;case 19:Ze(st);break;case 10:jf(h.type._context);break;case 22:case 23:xp()}u=u.return}if(Dt=i,gt=i=Fi(i.current,null),Ft=En=o,kt=0,Kl=null,gp=nd=Os=0,cn=Ql=null,Ns!==null){for(o=0;o<Ns.length;o++)if(u=Ns[o],h=u.interleaved,h!==null){u.interleaved=null;var p=h.next,y=u.pending;if(y!==null){var I=y.next;y.next=p,h.next=I}u.pending=h}Ns=null}return i}function i_(i,o){do{var u=gt;try{if(Mf(),Hc.current=Qc,Wc){for(var h=ot.memoizedState;h!==null;){var p=h.queue;p!==null&&(p.pending=null),h=h.next}Wc=!1}if(Vs=0,Nt=St=ot=null,zl=!1,$l=0,mp.current=null,u===null||u.return===null){kt=1,Kl=o,gt=null;break}e:{var y=i,I=u.return,b=u,N=o;if(o=Ft,b.flags|=32768,N!==null&&typeof N=="object"&&typeof N.then=="function"){var W=N,Z=b,ee=Z.tag;if((Z.mode&1)===0&&(ee===0||ee===11||ee===15)){var J=Z.alternate;J?(Z.updateQueue=J.updateQueue,Z.memoizedState=J.memoizedState,Z.lanes=J.lanes):(Z.updateQueue=null,Z.memoizedState=null)}var ue=Rv(I);if(ue!==null){ue.flags&=-257,Cv(ue,I,b,y,o),ue.mode&1&&Av(y,W,o),o=ue,N=W;var fe=o.updateQueue;if(fe===null){var me=new Set;me.add(N),o.updateQueue=me}else fe.add(N);break e}else{if((o&1)===0){Av(y,W,o),Tp();break e}N=Error(t(426))}}else if(tt&&b.mode&1){var ft=Rv(I);if(ft!==null){(ft.flags&65536)===0&&(ft.flags|=256),Cv(ft,I,b,y,o),Of(la(N,b));break e}}y=N=la(N,b),kt!==4&&(kt=2),Ql===null?Ql=[y]:Ql.push(y),y=I;do{switch(y.tag){case 3:y.flags|=65536,o&=-o,y.lanes|=o;var z=kv(y,N,o);Zy(y,z);break e;case 1:b=N;var V=y.type,H=y.stateNode;if((y.flags&128)===0&&(typeof V.getDerivedStateFromError=="function"||H!==null&&typeof H.componentDidCatch=="function"&&(Oi===null||!Oi.has(H)))){y.flags|=65536,o&=-o,y.lanes|=o;var ie=bv(y,b,o);Zy(y,ie);break e}}y=y.return}while(y!==null)}a_(u)}catch(ge){o=ge,gt===u&&u!==null&&(gt=u=u.return);continue}break}while(!0)}function s_(){var i=td.current;return td.current=Qc,i===null?Qc:i}function Tp(){(kt===0||kt===3||kt===2)&&(kt=4),Dt===null||(Os&268435455)===0&&(nd&268435455)===0||ji(Dt,Ft)}function ld(i,o){var u=je;je|=2;var h=s_();(Dt!==i||Ft!==o)&&(ti=null,Ms(i,o));do try{OS();break}catch(p){i_(i,p)}while(!0);if(Mf(),je=u,td.current=h,gt!==null)throw Error(t(261));return Dt=null,Ft=0,kt}function OS(){for(;gt!==null;)o_(gt)}function LS(){for(;gt!==null&&!sc();)o_(gt)}function o_(i){var o=c_(i.alternate,i,En);i.memoizedProps=i.pendingProps,o===null?a_(i):gt=o,mp.current=null}function a_(i){var o=i;do{var u=o.alternate;if(i=o.return,(o.flags&32768)===0){if(u=AS(u,o,En),u!==null){gt=u;return}}else{if(u=RS(u,o),u!==null){u.flags&=32767,gt=u;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{kt=6,gt=null;return}}if(o=o.sibling,o!==null){gt=o;return}gt=o=i}while(o!==null);kt===0&&(kt=5)}function js(i,o,u){var h=Ve,p=On.transition;try{On.transition=null,Ve=1,MS(i,o,u,h)}finally{On.transition=p,Ve=h}return null}function MS(i,o,u,h){do ha();while(Li!==null);if((je&6)!==0)throw Error(t(327));u=i.finishedWork;var p=i.finishedLanes;if(u===null)return null;if(i.finishedWork=null,i.finishedLanes=0,u===i.current)throw Error(t(177));i.callbackNode=null,i.callbackPriority=0;var y=u.lanes|u.childLanes;if(Ke(i,y),i===Dt&&(gt=Dt=null,Ft=0),(u.subtreeFlags&2064)===0&&(u.flags&2064)===0||id||(id=!0,d_(An,function(){return ha(),null})),y=(u.flags&15990)!==0,(u.subtreeFlags&15990)!==0||y){y=On.transition,On.transition=null;var I=Ve;Ve=1;var b=je;je|=4,mp.current=null,PS(i,u),Yv(u,i),rS(Tf),Si=!!xf,Tf=xf=null,i.current=u,NS(u),af(),je=b,Ve=I,On.transition=y}else i.current=u;if(id&&(id=!1,Li=i,sd=p),y=i.pendingLanes,y===0&&(Oi=null),lc(u.stateNode),dn(i,Xe()),o!==null)for(h=i.onRecoverableError,u=0;u<o.length;u++)p=o[u],h(p.value,{componentStack:p.stack,digest:p.digest});if(rd)throw rd=!1,i=vp,vp=null,i;return(sd&1)!==0&&i.tag!==0&&ha(),y=i.pendingLanes,(y&1)!==0?i===_p?Xl++:(Xl=0,_p=i):Xl=0,Pi(),null}function ha(){if(Li!==null){var i=xi(sd),o=On.transition,u=Ve;try{if(On.transition=null,Ve=16>i?16:i,Li===null)var h=!1;else{if(i=Li,Li=null,sd=0,(je&6)!==0)throw Error(t(331));var p=je;for(je|=4,he=i.current;he!==null;){var y=he,I=y.child;if((he.flags&16)!==0){var b=y.deletions;if(b!==null){for(var N=0;N<b.length;N++){var W=b[N];for(he=W;he!==null;){var Z=he;switch(Z.tag){case 0:case 11:case 15:Gl(8,Z,y)}var ee=Z.child;if(ee!==null)ee.return=Z,he=ee;else for(;he!==null;){Z=he;var J=Z.sibling,ue=Z.return;if(Wv(Z),Z===W){he=null;break}if(J!==null){J.return=ue,he=J;break}he=ue}}}var fe=y.alternate;if(fe!==null){var me=fe.child;if(me!==null){fe.child=null;do{var ft=me.sibling;me.sibling=null,me=ft}while(me!==null)}}he=y}}if((y.subtreeFlags&2064)!==0&&I!==null)I.return=y,he=I;else e:for(;he!==null;){if(y=he,(y.flags&2048)!==0)switch(y.tag){case 0:case 11:case 15:Gl(9,y,y.return)}var z=y.sibling;if(z!==null){z.return=y.return,he=z;break e}he=y.return}}var V=i.current;for(he=V;he!==null;){I=he;var H=I.child;if((I.subtreeFlags&2064)!==0&&H!==null)H.return=I,he=H;else e:for(I=V;he!==null;){if(b=he,(b.flags&2048)!==0)try{switch(b.tag){case 0:case 11:case 15:ed(9,b)}}catch(ge){ut(b,b.return,ge)}if(b===I){he=null;break e}var ie=b.sibling;if(ie!==null){ie.return=b.return,he=ie;break e}he=b.return}}if(je=p,Pi(),mn&&typeof mn.onPostCommitFiberRoot=="function")try{mn.onPostCommitFiberRoot(Es,i)}catch{}h=!0}return h}finally{Ve=u,On.transition=o}}return!1}function l_(i,o,u){o=la(u,o),o=kv(i,o,1),i=Di(i,o,1),o=en(),i!==null&&(Ei(i,1,o),dn(i,o))}function ut(i,o,u){if(i.tag===3)l_(i,i,u);else for(;o!==null;){if(o.tag===3){l_(o,i,u);break}else if(o.tag===1){var h=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(Oi===null||!Oi.has(h))){i=la(u,i),i=bv(o,i,1),o=Di(o,i,1),i=en(),o!==null&&(Ei(o,1,i),dn(o,i));break}}o=o.return}}function jS(i,o,u){var h=i.pingCache;h!==null&&h.delete(o),o=en(),i.pingedLanes|=i.suspendedLanes&u,Dt===i&&(Ft&u)===u&&(kt===4||kt===3&&(Ft&130023424)===Ft&&500>Xe()-yp?Ms(i,0):gp|=u),dn(i,o)}function u_(i,o){o===0&&((i.mode&1)===0?o=1:(o=Oo,Oo<<=1,(Oo&130023424)===0&&(Oo=4194304)));var u=en();i=Jr(i,o),i!==null&&(Ei(i,o,u),dn(i,u))}function FS(i){var o=i.memoizedState,u=0;o!==null&&(u=o.retryLane),u_(i,u)}function US(i,o){var u=0;switch(i.tag){case 13:var h=i.stateNode,p=i.memoizedState;p!==null&&(u=p.retryLane);break;case 19:h=i.stateNode;break;default:throw Error(t(314))}h!==null&&h.delete(o),u_(i,u)}var c_;c_=function(i,o,u){if(i!==null)if(i.memoizedProps!==o.pendingProps||an.current)un=!0;else{if((i.lanes&u)===0&&(o.flags&128)===0)return un=!1,bS(i,o,u);un=(i.flags&131072)!==0}else un=!1,tt&&(o.flags&1048576)!==0&&$y(o,Mc,o.index);switch(o.lanes=0,o.tag){case 2:var h=o.type;Jc(i,o),i=o.pendingProps;var p=ea(o,zt.current);oa(o,u),p=Kf(null,o,h,i,p,u);var y=Qf();return o.flags|=1,typeof p=="object"&&p!==null&&typeof p.render=="function"&&p.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,ln(h)?(y=!0,Vc(o)):y=!1,o.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,Bf(o),p.updater=Xc,o.stateNode=p,p._reactInternals=o,tp(o,h,i,u),o=sp(null,o,h,!0,y,u)):(o.tag=0,tt&&y&&Pf(o),Zt(null,o,p,u),o=o.child),o;case 16:h=o.elementType;e:{switch(Jc(i,o),i=o.pendingProps,p=h._init,h=p(h._payload),o.type=h,p=o.tag=zS(h),i=tr(h,i),p){case 0:o=ip(null,o,h,i,u);break e;case 1:o=Lv(null,o,h,i,u);break e;case 11:o=Pv(null,o,h,i,u);break e;case 14:o=Nv(null,o,h,tr(h.type,i),u);break e}throw Error(t(306,h,""))}return o;case 0:return h=o.type,p=o.pendingProps,p=o.elementType===h?p:tr(h,p),ip(i,o,h,p,u);case 1:return h=o.type,p=o.pendingProps,p=o.elementType===h?p:tr(h,p),Lv(i,o,h,p,u);case 3:e:{if(Mv(o),i===null)throw Error(t(387));h=o.pendingProps,y=o.memoizedState,p=y.element,Jy(i,o),$c(o,h,null,u);var I=o.memoizedState;if(h=I.element,y.isDehydrated)if(y={element:h,isDehydrated:!1,cache:I.cache,pendingSuspenseBoundaries:I.pendingSuspenseBoundaries,transitions:I.transitions},o.updateQueue.baseState=y,o.memoizedState=y,o.flags&256){p=la(Error(t(423)),o),o=jv(i,o,h,u,p);break e}else if(h!==p){p=la(Error(t(424)),o),o=jv(i,o,h,u,p);break e}else for(wn=Ai(o.stateNode.containerInfo.firstChild),_n=o,tt=!0,er=null,u=Xy(o,null,h,u),o.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling;else{if(ra(),h===p){o=ei(i,o,u);break e}Zt(i,o,h,u)}o=o.child}return o;case 5:return tv(o),i===null&&Vf(o),h=o.type,p=o.pendingProps,y=i!==null?i.memoizedProps:null,I=p.children,Sf(h,p)?I=null:y!==null&&Sf(h,y)&&(o.flags|=32),Ov(i,o),Zt(i,o,I,u),o.child;case 6:return i===null&&Vf(o),null;case 13:return Fv(i,o,u);case 4:return zf(o,o.stateNode.containerInfo),h=o.pendingProps,i===null?o.child=ia(o,null,h,u):Zt(i,o,h,u),o.child;case 11:return h=o.type,p=o.pendingProps,p=o.elementType===h?p:tr(h,p),Pv(i,o,h,p,u);case 7:return Zt(i,o,o.pendingProps,u),o.child;case 8:return Zt(i,o,o.pendingProps.children,u),o.child;case 12:return Zt(i,o,o.pendingProps.children,u),o.child;case 10:e:{if(h=o.type._context,p=o.pendingProps,y=o.memoizedProps,I=p.value,Ye(Uc,h._currentValue),h._currentValue=I,y!==null)if(Zn(y.value,I)){if(y.children===p.children&&!an.current){o=ei(i,o,u);break e}}else for(y=o.child,y!==null&&(y.return=o);y!==null;){var b=y.dependencies;if(b!==null){I=y.child;for(var N=b.firstContext;N!==null;){if(N.context===h){if(y.tag===1){N=Zr(-1,u&-u),N.tag=2;var W=y.updateQueue;if(W!==null){W=W.shared;var Z=W.pending;Z===null?N.next=N:(N.next=Z.next,Z.next=N),W.pending=N}}y.lanes|=u,N=y.alternate,N!==null&&(N.lanes|=u),Ff(y.return,u,o),b.lanes|=u;break}N=N.next}}else if(y.tag===10)I=y.type===o.type?null:y.child;else if(y.tag===18){if(I=y.return,I===null)throw Error(t(341));I.lanes|=u,b=I.alternate,b!==null&&(b.lanes|=u),Ff(I,u,o),I=y.sibling}else I=y.child;if(I!==null)I.return=y;else for(I=y;I!==null;){if(I===o){I=null;break}if(y=I.sibling,y!==null){y.return=I.return,I=y;break}I=I.return}y=I}Zt(i,o,p.children,u),o=o.child}return o;case 9:return p=o.type,h=o.pendingProps.children,oa(o,u),p=Dn(p),h=h(p),o.flags|=1,Zt(i,o,h,u),o.child;case 14:return h=o.type,p=tr(h,o.pendingProps),p=tr(h.type,p),Nv(i,o,h,p,u);case 15:return Dv(i,o,o.type,o.pendingProps,u);case 17:return h=o.type,p=o.pendingProps,p=o.elementType===h?p:tr(h,p),Jc(i,o),o.tag=1,ln(h)?(i=!0,Vc(o)):i=!1,oa(o,u),Tv(o,h,p),tp(o,h,p,u),sp(null,o,h,!0,i,u);case 19:return Bv(i,o,u);case 22:return Vv(i,o,u)}throw Error(t(156,o.tag))};function d_(i,o){return Do(i,o)}function BS(i,o,u,h){this.tag=i,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ln(i,o,u,h){return new BS(i,o,u,h)}function Sp(i){return i=i.prototype,!(!i||!i.isReactComponent)}function zS(i){if(typeof i=="function")return Sp(i)?1:0;if(i!=null){if(i=i.$$typeof,i===M)return 11;if(i===pt)return 14}return 2}function Fi(i,o){var u=i.alternate;return u===null?(u=Ln(i.tag,o,i.key,i.mode),u.elementType=i.elementType,u.type=i.type,u.stateNode=i.stateNode,u.alternate=i,i.alternate=u):(u.pendingProps=o,u.type=i.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=i.flags&14680064,u.childLanes=i.childLanes,u.lanes=i.lanes,u.child=i.child,u.memoizedProps=i.memoizedProps,u.memoizedState=i.memoizedState,u.updateQueue=i.updateQueue,o=i.dependencies,u.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},u.sibling=i.sibling,u.index=i.index,u.ref=i.ref,u}function ud(i,o,u,h,p,y){var I=2;if(h=i,typeof i=="function")Sp(i)&&(I=1);else if(typeof i=="string")I=5;else e:switch(i){case P:return Fs(u.children,p,y,o);case k:I=8,p|=8;break;case R:return i=Ln(12,u,o,p|2),i.elementType=R,i.lanes=y,i;case C:return i=Ln(13,u,o,p),i.elementType=C,i.lanes=y,i;case Pe:return i=Ln(19,u,o,p),i.elementType=Pe,i.lanes=y,i;case Ge:return cd(u,p,y,o);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case A:I=10;break e;case L:I=9;break e;case M:I=11;break e;case pt:I=14;break e;case Rt:I=16,h=null;break e}throw Error(t(130,i==null?i:typeof i,""))}return o=Ln(I,u,o,p),o.elementType=i,o.type=h,o.lanes=y,o}function Fs(i,o,u,h){return i=Ln(7,i,h,o),i.lanes=u,i}function cd(i,o,u,h){return i=Ln(22,i,h,o),i.elementType=Ge,i.lanes=u,i.stateNode={isHidden:!1},i}function kp(i,o,u){return i=Ln(6,i,null,o),i.lanes=u,i}function bp(i,o,u){return o=Ln(4,i.children!==null?i.children:[],i.key,o),o.lanes=u,o.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},o}function $S(i,o,u,h,p){this.tag=o,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=wi(0),this.expirationTimes=wi(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=wi(0),this.identifierPrefix=h,this.onRecoverableError=p,this.mutableSourceEagerHydrationData=null}function Ap(i,o,u,h,p,y,I,b,N){return i=new $S(i,o,u,b,N),o===1?(o=1,y===!0&&(o|=8)):o=0,y=Ln(3,null,null,o),i.current=y,y.stateNode=i,y.memoizedState={element:h,isDehydrated:u,cache:null,transitions:null,pendingSuspenseBoundaries:null},Bf(y),i}function qS(i,o,u){var h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ne,key:h==null?null:""+h,children:i,containerInfo:o,implementation:u}}function h_(i){if(!i)return Ci;i=i._reactInternals;e:{if(Wn(i)!==i||i.tag!==1)throw Error(t(170));var o=i;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(ln(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(t(171))}if(i.tag===1){var u=i.type;if(ln(u))return Uy(i,u,o)}return o}function f_(i,o,u,h,p,y,I,b,N){return i=Ap(u,h,!0,i,p,y,I,b,N),i.context=h_(null),u=i.current,h=en(),p=Mi(u),y=Zr(h,p),y.callback=o??null,Di(u,y,p),i.current.lanes=p,Ei(i,p,h),dn(i,h),i}function dd(i,o,u,h){var p=o.current,y=en(),I=Mi(p);return u=h_(u),o.context===null?o.context=u:o.pendingContext=u,o=Zr(y,I),o.payload={element:i},h=h===void 0?null:h,h!==null&&(o.callback=h),i=Di(p,o,I),i!==null&&(ir(i,p,I,y),zc(i,p,I)),I}function hd(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function p_(i,o){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var u=i.retryLane;i.retryLane=u!==0&&u<o?u:o}}function Rp(i,o){p_(i,o),(i=i.alternate)&&p_(i,o)}function HS(){return null}var m_=typeof reportError=="function"?reportError:function(i){console.error(i)};function Cp(i){this._internalRoot=i}fd.prototype.render=Cp.prototype.render=function(i){var o=this._internalRoot;if(o===null)throw Error(t(409));dd(i,o,null,null)},fd.prototype.unmount=Cp.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var o=i.containerInfo;Ls(function(){dd(null,i,null,null)}),o[Kr]=null}};function fd(i){this._internalRoot=i}fd.prototype.unstable_scheduleHydration=function(i){if(i){var o=fc();i={blockedOn:null,target:i,priority:o};for(var u=0;u<gr.length&&o!==0&&o<gr[u].priority;u++);gr.splice(u,0,i),u===0&&gc(i)}};function Pp(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function pd(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function g_(){}function WS(i,o,u,h,p){if(p){if(typeof h=="function"){var y=h;h=function(){var W=hd(I);y.call(W)}}var I=f_(o,h,i,0,null,!1,!1,"",g_);return i._reactRootContainer=I,i[Kr]=I.current,Vl(i.nodeType===8?i.parentNode:i),Ls(),I}for(;p=i.lastChild;)i.removeChild(p);if(typeof h=="function"){var b=h;h=function(){var W=hd(N);b.call(W)}}var N=Ap(i,0,!1,null,null,!1,!1,"",g_);return i._reactRootContainer=N,i[Kr]=N.current,Vl(i.nodeType===8?i.parentNode:i),Ls(function(){dd(o,N,u,h)}),N}function md(i,o,u,h,p){var y=u._reactRootContainer;if(y){var I=y;if(typeof p=="function"){var b=p;p=function(){var N=hd(I);b.call(N)}}dd(o,I,i,p)}else I=WS(u,o,i,p,h);return hd(I)}dc=function(i){switch(i.tag){case 3:var o=i.stateNode;if(o.current.memoizedState.isDehydrated){var u=_i(o.pendingLanes);u!==0&&(Ii(o,u|1),dn(o,Xe()),(je&6)===0&&(da=Xe()+500,Pi()))}break;case 13:Ls(function(){var h=Jr(i,1);if(h!==null){var p=en();ir(h,i,1,p)}}),Rp(i,1)}},Lo=function(i){if(i.tag===13){var o=Jr(i,134217728);if(o!==null){var u=en();ir(o,i,134217728,u)}Rp(i,134217728)}},hc=function(i){if(i.tag===13){var o=Mi(i),u=Jr(i,o);if(u!==null){var h=en();ir(u,i,o,h)}Rp(i,o)}},fc=function(){return Ve},pc=function(i,o){var u=Ve;try{return Ve=i,o()}finally{Ve=u}},bo=function(i,o,u){switch(o){case"input":if(sl(i,u),o=u.name,u.type==="radio"&&o!=null){for(u=i;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<u.length;o++){var h=u[o];if(h!==i&&h.form===i.form){var p=Nc(h);if(!p)throw Error(t(90));Eo(h),sl(h,p)}}}break;case"textarea":So(i,u);break;case"select":o=u.value,o!=null&&Ur(i,!!u.multiple,o,!1)}},gs=Ip,ml=Ls;var GS={usingClientEntryPoint:!1,Events:[Ml,Jo,Nc,pr,pl,Ip]},Yl={findFiberByHostInstance:As,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},KS={bundleType:Yl.bundleType,version:Yl.version,rendererPackageName:Yl.rendererPackageName,rendererConfig:Yl.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:re.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=vl(i),i===null?null:i.stateNode},findFiberByHostInstance:Yl.findFiberByHostInstance||HS,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var gd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!gd.isDisabled&&gd.supportsFiber)try{Es=gd.inject(KS),mn=gd}catch{}}return hn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=GS,hn.createPortal=function(i,o){var u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Pp(o))throw Error(t(200));return qS(i,o,null,u)},hn.createRoot=function(i,o){if(!Pp(i))throw Error(t(299));var u=!1,h="",p=m_;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(h=o.identifierPrefix),o.onRecoverableError!==void 0&&(p=o.onRecoverableError)),o=Ap(i,1,!1,null,null,u,!1,h,p),i[Kr]=o.current,Vl(i.nodeType===8?i.parentNode:i),new Cp(o)},hn.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var o=i._reactInternals;if(o===void 0)throw typeof i.render=="function"?Error(t(188)):(i=Object.keys(i).join(","),Error(t(268,i)));return i=vl(o),i=i===null?null:i.stateNode,i},hn.flushSync=function(i){return Ls(i)},hn.hydrate=function(i,o,u){if(!pd(o))throw Error(t(200));return md(null,i,o,!0,u)},hn.hydrateRoot=function(i,o,u){if(!Pp(i))throw Error(t(405));var h=u!=null&&u.hydratedSources||null,p=!1,y="",I=m_;if(u!=null&&(u.unstable_strictMode===!0&&(p=!0),u.identifierPrefix!==void 0&&(y=u.identifierPrefix),u.onRecoverableError!==void 0&&(I=u.onRecoverableError)),o=f_(o,null,i,1,u??null,p,!1,y,I),i[Kr]=o.current,Vl(i),h)for(i=0;i<h.length;i++)u=h[i],p=u._getVersion,p=p(u._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[u,p]:o.mutableSourceEagerHydrationData.push(u,p);return new fd(o)},hn.render=function(i,o,u){if(!pd(o))throw Error(t(200));return md(null,i,o,!1,u)},hn.unmountComponentAtNode=function(i){if(!pd(i))throw Error(t(40));return i._reactRootContainer?(Ls(function(){md(null,null,i,!1,function(){i._reactRootContainer=null,i[Kr]=null})}),!0):!1},hn.unstable_batchedUpdates=Ip,hn.unstable_renderSubtreeIntoContainer=function(i,o,u,h){if(!pd(u))throw Error(t(200));if(i==null||i._reactInternals===void 0)throw Error(t(38));return md(i,o,u,!1,h)},hn.version="18.3.1-next-f1338f8080-20240426",hn}var T_;function nk(){if(T_)return Vp.exports;T_=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Vp.exports=tk(),Vp.exports}var S_;function rk(){if(S_)return yd;S_=1;var n=nk();return yd.createRoot=n.createRoot,yd.hydrateRoot=n.hydrateRoot,yd}var ik=rk();const sk=q0(ik);/**
 * react-router v7.10.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var k_="popstate";function ok(n={}){function e(r,s){let{pathname:a,search:l,hash:d}=r.location;return tm("",{pathname:a,search:l,hash:d},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function t(r,s){return typeof s=="string"?s:Iu(s)}return lk(e,t,null,n)}function rt(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Bn(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function ak(){return Math.random().toString(36).substring(2,10)}function b_(n,e){return{usr:n.state,key:n.key,idx:e}}function tm(n,e,t=null,r){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?qa(e):e,state:t,key:e&&e.key||r||ak()}}function Iu({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function qa(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substring(r),n=n.substring(0,r)),n&&(e.pathname=n)}return e}function lk(n,e,t,r={}){let{window:s=document.defaultView,v5Compat:a=!1}=r,l=s.history,d="POP",f=null,m=v();m==null&&(m=0,l.replaceState({...l.state,idx:m},""));function v(){return(l.state||{idx:null}).idx}function w(){d="POP";let O=v(),K=O==null?null:O-m;m=O,f&&f({action:d,location:F.location,delta:K})}function x(O,K){d="PUSH";let X=tm(F.location,O,K);m=v()+1;let q=b_(X,m),re=F.createHref(X);try{l.pushState(q,"",re)}catch(de){if(de instanceof DOMException&&de.name==="DataCloneError")throw de;s.location.assign(re)}a&&f&&f({action:d,location:F.location,delta:1})}function S(O,K){d="REPLACE";let X=tm(F.location,O,K);m=v();let q=b_(X,m),re=F.createHref(X);l.replaceState(q,"",re),a&&f&&f({action:d,location:F.location,delta:0})}function D(O){return uk(O)}let F={get action(){return d},get location(){return n(s,l)},listen(O){if(f)throw new Error("A history only accepts one active listener");return s.addEventListener(k_,w),f=O,()=>{s.removeEventListener(k_,w),f=null}},createHref(O){return e(s,O)},createURL:D,encodeLocation(O){let K=D(O);return{pathname:K.pathname,search:K.search,hash:K.hash}},push:x,replace:S,go(O){return l.go(O)}};return F}function uk(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),rt(t,"No window.location.(origin|href) available to create URL");let r=typeof n=="string"?n:Iu(n);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=t+r),new URL(r,t)}function H0(n,e,t="/"){return ck(n,e,t,!1)}function ck(n,e,t,r){let s=typeof e=="string"?qa(e):e,a=ai(s.pathname||"/",t);if(a==null)return null;let l=W0(n);dk(l);let d=null;for(let f=0;d==null&&f<l.length;++f){let m=Ik(a);d=wk(l[f],m,r)}return d}function W0(n,e=[],t=[],r="",s=!1){let a=(l,d,f=s,m)=>{let v={relativePath:m===void 0?l.path||"":m,caseSensitive:l.caseSensitive===!0,childrenIndex:d,route:l};if(v.relativePath.startsWith("/")){if(!v.relativePath.startsWith(r)&&f)return;rt(v.relativePath.startsWith(r),`Absolute route path "${v.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),v.relativePath=v.relativePath.slice(r.length)}let w=oi([r,v.relativePath]),x=t.concat(v);l.children&&l.children.length>0&&(rt(l.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${w}".`),W0(l.children,e,x,w,f)),!(l.path==null&&!l.index)&&e.push({path:w,score:vk(w,l.index),routesMeta:x})};return n.forEach((l,d)=>{var f;if(l.path===""||!((f=l.path)!=null&&f.includes("?")))a(l,d);else for(let m of G0(l.path))a(l,d,!0,m)}),e}function G0(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,s=t.endsWith("?"),a=t.replace(/\?$/,"");if(r.length===0)return s?[a,""]:[a];let l=G0(r.join("/")),d=[];return d.push(...l.map(f=>f===""?a:[a,f].join("/"))),s&&d.push(...l),d.map(f=>n.startsWith("/")&&f===""?"/":f)}function dk(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:_k(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}var hk=/^:[\w-]+$/,fk=3,pk=2,mk=1,gk=10,yk=-2,A_=n=>n==="*";function vk(n,e){let t=n.split("/"),r=t.length;return t.some(A_)&&(r+=yk),e&&(r+=pk),t.filter(s=>!A_(s)).reduce((s,a)=>s+(hk.test(a)?fk:a===""?mk:gk),r)}function _k(n,e){return n.length===e.length&&n.slice(0,-1).every((r,s)=>r===e[s])?n[n.length-1]-e[e.length-1]:0}function wk(n,e,t=!1){let{routesMeta:r}=n,s={},a="/",l=[];for(let d=0;d<r.length;++d){let f=r[d],m=d===r.length-1,v=a==="/"?e:e.slice(a.length)||"/",w=Wd({path:f.relativePath,caseSensitive:f.caseSensitive,end:m},v),x=f.route;if(!w&&m&&t&&!r[r.length-1].route.index&&(w=Wd({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},v)),!w)return null;Object.assign(s,w.params),l.push({params:s,pathname:oi([a,w.pathname]),pathnameBase:bk(oi([a,w.pathnameBase])),route:x}),w.pathnameBase!=="/"&&(a=oi([a,w.pathnameBase]))}return l}function Wd(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=Ek(n.path,n.caseSensitive,n.end),s=e.match(t);if(!s)return null;let a=s[0],l=a.replace(/(.)\/+$/,"$1"),d=s.slice(1);return{params:r.reduce((m,{paramName:v,isOptional:w},x)=>{if(v==="*"){let D=d[x]||"";l=a.slice(0,a.length-D.length).replace(/(.)\/+$/,"$1")}const S=d[x];return w&&!S?m[v]=void 0:m[v]=(S||"").replace(/%2F/g,"/"),m},{}),pathname:a,pathnameBase:l,pattern:n}}function Ek(n,e=!1,t=!0){Bn(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let r=[],s="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,d,f)=>(r.push({paramName:d,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(r.push({paramName:"*"}),s+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?s+="\\/*$":n!==""&&n!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function Ik(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Bn(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function ai(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}var xk=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Tk=n=>xk.test(n);function Sk(n,e="/"){let{pathname:t,search:r="",hash:s=""}=typeof n=="string"?qa(n):n,a;if(t)if(Tk(t))a=t;else{if(t.includes("//")){let l=t;t=t.replace(/\/\/+/g,"/"),Bn(!1,`Pathnames cannot have embedded double slashes - normalizing ${l} -> ${t}`)}t.startsWith("/")?a=R_(t.substring(1),"/"):a=R_(t,e)}else a=e;return{pathname:a,search:Ak(r),hash:Rk(s)}}function R_(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(s=>{s===".."?t.length>1&&t.pop():s!=="."&&t.push(s)}),t.length>1?t.join("/"):"/"}function Mp(n,e,t,r){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function kk(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function Fm(n){let e=kk(n);return e.map((t,r)=>r===e.length-1?t.pathname:t.pathnameBase)}function Um(n,e,t,r=!1){let s;typeof n=="string"?s=qa(n):(s={...n},rt(!s.pathname||!s.pathname.includes("?"),Mp("?","pathname","search",s)),rt(!s.pathname||!s.pathname.includes("#"),Mp("#","pathname","hash",s)),rt(!s.search||!s.search.includes("#"),Mp("#","search","hash",s)));let a=n===""||s.pathname==="",l=a?"/":s.pathname,d;if(l==null)d=t;else{let w=e.length-1;if(!r&&l.startsWith("..")){let x=l.split("/");for(;x[0]==="..";)x.shift(),w-=1;s.pathname=x.join("/")}d=w>=0?e[w]:"/"}let f=Sk(s,d),m=l&&l!=="/"&&l.endsWith("/"),v=(a||l===".")&&t.endsWith("/");return!f.pathname.endsWith("/")&&(m||v)&&(f.pathname+="/"),f}var oi=n=>n.join("/").replace(/\/\/+/g,"/"),bk=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),Ak=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,Rk=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function Ck(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}function Pk(n){return n.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var K0=["POST","PUT","PATCH","DELETE"];new Set(K0);var Nk=["GET",...K0];new Set(Nk);var Ha=$.createContext(null);Ha.displayName="DataRouter";var Ih=$.createContext(null);Ih.displayName="DataRouterState";$.createContext(!1);var Q0=$.createContext({isTransitioning:!1});Q0.displayName="ViewTransition";var Dk=$.createContext(new Map);Dk.displayName="Fetchers";var Vk=$.createContext(null);Vk.displayName="Await";var zn=$.createContext(null);zn.displayName="Navigation";var Fu=$.createContext(null);Fu.displayName="Location";var cr=$.createContext({outlet:null,matches:[],isDataRoute:!1});cr.displayName="Route";var Bm=$.createContext(null);Bm.displayName="RouteError";function Ok(n,{relative:e}={}){rt(Wa(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:r}=$.useContext(zn),{hash:s,pathname:a,search:l}=Uu(n,{relative:e}),d=a;return t!=="/"&&(d=a==="/"?t:oi([t,a])),r.createHref({pathname:d,search:l,hash:s})}function Wa(){return $.useContext(Fu)!=null}function us(){return rt(Wa(),"useLocation() may be used only in the context of a <Router> component."),$.useContext(Fu).location}var X0="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Y0(n){$.useContext(zn).static||$.useLayoutEffect(n)}function $n(){let{isDataRoute:n}=$.useContext(cr);return n?Kk():Lk()}function Lk(){rt(Wa(),"useNavigate() may be used only in the context of a <Router> component.");let n=$.useContext(Ha),{basename:e,navigator:t}=$.useContext(zn),{matches:r}=$.useContext(cr),{pathname:s}=us(),a=JSON.stringify(Fm(r)),l=$.useRef(!1);return Y0(()=>{l.current=!0}),$.useCallback((f,m={})=>{if(Bn(l.current,X0),!l.current)return;if(typeof f=="number"){t.go(f);return}let v=Um(f,JSON.parse(a),s,m.relative==="path");n==null&&e!=="/"&&(v.pathname=v.pathname==="/"?e:oi([e,v.pathname])),(m.replace?t.replace:t.push)(v,m.state,m)},[e,t,a,s,n])}$.createContext(null);function zm(){let{matches:n}=$.useContext(cr),e=n[n.length-1];return e?e.params:{}}function Uu(n,{relative:e}={}){let{matches:t}=$.useContext(cr),{pathname:r}=us(),s=JSON.stringify(Fm(t));return $.useMemo(()=>Um(n,JSON.parse(s),r,e==="path"),[n,s,r,e])}function Mk(n,e){return J0(n,e)}function J0(n,e,t,r,s){var X;rt(Wa(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=$.useContext(zn),{matches:l}=$.useContext(cr),d=l[l.length-1],f=d?d.params:{},m=d?d.pathname:"/",v=d?d.pathnameBase:"/",w=d&&d.route;{let q=w&&w.path||"";Z0(m,!w||q.endsWith("*")||q.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${m}" (under <Route path="${q}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${q}"> to <Route path="${q==="/"?"*":`${q}/*`}">.`)}let x=us(),S;if(e){let q=typeof e=="string"?qa(e):e;rt(v==="/"||((X=q.pathname)==null?void 0:X.startsWith(v)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${v}" but pathname "${q.pathname}" was given in the \`location\` prop.`),S=q}else S=x;let D=S.pathname||"/",F=D;if(v!=="/"){let q=v.replace(/^\//,"").split("/");F="/"+D.replace(/^\//,"").split("/").slice(q.length).join("/")}let O=H0(n,{pathname:F});Bn(w||O!=null,`No routes matched location "${S.pathname}${S.search}${S.hash}" `),Bn(O==null||O[O.length-1].route.element!==void 0||O[O.length-1].route.Component!==void 0||O[O.length-1].route.lazy!==void 0,`Matched leaf route at location "${S.pathname}${S.search}${S.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let K=zk(O&&O.map(q=>Object.assign({},q,{params:Object.assign({},f,q.params),pathname:oi([v,a.encodeLocation?a.encodeLocation(q.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:q.pathname]),pathnameBase:q.pathnameBase==="/"?v:oi([v,a.encodeLocation?a.encodeLocation(q.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:q.pathnameBase])})),l,t,r,s);return e&&K?$.createElement(Fu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...S},navigationType:"POP"}},K):K}function jk(){let n=Gk(),e=Ck(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,r="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:r},a={padding:"2px 4px",backgroundColor:r},l=null;return console.error("Error handled by React Router default ErrorBoundary:",n),l=$.createElement($.Fragment,null,$.createElement("p",null," Hey developer "),$.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",$.createElement("code",{style:a},"ErrorBoundary")," or"," ",$.createElement("code",{style:a},"errorElement")," prop on your route.")),$.createElement($.Fragment,null,$.createElement("h2",null,"Unexpected Application Error!"),$.createElement("h3",{style:{fontStyle:"italic"}},e),t?$.createElement("pre",{style:s},t):null,l)}var Fk=$.createElement(jk,null),Uk=class extends $.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){this.props.onError?this.props.onError(n,e):console.error("React Router caught the following error during render",n)}render(){return this.state.error!==void 0?$.createElement(cr.Provider,{value:this.props.routeContext},$.createElement(Bm.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Bk({routeContext:n,match:e,children:t}){let r=$.useContext(Ha);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),$.createElement(cr.Provider,{value:n},t)}function zk(n,e=[],t=null,r=null,s=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let a=n,l=t==null?void 0:t.errors;if(l!=null){let v=a.findIndex(w=>w.route.id&&(l==null?void 0:l[w.route.id])!==void 0);rt(v>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(l).join(",")}`),a=a.slice(0,Math.min(a.length,v+1))}let d=!1,f=-1;if(t)for(let v=0;v<a.length;v++){let w=a[v];if((w.route.HydrateFallback||w.route.hydrateFallbackElement)&&(f=v),w.route.id){let{loaderData:x,errors:S}=t,D=w.route.loader&&!x.hasOwnProperty(w.route.id)&&(!S||S[w.route.id]===void 0);if(w.route.lazy||D){d=!0,f>=0?a=a.slice(0,f+1):a=[a[0]];break}}}let m=t&&r?(v,w)=>{var x,S;r(v,{location:t.location,params:((S=(x=t.matches)==null?void 0:x[0])==null?void 0:S.params)??{},unstable_pattern:Pk(t.matches),errorInfo:w})}:void 0;return a.reduceRight((v,w,x)=>{let S,D=!1,F=null,O=null;t&&(S=l&&w.route.id?l[w.route.id]:void 0,F=w.route.errorElement||Fk,d&&(f<0&&x===0?(Z0("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),D=!0,O=null):f===x&&(D=!0,O=w.route.hydrateFallbackElement||null)));let K=e.concat(a.slice(0,x+1)),X=()=>{let q;return S?q=F:D?q=O:w.route.Component?q=$.createElement(w.route.Component,null):w.route.element?q=w.route.element:q=v,$.createElement(Bk,{match:w,routeContext:{outlet:v,matches:K,isDataRoute:t!=null},children:q})};return t&&(w.route.ErrorBoundary||w.route.errorElement||x===0)?$.createElement(Uk,{location:t.location,revalidation:t.revalidation,component:F,error:S,children:X(),routeContext:{outlet:null,matches:K,isDataRoute:!0},onError:m}):X()},null)}function $m(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function $k(n){let e=$.useContext(Ha);return rt(e,$m(n)),e}function qk(n){let e=$.useContext(Ih);return rt(e,$m(n)),e}function Hk(n){let e=$.useContext(cr);return rt(e,$m(n)),e}function qm(n){let e=Hk(n),t=e.matches[e.matches.length-1];return rt(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function Wk(){return qm("useRouteId")}function Gk(){var r;let n=$.useContext(Bm),e=qk("useRouteError"),t=qm("useRouteError");return n!==void 0?n:(r=e.errors)==null?void 0:r[t]}function Kk(){let{router:n}=$k("useNavigate"),e=qm("useNavigate"),t=$.useRef(!1);return Y0(()=>{t.current=!0}),$.useCallback(async(s,a={})=>{Bn(t.current,X0),t.current&&(typeof s=="number"?await n.navigate(s):await n.navigate(s,{fromRouteId:e,...a}))},[n,e])}var C_={};function Z0(n,e,t){!e&&!C_[n]&&(C_[n]=!0,Bn(!1,t))}$.memo(Qk);function Qk({routes:n,future:e,state:t,unstable_onError:r}){return J0(n,void 0,t,r,e)}function Xk({to:n,replace:e,state:t,relative:r}){rt(Wa(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=$.useContext(zn);Bn(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:a}=$.useContext(cr),{pathname:l}=us(),d=$n(),f=Um(n,Fm(a),l,r==="path"),m=JSON.stringify(f);return $.useEffect(()=>{d(JSON.parse(m),{replace:e,state:t,relative:r})},[d,m,r,e,t]),null}function Tr(n){rt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Yk({basename:n="/",children:e=null,location:t,navigationType:r="POP",navigator:s,static:a=!1,unstable_useTransitions:l}){rt(!Wa(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let d=n.replace(/^\/*/,"/"),f=$.useMemo(()=>({basename:d,navigator:s,static:a,unstable_useTransitions:l,future:{}}),[d,s,a,l]);typeof t=="string"&&(t=qa(t));let{pathname:m="/",search:v="",hash:w="",state:x=null,key:S="default"}=t,D=$.useMemo(()=>{let F=ai(m,d);return F==null?null:{location:{pathname:F,search:v,hash:w,state:x,key:S},navigationType:r}},[d,m,v,w,x,S,r]);return Bn(D!=null,`<Router basename="${d}"> is not able to match the URL "${m}${v}${w}" because it does not start with the basename, so the <Router> won't render anything.`),D==null?null:$.createElement(zn.Provider,{value:f},$.createElement(Fu.Provider,{children:e,value:D}))}function Jk({children:n,location:e}){return Mk(nm(n),e)}function nm(n,e=[]){let t=[];return $.Children.forEach(n,(r,s)=>{if(!$.isValidElement(r))return;let a=[...e,s];if(r.type===$.Fragment){t.push.apply(t,nm(r.props.children,a));return}rt(r.type===Tr,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),rt(!r.props.index||!r.props.children,"An index route cannot have child routes.");let l={id:r.props.id||a.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(l.children=nm(r.props.children,a)),t.push(l)}),t}var bd="get",Ad="application/x-www-form-urlencoded";function xh(n){return typeof HTMLElement<"u"&&n instanceof HTMLElement}function Zk(n){return xh(n)&&n.tagName.toLowerCase()==="button"}function e1(n){return xh(n)&&n.tagName.toLowerCase()==="form"}function t1(n){return xh(n)&&n.tagName.toLowerCase()==="input"}function n1(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function r1(n,e){return n.button===0&&(!e||e==="_self")&&!n1(n)}var vd=null;function i1(){if(vd===null)try{new FormData(document.createElement("form"),0),vd=!1}catch{vd=!0}return vd}var s1=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function jp(n){return n!=null&&!s1.has(n)?(Bn(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Ad}"`),null):n}function o1(n,e){let t,r,s,a,l;if(e1(n)){let d=n.getAttribute("action");r=d?ai(d,e):null,t=n.getAttribute("method")||bd,s=jp(n.getAttribute("enctype"))||Ad,a=new FormData(n)}else if(Zk(n)||t1(n)&&(n.type==="submit"||n.type==="image")){let d=n.form;if(d==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let f=n.getAttribute("formaction")||d.getAttribute("action");if(r=f?ai(f,e):null,t=n.getAttribute("formmethod")||d.getAttribute("method")||bd,s=jp(n.getAttribute("formenctype"))||jp(d.getAttribute("enctype"))||Ad,a=new FormData(d,n),!i1()){let{name:m,type:v,value:w}=n;if(v==="image"){let x=m?`${m}.`:"";a.append(`${x}x`,"0"),a.append(`${x}y`,"0")}else m&&a.append(m,w)}}else{if(xh(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=bd,r=null,s=Ad,l=n}return a&&s==="text/plain"&&(l=a,a=void 0),{action:r,method:t.toLowerCase(),encType:s,formData:a,body:l}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Hm(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function a1(n,e,t){let r=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return r.pathname==="/"?r.pathname=`_root.${t}`:e&&ai(r.pathname,e)==="/"?r.pathname=`${e.replace(/\/$/,"")}/_root.${t}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${t}`,r}async function l1(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function u1(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function c1(n,e,t){let r=await Promise.all(n.map(async s=>{let a=e.routes[s.route.id];if(a){let l=await l1(a,t);return l.links?l.links():[]}return[]}));return p1(r.flat(1).filter(u1).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function P_(n,e,t,r,s,a){let l=(f,m)=>t[m]?f.route.id!==t[m].route.id:!0,d=(f,m)=>{var v;return t[m].pathname!==f.pathname||((v=t[m].route.path)==null?void 0:v.endsWith("*"))&&t[m].params["*"]!==f.params["*"]};return a==="assets"?e.filter((f,m)=>l(f,m)||d(f,m)):a==="data"?e.filter((f,m)=>{var w;let v=r.routes[f.route.id];if(!v||!v.hasLoader)return!1;if(l(f,m)||d(f,m))return!0;if(f.route.shouldRevalidate){let x=f.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:((w=t[0])==null?void 0:w.params)||{},nextUrl:new URL(n,window.origin),nextParams:f.params,defaultShouldRevalidate:!0});if(typeof x=="boolean")return x}return!0}):[]}function d1(n,e,{includeHydrateFallback:t}={}){return h1(n.map(r=>{let s=e.routes[r.route.id];if(!s)return[];let a=[s.module];return s.clientActionModule&&(a=a.concat(s.clientActionModule)),s.clientLoaderModule&&(a=a.concat(s.clientLoaderModule)),t&&s.hydrateFallbackModule&&(a=a.concat(s.hydrateFallbackModule)),s.imports&&(a=a.concat(s.imports)),a}).flat(1))}function h1(n){return[...new Set(n)]}function f1(n){let e={},t=Object.keys(n).sort();for(let r of t)e[r]=n[r];return e}function p1(n,e){let t=new Set;return new Set(e),n.reduce((r,s)=>{let a=JSON.stringify(f1(s));return t.has(a)||(t.add(a),r.push({key:a,link:s})),r},[])}function eE(){let n=$.useContext(Ha);return Hm(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function m1(){let n=$.useContext(Ih);return Hm(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var Wm=$.createContext(void 0);Wm.displayName="FrameworkContext";function tE(){let n=$.useContext(Wm);return Hm(n,"You must render this element inside a <HydratedRouter> element"),n}function g1(n,e){let t=$.useContext(Wm),[r,s]=$.useState(!1),[a,l]=$.useState(!1),{onFocus:d,onBlur:f,onMouseEnter:m,onMouseLeave:v,onTouchStart:w}=e,x=$.useRef(null);$.useEffect(()=>{if(n==="render"&&l(!0),n==="viewport"){let F=K=>{K.forEach(X=>{l(X.isIntersecting)})},O=new IntersectionObserver(F,{threshold:.5});return x.current&&O.observe(x.current),()=>{O.disconnect()}}},[n]),$.useEffect(()=>{if(r){let F=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(F)}}},[r]);let S=()=>{s(!0)},D=()=>{s(!1),l(!1)};return t?n!=="intent"?[a,x,{}]:[a,x,{onFocus:Zl(d,S),onBlur:Zl(f,D),onMouseEnter:Zl(m,S),onMouseLeave:Zl(v,D),onTouchStart:Zl(w,S)}]:[!1,x,{}]}function Zl(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function y1({page:n,...e}){let{router:t}=eE(),r=$.useMemo(()=>H0(t.routes,n,t.basename),[t.routes,n,t.basename]);return r?$.createElement(_1,{page:n,matches:r,...e}):null}function v1(n){let{manifest:e,routeModules:t}=tE(),[r,s]=$.useState([]);return $.useEffect(()=>{let a=!1;return c1(n,e,t).then(l=>{a||s(l)}),()=>{a=!0}},[n,e,t]),r}function _1({page:n,matches:e,...t}){let r=us(),{manifest:s,routeModules:a}=tE(),{basename:l}=eE(),{loaderData:d,matches:f}=m1(),m=$.useMemo(()=>P_(n,e,f,s,r,"data"),[n,e,f,s,r]),v=$.useMemo(()=>P_(n,e,f,s,r,"assets"),[n,e,f,s,r]),w=$.useMemo(()=>{if(n===r.pathname+r.search+r.hash)return[];let D=new Set,F=!1;if(e.forEach(K=>{var q;let X=s.routes[K.route.id];!X||!X.hasLoader||(!m.some(re=>re.route.id===K.route.id)&&K.route.id in d&&((q=a[K.route.id])!=null&&q.shouldRevalidate)||X.hasClientLoader?F=!0:D.add(K.route.id))}),D.size===0)return[];let O=a1(n,l,"data");return F&&D.size>0&&O.searchParams.set("_routes",e.filter(K=>D.has(K.route.id)).map(K=>K.route.id).join(",")),[O.pathname+O.search]},[l,d,r,s,m,e,n,a]),x=$.useMemo(()=>d1(v,s),[v,s]),S=v1(v);return $.createElement($.Fragment,null,w.map(D=>$.createElement("link",{key:D,rel:"prefetch",as:"fetch",href:D,...t})),x.map(D=>$.createElement("link",{key:D,rel:"modulepreload",href:D,...t})),S.map(({key:D,link:F})=>$.createElement("link",{key:D,nonce:t.nonce,...F})))}function w1(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var nE=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{nE&&(window.__reactRouterVersion="7.10.1")}catch{}function E1({basename:n,children:e,unstable_useTransitions:t,window:r}){let s=$.useRef();s.current==null&&(s.current=ok({window:r,v5Compat:!0}));let a=s.current,[l,d]=$.useState({action:a.action,location:a.location}),f=$.useCallback(m=>{t===!1?d(m):$.startTransition(()=>d(m))},[t]);return $.useLayoutEffect(()=>a.listen(f),[a,f]),$.createElement(Yk,{basename:n,children:e,location:l.location,navigationType:l.action,navigator:a,unstable_useTransitions:t===!0})}var rE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,iE=$.forwardRef(function({onClick:e,discover:t="render",prefetch:r="none",relative:s,reloadDocument:a,replace:l,state:d,target:f,to:m,preventScrollReset:v,viewTransition:w,...x},S){let{basename:D,unstable_useTransitions:F}=$.useContext(zn),O=typeof m=="string"&&rE.test(m),K,X=!1;if(typeof m=="string"&&O&&(K=m,nE))try{let A=new URL(window.location.href),L=m.startsWith("//")?new URL(A.protocol+m):new URL(m),M=ai(L.pathname,D);L.origin===A.origin&&M!=null?m=M+L.search+L.hash:X=!0}catch{Bn(!1,`<Link to="${m}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let q=Ok(m,{relative:s}),[re,de,ne]=g1(r,x),P=T1(m,{replace:l,state:d,target:f,preventScrollReset:v,relative:s,viewTransition:w,unstable_useTransitions:F});function k(A){e&&e(A),A.defaultPrevented||P(A)}let R=$.createElement("a",{...x,...ne,href:K||q,onClick:X||a?e:k,ref:w1(S,de),target:f,"data-discover":!O&&t==="render"?"true":void 0});return re&&!O?$.createElement($.Fragment,null,R,$.createElement(y1,{page:q})):R});iE.displayName="Link";var sE=$.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:r="",end:s=!1,style:a,to:l,viewTransition:d,children:f,...m},v){let w=Uu(l,{relative:m.relative}),x=us(),S=$.useContext(Ih),{navigator:D,basename:F}=$.useContext(zn),O=S!=null&&R1(w)&&d===!0,K=D.encodeLocation?D.encodeLocation(w).pathname:w.pathname,X=x.pathname,q=S&&S.navigation&&S.navigation.location?S.navigation.location.pathname:null;t||(X=X.toLowerCase(),q=q?q.toLowerCase():null,K=K.toLowerCase()),q&&F&&(q=ai(q,F)||q);const re=K!=="/"&&K.endsWith("/")?K.length-1:K.length;let de=X===K||!s&&X.startsWith(K)&&X.charAt(re)==="/",ne=q!=null&&(q===K||!s&&q.startsWith(K)&&q.charAt(K.length)==="/"),P={isActive:de,isPending:ne,isTransitioning:O},k=de?e:void 0,R;typeof r=="function"?R=r(P):R=[r,de?"active":null,ne?"pending":null,O?"transitioning":null].filter(Boolean).join(" ");let A=typeof a=="function"?a(P):a;return $.createElement(iE,{...m,"aria-current":k,className:R,ref:v,style:A,to:l,viewTransition:d},typeof f=="function"?f(P):f)});sE.displayName="NavLink";var I1=$.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:r,replace:s,state:a,method:l=bd,action:d,onSubmit:f,relative:m,preventScrollReset:v,viewTransition:w,...x},S)=>{let{unstable_useTransitions:D}=$.useContext(zn),F=b1(),O=A1(d,{relative:m}),K=l.toLowerCase()==="get"?"get":"post",X=typeof d=="string"&&rE.test(d),q=re=>{if(f&&f(re),re.defaultPrevented)return;re.preventDefault();let de=re.nativeEvent.submitter,ne=(de==null?void 0:de.getAttribute("formmethod"))||l,P=()=>F(de||re.currentTarget,{fetcherKey:e,method:ne,navigate:t,replace:s,state:a,relative:m,preventScrollReset:v,viewTransition:w});D&&t!==!1?$.startTransition(()=>P()):P()};return $.createElement("form",{ref:S,method:K,action:O,onSubmit:r?f:q,...x,"data-discover":!X&&n==="render"?"true":void 0})});I1.displayName="Form";function x1(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function oE(n){let e=$.useContext(Ha);return rt(e,x1(n)),e}function T1(n,{target:e,replace:t,state:r,preventScrollReset:s,relative:a,viewTransition:l,unstable_useTransitions:d}={}){let f=$n(),m=us(),v=Uu(n,{relative:a});return $.useCallback(w=>{if(r1(w,e)){w.preventDefault();let x=t!==void 0?t:Iu(m)===Iu(v),S=()=>f(n,{replace:x,state:r,preventScrollReset:s,relative:a,viewTransition:l});d?$.startTransition(()=>S()):S()}},[m,f,v,t,r,e,n,s,a,l,d])}var S1=0,k1=()=>`__${String(++S1)}__`;function b1(){let{router:n}=oE("useSubmit"),{basename:e}=$.useContext(zn),t=Wk(),r=n.fetch,s=n.navigate;return $.useCallback(async(a,l={})=>{let{action:d,method:f,encType:m,formData:v,body:w}=o1(a,e);if(l.navigate===!1){let x=l.fetcherKey||k1();await r(x,t,l.action||d,{preventScrollReset:l.preventScrollReset,formData:v,body:w,formMethod:l.method||f,formEncType:l.encType||m,flushSync:l.flushSync})}else await s(l.action||d,{preventScrollReset:l.preventScrollReset,formData:v,body:w,formMethod:l.method||f,formEncType:l.encType||m,replace:l.replace,state:l.state,fromRouteId:t,flushSync:l.flushSync,viewTransition:l.viewTransition})},[r,s,e,t])}function A1(n,{relative:e}={}){let{basename:t}=$.useContext(zn),r=$.useContext(cr);rt(r,"useFormAction must be used inside a RouteContext");let[s]=r.matches.slice(-1),a={...Uu(n||".",{relative:e})},l=us();if(n==null){a.search=l.search;let d=new URLSearchParams(a.search),f=d.getAll("index");if(f.some(v=>v==="")){d.delete("index"),f.filter(w=>w).forEach(w=>d.append("index",w));let v=d.toString();a.search=v?`?${v}`:""}}return(!n||n===".")&&s.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(a.pathname=a.pathname==="/"?t:oi([t,a.pathname])),Iu(a)}function R1(n,{relative:e}={}){let t=$.useContext(Q0);rt(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=oE("useViewTransitionState"),s=Uu(n,{relative:e});if(!t.isTransitioning)return!1;let a=ai(t.currentLocation.pathname,r)||t.currentLocation.pathname,l=ai(t.nextLocation.pathname,r)||t.nextLocation.pathname;return Wd(s.pathname,l)!=null||Wd(s.pathname,a)!=null}const N_=n=>{let e;const t=new Set,r=(m,v)=>{const w=typeof m=="function"?m(e):m;if(!Object.is(w,e)){const x=e;e=v??(typeof w!="object"||w===null)?w:Object.assign({},e,w),t.forEach(S=>S(e,x))}},s=()=>e,d={setState:r,getState:s,getInitialState:()=>f,subscribe:m=>(t.add(m),()=>t.delete(m))},f=e=n(r,s,d);return d},C1=(n=>n?N_(n):N_),P1=n=>n;function N1(n,e=P1){const t=su.useSyncExternalStore(n.subscribe,su.useCallback(()=>e(n.getState()),[n,e]),su.useCallback(()=>e(n.getInitialState()),[n,e]));return su.useDebugValue(t),t}const D_=n=>{const e=C1(n),t=r=>N1(e,r);return Object.assign(t,e),t},aE=(n=>n?D_(n):D_),mo=aE(n=>({user:null,isLoading:!0,isAuthenticated:!1,setUser:e=>n({user:e,isAuthenticated:!!e}),setLoading:e=>n({isLoading:e}),clearUser:()=>n({user:null,isAuthenticated:!1})})),D1=()=>{};var V_={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lE=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},V1=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const s=n[t++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const a=n[t++];e[r++]=String.fromCharCode((s&31)<<6|a&63)}else if(s>239&&s<365){const a=n[t++],l=n[t++],d=n[t++],f=((s&7)<<18|(a&63)<<12|(l&63)<<6|d&63)-65536;e[r++]=String.fromCharCode(55296+(f>>10)),e[r++]=String.fromCharCode(56320+(f&1023))}else{const a=n[t++],l=n[t++];e[r++]=String.fromCharCode((s&15)<<12|(a&63)<<6|l&63)}}return e.join("")},uE={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const a=n[s],l=s+1<n.length,d=l?n[s+1]:0,f=s+2<n.length,m=f?n[s+2]:0,v=a>>2,w=(a&3)<<4|d>>4;let x=(d&15)<<2|m>>6,S=m&63;f||(S=64,l||(x=64)),r.push(t[v],t[w],t[x],t[S])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(lE(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):V1(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const a=t[n.charAt(s++)],d=s<n.length?t[n.charAt(s)]:0;++s;const m=s<n.length?t[n.charAt(s)]:64;++s;const w=s<n.length?t[n.charAt(s)]:64;if(++s,a==null||d==null||m==null||w==null)throw new O1;const x=a<<2|d>>4;if(r.push(x),m!==64){const S=d<<4&240|m>>2;if(r.push(S),w!==64){const D=m<<6&192|w;r.push(D)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class O1 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const L1=function(n){const e=lE(n);return uE.encodeByteArray(e,!0)},Gd=function(n){return L1(n).replace(/\./g,"")},cE=function(n){try{return uE.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dE(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M1=()=>dE().__FIREBASE_DEFAULTS__,j1=()=>{if(typeof process>"u"||typeof V_>"u")return;const n=V_.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},F1=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&cE(n[1]);return e&&JSON.parse(e)},Th=()=>{try{return D1()||M1()||j1()||F1()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},hE=n=>{var e,t;return(t=(e=Th())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},U1=n=>{const e=hE(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},fE=()=>{var n;return(n=Th())===null||n===void 0?void 0:n.config},pE=n=>{var e;return(e=Th())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B1{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ga(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function mE(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z1(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",s=n.iat||0,a=n.sub||n.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Gd(JSON.stringify(t)),Gd(JSON.stringify(l)),""].join(".")}const du={};function $1(){const n={prod:[],emulator:[]};for(const e of Object.keys(du))du[e]?n.emulator.push(e):n.prod.push(e);return n}function q1(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let O_=!1;function gE(n,e){if(typeof window>"u"||typeof document>"u"||!Ga(window.location.host)||du[n]===e||du[n]||O_)return;du[n]=e;function t(x){return`__firebase__banner__${x}`}const r="__firebase__banner",a=$1().prod.length>0;function l(){const x=document.getElementById(r);x&&x.remove()}function d(x){x.style.display="flex",x.style.background="#7faaf0",x.style.position="fixed",x.style.bottom="5px",x.style.left="5px",x.style.padding=".5em",x.style.borderRadius="5px",x.style.alignItems="center"}function f(x,S){x.setAttribute("width","24"),x.setAttribute("id",S),x.setAttribute("height","24"),x.setAttribute("viewBox","0 0 24 24"),x.setAttribute("fill","none"),x.style.marginLeft="-6px"}function m(){const x=document.createElement("span");return x.style.cursor="pointer",x.style.marginLeft="16px",x.style.fontSize="24px",x.innerHTML=" &times;",x.onclick=()=>{O_=!0,l()},x}function v(x,S){x.setAttribute("id",S),x.innerText="Learn more",x.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",x.setAttribute("target","__blank"),x.style.paddingLeft="5px",x.style.textDecoration="underline"}function w(){const x=q1(r),S=t("text"),D=document.getElementById(S)||document.createElement("span"),F=t("learnmore"),O=document.getElementById(F)||document.createElement("a"),K=t("preprendIcon"),X=document.getElementById(K)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(x.created){const q=x.element;d(q),v(O,F);const re=m();f(X,K),q.append(X,D,O,re),document.body.appendChild(q)}a?(D.innerText="Preview backend disconnected.",X.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(X.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,D.innerText="Preview backend running in this workspace."),D.setAttribute("id",S)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",w):w()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function H1(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(bt())}function yE(){var n;const e=(n=Th())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function W1(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Gm(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function G1(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function K1(){const n=bt();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function vE(){return!yE()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function _E(){return!yE()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function Sh(){try{return typeof indexedDB=="object"}catch{return!1}}function Km(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var a;e(((a=s.error)===null||a===void 0?void 0:a.message)||"")}}catch(t){e(t)}})}function wE(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q1="FirebaseError";class dr extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=Q1,Object.setPrototypeOf(this,dr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,go.prototype.create)}}class go{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},s=`${this.service}/${e}`,a=this.errors[e],l=a?X1(a,r):"Error",d=`${this.serviceName}: ${l} (${s}).`;return new dr(s,d,r)}}function X1(n,e){return n.replace(Y1,(t,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const Y1=/\{\$([^}]+)}/g;function J1(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function is(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const s of t){if(!r.includes(s))return!1;const a=n[s],l=e[s];if(L_(a)&&L_(l)){if(!is(a,l))return!1}else if(a!==l)return!1}for(const s of r)if(!t.includes(s))return!1;return!0}function L_(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bu(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Z1(n,e){const t=new eb(n,e);return t.subscribe.bind(t)}class eb{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let s;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");tb(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:r},s.next===void 0&&(s.next=Fp),s.error===void 0&&(s.error=Fp),s.complete===void 0&&(s.complete=Fp);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function tb(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Fp(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nb=1e3,rb=2,ib=14400*1e3,sb=.5;function M_(n,e=nb,t=rb){const r=e*Math.pow(t,n),s=Math.round(sb*r*(Math.random()-.5)*2);return Math.min(ib,r+s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wt(n){return n&&n._delegate?n._delegate:n}class ur{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bs="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ob{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new B1;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(a){if(s)return null;throw a}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(lb(e))try{this.getOrInitializeService({instanceIdentifier:Bs})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const a=this.getOrInitializeService({instanceIdentifier:s});r.resolve(a)}catch{}}}}clearInstance(e=Bs){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Bs){return this.instances.has(e)}getOptions(e=Bs){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[a,l]of this.instancesDeferred.entries()){const d=this.normalizeInstanceIdentifier(a);r===d&&l.resolve(s)}return s}onInit(e,t){var r;const s=this.normalizeInstanceIdentifier(t),a=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;a.add(e),this.onInitCallbacks.set(s,a);const l=this.instances.get(s);return l&&e(l,s),()=>{a.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const s of r)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:ab(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Bs){return this.component?this.component.multipleInstances?e:Bs:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function ab(n){return n===Bs?void 0:n}function lb(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ub{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new ob(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ne;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Ne||(Ne={}));const cb={debug:Ne.DEBUG,verbose:Ne.VERBOSE,info:Ne.INFO,warn:Ne.WARN,error:Ne.ERROR,silent:Ne.SILENT},db=Ne.INFO,hb={[Ne.DEBUG]:"log",[Ne.VERBOSE]:"log",[Ne.INFO]:"info",[Ne.WARN]:"warn",[Ne.ERROR]:"error"},fb=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),s=hb[e];if(s)console[s](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class kh{constructor(e){this.name=e,this._logLevel=db,this._logHandler=fb,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ne))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?cb[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ne.DEBUG,...e),this._logHandler(this,Ne.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ne.VERBOSE,...e),this._logHandler(this,Ne.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ne.INFO,...e),this._logHandler(this,Ne.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ne.WARN,...e),this._logHandler(this,Ne.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ne.ERROR,...e),this._logHandler(this,Ne.ERROR,...e)}}const pb=(n,e)=>e.some(t=>n instanceof t);let j_,F_;function mb(){return j_||(j_=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function gb(){return F_||(F_=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const EE=new WeakMap,rm=new WeakMap,IE=new WeakMap,Up=new WeakMap,Qm=new WeakMap;function yb(n){const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("success",a),n.removeEventListener("error",l)},a=()=>{t(Ji(n.result)),s()},l=()=>{r(n.error),s()};n.addEventListener("success",a),n.addEventListener("error",l)});return e.then(t=>{t instanceof IDBCursor&&EE.set(t,n)}).catch(()=>{}),Qm.set(e,n),e}function vb(n){if(rm.has(n))return;const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("complete",a),n.removeEventListener("error",l),n.removeEventListener("abort",l)},a=()=>{t(),s()},l=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",a),n.addEventListener("error",l),n.addEventListener("abort",l)});rm.set(n,e)}let im={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return rm.get(n);if(e==="objectStoreNames")return n.objectStoreNames||IE.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Ji(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function _b(n){im=n(im)}function wb(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(Bp(this),e,...t);return IE.set(r,e.sort?e.sort():[e]),Ji(r)}:gb().includes(n)?function(...e){return n.apply(Bp(this),e),Ji(EE.get(this))}:function(...e){return Ji(n.apply(Bp(this),e))}}function Eb(n){return typeof n=="function"?wb(n):(n instanceof IDBTransaction&&vb(n),pb(n,mb())?new Proxy(n,im):n)}function Ji(n){if(n instanceof IDBRequest)return yb(n);if(Up.has(n))return Up.get(n);const e=Eb(n);return e!==n&&(Up.set(n,e),Qm.set(e,n)),e}const Bp=n=>Qm.get(n);function xE(n,e,{blocked:t,upgrade:r,blocking:s,terminated:a}={}){const l=indexedDB.open(n,e),d=Ji(l);return r&&l.addEventListener("upgradeneeded",f=>{r(Ji(l.result),f.oldVersion,f.newVersion,Ji(l.transaction),f)}),t&&l.addEventListener("blocked",f=>t(f.oldVersion,f.newVersion,f)),d.then(f=>{a&&f.addEventListener("close",()=>a()),s&&f.addEventListener("versionchange",m=>s(m.oldVersion,m.newVersion,m))}).catch(()=>{}),d}const Ib=["get","getKey","getAll","getAllKeys","count"],xb=["put","add","delete","clear"],zp=new Map;function U_(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(zp.get(e))return zp.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,s=xb.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(s||Ib.includes(t)))return;const a=async function(l,...d){const f=this.transaction(l,s?"readwrite":"readonly");let m=f.store;return r&&(m=m.index(d.shift())),(await Promise.all([m[t](...d),s&&f.done]))[0]};return zp.set(e,a),a}_b(n=>({...n,get:(e,t,r)=>U_(e,t)||n.get(e,t,r),has:(e,t)=>!!U_(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tb{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Sb(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function Sb(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const sm="@firebase/app",B_="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const li=new kh("@firebase/app"),kb="@firebase/app-compat",bb="@firebase/analytics-compat",Ab="@firebase/analytics",Rb="@firebase/app-check-compat",Cb="@firebase/app-check",Pb="@firebase/auth",Nb="@firebase/auth-compat",Db="@firebase/database",Vb="@firebase/data-connect",Ob="@firebase/database-compat",Lb="@firebase/functions",Mb="@firebase/functions-compat",jb="@firebase/installations",Fb="@firebase/installations-compat",Ub="@firebase/messaging",Bb="@firebase/messaging-compat",zb="@firebase/performance",$b="@firebase/performance-compat",qb="@firebase/remote-config",Hb="@firebase/remote-config-compat",Wb="@firebase/storage",Gb="@firebase/storage-compat",Kb="@firebase/firestore",Qb="@firebase/ai",Xb="@firebase/firestore-compat",Yb="firebase",Jb="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const om="[DEFAULT]",Zb={[sm]:"fire-core",[kb]:"fire-core-compat",[Ab]:"fire-analytics",[bb]:"fire-analytics-compat",[Cb]:"fire-app-check",[Rb]:"fire-app-check-compat",[Pb]:"fire-auth",[Nb]:"fire-auth-compat",[Db]:"fire-rtdb",[Vb]:"fire-data-connect",[Ob]:"fire-rtdb-compat",[Lb]:"fire-fn",[Mb]:"fire-fn-compat",[jb]:"fire-iid",[Fb]:"fire-iid-compat",[Ub]:"fire-fcm",[Bb]:"fire-fcm-compat",[zb]:"fire-perf",[$b]:"fire-perf-compat",[qb]:"fire-rc",[Hb]:"fire-rc-compat",[Wb]:"fire-gcs",[Gb]:"fire-gcs-compat",[Kb]:"fire-fst",[Xb]:"fire-fst-compat",[Qb]:"fire-vertex","fire-js":"fire-js",[Yb]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kd=new Map,eA=new Map,am=new Map;function z_(n,e){try{n.container.addComponent(e)}catch(t){li.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Nr(n){const e=n.name;if(am.has(e))return li.debug(`There were multiple attempts to register component ${e}.`),!1;am.set(e,n);for(const t of Kd.values())z_(t,n);for(const t of eA.values())z_(t,n);return!0}function yo(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function or(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tA={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Zi=new go("app","Firebase",tA);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nA{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new ur("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Zi.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ka=Jb;function TE(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:om,automaticDataCollectionEnabled:!0},e),s=r.name;if(typeof s!="string"||!s)throw Zi.create("bad-app-name",{appName:String(s)});if(t||(t=fE()),!t)throw Zi.create("no-options");const a=Kd.get(s);if(a){if(is(t,a.options)&&is(r,a.config))return a;throw Zi.create("duplicate-app",{appName:s})}const l=new ub(s);for(const f of am.values())l.addComponent(f);const d=new nA(t,r,l);return Kd.set(s,d),d}function Xm(n=om){const e=Kd.get(n);if(!e&&n===om&&fE())return TE();if(!e)throw Zi.create("no-app",{appName:n});return e}function Fn(n,e,t){var r;let s=(r=Zb[n])!==null&&r!==void 0?r:n;t&&(s+=`-${t}`);const a=s.match(/\s|\//),l=e.match(/\s|\//);if(a||l){const d=[`Unable to register library "${s}" with version "${e}":`];a&&d.push(`library name "${s}" contains illegal characters (whitespace or "/")`),a&&l&&d.push("and"),l&&d.push(`version name "${e}" contains illegal characters (whitespace or "/")`),li.warn(d.join(" "));return}Nr(new ur(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rA="firebase-heartbeat-database",iA=1,xu="firebase-heartbeat-store";let $p=null;function SE(){return $p||($p=xE(rA,iA,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(xu)}catch(t){console.warn(t)}}}}).catch(n=>{throw Zi.create("idb-open",{originalErrorMessage:n.message})})),$p}async function sA(n){try{const t=(await SE()).transaction(xu),r=await t.objectStore(xu).get(kE(n));return await t.done,r}catch(e){if(e instanceof dr)li.warn(e.message);else{const t=Zi.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});li.warn(t.message)}}}async function $_(n,e){try{const r=(await SE()).transaction(xu,"readwrite");await r.objectStore(xu).put(e,kE(n)),await r.done}catch(t){if(t instanceof dr)li.warn(t.message);else{const r=Zi.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});li.warn(r.message)}}}function kE(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oA=1024,aA=30;class lA{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new cA(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=q_();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(l=>l.date===a))return;if(this._heartbeatsCache.heartbeats.push({date:a,agent:s}),this._heartbeatsCache.heartbeats.length>aA){const l=dA(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){li.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=q_(),{heartbeatsToSend:r,unsentEntries:s}=uA(this._heartbeatsCache.heartbeats),a=Gd(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(t){return li.warn(t),""}}}function q_(){return new Date().toISOString().substring(0,10)}function uA(n,e=oA){const t=[];let r=n.slice();for(const s of n){const a=t.find(l=>l.agent===s.agent);if(a){if(a.dates.push(s.date),H_(t)>e){a.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),H_(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class cA{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Sh()?Km().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await sA(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return $_(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return $_(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function H_(n){return Gd(JSON.stringify({version:2,heartbeats:n})).length}function dA(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hA(n){Nr(new ur("platform-logger",e=>new Tb(e),"PRIVATE")),Nr(new ur("heartbeat",e=>new lA(e),"PRIVATE")),Fn(sm,B_,n),Fn(sm,B_,"esm2017"),Fn("fire-js","")}hA("");var W_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var es,bE;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(P,k){function R(){}R.prototype=k.prototype,P.D=k.prototype,P.prototype=new R,P.prototype.constructor=P,P.C=function(A,L,M){for(var C=Array(arguments.length-2),Pe=2;Pe<arguments.length;Pe++)C[Pe-2]=arguments[Pe];return k.prototype[L].apply(A,C)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(P,k,R){R||(R=0);var A=Array(16);if(typeof k=="string")for(var L=0;16>L;++L)A[L]=k.charCodeAt(R++)|k.charCodeAt(R++)<<8|k.charCodeAt(R++)<<16|k.charCodeAt(R++)<<24;else for(L=0;16>L;++L)A[L]=k[R++]|k[R++]<<8|k[R++]<<16|k[R++]<<24;k=P.g[0],R=P.g[1],L=P.g[2];var M=P.g[3],C=k+(M^R&(L^M))+A[0]+3614090360&4294967295;k=R+(C<<7&4294967295|C>>>25),C=M+(L^k&(R^L))+A[1]+3905402710&4294967295,M=k+(C<<12&4294967295|C>>>20),C=L+(R^M&(k^R))+A[2]+606105819&4294967295,L=M+(C<<17&4294967295|C>>>15),C=R+(k^L&(M^k))+A[3]+3250441966&4294967295,R=L+(C<<22&4294967295|C>>>10),C=k+(M^R&(L^M))+A[4]+4118548399&4294967295,k=R+(C<<7&4294967295|C>>>25),C=M+(L^k&(R^L))+A[5]+1200080426&4294967295,M=k+(C<<12&4294967295|C>>>20),C=L+(R^M&(k^R))+A[6]+2821735955&4294967295,L=M+(C<<17&4294967295|C>>>15),C=R+(k^L&(M^k))+A[7]+4249261313&4294967295,R=L+(C<<22&4294967295|C>>>10),C=k+(M^R&(L^M))+A[8]+1770035416&4294967295,k=R+(C<<7&4294967295|C>>>25),C=M+(L^k&(R^L))+A[9]+2336552879&4294967295,M=k+(C<<12&4294967295|C>>>20),C=L+(R^M&(k^R))+A[10]+4294925233&4294967295,L=M+(C<<17&4294967295|C>>>15),C=R+(k^L&(M^k))+A[11]+2304563134&4294967295,R=L+(C<<22&4294967295|C>>>10),C=k+(M^R&(L^M))+A[12]+1804603682&4294967295,k=R+(C<<7&4294967295|C>>>25),C=M+(L^k&(R^L))+A[13]+4254626195&4294967295,M=k+(C<<12&4294967295|C>>>20),C=L+(R^M&(k^R))+A[14]+2792965006&4294967295,L=M+(C<<17&4294967295|C>>>15),C=R+(k^L&(M^k))+A[15]+1236535329&4294967295,R=L+(C<<22&4294967295|C>>>10),C=k+(L^M&(R^L))+A[1]+4129170786&4294967295,k=R+(C<<5&4294967295|C>>>27),C=M+(R^L&(k^R))+A[6]+3225465664&4294967295,M=k+(C<<9&4294967295|C>>>23),C=L+(k^R&(M^k))+A[11]+643717713&4294967295,L=M+(C<<14&4294967295|C>>>18),C=R+(M^k&(L^M))+A[0]+3921069994&4294967295,R=L+(C<<20&4294967295|C>>>12),C=k+(L^M&(R^L))+A[5]+3593408605&4294967295,k=R+(C<<5&4294967295|C>>>27),C=M+(R^L&(k^R))+A[10]+38016083&4294967295,M=k+(C<<9&4294967295|C>>>23),C=L+(k^R&(M^k))+A[15]+3634488961&4294967295,L=M+(C<<14&4294967295|C>>>18),C=R+(M^k&(L^M))+A[4]+3889429448&4294967295,R=L+(C<<20&4294967295|C>>>12),C=k+(L^M&(R^L))+A[9]+568446438&4294967295,k=R+(C<<5&4294967295|C>>>27),C=M+(R^L&(k^R))+A[14]+3275163606&4294967295,M=k+(C<<9&4294967295|C>>>23),C=L+(k^R&(M^k))+A[3]+4107603335&4294967295,L=M+(C<<14&4294967295|C>>>18),C=R+(M^k&(L^M))+A[8]+1163531501&4294967295,R=L+(C<<20&4294967295|C>>>12),C=k+(L^M&(R^L))+A[13]+2850285829&4294967295,k=R+(C<<5&4294967295|C>>>27),C=M+(R^L&(k^R))+A[2]+4243563512&4294967295,M=k+(C<<9&4294967295|C>>>23),C=L+(k^R&(M^k))+A[7]+1735328473&4294967295,L=M+(C<<14&4294967295|C>>>18),C=R+(M^k&(L^M))+A[12]+2368359562&4294967295,R=L+(C<<20&4294967295|C>>>12),C=k+(R^L^M)+A[5]+4294588738&4294967295,k=R+(C<<4&4294967295|C>>>28),C=M+(k^R^L)+A[8]+2272392833&4294967295,M=k+(C<<11&4294967295|C>>>21),C=L+(M^k^R)+A[11]+1839030562&4294967295,L=M+(C<<16&4294967295|C>>>16),C=R+(L^M^k)+A[14]+4259657740&4294967295,R=L+(C<<23&4294967295|C>>>9),C=k+(R^L^M)+A[1]+2763975236&4294967295,k=R+(C<<4&4294967295|C>>>28),C=M+(k^R^L)+A[4]+1272893353&4294967295,M=k+(C<<11&4294967295|C>>>21),C=L+(M^k^R)+A[7]+4139469664&4294967295,L=M+(C<<16&4294967295|C>>>16),C=R+(L^M^k)+A[10]+3200236656&4294967295,R=L+(C<<23&4294967295|C>>>9),C=k+(R^L^M)+A[13]+681279174&4294967295,k=R+(C<<4&4294967295|C>>>28),C=M+(k^R^L)+A[0]+3936430074&4294967295,M=k+(C<<11&4294967295|C>>>21),C=L+(M^k^R)+A[3]+3572445317&4294967295,L=M+(C<<16&4294967295|C>>>16),C=R+(L^M^k)+A[6]+76029189&4294967295,R=L+(C<<23&4294967295|C>>>9),C=k+(R^L^M)+A[9]+3654602809&4294967295,k=R+(C<<4&4294967295|C>>>28),C=M+(k^R^L)+A[12]+3873151461&4294967295,M=k+(C<<11&4294967295|C>>>21),C=L+(M^k^R)+A[15]+530742520&4294967295,L=M+(C<<16&4294967295|C>>>16),C=R+(L^M^k)+A[2]+3299628645&4294967295,R=L+(C<<23&4294967295|C>>>9),C=k+(L^(R|~M))+A[0]+4096336452&4294967295,k=R+(C<<6&4294967295|C>>>26),C=M+(R^(k|~L))+A[7]+1126891415&4294967295,M=k+(C<<10&4294967295|C>>>22),C=L+(k^(M|~R))+A[14]+2878612391&4294967295,L=M+(C<<15&4294967295|C>>>17),C=R+(M^(L|~k))+A[5]+4237533241&4294967295,R=L+(C<<21&4294967295|C>>>11),C=k+(L^(R|~M))+A[12]+1700485571&4294967295,k=R+(C<<6&4294967295|C>>>26),C=M+(R^(k|~L))+A[3]+2399980690&4294967295,M=k+(C<<10&4294967295|C>>>22),C=L+(k^(M|~R))+A[10]+4293915773&4294967295,L=M+(C<<15&4294967295|C>>>17),C=R+(M^(L|~k))+A[1]+2240044497&4294967295,R=L+(C<<21&4294967295|C>>>11),C=k+(L^(R|~M))+A[8]+1873313359&4294967295,k=R+(C<<6&4294967295|C>>>26),C=M+(R^(k|~L))+A[15]+4264355552&4294967295,M=k+(C<<10&4294967295|C>>>22),C=L+(k^(M|~R))+A[6]+2734768916&4294967295,L=M+(C<<15&4294967295|C>>>17),C=R+(M^(L|~k))+A[13]+1309151649&4294967295,R=L+(C<<21&4294967295|C>>>11),C=k+(L^(R|~M))+A[4]+4149444226&4294967295,k=R+(C<<6&4294967295|C>>>26),C=M+(R^(k|~L))+A[11]+3174756917&4294967295,M=k+(C<<10&4294967295|C>>>22),C=L+(k^(M|~R))+A[2]+718787259&4294967295,L=M+(C<<15&4294967295|C>>>17),C=R+(M^(L|~k))+A[9]+3951481745&4294967295,P.g[0]=P.g[0]+k&4294967295,P.g[1]=P.g[1]+(L+(C<<21&4294967295|C>>>11))&4294967295,P.g[2]=P.g[2]+L&4294967295,P.g[3]=P.g[3]+M&4294967295}r.prototype.u=function(P,k){k===void 0&&(k=P.length);for(var R=k-this.blockSize,A=this.B,L=this.h,M=0;M<k;){if(L==0)for(;M<=R;)s(this,P,M),M+=this.blockSize;if(typeof P=="string"){for(;M<k;)if(A[L++]=P.charCodeAt(M++),L==this.blockSize){s(this,A),L=0;break}}else for(;M<k;)if(A[L++]=P[M++],L==this.blockSize){s(this,A),L=0;break}}this.h=L,this.o+=k},r.prototype.v=function(){var P=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);P[0]=128;for(var k=1;k<P.length-8;++k)P[k]=0;var R=8*this.o;for(k=P.length-8;k<P.length;++k)P[k]=R&255,R/=256;for(this.u(P),P=Array(16),k=R=0;4>k;++k)for(var A=0;32>A;A+=8)P[R++]=this.g[k]>>>A&255;return P};function a(P,k){var R=d;return Object.prototype.hasOwnProperty.call(R,P)?R[P]:R[P]=k(P)}function l(P,k){this.h=k;for(var R=[],A=!0,L=P.length-1;0<=L;L--){var M=P[L]|0;A&&M==k||(R[L]=M,A=!1)}this.g=R}var d={};function f(P){return-128<=P&&128>P?a(P,function(k){return new l([k|0],0>k?-1:0)}):new l([P|0],0>P?-1:0)}function m(P){if(isNaN(P)||!isFinite(P))return w;if(0>P)return O(m(-P));for(var k=[],R=1,A=0;P>=R;A++)k[A]=P/R|0,R*=4294967296;return new l(k,0)}function v(P,k){if(P.length==0)throw Error("number format error: empty string");if(k=k||10,2>k||36<k)throw Error("radix out of range: "+k);if(P.charAt(0)=="-")return O(v(P.substring(1),k));if(0<=P.indexOf("-"))throw Error('number format error: interior "-" character');for(var R=m(Math.pow(k,8)),A=w,L=0;L<P.length;L+=8){var M=Math.min(8,P.length-L),C=parseInt(P.substring(L,L+M),k);8>M?(M=m(Math.pow(k,M)),A=A.j(M).add(m(C))):(A=A.j(R),A=A.add(m(C)))}return A}var w=f(0),x=f(1),S=f(16777216);n=l.prototype,n.m=function(){if(F(this))return-O(this).m();for(var P=0,k=1,R=0;R<this.g.length;R++){var A=this.i(R);P+=(0<=A?A:4294967296+A)*k,k*=4294967296}return P},n.toString=function(P){if(P=P||10,2>P||36<P)throw Error("radix out of range: "+P);if(D(this))return"0";if(F(this))return"-"+O(this).toString(P);for(var k=m(Math.pow(P,6)),R=this,A="";;){var L=re(R,k).g;R=K(R,L.j(k));var M=((0<R.g.length?R.g[0]:R.h)>>>0).toString(P);if(R=L,D(R))return M+A;for(;6>M.length;)M="0"+M;A=M+A}},n.i=function(P){return 0>P?0:P<this.g.length?this.g[P]:this.h};function D(P){if(P.h!=0)return!1;for(var k=0;k<P.g.length;k++)if(P.g[k]!=0)return!1;return!0}function F(P){return P.h==-1}n.l=function(P){return P=K(this,P),F(P)?-1:D(P)?0:1};function O(P){for(var k=P.g.length,R=[],A=0;A<k;A++)R[A]=~P.g[A];return new l(R,~P.h).add(x)}n.abs=function(){return F(this)?O(this):this},n.add=function(P){for(var k=Math.max(this.g.length,P.g.length),R=[],A=0,L=0;L<=k;L++){var M=A+(this.i(L)&65535)+(P.i(L)&65535),C=(M>>>16)+(this.i(L)>>>16)+(P.i(L)>>>16);A=C>>>16,M&=65535,C&=65535,R[L]=C<<16|M}return new l(R,R[R.length-1]&-2147483648?-1:0)};function K(P,k){return P.add(O(k))}n.j=function(P){if(D(this)||D(P))return w;if(F(this))return F(P)?O(this).j(O(P)):O(O(this).j(P));if(F(P))return O(this.j(O(P)));if(0>this.l(S)&&0>P.l(S))return m(this.m()*P.m());for(var k=this.g.length+P.g.length,R=[],A=0;A<2*k;A++)R[A]=0;for(A=0;A<this.g.length;A++)for(var L=0;L<P.g.length;L++){var M=this.i(A)>>>16,C=this.i(A)&65535,Pe=P.i(L)>>>16,pt=P.i(L)&65535;R[2*A+2*L]+=C*pt,X(R,2*A+2*L),R[2*A+2*L+1]+=M*pt,X(R,2*A+2*L+1),R[2*A+2*L+1]+=C*Pe,X(R,2*A+2*L+1),R[2*A+2*L+2]+=M*Pe,X(R,2*A+2*L+2)}for(A=0;A<k;A++)R[A]=R[2*A+1]<<16|R[2*A];for(A=k;A<2*k;A++)R[A]=0;return new l(R,0)};function X(P,k){for(;(P[k]&65535)!=P[k];)P[k+1]+=P[k]>>>16,P[k]&=65535,k++}function q(P,k){this.g=P,this.h=k}function re(P,k){if(D(k))throw Error("division by zero");if(D(P))return new q(w,w);if(F(P))return k=re(O(P),k),new q(O(k.g),O(k.h));if(F(k))return k=re(P,O(k)),new q(O(k.g),k.h);if(30<P.g.length){if(F(P)||F(k))throw Error("slowDivide_ only works with positive integers.");for(var R=x,A=k;0>=A.l(P);)R=de(R),A=de(A);var L=ne(R,1),M=ne(A,1);for(A=ne(A,2),R=ne(R,2);!D(A);){var C=M.add(A);0>=C.l(P)&&(L=L.add(R),M=C),A=ne(A,1),R=ne(R,1)}return k=K(P,L.j(k)),new q(L,k)}for(L=w;0<=P.l(k);){for(R=Math.max(1,Math.floor(P.m()/k.m())),A=Math.ceil(Math.log(R)/Math.LN2),A=48>=A?1:Math.pow(2,A-48),M=m(R),C=M.j(k);F(C)||0<C.l(P);)R-=A,M=m(R),C=M.j(k);D(M)&&(M=x),L=L.add(M),P=K(P,C)}return new q(L,P)}n.A=function(P){return re(this,P).h},n.and=function(P){for(var k=Math.max(this.g.length,P.g.length),R=[],A=0;A<k;A++)R[A]=this.i(A)&P.i(A);return new l(R,this.h&P.h)},n.or=function(P){for(var k=Math.max(this.g.length,P.g.length),R=[],A=0;A<k;A++)R[A]=this.i(A)|P.i(A);return new l(R,this.h|P.h)},n.xor=function(P){for(var k=Math.max(this.g.length,P.g.length),R=[],A=0;A<k;A++)R[A]=this.i(A)^P.i(A);return new l(R,this.h^P.h)};function de(P){for(var k=P.g.length+1,R=[],A=0;A<k;A++)R[A]=P.i(A)<<1|P.i(A-1)>>>31;return new l(R,P.h)}function ne(P,k){var R=k>>5;k%=32;for(var A=P.g.length-R,L=[],M=0;M<A;M++)L[M]=0<k?P.i(M+R)>>>k|P.i(M+R+1)<<32-k:P.i(M+R);return new l(L,P.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,bE=r,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.A,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=m,l.fromString=v,es=l}).apply(typeof W_<"u"?W_:typeof self<"u"?self:typeof window<"u"?window:{});var _d=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var AE,ou,RE,Rd,lm,CE,PE,NE;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(c,g,_){return c==Array.prototype||c==Object.prototype||(c[g]=_.value),c};function t(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof _d=="object"&&_d];for(var g=0;g<c.length;++g){var _=c[g];if(_&&_.Math==Math)return _}throw Error("Cannot find global object")}var r=t(this);function s(c,g){if(g)e:{var _=r;c=c.split(".");for(var T=0;T<c.length-1;T++){var U=c[T];if(!(U in _))break e;_=_[U]}c=c[c.length-1],T=_[c],g=g(T),g!=T&&g!=null&&e(_,c,{configurable:!0,writable:!0,value:g})}}function a(c,g){c instanceof String&&(c+="");var _=0,T=!1,U={next:function(){if(!T&&_<c.length){var G=_++;return{value:g(G,c[G]),done:!1}}return T=!0,{done:!0,value:void 0}}};return U[Symbol.iterator]=function(){return U},U}s("Array.prototype.values",function(c){return c||function(){return a(this,function(g,_){return _})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var l=l||{},d=this||self;function f(c){var g=typeof c;return g=g!="object"?g:c?Array.isArray(c)?"array":g:"null",g=="array"||g=="object"&&typeof c.length=="number"}function m(c){var g=typeof c;return g=="object"&&c!=null||g=="function"}function v(c,g,_){return c.call.apply(c.bind,arguments)}function w(c,g,_){if(!c)throw Error();if(2<arguments.length){var T=Array.prototype.slice.call(arguments,2);return function(){var U=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(U,T),c.apply(g,U)}}return function(){return c.apply(g,arguments)}}function x(c,g,_){return x=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?v:w,x.apply(null,arguments)}function S(c,g){var _=Array.prototype.slice.call(arguments,1);return function(){var T=_.slice();return T.push.apply(T,arguments),c.apply(this,T)}}function D(c,g){function _(){}_.prototype=g.prototype,c.aa=g.prototype,c.prototype=new _,c.prototype.constructor=c,c.Qb=function(T,U,G){for(var oe=Array(arguments.length-2),$e=2;$e<arguments.length;$e++)oe[$e-2]=arguments[$e];return g.prototype[U].apply(T,oe)}}function F(c){const g=c.length;if(0<g){const _=Array(g);for(let T=0;T<g;T++)_[T]=c[T];return _}return[]}function O(c,g){for(let _=1;_<arguments.length;_++){const T=arguments[_];if(f(T)){const U=c.length||0,G=T.length||0;c.length=U+G;for(let oe=0;oe<G;oe++)c[U+oe]=T[oe]}else c.push(T)}}class K{constructor(g,_){this.i=g,this.j=_,this.h=0,this.g=null}get(){let g;return 0<this.h?(this.h--,g=this.g,this.g=g.next,g.next=null):g=this.i(),g}}function X(c){return/^[\s\xa0]*$/.test(c)}function q(){var c=d.navigator;return c&&(c=c.userAgent)?c:""}function re(c){return re[" "](c),c}re[" "]=function(){};var de=q().indexOf("Gecko")!=-1&&!(q().toLowerCase().indexOf("webkit")!=-1&&q().indexOf("Edge")==-1)&&!(q().indexOf("Trident")!=-1||q().indexOf("MSIE")!=-1)&&q().indexOf("Edge")==-1;function ne(c,g,_){for(const T in c)g.call(_,c[T],T,c)}function P(c,g){for(const _ in c)g.call(void 0,c[_],_,c)}function k(c){const g={};for(const _ in c)g[_]=c[_];return g}const R="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function A(c,g){let _,T;for(let U=1;U<arguments.length;U++){T=arguments[U];for(_ in T)c[_]=T[_];for(let G=0;G<R.length;G++)_=R[G],Object.prototype.hasOwnProperty.call(T,_)&&(c[_]=T[_])}}function L(c){var g=1;c=c.split(":");const _=[];for(;0<g&&c.length;)_.push(c.shift()),g--;return c.length&&_.push(c.join(":")),_}function M(c){d.setTimeout(()=>{throw c},0)}function C(){var c=we;let g=null;return c.g&&(g=c.g,c.g=c.g.next,c.g||(c.h=null),g.next=null),g}class Pe{constructor(){this.h=this.g=null}add(g,_){const T=pt.get();T.set(g,_),this.h?this.h.next=T:this.g=T,this.h=T}}var pt=new K(()=>new Rt,c=>c.reset());class Rt{constructor(){this.next=this.g=this.h=null}set(g,_){this.h=g,this.g=_,this.next=null}reset(){this.next=this.g=this.h=null}}let Ge,ae=!1,we=new Pe,ce=()=>{const c=d.Promise.resolve(void 0);Ge=()=>{c.then(j)}};var j=()=>{for(var c;c=C();){try{c.h.call(c.g)}catch(_){M(_)}var g=pt;g.j(c),100>g.h&&(g.h++,c.next=g.g,g.g=c)}ae=!1};function Y(){this.s=this.s,this.C=this.C}Y.prototype.s=!1,Y.prototype.ma=function(){this.s||(this.s=!0,this.N())},Y.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ve(c,g){this.type=c,this.g=this.target=g,this.defaultPrevented=!1}ve.prototype.h=function(){this.defaultPrevented=!0};var be=(function(){if(!d.addEventListener||!Object.defineProperty)return!1;var c=!1,g=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const _=()=>{};d.addEventListener("test",_,g),d.removeEventListener("test",_,g)}catch{}return c})();function Re(c,g){if(ve.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c){var _=this.type=c.type,T=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;if(this.target=c.target||c.srcElement,this.g=g,g=c.relatedTarget){if(de){e:{try{re(g.nodeName);var U=!0;break e}catch{}U=!1}U||(g=null)}}else _=="mouseover"?g=c.fromElement:_=="mouseout"&&(g=c.toElement);this.relatedTarget=g,T?(this.clientX=T.clientX!==void 0?T.clientX:T.pageX,this.clientY=T.clientY!==void 0?T.clientY:T.pageY,this.screenX=T.screenX||0,this.screenY=T.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=typeof c.pointerType=="string"?c.pointerType:Oe[c.pointerType]||"",this.state=c.state,this.i=c,c.defaultPrevented&&Re.aa.h.call(this)}}D(Re,ve);var Oe={2:"touch",3:"pen",4:"mouse"};Re.prototype.h=function(){Re.aa.h.call(this);var c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var Ue="closure_listenable_"+(1e6*Math.random()|0),Be=0;function Qe(c,g,_,T,U){this.listener=c,this.proxy=null,this.src=g,this.type=_,this.capture=!!T,this.ha=U,this.key=++Be,this.da=this.fa=!1}function Ct(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function jr(c){this.src=c,this.g={},this.h=0}jr.prototype.add=function(c,g,_,T,U){var G=c.toString();c=this.g[G],c||(c=this.g[G]=[],this.h++);var oe=gi(c,g,T,U);return-1<oe?(g=c[oe],_||(g.fa=!1)):(g=new Qe(g,this.src,G,!!T,U),g.fa=_,c.push(g)),g};function Eo(c,g){var _=g.type;if(_ in c.g){var T=c.g[_],U=Array.prototype.indexOf.call(T,g,void 0),G;(G=0<=U)&&Array.prototype.splice.call(T,U,1),G&&(Ct(g),c.g[_].length==0&&(delete c.g[_],c.h--))}}function gi(c,g,_,T){for(var U=0;U<c.length;++U){var G=c[U];if(!G.da&&G.listener==g&&G.capture==!!_&&G.ha==T)return U}return-1}var hs="closure_lm_"+(1e6*Math.random()|0),Io={};function il(c,g,_,T,U){if(Array.isArray(g)){for(var G=0;G<g.length;G++)il(c,g[G],_,T,U);return null}return _=al(_),c&&c[Ue]?c.K(g,_,m(T)?!!T.capture:!1,U):sl(c,g,_,!1,T,U)}function sl(c,g,_,T,U,G){if(!g)throw Error("Invalid event type");var oe=m(U)?!!U.capture:!!U,$e=To(c);if($e||(c[hs]=$e=new jr(c)),_=$e.add(g,_,T,oe,G),_.proxy)return _;if(T=nc(),_.proxy=T,T.src=c,T.listener=_,c.addEventListener)be||(U=oe),U===void 0&&(U=!1),c.addEventListener(g.toString(),T,U);else if(c.attachEvent)c.attachEvent(Ur(g.toString()),T);else if(c.addListener&&c.removeListener)c.addListener(T);else throw Error("addEventListener and attachEvent are unavailable.");return _}function nc(){function c(_){return g.call(c.src,c.listener,_)}const g=ol;return c}function xo(c,g,_,T,U){if(Array.isArray(g))for(var G=0;G<g.length;G++)xo(c,g[G],_,T,U);else T=m(T)?!!T.capture:!!T,_=al(_),c&&c[Ue]?(c=c.i,g=String(g).toString(),g in c.g&&(G=c.g[g],_=gi(G,_,T,U),-1<_&&(Ct(G[_]),Array.prototype.splice.call(G,_,1),G.length==0&&(delete c.g[g],c.h--)))):c&&(c=To(c))&&(g=c.g[g.toString()],c=-1,g&&(c=gi(g,_,T,U)),(_=-1<c?g[c]:null)&&Fr(_))}function Fr(c){if(typeof c!="number"&&c&&!c.da){var g=c.src;if(g&&g[Ue])Eo(g.i,c);else{var _=c.type,T=c.proxy;g.removeEventListener?g.removeEventListener(_,T,c.capture):g.detachEvent?g.detachEvent(Ur(_),T):g.addListener&&g.removeListener&&g.removeListener(T),(_=To(g))?(Eo(_,c),_.h==0&&(_.src=null,g[hs]=null)):Ct(c)}}}function Ur(c){return c in Io?Io[c]:Io[c]="on"+c}function ol(c,g){if(c.da)c=!0;else{g=new Re(g,this);var _=c.listener,T=c.ha||c.src;c.fa&&Fr(c),c=_.call(T,g)}return c}function To(c){return c=c[hs],c instanceof jr?c:null}var So="__closure_events_fn_"+(1e9*Math.random()>>>0);function al(c){return typeof c=="function"?c:(c[So]||(c[So]=function(g){return c.handleEvent(g)}),c[So])}function It(){Y.call(this),this.i=new jr(this),this.M=this,this.F=null}D(It,Y),It.prototype[Ue]=!0,It.prototype.removeEventListener=function(c,g,_,T){xo(this,c,g,_,T)};function xt(c,g){var _,T=c.F;if(T)for(_=[];T;T=T.F)_.push(T);if(c=c.M,T=g.type||g,typeof g=="string")g=new ve(g,c);else if(g instanceof ve)g.target=g.target||c;else{var U=g;g=new ve(T,c),A(g,U)}if(U=!0,_)for(var G=_.length-1;0<=G;G--){var oe=g.g=_[G];U=Br(oe,T,!0,g)&&U}if(oe=g.g=c,U=Br(oe,T,!0,g)&&U,U=Br(oe,T,!1,g)&&U,_)for(G=0;G<_.length;G++)oe=g.g=_[G],U=Br(oe,T,!1,g)&&U}It.prototype.N=function(){if(It.aa.N.call(this),this.i){var c=this.i,g;for(g in c.g){for(var _=c.g[g],T=0;T<_.length;T++)Ct(_[T]);delete c.g[g],c.h--}}this.F=null},It.prototype.K=function(c,g,_,T){return this.i.add(String(c),g,!1,_,T)},It.prototype.L=function(c,g,_,T){return this.i.add(String(c),g,!0,_,T)};function Br(c,g,_,T){if(g=c.i.g[String(g)],!g)return!0;g=g.concat();for(var U=!0,G=0;G<g.length;++G){var oe=g[G];if(oe&&!oe.da&&oe.capture==_){var $e=oe.listener,Tt=oe.ha||oe.src;oe.fa&&Eo(c.i,oe),U=$e.call(Tt,T)!==!1&&U}}return U&&!T.defaultPrevented}function ll(c,g,_){if(typeof c=="function")_&&(c=x(c,_));else if(c&&typeof c.handleEvent=="function")c=x(c.handleEvent,c);else throw Error("Invalid listener argument");return 2147483647<Number(g)?-1:d.setTimeout(c,g||0)}function yi(c){c.g=ll(()=>{c.g=null,c.i&&(c.i=!1,yi(c))},c.l);const g=c.h;c.h=null,c.m.apply(null,g)}class fs extends Y{constructor(g,_){super(),this.m=g,this.l=_,this.h=null,this.i=!1,this.g=null}j(g){this.h=arguments,this.g?this.i=!0:yi(this)}N(){super.N(),this.g&&(d.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ps(c){Y.call(this),this.h=c,this.g={}}D(ps,Y);var ul=[];function cl(c){ne(c.g,function(g,_){this.g.hasOwnProperty(_)&&Fr(g)},c),c.g={}}ps.prototype.N=function(){ps.aa.N.call(this),cl(this)},ps.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var dl=d.JSON.stringify,hl=d.JSON.parse,fl=class{stringify(c){return d.JSON.stringify(c,void 0)}parse(c){return d.JSON.parse(c,void 0)}};function ms(){}ms.prototype.h=null;function ko(c){return c.h||(c.h=c.i())}function bo(){}var bn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function fr(){ve.call(this,"d")}D(fr,ve);function Ao(){ve.call(this,"c")}D(Ao,ve);var pr={},pl=null;function gs(){return pl=pl||new It}pr.La="serverreachability";function ml(c){ve.call(this,pr.La,c)}D(ml,ve);function zr(c){const g=gs();xt(g,new ml(g))}pr.STAT_EVENT="statevent";function gl(c,g){ve.call(this,pr.STAT_EVENT,c),this.stat=g}D(gl,ve);function ht(c){const g=gs();xt(g,new gl(g,c))}pr.Ma="timingevent";function Ro(c,g){ve.call(this,pr.Ma,c),this.size=g}D(Ro,ve);function qn(c,g){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return d.setTimeout(function(){c()},g)}function ys(){this.g=!0}ys.prototype.xa=function(){this.g=!1};function vs(c,g,_,T,U,G){c.info(function(){if(c.g)if(G)for(var oe="",$e=G.split("&"),Tt=0;Tt<$e.length;Tt++){var Le=$e[Tt].split("=");if(1<Le.length){var Pt=Le[0];Le=Le[1];var mt=Pt.split("_");oe=2<=mt.length&&mt[1]=="type"?oe+(Pt+"="+Le+"&"):oe+(Pt+"=redacted&")}}else oe=null;else oe=G;return"XMLHTTP REQ ("+T+") [attempt "+U+"]: "+g+`
`+_+`
`+oe})}function Co(c,g,_,T,U,G,oe){c.info(function(){return"XMLHTTP RESP ("+T+") [ attempt "+U+"]: "+g+`
`+_+`
`+G+" "+oe})}function Hn(c,g,_,T){c.info(function(){return"XMLHTTP TEXT ("+g+"): "+of(c,_)+(T?" "+T:"")})}function yl(c,g){c.info(function(){return"TIMEOUT: "+g})}ys.prototype.info=function(){};function of(c,g){if(!c.g)return g;if(!g)return null;try{var _=JSON.parse(g);if(_){for(c=0;c<_.length;c++)if(Array.isArray(_[c])){var T=_[c];if(!(2>T.length)){var U=T[1];if(Array.isArray(U)&&!(1>U.length)){var G=U[0];if(G!="noop"&&G!="stop"&&G!="close")for(var oe=1;oe<U.length;oe++)U[oe]=""}}}}return dl(_)}catch{return g}}var Po={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},rc={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Wn;function _s(){}D(_s,ms),_s.prototype.g=function(){return new XMLHttpRequest},_s.prototype.i=function(){return{}},Wn=new _s;function Gn(c,g,_,T){this.j=c,this.i=g,this.l=_,this.R=T||1,this.U=new ps(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new ic}function ic(){this.i=null,this.g="",this.h=!1}var vl={},No={};function Do(c,g,_){c.L=1,c.v=Ii(gn(g)),c.m=_,c.P=!0,_l(c,null)}function _l(c,g){c.F=Date.now(),Xe(c),c.A=gn(c.v);var _=c.A,T=c.R;Array.isArray(T)||(T=[String(T)]),Ti(_.i,"t",T),c.C=0,_=c.j.J,c.h=new ic,c.g=Ic(c.j,_?g:null,!c.m),0<c.O&&(c.M=new fs(x(c.Y,c,c.g),c.O)),g=c.U,_=c.g,T=c.ca;var U="readystatechange";Array.isArray(U)||(U&&(ul[0]=U.toString()),U=ul);for(var G=0;G<U.length;G++){var oe=il(_,U[G],T||g.handleEvent,!1,g.h||g);if(!oe)break;g.g[oe.key]=oe}g=c.H?k(c.H):{},c.m?(c.u||(c.u="POST"),g["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.A,c.u,c.m,g)):(c.u="GET",c.g.ea(c.A,c.u,null,g)),zr(),vs(c.i,c.u,c.A,c.l,c.R,c.m)}Gn.prototype.ca=function(c){c=c.target;const g=this.M;g&&on(c)==3?g.j():this.Y(c)},Gn.prototype.Y=function(c){try{if(c==this.g)e:{const mt=on(this.g);var g=this.g.Ba();const Cn=this.g.Z();if(!(3>mt)&&(mt!=3||this.g&&(this.h.h||this.g.oa()||Sl(this.g)))){this.J||mt!=4||g==7||(g==8||0>=Cn?zr(3):zr(2)),ws(this);var _=this.g.Z();this.X=_;t:if(sc(this)){var T=Sl(this.g);c="";var U=T.length,G=on(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){An(this),vi(this);var oe="";break t}this.h.i=new d.TextDecoder}for(g=0;g<U;g++)this.h.h=!0,c+=this.h.i.decode(T[g],{stream:!(G&&g==U-1)});T.length=0,this.h.g+=c,this.C=0,oe=this.h.g}else oe=this.g.oa();if(this.o=_==200,Co(this.i,this.u,this.A,this.l,this.R,mt,_),this.o){if(this.T&&!this.K){t:{if(this.g){var $e,Tt=this.g;if(($e=Tt.g?Tt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!X($e)){var Le=$e;break t}}Le=null}if(_=Le)Hn(this.i,this.l,_,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,wl(this,_);else{this.o=!1,this.s=3,ht(12),An(this),vi(this);break e}}if(this.P){_=!0;let vn;for(;!this.J&&this.C<oe.length;)if(vn=af(this,oe),vn==No){mt==4&&(this.s=4,ht(14),_=!1),Hn(this.i,this.l,null,"[Incomplete Response]");break}else if(vn==vl){this.s=4,ht(15),Hn(this.i,this.l,oe,"[Invalid Chunk]"),_=!1;break}else Hn(this.i,this.l,vn,null),wl(this,vn);if(sc(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),mt!=4||oe.length!=0||this.h.h||(this.s=1,ht(16),_=!1),this.o=this.o&&_,!_)Hn(this.i,this.l,oe,"[Invalid Chunked Response]"),An(this),vi(this);else if(0<oe.length&&!this.W){this.W=!0;var Pt=this.j;Pt.g==this&&Pt.ba&&!Pt.M&&(Pt.j.info("Great, no buffering proxy detected. Bytes received: "+oe.length),bl(Pt),Pt.M=!0,ht(11))}}else Hn(this.i,this.l,oe,null),wl(this,oe);mt==4&&An(this),this.o&&!this.J&&(mt==4?qo(this.j,this):(this.o=!1,Xe(this)))}else Fo(this.g),_==400&&0<oe.indexOf("Unknown SID")?(this.s=3,ht(12)):(this.s=0,ht(13)),An(this),vi(this)}}}catch{}finally{}};function sc(c){return c.g?c.u=="GET"&&c.L!=2&&c.j.Ca:!1}function af(c,g){var _=c.C,T=g.indexOf(`
`,_);return T==-1?No:(_=Number(g.substring(_,T)),isNaN(_)?vl:(T+=1,T+_>g.length?No:(g=g.slice(T,T+_),c.C=T+_,g)))}Gn.prototype.cancel=function(){this.J=!0,An(this)};function Xe(c){c.S=Date.now()+c.I,oc(c,c.I)}function oc(c,g){if(c.B!=null)throw Error("WatchDog timer not null");c.B=qn(x(c.ba,c),g)}function ws(c){c.B&&(d.clearTimeout(c.B),c.B=null)}Gn.prototype.ba=function(){this.B=null;const c=Date.now();0<=c-this.S?(yl(this.i,this.A),this.L!=2&&(zr(),ht(17)),An(this),this.s=2,vi(this)):oc(this,this.S-c)};function vi(c){c.j.G==0||c.J||qo(c.j,c)}function An(c){ws(c);var g=c.M;g&&typeof g.ma=="function"&&g.ma(),c.M=null,cl(c.U),c.g&&(g=c.g,c.g=null,g.abort(),g.ma())}function wl(c,g){try{var _=c.j;if(_.G!=0&&(_.g==c||Yt(_.h,c))){if(!c.K&&Yt(_.h,c)&&_.G==3){try{var T=_.Da.g.parse(g)}catch{T=null}if(Array.isArray(T)&&T.length==3){var U=T;if(U[0]==0){e:if(!_.u){if(_.g)if(_.g.F+3e3<c.F)$o(_),Jn(_);else break e;zo(_),ht(18)}}else _.za=U[1],0<_.za-_.T&&37500>U[2]&&_.F&&_.v==0&&!_.C&&(_.C=qn(x(_.Za,_),6e3));if(1>=lc(_.h)&&_.ca){try{_.ca()}catch{}_.ca=void 0}}else Gr(_,11)}else if((c.K||_.g==c)&&$o(_),!X(g))for(U=_.Da.g.parse(g),g=0;g<U.length;g++){let Le=U[g];if(_.T=Le[0],Le=Le[1],_.G==2)if(Le[0]=="c"){_.K=Le[1],_.ia=Le[2];const Pt=Le[3];Pt!=null&&(_.la=Pt,_.j.info("VER="+_.la));const mt=Le[4];mt!=null&&(_.Aa=mt,_.j.info("SVER="+_.Aa));const Cn=Le[5];Cn!=null&&typeof Cn=="number"&&0<Cn&&(T=1.5*Cn,_.L=T,_.j.info("backChannelRequestTimeoutMs_="+T)),T=_;const vn=c.g;if(vn){const bs=vn.g?vn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(bs){var G=T.h;G.g||bs.indexOf("spdy")==-1&&bs.indexOf("quic")==-1&&bs.indexOf("h2")==-1||(G.j=G.l,G.g=new Set,G.h&&(El(G,G.h),G.h=null))}if(T.D){const Wo=vn.g?vn.g.getResponseHeader("X-HTTP-Session-Id"):null;Wo&&(T.ya=Wo,Ke(T.I,T.D,Wo))}}_.G=3,_.l&&_.l.ua(),_.ba&&(_.R=Date.now()-c.F,_.j.info("Handshake RTT: "+_.R+"ms")),T=_;var oe=c;if(T.qa=Ec(T,T.J?T.ia:null,T.W),oe.K){uc(T.h,oe);var $e=oe,Tt=T.L;Tt&&($e.I=Tt),$e.B&&(ws($e),Xe($e)),T.g=oe}else ks(T);0<_.i.length&&vr(_)}else Le[0]!="stop"&&Le[0]!="close"||Gr(_,7);else _.G==3&&(Le[0]=="stop"||Le[0]=="close"?Le[0]=="stop"?Gr(_,7):Mt(_):Le[0]!="noop"&&_.l&&_.l.ta(Le),_.v=0)}}zr(4)}catch{}}var ac=class{constructor(c,g){this.g=c,this.map=g}};function Es(c){this.l=c||10,d.PerformanceNavigationTiming?(c=d.performance.getEntriesByType("navigation"),c=0<c.length&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(d.chrome&&d.chrome.loadTimes&&d.chrome.loadTimes()&&d.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function mn(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function lc(c){return c.h?1:c.g?c.g.size:0}function Yt(c,g){return c.h?c.h==g:c.g?c.g.has(g):!1}function El(c,g){c.g?c.g.add(g):c.h=g}function uc(c,g){c.h&&c.h==g?c.h=null:c.g&&c.g.has(g)&&c.g.delete(g)}Es.prototype.cancel=function(){if(this.i=cc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function cc(c){if(c.h!=null)return c.i.concat(c.h.D);if(c.g!=null&&c.g.size!==0){let g=c.i;for(const _ of c.g.values())g=g.concat(_.D);return g}return F(c.i)}function Vo(c){if(c.V&&typeof c.V=="function")return c.V();if(typeof Map<"u"&&c instanceof Map||typeof Set<"u"&&c instanceof Set)return Array.from(c.values());if(typeof c=="string")return c.split("");if(f(c)){for(var g=[],_=c.length,T=0;T<_;T++)g.push(c[T]);return g}g=[],_=0;for(T in c)g[_++]=c[T];return g}function Oo(c){if(c.na&&typeof c.na=="function")return c.na();if(!c.V||typeof c.V!="function"){if(typeof Map<"u"&&c instanceof Map)return Array.from(c.keys());if(!(typeof Set<"u"&&c instanceof Set)){if(f(c)||typeof c=="string"){var g=[];c=c.length;for(var _=0;_<c;_++)g.push(_);return g}g=[],_=0;for(const T in c)g[_++]=T;return g}}}function _i(c,g){if(c.forEach&&typeof c.forEach=="function")c.forEach(g,void 0);else if(f(c)||typeof c=="string")Array.prototype.forEach.call(c,g,void 0);else for(var _=Oo(c),T=Vo(c),U=T.length,G=0;G<U;G++)g.call(void 0,T[G],_&&_[G],c)}var Is=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function lf(c,g){if(c){c=c.split("&");for(var _=0;_<c.length;_++){var T=c[_].indexOf("="),U=null;if(0<=T){var G=c[_].substring(0,T);U=c[_].substring(T+1)}else G=c[_];g(G,U?decodeURIComponent(U.replace(/\+/g," ")):"")}}}function $r(c){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,c instanceof $r){this.h=c.h,xs(this,c.j),this.o=c.o,this.g=c.g,wi(this,c.s),this.l=c.l;var g=c.i,_=new mr;_.i=g.i,g.g&&(_.g=new Map(g.g),_.h=g.h),Ei(this,_),this.m=c.m}else c&&(g=String(c).match(Is))?(this.h=!1,xs(this,g[1]||"",!0),this.o=Ve(g[2]||""),this.g=Ve(g[3]||"",!0),wi(this,g[4]),this.l=Ve(g[5]||"",!0),Ei(this,g[6]||"",!0),this.m=Ve(g[7]||"")):(this.h=!1,this.i=new mr(null,this.h))}$r.prototype.toString=function(){var c=[],g=this.j;g&&c.push(xi(g,Lo,!0),":");var _=this.g;return(_||g=="file")&&(c.push("//"),(g=this.o)&&c.push(xi(g,Lo,!0),"@"),c.push(encodeURIComponent(String(_)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_=this.s,_!=null&&c.push(":",String(_))),(_=this.l)&&(this.g&&_.charAt(0)!="/"&&c.push("/"),c.push(xi(_,_.charAt(0)=="/"?fc:hc,!0))),(_=this.i.toString())&&c.push("?",_),(_=this.m)&&c.push("#",xi(_,Il)),c.join("")};function gn(c){return new $r(c)}function xs(c,g,_){c.j=_?Ve(g,!0):g,c.j&&(c.j=c.j.replace(/:$/,""))}function wi(c,g){if(g){if(g=Number(g),isNaN(g)||0>g)throw Error("Bad port number "+g);c.s=g}else c.s=null}function Ei(c,g,_){g instanceof mr?(c.i=g,gr(c.i,c.h)):(_||(g=xi(g,pc)),c.i=new mr(g,c.h))}function Ke(c,g,_){c.i.set(g,_)}function Ii(c){return Ke(c,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),c}function Ve(c,g){return c?g?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function xi(c,g,_){return typeof c=="string"?(c=encodeURI(c).replace(g,dc),_&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function dc(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var Lo=/[#\/\?@]/g,hc=/[#\?:]/g,fc=/[#\?]/g,pc=/[#\?@]/g,Il=/#/g;function mr(c,g){this.h=this.g=null,this.i=c||null,this.j=!!g}function Lt(c){c.g||(c.g=new Map,c.h=0,c.i&&lf(c.i,function(g,_){c.add(decodeURIComponent(g.replace(/\+/g," ")),_)}))}n=mr.prototype,n.add=function(c,g){Lt(this),this.i=null,c=Rn(this,c);var _=this.g.get(c);return _||this.g.set(c,_=[]),_.push(g),this.h+=1,this};function Kn(c,g){Lt(c),g=Rn(c,g),c.g.has(g)&&(c.i=null,c.h-=c.g.get(g).length,c.g.delete(g))}function Qn(c,g){return Lt(c),g=Rn(c,g),c.g.has(g)}n.forEach=function(c,g){Lt(this),this.g.forEach(function(_,T){_.forEach(function(U){c.call(g,U,T,this)},this)},this)},n.na=function(){Lt(this);const c=Array.from(this.g.values()),g=Array.from(this.g.keys()),_=[];for(let T=0;T<g.length;T++){const U=c[T];for(let G=0;G<U.length;G++)_.push(g[T])}return _},n.V=function(c){Lt(this);let g=[];if(typeof c=="string")Qn(this,c)&&(g=g.concat(this.g.get(Rn(this,c))));else{c=Array.from(this.g.values());for(let _=0;_<c.length;_++)g=g.concat(c[_])}return g},n.set=function(c,g){return Lt(this),this.i=null,c=Rn(this,c),Qn(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[g]),this.h+=1,this},n.get=function(c,g){return c?(c=this.V(c),0<c.length?String(c[0]):g):g};function Ti(c,g,_){Kn(c,g),0<_.length&&(c.i=null,c.g.set(Rn(c,g),F(_)),c.h+=_.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],g=Array.from(this.g.keys());for(var _=0;_<g.length;_++){var T=g[_];const G=encodeURIComponent(String(T)),oe=this.V(T);for(T=0;T<oe.length;T++){var U=G;oe[T]!==""&&(U+="="+encodeURIComponent(String(oe[T]))),c.push(U)}}return this.i=c.join("&")};function Rn(c,g){return g=String(g),c.j&&(g=g.toLowerCase()),g}function gr(c,g){g&&!c.j&&(Lt(c),c.i=null,c.g.forEach(function(_,T){var U=T.toLowerCase();T!=U&&(Kn(this,T),Ti(this,U,_))},c)),c.j=g}function uf(c,g){const _=new ys;if(d.Image){const T=new Image;T.onload=S(sn,_,"TestLoadImage: loaded",!0,g,T),T.onerror=S(sn,_,"TestLoadImage: error",!1,g,T),T.onabort=S(sn,_,"TestLoadImage: abort",!1,g,T),T.ontimeout=S(sn,_,"TestLoadImage: timeout",!1,g,T),d.setTimeout(function(){T.ontimeout&&T.ontimeout()},1e4),T.src=c}else g(!1)}function mc(c,g){const _=new ys,T=new AbortController,U=setTimeout(()=>{T.abort(),sn(_,"TestPingServer: timeout",!1,g)},1e4);fetch(c,{signal:T.signal}).then(G=>{clearTimeout(U),G.ok?sn(_,"TestPingServer: ok",!0,g):sn(_,"TestPingServer: server error",!1,g)}).catch(()=>{clearTimeout(U),sn(_,"TestPingServer: error",!1,g)})}function sn(c,g,_,T,U){try{U&&(U.onload=null,U.onerror=null,U.onabort=null,U.ontimeout=null),T(_)}catch{}}function cf(){this.g=new fl}function gc(c,g,_){const T=_||"";try{_i(c,function(U,G){let oe=U;m(U)&&(oe=dl(U)),g.push(T+G+"="+encodeURIComponent(oe))})}catch(U){throw g.push(T+"type="+encodeURIComponent("_badmap")),U}}function qr(c){this.l=c.Ub||null,this.j=c.eb||!1}D(qr,ms),qr.prototype.g=function(){return new Ts(this.l,this.j)},qr.prototype.i=(function(c){return function(){return c}})({});function Ts(c,g){It.call(this),this.D=c,this.o=g,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}D(Ts,It),n=Ts.prototype,n.open=function(c,g){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=c,this.A=g,this.readyState=1,Yn(this)},n.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const g={headers:this.u,method:this.B,credentials:this.m,cache:void 0};c&&(g.body=c),(this.D||d).fetch(new Request(this.A,g)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Xn(this)),this.readyState=0},n.Sa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,Yn(this)),this.g&&(this.readyState=3,Yn(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof d.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;yc(this)}else c.text().then(this.Ra.bind(this),this.ga.bind(this))};function yc(c){c.j.read().then(c.Pa.bind(c)).catch(c.ga.bind(c))}n.Pa=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var g=c.value?c.value:new Uint8Array(0);(g=this.v.decode(g,{stream:!c.done}))&&(this.response=this.responseText+=g)}c.done?Xn(this):Yn(this),this.readyState==3&&yc(this)}},n.Ra=function(c){this.g&&(this.response=this.responseText=c,Xn(this))},n.Qa=function(c){this.g&&(this.response=c,Xn(this))},n.ga=function(){this.g&&Xn(this)};function Xn(c){c.readyState=4,c.l=null,c.j=null,c.v=null,Yn(c)}n.setRequestHeader=function(c,g){this.u.append(c,g)},n.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],g=this.h.entries();for(var _=g.next();!_.done;)_=_.value,c.push(_[0]+": "+_[1]),_=g.next();return c.join(`\r
`)};function Yn(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(Ts.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function Hr(c){let g="";return ne(c,function(_,T){g+=T,g+=":",g+=_,g+=`\r
`}),g}function Si(c,g,_){e:{for(T in _){var T=!1;break e}T=!0}T||(_=Hr(_),typeof c=="string"?_!=null&&encodeURIComponent(String(_)):Ke(c,g,_))}function et(c){It.call(this),this.headers=new Map,this.o=c||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}D(et,It);var df=/^https?$/i,xl=["POST","PUT"];n=et.prototype,n.Ha=function(c){this.J=c},n.ea=function(c,g,_,T){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);g=g?g.toUpperCase():"GET",this.D=c,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Wn.g(),this.v=this.o?ko(this.o):ko(Wn),this.g.onreadystatechange=x(this.Ea,this);try{this.B=!0,this.g.open(g,String(c),!0),this.B=!1}catch(G){Ss(this,G);return}if(c=_||"",_=new Map(this.headers),T)if(Object.getPrototypeOf(T)===Object.prototype)for(var U in T)_.set(U,T[U]);else if(typeof T.keys=="function"&&typeof T.get=="function")for(const G of T.keys())_.set(G,T.get(G));else throw Error("Unknown input type for opt_headers: "+String(T));T=Array.from(_.keys()).find(G=>G.toLowerCase()=="content-type"),U=d.FormData&&c instanceof d.FormData,!(0<=Array.prototype.indexOf.call(xl,g,void 0))||T||U||_.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[G,oe]of _)this.g.setRequestHeader(G,oe);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{jo(this),this.u=!0,this.g.send(c),this.u=!1}catch(G){Ss(this,G)}};function Ss(c,g){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=g,c.m=5,Mo(c),yn(c)}function Mo(c){c.A||(c.A=!0,xt(c,"complete"),xt(c,"error"))}n.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=c||7,xt(this,"complete"),xt(this,"abort"),yn(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),yn(this,!0)),et.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?Tl(this):this.bb())},n.bb=function(){Tl(this)};function Tl(c){if(c.h&&typeof l<"u"&&(!c.v[1]||on(c)!=4||c.Z()!=2)){if(c.u&&on(c)==4)ll(c.Ea,0,c);else if(xt(c,"readystatechange"),on(c)==4){c.h=!1;try{const oe=c.Z();e:switch(oe){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var g=!0;break e;default:g=!1}var _;if(!(_=g)){var T;if(T=oe===0){var U=String(c.D).match(Is)[1]||null;!U&&d.self&&d.self.location&&(U=d.self.location.protocol.slice(0,-1)),T=!df.test(U?U.toLowerCase():"")}_=T}if(_)xt(c,"complete"),xt(c,"success");else{c.m=6;try{var G=2<on(c)?c.g.statusText:""}catch{G=""}c.l=G+" ["+c.Z()+"]",Mo(c)}}finally{yn(c)}}}}function yn(c,g){if(c.g){jo(c);const _=c.g,T=c.v[0]?()=>{}:null;c.g=null,c.v=null,g||xt(c,"ready");try{_.onreadystatechange=T}catch{}}}function jo(c){c.I&&(d.clearTimeout(c.I),c.I=null)}n.isActive=function(){return!!this.g};function on(c){return c.g?c.g.readyState:0}n.Z=function(){try{return 2<on(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(c){if(this.g){var g=this.g.responseText;return c&&g.indexOf(c)==0&&(g=g.substring(c.length)),hl(g)}};function Sl(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.H){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function Fo(c){const g={};c=(c.g&&2<=on(c)&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let T=0;T<c.length;T++){if(X(c[T]))continue;var _=L(c[T]);const U=_[0];if(_=_[1],typeof _!="string")continue;_=_.trim();const G=g[U]||[];g[U]=G,G.push(_)}P(g,function(T){return T.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function yr(c,g,_){return _&&_.internalChannelParams&&_.internalChannelParams[c]||g}function kl(c){this.Aa=0,this.i=[],this.j=new ys,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=yr("failFast",!1,c),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=yr("baseRetryDelayMs",5e3,c),this.cb=yr("retryDelaySeedMs",1e4,c),this.Wa=yr("forwardChannelMaxRetries",2,c),this.wa=yr("forwardChannelRequestTimeoutMs",2e4,c),this.pa=c&&c.xmlHttpFactory||void 0,this.Xa=c&&c.Tb||void 0,this.Ca=c&&c.useFetchStreams||!1,this.L=void 0,this.J=c&&c.supportsCrossDomainXhr||!1,this.K="",this.h=new Es(c&&c.concurrentRequestLimit),this.Da=new cf,this.P=c&&c.fastHandshake||!1,this.O=c&&c.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=c&&c.Rb||!1,c&&c.xa&&this.j.xa(),c&&c.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&c&&c.detectBufferingProxy||!1,this.ja=void 0,c&&c.longPollingTimeout&&0<c.longPollingTimeout&&(this.ja=c.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=kl.prototype,n.la=8,n.G=1,n.connect=function(c,g,_,T){ht(0),this.W=c,this.H=g||{},_&&T!==void 0&&(this.H.OSID=_,this.H.OAID=T),this.F=this.X,this.I=Ec(this,null,this.W),vr(this)};function Mt(c){if(Uo(c),c.G==3){var g=c.U++,_=gn(c.I);if(Ke(_,"SID",c.K),Ke(_,"RID",g),Ke(_,"TYPE","terminate"),Wr(c,_),g=new Gn(c,c.j,g),g.L=2,g.v=Ii(gn(_)),_=!1,d.navigator&&d.navigator.sendBeacon)try{_=d.navigator.sendBeacon(g.v.toString(),"")}catch{}!_&&d.Image&&(new Image().src=g.v,_=!0),_||(g.g=Ic(g.j,null),g.g.ea(g.v)),g.F=Date.now(),Xe(g)}wc(c)}function Jn(c){c.g&&(bl(c),c.g.cancel(),c.g=null)}function Uo(c){Jn(c),c.u&&(d.clearTimeout(c.u),c.u=null),$o(c),c.h.cancel(),c.s&&(typeof c.s=="number"&&d.clearTimeout(c.s),c.s=null)}function vr(c){if(!mn(c.h)&&!c.s){c.s=!0;var g=c.Ga;Ge||ce(),ae||(Ge(),ae=!0),we.add(g,c),c.B=0}}function hf(c,g){return lc(c.h)>=c.h.j-(c.s?1:0)?!1:c.s?(c.i=g.D.concat(c.i),!0):c.G==1||c.G==2||c.B>=(c.Va?0:c.Wa)?!1:(c.s=qn(x(c.Ga,c,g),_c(c,c.B)),c.B++,!0)}n.Ga=function(c){if(this.s)if(this.s=null,this.G==1){if(!c){this.U=Math.floor(1e5*Math.random()),c=this.U++;const U=new Gn(this,this.j,c);let G=this.o;if(this.S&&(G?(G=k(G),A(G,this.S)):G=this.S),this.m!==null||this.O||(U.H=G,G=null),this.P)e:{for(var g=0,_=0;_<this.i.length;_++){t:{var T=this.i[_];if("__data__"in T.map&&(T=T.map.__data__,typeof T=="string")){T=T.length;break t}T=void 0}if(T===void 0)break;if(g+=T,4096<g){g=_;break e}if(g===4096||_===this.i.length-1){g=_+1;break e}}g=1e3}else g=1e3;g=ki(this,U,g),_=gn(this.I),Ke(_,"RID",c),Ke(_,"CVER",22),this.D&&Ke(_,"X-HTTP-Session-Id",this.D),Wr(this,_),G&&(this.O?g="headers="+encodeURIComponent(String(Hr(G)))+"&"+g:this.m&&Si(_,this.m,G)),El(this.h,U),this.Ua&&Ke(_,"TYPE","init"),this.P?(Ke(_,"$req",g),Ke(_,"SID","null"),U.T=!0,Do(U,_,null)):Do(U,_,g),this.G=2}}else this.G==3&&(c?Bo(this,c):this.i.length==0||mn(this.h)||Bo(this))};function Bo(c,g){var _;g?_=g.l:_=c.U++;const T=gn(c.I);Ke(T,"SID",c.K),Ke(T,"RID",_),Ke(T,"AID",c.T),Wr(c,T),c.m&&c.o&&Si(T,c.m,c.o),_=new Gn(c,c.j,_,c.B+1),c.m===null&&(_.H=c.o),g&&(c.i=g.D.concat(c.i)),g=ki(c,_,1e3),_.I=Math.round(.5*c.wa)+Math.round(.5*c.wa*Math.random()),El(c.h,_),Do(_,T,g)}function Wr(c,g){c.H&&ne(c.H,function(_,T){Ke(g,T,_)}),c.l&&_i({},function(_,T){Ke(g,T,_)})}function ki(c,g,_){_=Math.min(c.i.length,_);var T=c.l?x(c.l.Na,c.l,c):null;e:{var U=c.i;let G=-1;for(;;){const oe=["count="+_];G==-1?0<_?(G=U[0].g,oe.push("ofs="+G)):G=0:oe.push("ofs="+G);let $e=!0;for(let Tt=0;Tt<_;Tt++){let Le=U[Tt].g;const Pt=U[Tt].map;if(Le-=G,0>Le)G=Math.max(0,U[Tt].g-100),$e=!1;else try{gc(Pt,oe,"req"+Le+"_")}catch{T&&T(Pt)}}if($e){T=oe.join("&");break e}}}return c=c.i.splice(0,_),g.D=c,T}function ks(c){if(!c.g&&!c.u){c.Y=1;var g=c.Fa;Ge||ce(),ae||(Ge(),ae=!0),we.add(g,c),c.v=0}}function zo(c){return c.g||c.u||3<=c.v?!1:(c.Y++,c.u=qn(x(c.Fa,c),_c(c,c.v)),c.v++,!0)}n.Fa=function(){if(this.u=null,vc(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var c=2*this.R;this.j.info("BP detection timer enabled: "+c),this.A=qn(x(this.ab,this),c)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,ht(10),Jn(this),vc(this))};function bl(c){c.A!=null&&(d.clearTimeout(c.A),c.A=null)}function vc(c){c.g=new Gn(c,c.j,"rpc",c.Y),c.m===null&&(c.g.H=c.o),c.g.O=0;var g=gn(c.qa);Ke(g,"RID","rpc"),Ke(g,"SID",c.K),Ke(g,"AID",c.T),Ke(g,"CI",c.F?"0":"1"),!c.F&&c.ja&&Ke(g,"TO",c.ja),Ke(g,"TYPE","xmlhttp"),Wr(c,g),c.m&&c.o&&Si(g,c.m,c.o),c.L&&(c.g.I=c.L);var _=c.g;c=c.ia,_.L=1,_.v=Ii(gn(g)),_.m=null,_.P=!0,_l(_,c)}n.Za=function(){this.C!=null&&(this.C=null,Jn(this),zo(this),ht(19))};function $o(c){c.C!=null&&(d.clearTimeout(c.C),c.C=null)}function qo(c,g){var _=null;if(c.g==g){$o(c),bl(c),c.g=null;var T=2}else if(Yt(c.h,g))_=g.D,uc(c.h,g),T=1;else return;if(c.G!=0){if(g.o)if(T==1){_=g.m?g.m.length:0,g=Date.now()-g.F;var U=c.B;T=gs(),xt(T,new Ro(T,_)),vr(c)}else ks(c);else if(U=g.s,U==3||U==0&&0<g.X||!(T==1&&hf(c,g)||T==2&&zo(c)))switch(_&&0<_.length&&(g=c.h,g.i=g.i.concat(_)),U){case 1:Gr(c,5);break;case 4:Gr(c,10);break;case 3:Gr(c,6);break;default:Gr(c,2)}}}function _c(c,g){let _=c.Ta+Math.floor(Math.random()*c.cb);return c.isActive()||(_*=2),_*g}function Gr(c,g){if(c.j.info("Error code "+g),g==2){var _=x(c.fb,c),T=c.Xa;const U=!T;T=new $r(T||"//www.google.com/images/cleardot.gif"),d.location&&d.location.protocol=="http"||xs(T,"https"),Ii(T),U?uf(T.toString(),_):mc(T.toString(),_)}else ht(2);c.G=0,c.l&&c.l.sa(g),wc(c),Uo(c)}n.fb=function(c){c?(this.j.info("Successfully pinged google.com"),ht(2)):(this.j.info("Failed to ping google.com"),ht(1))};function wc(c){if(c.G=0,c.ka=[],c.l){const g=cc(c.h);(g.length!=0||c.i.length!=0)&&(O(c.ka,g),O(c.ka,c.i),c.h.i.length=0,F(c.i),c.i.length=0),c.l.ra()}}function Ec(c,g,_){var T=_ instanceof $r?gn(_):new $r(_);if(T.g!="")g&&(T.g=g+"."+T.g),wi(T,T.s);else{var U=d.location;T=U.protocol,g=g?g+"."+U.hostname:U.hostname,U=+U.port;var G=new $r(null);T&&xs(G,T),g&&(G.g=g),U&&wi(G,U),_&&(G.l=_),T=G}return _=c.D,g=c.ya,_&&g&&Ke(T,_,g),Ke(T,"VER",c.la),Wr(c,T),T}function Ic(c,g,_){if(g&&!c.J)throw Error("Can't create secondary domain capable XhrIo object.");return g=c.Ca&&!c.pa?new et(new qr({eb:_})):new et(c.pa),g.Ha(c.J),g}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Al(){}n=Al.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Ho(){}Ho.prototype.g=function(c,g){return new Jt(c,g)};function Jt(c,g){It.call(this),this.g=new kl(g),this.l=c,this.h=g&&g.messageUrlParams||null,c=g&&g.messageHeaders||null,g&&g.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=g&&g.initMessageHeaders||null,g&&g.messageContentType&&(c?c["X-WebChannel-Content-Type"]=g.messageContentType:c={"X-WebChannel-Content-Type":g.messageContentType}),g&&g.va&&(c?c["X-WebChannel-Client-Profile"]=g.va:c={"X-WebChannel-Client-Profile":g.va}),this.g.S=c,(c=g&&g.Sb)&&!X(c)&&(this.g.m=c),this.v=g&&g.supportsCrossDomainXhr||!1,this.u=g&&g.sendRawJson||!1,(g=g&&g.httpSessionIdParam)&&!X(g)&&(this.g.D=g,c=this.h,c!==null&&g in c&&(c=this.h,g in c&&delete c[g])),this.j=new _r(this)}D(Jt,It),Jt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Jt.prototype.close=function(){Mt(this.g)},Jt.prototype.o=function(c){var g=this.g;if(typeof c=="string"){var _={};_.__data__=c,c=_}else this.u&&(_={},_.__data__=dl(c),c=_);g.i.push(new ac(g.Ya++,c)),g.G==3&&vr(g)},Jt.prototype.N=function(){this.g.l=null,delete this.j,Mt(this.g),delete this.g,Jt.aa.N.call(this)};function xc(c){fr.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var g=c.__sm__;if(g){e:{for(const _ in g){c=_;break e}c=void 0}(this.i=c)&&(c=this.i,g=g!==null&&c in g?g[c]:void 0),this.data=g}else this.data=c}D(xc,fr);function Tc(){Ao.call(this),this.status=1}D(Tc,Ao);function _r(c){this.g=c}D(_r,Al),_r.prototype.ua=function(){xt(this.g,"a")},_r.prototype.ta=function(c){xt(this.g,new xc(c))},_r.prototype.sa=function(c){xt(this.g,new Tc)},_r.prototype.ra=function(){xt(this.g,"b")},Ho.prototype.createWebChannel=Ho.prototype.g,Jt.prototype.send=Jt.prototype.o,Jt.prototype.open=Jt.prototype.m,Jt.prototype.close=Jt.prototype.close,NE=function(){return new Ho},PE=function(){return gs()},CE=pr,lm={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Po.NO_ERROR=0,Po.TIMEOUT=8,Po.HTTP_ERROR=6,Rd=Po,rc.COMPLETE="complete",RE=rc,bo.EventType=bn,bn.OPEN="a",bn.CLOSE="b",bn.ERROR="c",bn.MESSAGE="d",It.prototype.listen=It.prototype.K,ou=bo,et.prototype.listenOnce=et.prototype.L,et.prototype.getLastError=et.prototype.Ka,et.prototype.getLastErrorCode=et.prototype.Ba,et.prototype.getStatus=et.prototype.Z,et.prototype.getResponseJson=et.prototype.Oa,et.prototype.getResponseText=et.prototype.oa,et.prototype.send=et.prototype.ea,et.prototype.setWithCredentials=et.prototype.Ha,AE=et}).apply(typeof _d<"u"?_d:typeof self<"u"?self:typeof window<"u"?window:{});const G_="@firebase/firestore",K_="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ut{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ut.UNAUTHENTICATED=new Ut(null),Ut.GOOGLE_CREDENTIALS=new Ut("google-credentials-uid"),Ut.FIRST_PARTY=new Ut("first-party-uid"),Ut.MOCK_USER=new Ut("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Qa="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ro=new kh("@firebase/firestore");function _a(){return ro.logLevel}function te(n,...e){if(ro.logLevel<=Ne.DEBUG){const t=e.map(Ym);ro.debug(`Firestore (${Qa}): ${n}`,...t)}}function tn(n,...e){if(ro.logLevel<=Ne.ERROR){const t=e.map(Ym);ro.error(`Firestore (${Qa}): ${n}`,...t)}}function Dr(n,...e){if(ro.logLevel<=Ne.WARN){const t=e.map(Ym);ro.warn(`Firestore (${Qa}): ${n}`,...t)}}function Ym(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pe(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,DE(n,r,t)}function DE(n,e,t){let r=`FIRESTORE (${Qa}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw tn(r),new Error(r)}function ye(n,e,t,r){let s="Unexpected state";typeof t=="string"?s=t:r=t,n||DE(e,s,r)}function ke(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class se extends dr{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ar{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VE{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class fA{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Ut.UNAUTHENTICATED)))}shutdown(){}}class pA{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class mA{constructor(e){this.t=e,this.currentUser=Ut.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){ye(this.o===void 0,42304);let r=this.i;const s=f=>this.i!==r?(r=this.i,t(f)):Promise.resolve();let a=new Ar;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new Ar,e.enqueueRetryable((()=>s(this.currentUser)))};const l=()=>{const f=a;e.enqueueRetryable((async()=>{await f.promise,await s(this.currentUser)}))},d=f=>{te("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=f,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit((f=>d(f))),setTimeout((()=>{if(!this.auth){const f=this.t.getImmediate({optional:!0});f?d(f):(te("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new Ar)}}),0),l()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(te("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ye(typeof r.accessToken=="string",31837,{l:r}),new VE(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ye(e===null||typeof e=="string",2055,{h:e}),new Ut(e)}}class gA{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Ut.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class yA{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new gA(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Ut.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class Q_{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class vA{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,or(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){ye(this.o===void 0,3512);const r=a=>{a.error!=null&&te("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const l=a.token!==this.m;return this.m=a.token,te("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?t(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable((()=>r(a)))};const s=a=>{te("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((a=>s(a))),setTimeout((()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?s(a):te("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new Q_(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(ye(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new Q_(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _A(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OE(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jm{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=_A(40);for(let a=0;a<s.length;++a)r.length<20&&s[a]<t&&(r+=e.charAt(s[a]%62))}return r}}function xe(n,e){return n<e?-1:n>e?1:0}function um(n,e){let t=0;for(;t<n.length&&t<e.length;){const r=n.codePointAt(t),s=e.codePointAt(t);if(r!==s){if(r<128&&s<128)return xe(r,s);{const a=OE(),l=wA(a.encode(X_(n,t)),a.encode(X_(e,t)));return l!==0?l:xe(r,s)}}t+=r>65535?2:1}return xe(n.length,e.length)}function X_(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function wA(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return xe(n[t],e[t]);return xe(n.length,e.length)}function Aa(n,e,t){return n.length===e.length&&n.every(((r,s)=>t(r,e[s])))}function LE(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y_="__name__";class Sr{constructor(e,t,r){t===void 0?t=0:t>e.length&&pe(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&pe(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Sr.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Sr?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let s=0;s<r;s++){const a=Sr.compareSegments(e.get(s),t.get(s));if(a!==0)return a}return xe(e.length,t.length)}static compareSegments(e,t){const r=Sr.isNumericId(e),s=Sr.isNumericId(t);return r&&!s?-1:!r&&s?1:r&&s?Sr.extractNumericId(e).compare(Sr.extractNumericId(t)):um(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return es.fromString(e.substring(4,e.length-2))}}class ze extends Sr{construct(e,t,r){return new ze(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new se(Q.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((s=>s.length>0)))}return new ze(t)}static emptyPath(){return new ze([])}}const EA=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class at extends Sr{construct(e,t,r){return new at(e,t,r)}static isValidIdentifier(e){return EA.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),at.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===Y_}static keyField(){return new at([Y_])}static fromServerFormat(e){const t=[];let r="",s=0;const a=()=>{if(r.length===0)throw new se(Q.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let l=!1;for(;s<e.length;){const d=e[s];if(d==="\\"){if(s+1===e.length)throw new se(Q.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const f=e[s+1];if(f!=="\\"&&f!=="."&&f!=="`")throw new se(Q.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=f,s+=2}else d==="`"?(l=!l,s++):d!=="."||l?(r+=d,s++):(a(),s++)}if(a(),l)throw new se(Q.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new at(t)}static emptyPath(){return new at([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class le{constructor(e){this.path=e}static fromPath(e){return new le(ze.fromString(e))}static fromName(e){return new le(ze.fromString(e).popFirst(5))}static empty(){return new le(ze.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&ze.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return ze.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new le(new ze(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ME(n,e,t){if(!t)throw new se(Q.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function IA(n,e,t,r){if(e===!0&&r===!0)throw new se(Q.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function J_(n){if(!le.isDocumentKey(n))throw new se(Q.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function Z_(n){if(le.isDocumentKey(n))throw new se(Q.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function jE(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function bh(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":pe(12329,{type:typeof n})}function nn(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new se(Q.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=bh(n);throw new se(Q.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function xA(n,e){if(e<=0)throw new se(Q.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vt(n,e){const t={typeString:n};return e&&(t.value=e),t}function zu(n,e){if(!jE(n))throw new se(Q.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const s=e[r].typeString,a="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const l=n[r];if(s&&typeof l!==s){t=`JSON field '${r}' must be a ${s}.`;break}if(a!==void 0&&l!==a.value){t=`Expected '${r}' field to equal '${a.value}'`;break}}if(t)throw new se(Q.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ew=-62135596800,tw=1e6;class qe{static now(){return qe.fromMillis(Date.now())}static fromDate(e){return qe.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*tw);return new qe(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new se(Q.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new se(Q.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<ew)throw new se(Q.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new se(Q.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/tw}_compareTo(e){return this.seconds===e.seconds?xe(this.nanoseconds,e.nanoseconds):xe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:qe._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(zu(e,qe._jsonSchema))return new qe(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-ew;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}qe._jsonSchemaVersion="firestore/timestamp/1.0",qe._jsonSchema={type:vt("string",qe._jsonSchemaVersion),seconds:vt("number"),nanoseconds:vt("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _e{static fromTimestamp(e){return new _e(e)}static min(){return new _e(new qe(0,0))}static max(){return new _e(new qe(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tu=-1;class Qd{constructor(e,t,r,s){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=s}}function cm(n){return n.fields.find((e=>e.kind===2))}function zs(n){return n.fields.filter((e=>e.kind!==2))}Qd.UNKNOWN_ID=-1;class Cd{constructor(e,t){this.fieldPath=e,this.kind=t}}class Su{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Su(0,Sn.min())}}function TA(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=_e.fromTimestamp(r===1e9?new qe(t+1,0):new qe(t,r));return new Sn(s,le.empty(),e)}function FE(n){return new Sn(n.readTime,n.key,Tu)}class Sn{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Sn(_e.min(),le.empty(),Tu)}static max(){return new Sn(_e.max(),le.empty(),Tu)}}function Zm(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=le.comparator(n.documentKey,e.documentKey),t!==0?t:xe(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UE="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class BE{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vo(n){if(n.code!==Q.FAILED_PRECONDITION||n.message!==UE)throw n;te("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&pe(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new B(((r,s)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(r,s)},this.catchCallback=a=>{this.wrapFailure(t,a).next(r,s)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof B?t:B.resolve(t)}catch(t){return B.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):B.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):B.reject(t)}static resolve(e){return new B(((t,r)=>{t(e)}))}static reject(e){return new B(((t,r)=>{r(e)}))}static waitFor(e){return new B(((t,r)=>{let s=0,a=0,l=!1;e.forEach((d=>{++s,d.next((()=>{++a,l&&a===s&&t()}),(f=>r(f)))})),l=!0,a===s&&t()}))}static or(e){let t=B.resolve(!1);for(const r of e)t=t.next((s=>s?B.resolve(s):r()));return t}static forEach(e,t){const r=[];return e.forEach(((s,a)=>{r.push(t.call(this,s,a))})),this.waitFor(r)}static mapArray(e,t){return new B(((r,s)=>{const a=e.length,l=new Array(a);let d=0;for(let f=0;f<a;f++){const m=f;t(e[m]).next((v=>{l[m]=v,++d,d===a&&r(l)}),(v=>s(v)))}}))}static doWhile(e,t){return new B(((r,s)=>{const a=()=>{e()===!0?t().next((()=>{a()}),s):r()};a()}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const In="SimpleDb";class Ah{static open(e,t,r,s){try{return new Ah(t,e.transaction(s,r))}catch(a){throw new hu(t,a)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new Ar,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new hu(e,t.error)):this.S.resolve()},this.transaction.onerror=r=>{const s=eg(r.target.error);this.S.reject(new hu(e,s))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(te(In,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}v(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new kA(t)}}class ts{static delete(e){return te(In,"Removing database:",e),qs(dE().indexedDB.deleteDatabase(e)).toPromise()}static C(){if(!Sh())return!1;if(ts.F())return!0;const e=bt(),t=ts.M(e),r=0<t&&t<10,s=zE(e),a=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||a)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.O)==="YES"}static N(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.B=r,this.L=null,ts.M(bt())===12.2&&tn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async k(e){return this.db||(te(In,"Opening database:",this.name),this.db=await new Promise(((t,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=a=>{const l=a.target.result;t(l)},s.onblocked=()=>{r(new hu(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=a=>{const l=a.target.error;l.name==="VersionError"?r(new se(Q.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):l.name==="InvalidStateError"?r(new se(Q.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+l)):r(new hu(e,l))},s.onupgradeneeded=a=>{te(In,'Database "'+this.name+'" requires upgrade from version:',a.oldVersion);const l=a.target.result;if(this.L!==null&&this.L!==a.oldVersion)throw new Error(`refusing to open IndexedDB database due to potential corruption of the IndexedDB database data; this corruption could be caused by clicking the "clear site data" button in a web browser; try reloading the web page to re-initialize the IndexedDB database: lastClosedDbVersion=${this.L}, event.oldVersion=${a.oldVersion}, event.newVersion=${a.newVersion}, db.version=${l.version}`);this.B.q(l,s.transaction,a.oldVersion,this.version).next((()=>{te(In,"Database upgrade to version "+this.version+" complete")}))}})),this.db.addEventListener("close",(t=>{const r=t.target;this.L=r.version}),{passive:!0})),this.db.addEventListener("versionchange",(t=>{var r;t.newVersion===null&&(Dr('Received "versionchange" event with newVersion===null; notifying the registered DatabaseDeletedListener, if any'),(r=this.databaseDeletedListener)===null||r===void 0||r.call(this))}),{passive:!0}),this.db}setDatabaseDeletedListener(e){if(this.databaseDeletedListener)throw new Error("setDatabaseDeletedListener() may only be called once, and it has already been called");this.databaseDeletedListener=e}async runTransaction(e,t,r,s){const a=t==="readonly";let l=0;for(;;){++l;try{this.db=await this.k(e);const d=Ah.open(this.db,e,a?"readonly":"readwrite",r),f=s(d).next((m=>(d.v(),m))).catch((m=>(d.abort(m),B.reject(m)))).toPromise();return f.catch((()=>{})),await d.D,f}catch(d){const f=d,m=f.name!=="FirebaseError"&&l<3;if(te(In,"Transaction failed with error:",f.message,"Retrying:",m),this.close(),!m)return Promise.reject(f)}}}close(){this.db&&this.db.close(),this.db=void 0}}function zE(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class SA{constructor(e){this.$=e,this.U=!1,this.K=null}get isDone(){return this.U}get W(){return this.K}set cursor(e){this.$=e}done(){this.U=!0}G(e){this.K=e}delete(){return qs(this.$.delete())}}class hu extends se{constructor(e,t){super(Q.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function cs(n){return n.name==="IndexedDbTransactionError"}class kA{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(te(In,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(te(In,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),qs(r)}add(e){return te(In,"ADD",this.store.name,e,e),qs(this.store.add(e))}get(e){return qs(this.store.get(e)).next((t=>(t===void 0&&(t=null),te(In,"GET",this.store.name,e,t),t)))}delete(e){return te(In,"DELETE",this.store.name,e),qs(this.store.delete(e))}count(){return te(In,"COUNT",this.store.name),qs(this.store.count())}j(e,t){const r=this.options(e,t),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const a=s.getAll(r.range);return new B(((l,d)=>{a.onerror=f=>{d(f.target.error)},a.onsuccess=f=>{l(f.target.result)}}))}{const a=this.cursor(r),l=[];return this.J(a,((d,f)=>{l.push(f)})).next((()=>l))}}H(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new B(((s,a)=>{r.onerror=l=>{a(l.target.error)},r.onsuccess=l=>{s(l.target.result)}}))}Y(e,t){te(In,"DELETE ALL",this.store.name);const r=this.options(e,t);r.Z=!1;const s=this.cursor(r);return this.J(s,((a,l,d)=>d.delete()))}X(e,t){let r;t?r=e:(r={},t=e);const s=this.cursor(r);return this.J(s,t)}ee(e){const t=this.cursor({});return new B(((r,s)=>{t.onerror=a=>{const l=eg(a.target.error);s(l)},t.onsuccess=a=>{const l=a.target.result;l?e(l.primaryKey,l.value).next((d=>{d?l.continue():r()})):r()}}))}J(e,t){const r=[];return new B(((s,a)=>{e.onerror=l=>{a(l.target.error)},e.onsuccess=l=>{const d=l.target.result;if(!d)return void s();const f=new SA(d),m=t(d.primaryKey,d.value,f);if(m instanceof B){const v=m.catch((w=>(f.done(),B.reject(w))));r.push(v)}f.isDone?s():f.W===null?d.continue():d.continue(f.W)}})).next((()=>B.waitFor(r)))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.Z?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function qs(n){return new B(((e,t)=>{n.onsuccess=r=>{const s=r.target.result;e(s)},n.onerror=r=>{const s=eg(r.target.error);t(s)}}))}let nw=!1;function eg(n){const e=ts.M(bt());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new se("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return nw||(nw=!0,setTimeout((()=>{throw r}),0)),r}}return n}const fu="IndexBackfiller";class bA{constructor(e,t){this.asyncQueue=e,this.te=t,this.task=null}start(){this.ne(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}ne(e){te(fu,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.te.re();te(fu,`Documents written: ${t}`)}catch(t){cs(t)?te(fu,"Ignoring IndexedDB error during index backfill: ",t):await vo(t)}await this.ne(6e4)}))}}class AA{constructor(e,t){this.localStore=e,this.persistence=t}async re(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.ie(t,e)))}ie(e,t){const r=new Set;let s=t,a=!0;return B.doWhile((()=>a===!0&&s>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((l=>{if(l!==null&&!r.has(l))return te(fu,`Processing collection: ${l}`),this.se(e,l,s).next((d=>{s-=d,r.add(l)}));a=!1})))).next((()=>t-s))}se(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((s=>this.localStore.localDocuments.getNextDocuments(e,t,s,r).next((a=>{const l=a.changes;return this.localStore.indexManager.updateIndexEntries(e,l).next((()=>this.oe(s,a))).next((d=>(te(fu,`Updating offset: ${d}`),this.localStore.indexManager.updateCollectionGroup(e,t,d)))).next((()=>l.size))}))))}oe(e,t){let r=e;return t.changes.forEach(((s,a)=>{const l=FE(a);Zm(l,r)>0&&(r=l)})),new Sn(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jn{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this._e(r),this.ae=r=>t.writeSequenceNumber(r))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}jn.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ys=-1;function Rh(n){return n==null}function ku(n){return n===0&&1/n==-1/0}function RA(n){return typeof n=="number"&&Number.isInteger(n)&&!ku(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xd="";function Xt(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=rw(e)),e=CA(n.get(t),e);return rw(e)}function CA(n,e){let t=e;const r=n.length;for(let s=0;s<r;s++){const a=n.charAt(s);switch(a){case"\0":t+="";break;case Xd:t+="";break;default:t+=a}}return t}function rw(n){return n+Xd+""}function kr(n){const e=n.length;if(ye(e>=2,64408,{path:n}),e===2)return ye(n.charAt(0)===Xd&&n.charAt(1)==="",56145,{path:n}),ze.emptyPath();const t=e-2,r=[];let s="";for(let a=0;a<e;){const l=n.indexOf(Xd,a);switch((l<0||l>t)&&pe(50515,{path:n}),n.charAt(l+1)){case"":const d=n.substring(a,l);let f;s.length===0?f=d:(s+=d,f=s,s=""),r.push(f);break;case"":s+=n.substring(a,l),s+="\0";break;case"":s+=n.substring(a,l+1);break;default:pe(61167,{path:n})}a=l+2}return new ze(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $s="remoteDocuments",$u="owner",fa="owner",bu="mutationQueues",PA="userId",sr="mutations",iw="batchId",Ks="userMutationsIndex",sw=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pd(n,e){return[n,Xt(e)]}function $E(n,e,t){return[n,Xt(e),t]}const NA={},Ra="documentMutations",Yd="remoteDocumentsV14",DA=["prefixPath","collectionGroup","readTime","documentId"],Nd="documentKeyIndex",VA=["prefixPath","collectionGroup","documentId"],qE="collectionGroupIndex",OA=["collectionGroup","readTime","prefixPath","documentId"],Au="remoteDocumentGlobal",dm="remoteDocumentGlobalKey",Ca="targets",HE="queryTargetsIndex",LA=["canonicalId","targetId"],Pa="targetDocuments",MA=["targetId","path"],tg="documentTargetsIndex",jA=["path","targetId"],Jd="targetGlobalKey",Js="targetGlobal",Ru="collectionParents",FA=["collectionId","parent"],Na="clientMetadata",UA="clientId",Ch="bundles",BA="bundleId",Ph="namedQueries",zA="name",ng="indexConfiguration",$A="indexId",hm="collectionGroupIndex",qA="collectionGroup",pu="indexState",HA=["indexId","uid"],WE="sequenceNumberIndex",WA=["uid","sequenceNumber"],mu="indexEntries",GA=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],GE="documentKeyIndex",KA=["indexId","uid","orderedDocumentKey"],Nh="documentOverlays",QA=["userId","collectionPath","documentId"],fm="collectionPathOverlayIndex",XA=["userId","collectionPath","largestBatchId"],KE="collectionGroupOverlayIndex",YA=["userId","collectionGroup","largestBatchId"],rg="globals",JA="name",QE=[bu,sr,Ra,$s,Ca,$u,Js,Pa,Na,Au,Ru,Ch,Ph],ZA=[...QE,Nh],XE=[bu,sr,Ra,Yd,Ca,$u,Js,Pa,Na,Au,Ru,Ch,Ph,Nh],YE=XE,ig=[...YE,ng,pu,mu],eR=ig,JE=[...ig,rg],tR=JE;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pm extends BE{constructor(e,t){super(),this.ce=e,this.currentSequenceNumber=t}}function At(n,e){const t=ke(n);return ts.N(t.ce,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ow(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function ds(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function ZE(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class it{constructor(e,t){this.comparator=e,this.root=t||Bt.EMPTY}insert(e,t){return new it(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Bt.BLACK,null,null))}remove(e){return new it(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Bt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return t+r.left.size;s<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new wd(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new wd(this.root,e,this.comparator,!1)}getReverseIterator(){return new wd(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new wd(this.root,e,this.comparator,!0)}}class wd{constructor(e,t,r,s){this.isReverse=s,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?r(e.key,t):1,t&&s&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Bt{constructor(e,t,r,s,a){this.key=e,this.value=t,this.color=r??Bt.RED,this.left=s??Bt.EMPTY,this.right=a??Bt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,s,a){return new Bt(e??this.key,t??this.value,r??this.color,s??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this;const a=r(e,s.key);return s=a<0?s.copy(null,null,null,s.left.insert(e,t,r),null):a===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Bt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return Bt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Bt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Bt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw pe(43730,{key:this.key,value:this.value});if(this.right.isRed())throw pe(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw pe(27949);return e+(this.isRed()?0:1)}}Bt.EMPTY=null,Bt.RED=!0,Bt.BLACK=!1;Bt.EMPTY=new class{constructor(){this.size=0}get key(){throw pe(57766)}get value(){throw pe(16141)}get color(){throw pe(16727)}get left(){throw pe(29726)}get right(){throw pe(36894)}copy(e,t,r,s,a){return this}insert(e,t,r){return new Bt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class We{constructor(e){this.comparator=e,this.data=new it(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new aw(this.data.getIterator())}getIteratorFrom(e){return new aw(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof We)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,a=r.getNext().key;if(this.comparator(s,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new We(this.comparator);return t.data=e,t}}class aw{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function pa(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fn{constructor(e){this.fields=e,e.sort(at.comparator)}static empty(){return new fn([])}unionWith(e){let t=new We(at.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new fn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Aa(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eI extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Et{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(s){try{return atob(s)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new eI("Invalid base64 string: "+a):a}})(e);return new Et(t)}static fromUint8Array(e){const t=(function(s){let a="";for(let l=0;l<s.length;++l)a+=String.fromCharCode(s[l]);return a})(e);return new Et(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return xe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Et.EMPTY_BYTE_STRING=new Et("");const nR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function ui(n){if(ye(!!n,39018),typeof n=="string"){let e=0;const t=nR.exec(n);if(ye(!!t,46558,{timestamp:n}),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:nt(n.seconds),nanos:nt(n.nanos)}}function nt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function ci(n){return typeof n=="string"?Et.fromBase64String(n):Et.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tI="server_timestamp",nI="__type__",rI="__previous_value__",iI="__local_write_time__";function sg(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[nI])===null||t===void 0?void 0:t.stringValue)===tI}function Dh(n){const e=n.mapValue.fields[rI];return sg(e)?Dh(e):e}function Cu(n){const e=ui(n.mapValue.fields[iI].timestampValue);return new qe(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rR{constructor(e,t,r,s,a,l,d,f,m,v){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=s,this.ssl=a,this.forceLongPolling=l,this.autoDetectLongPolling=d,this.longPollingOptions=f,this.useFetchStreams=m,this.isUsingEmulator=v}}const Zd="(default)";class io{constructor(e,t){this.projectId=e,this.database=t||Zd}static empty(){return new io("","")}get isDefaultDatabase(){return this.database===Zd}isEqual(e){return e instanceof io&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const og="__type__",sI="__max__",Yi={mapValue:{fields:{__type__:{stringValue:sI}}}},ag="__vector__",Da="value",Dd={nullValue:"NULL_VALUE"};function ss(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?sg(n)?4:oI(n)?9007199254740991:Vh(n)?10:11:pe(28295,{value:n})}function Vr(n,e){if(n===e)return!0;const t=ss(n);if(t!==ss(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Cu(n).isEqual(Cu(e));case 3:return(function(s,a){if(typeof s.timestampValue=="string"&&typeof a.timestampValue=="string"&&s.timestampValue.length===a.timestampValue.length)return s.timestampValue===a.timestampValue;const l=ui(s.timestampValue),d=ui(a.timestampValue);return l.seconds===d.seconds&&l.nanos===d.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(s,a){return ci(s.bytesValue).isEqual(ci(a.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(s,a){return nt(s.geoPointValue.latitude)===nt(a.geoPointValue.latitude)&&nt(s.geoPointValue.longitude)===nt(a.geoPointValue.longitude)})(n,e);case 2:return(function(s,a){if("integerValue"in s&&"integerValue"in a)return nt(s.integerValue)===nt(a.integerValue);if("doubleValue"in s&&"doubleValue"in a){const l=nt(s.doubleValue),d=nt(a.doubleValue);return l===d?ku(l)===ku(d):isNaN(l)&&isNaN(d)}return!1})(n,e);case 9:return Aa(n.arrayValue.values||[],e.arrayValue.values||[],Vr);case 10:case 11:return(function(s,a){const l=s.mapValue.fields||{},d=a.mapValue.fields||{};if(ow(l)!==ow(d))return!1;for(const f in l)if(l.hasOwnProperty(f)&&(d[f]===void 0||!Vr(l[f],d[f])))return!1;return!0})(n,e);default:return pe(52216,{left:n})}}function Pu(n,e){return(n.values||[]).find((t=>Vr(t,e)))!==void 0}function os(n,e){if(n===e)return 0;const t=ss(n),r=ss(e);if(t!==r)return xe(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return xe(n.booleanValue,e.booleanValue);case 2:return(function(a,l){const d=nt(a.integerValue||a.doubleValue),f=nt(l.integerValue||l.doubleValue);return d<f?-1:d>f?1:d===f?0:isNaN(d)?isNaN(f)?0:-1:1})(n,e);case 3:return lw(n.timestampValue,e.timestampValue);case 4:return lw(Cu(n),Cu(e));case 5:return um(n.stringValue,e.stringValue);case 6:return(function(a,l){const d=ci(a),f=ci(l);return d.compareTo(f)})(n.bytesValue,e.bytesValue);case 7:return(function(a,l){const d=a.split("/"),f=l.split("/");for(let m=0;m<d.length&&m<f.length;m++){const v=xe(d[m],f[m]);if(v!==0)return v}return xe(d.length,f.length)})(n.referenceValue,e.referenceValue);case 8:return(function(a,l){const d=xe(nt(a.latitude),nt(l.latitude));return d!==0?d:xe(nt(a.longitude),nt(l.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return uw(n.arrayValue,e.arrayValue);case 10:return(function(a,l){var d,f,m,v;const w=a.fields||{},x=l.fields||{},S=(d=w[Da])===null||d===void 0?void 0:d.arrayValue,D=(f=x[Da])===null||f===void 0?void 0:f.arrayValue,F=xe(((m=S==null?void 0:S.values)===null||m===void 0?void 0:m.length)||0,((v=D==null?void 0:D.values)===null||v===void 0?void 0:v.length)||0);return F!==0?F:uw(S,D)})(n.mapValue,e.mapValue);case 11:return(function(a,l){if(a===Yi.mapValue&&l===Yi.mapValue)return 0;if(a===Yi.mapValue)return 1;if(l===Yi.mapValue)return-1;const d=a.fields||{},f=Object.keys(d),m=l.fields||{},v=Object.keys(m);f.sort(),v.sort();for(let w=0;w<f.length&&w<v.length;++w){const x=um(f[w],v[w]);if(x!==0)return x;const S=os(d[f[w]],m[v[w]]);if(S!==0)return S}return xe(f.length,v.length)})(n.mapValue,e.mapValue);default:throw pe(23264,{le:t})}}function lw(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return xe(n,e);const t=ui(n),r=ui(e),s=xe(t.seconds,r.seconds);return s!==0?s:xe(t.nanos,r.nanos)}function uw(n,e){const t=n.values||[],r=e.values||[];for(let s=0;s<t.length&&s<r.length;++s){const a=os(t[s],r[s]);if(a)return a}return xe(t.length,r.length)}function Va(n){return mm(n)}function mm(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=ui(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return ci(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return le.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",s=!0;for(const a of t.values||[])s?s=!1:r+=",",r+=mm(a);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let s="{",a=!0;for(const l of r)a?a=!1:s+=",",s+=`${l}:${mm(t.fields[l])}`;return s+"}"})(n.mapValue):pe(61005,{value:n})}function Vd(n){switch(ss(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Dh(n);return e?16+Vd(e):16;case 5:return 2*n.stringValue.length;case 6:return ci(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((s,a)=>s+Vd(a)),0)})(n.arrayValue);case 10:case 11:return(function(r){let s=0;return ds(r.fields,((a,l)=>{s+=a.length+Vd(l)})),s})(n.mapValue);default:throw pe(13486,{value:n})}}function Nu(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function gm(n){return!!n&&"integerValue"in n}function Du(n){return!!n&&"arrayValue"in n}function cw(n){return!!n&&"nullValue"in n}function dw(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Od(n){return!!n&&"mapValue"in n}function Vh(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[og])===null||t===void 0?void 0:t.stringValue)===ag}function gu(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return ds(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=gu(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=gu(n.arrayValue.values[t]);return e}return Object.assign({},n)}function oI(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===sI}const aI={mapValue:{fields:{[og]:{stringValue:ag},[Da]:{arrayValue:{}}}}};function iR(n){return"nullValue"in n?Dd:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Nu(io.empty(),le.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Vh(n)?aI:{mapValue:{}}:pe(35942,{value:n})}function sR(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Nu(io.empty(),le.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?aI:"mapValue"in n?Vh(n)?{mapValue:{}}:Yi:pe(61959,{value:n})}function hw(n,e){const t=os(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function fw(n,e){const t=os(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kt{constructor(e){this.value=e}static empty(){return new Kt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!Od(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=gu(t)}setAll(e){let t=at.emptyPath(),r={},s=[];e.forEach(((l,d)=>{if(!t.isImmediateParentOf(d)){const f=this.getFieldsMap(t);this.applyChanges(f,r,s),r={},s=[],t=d.popLast()}l?r[d.lastSegment()]=gu(l):s.push(d.lastSegment())}));const a=this.getFieldsMap(t);this.applyChanges(a,r,s)}delete(e){const t=this.field(e.popLast());Od(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Vr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=t.mapValue.fields[e.get(r)];Od(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,r){ds(t,((s,a)=>e[s]=a));for(const s of r)delete e[s]}clone(){return new Kt(gu(this.value))}}function lI(n){const e=[];return ds(n.fields,((t,r)=>{const s=new at([t]);if(Od(r)){const a=lI(r.mapValue).fields;if(a.length===0)e.push(s);else for(const l of a)e.push(s.child(l))}else e.push(s)})),new fn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ct{constructor(e,t,r,s,a,l,d){this.key=e,this.documentType=t,this.version=r,this.readTime=s,this.createTime=a,this.data=l,this.documentState=d}static newInvalidDocument(e){return new ct(e,0,_e.min(),_e.min(),_e.min(),Kt.empty(),0)}static newFoundDocument(e,t,r,s){return new ct(e,1,t,_e.min(),r,s,0)}static newNoDocument(e,t){return new ct(e,2,t,_e.min(),_e.min(),Kt.empty(),0)}static newUnknownDocument(e,t){return new ct(e,3,t,_e.min(),_e.min(),Kt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(_e.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Kt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Kt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=_e.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ct&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ct(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oa{constructor(e,t){this.position=e,this.inclusive=t}}function pw(n,e,t){let r=0;for(let s=0;s<n.position.length;s++){const a=e[s],l=n.position[s];if(a.field.isKeyField()?r=le.comparator(le.fromName(l.referenceValue),t.key):r=os(l,t.data.field(a.field)),a.dir==="desc"&&(r*=-1),r!==0)break}return r}function mw(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!Vr(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vu{constructor(e,t="asc"){this.field=e,this.dir=t}}function oR(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uI{}class De extends uI{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new aR(e,t,r):t==="array-contains"?new cR(e,r):t==="in"?new mI(e,r):t==="not-in"?new dR(e,r):t==="array-contains-any"?new hR(e,r):new De(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new lR(e,r):new uR(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(os(t,this.value)):t!==null&&ss(this.value)===ss(t)&&this.matchesComparison(os(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return pe(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class He extends uI{constructor(e,t){super(),this.filters=e,this.op=t,this.he=null}static create(e,t){return new He(e,t)}matches(e){return La(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function La(n){return n.op==="and"}function ym(n){return n.op==="or"}function lg(n){return cI(n)&&La(n)}function cI(n){for(const e of n.filters)if(e instanceof He)return!1;return!0}function vm(n){if(n instanceof De)return n.field.canonicalString()+n.op.toString()+Va(n.value);if(lg(n))return n.filters.map((e=>vm(e))).join(",");{const e=n.filters.map((t=>vm(t))).join(",");return`${n.op}(${e})`}}function dI(n,e){return n instanceof De?(function(r,s){return s instanceof De&&r.op===s.op&&r.field.isEqual(s.field)&&Vr(r.value,s.value)})(n,e):n instanceof He?(function(r,s){return s instanceof He&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce(((a,l,d)=>a&&dI(l,s.filters[d])),!0):!1})(n,e):void pe(19439)}function hI(n,e){const t=n.filters.concat(e);return He.create(t,n.op)}function fI(n){return n instanceof De?(function(t){return`${t.field.canonicalString()} ${t.op} ${Va(t.value)}`})(n):n instanceof He?(function(t){return t.op.toString()+" {"+t.getFilters().map(fI).join(" ,")+"}"})(n):"Filter"}class aR extends De{constructor(e,t,r){super(e,t,r),this.key=le.fromName(r.referenceValue)}matches(e){const t=le.comparator(e.key,this.key);return this.matchesComparison(t)}}class lR extends De{constructor(e,t){super(e,"in",t),this.keys=pI("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class uR extends De{constructor(e,t){super(e,"not-in",t),this.keys=pI("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function pI(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map((r=>le.fromName(r.referenceValue)))}class cR extends De{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Du(t)&&Pu(t.arrayValue,this.value)}}class mI extends De{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Pu(this.value.arrayValue,t)}}class dR extends De{constructor(e,t){super(e,"not-in",t)}matches(e){if(Pu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Pu(this.value.arrayValue,t)}}class hR extends De{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Du(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>Pu(this.value.arrayValue,r)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fR{constructor(e,t=null,r=[],s=[],a=null,l=null,d=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=s,this.limit=a,this.startAt=l,this.endAt=d,this.Pe=null}}function _m(n,e=null,t=[],r=[],s=null,a=null,l=null){return new fR(n,e,t,r,s,a,l)}function so(n){const e=ke(n);if(e.Pe===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>vm(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(a){return a.field.canonicalString()+a.dir})(r))).join(","),Rh(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>Va(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>Va(r))).join(",")),e.Pe=t}return e.Pe}function qu(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!oR(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!dI(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!mw(n.startAt,e.startAt)&&mw(n.endAt,e.endAt)}function eh(n){return le.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function th(n,e){return n.filters.filter((t=>t instanceof De&&t.field.isEqual(e)))}function gw(n,e,t){let r=Dd,s=!0;for(const a of th(n,e)){let l=Dd,d=!0;switch(a.op){case"<":case"<=":l=iR(a.value);break;case"==":case"in":case">=":l=a.value;break;case">":l=a.value,d=!1;break;case"!=":case"not-in":l=Dd}hw({value:r,inclusive:s},{value:l,inclusive:d})<0&&(r=l,s=d)}if(t!==null){for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const l=t.position[a];hw({value:r,inclusive:s},{value:l,inclusive:t.inclusive})<0&&(r=l,s=t.inclusive);break}}return{value:r,inclusive:s}}function yw(n,e,t){let r=Yi,s=!0;for(const a of th(n,e)){let l=Yi,d=!0;switch(a.op){case">=":case">":l=sR(a.value),d=!1;break;case"==":case"in":case"<=":l=a.value;break;case"<":l=a.value,d=!1;break;case"!=":case"not-in":l=Yi}fw({value:r,inclusive:s},{value:l,inclusive:d})>0&&(r=l,s=d)}if(t!==null){for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const l=t.position[a];fw({value:r,inclusive:s},{value:l,inclusive:t.inclusive})>0&&(r=l,s=t.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xa{constructor(e,t=null,r=[],s=[],a=null,l="F",d=null,f=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=s,this.limit=a,this.limitType=l,this.startAt=d,this.endAt=f,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function pR(n,e,t,r,s,a,l,d){return new Xa(n,e,t,r,s,a,l,d)}function Hu(n){return new Xa(n)}function vw(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function gI(n){return n.collectionGroup!==null}function yu(n){const e=ke(n);if(e.Te===null){e.Te=[];const t=new Set;for(const a of e.explicitOrderBy)e.Te.push(a),t.add(a.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(l){let d=new We(at.comparator);return l.filters.forEach((f=>{f.getFlattenedFilters().forEach((m=>{m.isInequality()&&(d=d.add(m.field))}))})),d})(e).forEach((a=>{t.has(a.canonicalString())||a.isKeyField()||e.Te.push(new Vu(a,r))})),t.has(at.keyField().canonicalString())||e.Te.push(new Vu(at.keyField(),r))}return e.Te}function Un(n){const e=ke(n);return e.Ie||(e.Ie=mR(e,yu(n))),e.Ie}function mR(n,e){if(n.limitType==="F")return _m(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((s=>{const a=s.dir==="desc"?"asc":"desc";return new Vu(s.field,a)}));const t=n.endAt?new Oa(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Oa(n.startAt.position,n.startAt.inclusive):null;return _m(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function wm(n,e){const t=n.filters.concat([e]);return new Xa(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function nh(n,e,t){return new Xa(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Oh(n,e){return qu(Un(n),Un(e))&&n.limitType===e.limitType}function yI(n){return`${so(Un(n))}|lt:${n.limitType}`}function wa(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((s=>fI(s))).join(", ")}]`),Rh(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((s=>(function(l){return`${l.field.canonicalString()} (${l.dir})`})(s))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((s=>Va(s))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((s=>Va(s))).join(",")),`Target(${r})`})(Un(n))}; limitType=${n.limitType})`}function Wu(n,e){return e.isFoundDocument()&&(function(r,s){const a=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(a):le.isDocumentKey(r.path)?r.path.isEqual(a):r.path.isImmediateParentOf(a)})(n,e)&&(function(r,s){for(const a of yu(r))if(!a.field.isKeyField()&&s.data.field(a.field)===null)return!1;return!0})(n,e)&&(function(r,s){for(const a of r.filters)if(!a.matches(s))return!1;return!0})(n,e)&&(function(r,s){return!(r.startAt&&!(function(l,d,f){const m=pw(l,d,f);return l.inclusive?m<=0:m<0})(r.startAt,yu(r),s)||r.endAt&&!(function(l,d,f){const m=pw(l,d,f);return l.inclusive?m>=0:m>0})(r.endAt,yu(r),s))})(n,e)}function gR(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function vI(n){return(e,t)=>{let r=!1;for(const s of yu(n)){const a=yR(s,e,t);if(a!==0)return a;r=r||s.field.isKeyField()}return 0}}function yR(n,e,t){const r=n.field.isKeyField()?le.comparator(e.key,t.key):(function(a,l,d){const f=l.data.field(a),m=d.data.field(a);return f!==null&&m!==null?os(f,m):pe(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return pe(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hi{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[s,a]of r)if(this.equalsFn(s,e))return a}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let a=0;a<s.length;a++)if(this.equalsFn(s[a][0],e))return void(s[a]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[t]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){ds(this.inner,((t,r)=>{for(const[s,a]of r)e(s,a)}))}isEmpty(){return ZE(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vR=new it(le.comparator);function xn(){return vR}const _I=new it(le.comparator);function au(...n){let e=_I;for(const t of n)e=e.insert(t.key,t);return e}function wI(n){let e=_I;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function br(){return vu()}function EI(){return vu()}function vu(){return new hi((n=>n.toString()),((n,e)=>n.isEqual(e)))}const _R=new it(le.comparator),wR=new We(le.comparator);function Ae(...n){let e=wR;for(const t of n)e=e.add(t);return e}const ER=new We(xe);function IR(){return ER}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ug(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:ku(e)?"-0":e}}function II(n){return{integerValue:""+n}}function xR(n,e){return RA(e)?II(e):ug(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lh{constructor(){this._=void 0}}function TR(n,e,t){return n instanceof Ma?(function(s,a){const l={fields:{[nI]:{stringValue:tI},[iI]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return a&&sg(a)&&(a=Dh(a)),a&&(l.fields[rI]=a),{mapValue:l}})(t,e):n instanceof ja?TI(n,e):n instanceof Fa?SI(n,e):(function(s,a){const l=xI(s,a),d=_w(l)+_w(s.Ee);return gm(l)&&gm(s.Ee)?II(d):ug(s.serializer,d)})(n,e)}function SR(n,e,t){return n instanceof ja?TI(n,e):n instanceof Fa?SI(n,e):t}function xI(n,e){return n instanceof Ou?(function(r){return gm(r)||(function(a){return!!a&&"doubleValue"in a})(r)})(e)?e:{integerValue:0}:null}class Ma extends Lh{}class ja extends Lh{constructor(e){super(),this.elements=e}}function TI(n,e){const t=kI(e);for(const r of n.elements)t.some((s=>Vr(s,r)))||t.push(r);return{arrayValue:{values:t}}}class Fa extends Lh{constructor(e){super(),this.elements=e}}function SI(n,e){let t=kI(e);for(const r of n.elements)t=t.filter((s=>!Vr(s,r)));return{arrayValue:{values:t}}}class Ou extends Lh{constructor(e,t){super(),this.serializer=e,this.Ee=t}}function _w(n){return nt(n.integerValue||n.doubleValue)}function kI(n){return Du(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bI{constructor(e,t){this.field=e,this.transform=t}}function kR(n,e){return n.field.isEqual(e.field)&&(function(r,s){return r instanceof ja&&s instanceof ja||r instanceof Fa&&s instanceof Fa?Aa(r.elements,s.elements,Vr):r instanceof Ou&&s instanceof Ou?Vr(r.Ee,s.Ee):r instanceof Ma&&s instanceof Ma})(n.transform,e.transform)}class bR{constructor(e,t){this.version=e,this.transformResults=t}}class Qt{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Qt}static exists(e){return new Qt(void 0,e)}static updateTime(e){return new Qt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ld(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Mh{}function AI(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new jh(n.key,Qt.none()):new Ya(n.key,n.data,Qt.none());{const t=n.data,r=Kt.empty();let s=new We(at.comparator);for(let a of e.fields)if(!s.has(a)){let l=t.field(a);l===null&&a.length>1&&(a=a.popLast(),l=t.field(a)),l===null?r.delete(a):r.set(a,l),s=s.add(a)}return new fi(n.key,r,new fn(s.toArray()),Qt.none())}}function AR(n,e,t){n instanceof Ya?(function(s,a,l){const d=s.value.clone(),f=Ew(s.fieldTransforms,a,l.transformResults);d.setAll(f),a.convertToFoundDocument(l.version,d).setHasCommittedMutations()})(n,e,t):n instanceof fi?(function(s,a,l){if(!Ld(s.precondition,a))return void a.convertToUnknownDocument(l.version);const d=Ew(s.fieldTransforms,a,l.transformResults),f=a.data;f.setAll(RI(s)),f.setAll(d),a.convertToFoundDocument(l.version,f).setHasCommittedMutations()})(n,e,t):(function(s,a,l){a.convertToNoDocument(l.version).setHasCommittedMutations()})(0,e,t)}function _u(n,e,t,r){return n instanceof Ya?(function(a,l,d,f){if(!Ld(a.precondition,l))return d;const m=a.value.clone(),v=Iw(a.fieldTransforms,f,l);return m.setAll(v),l.convertToFoundDocument(l.version,m).setHasLocalMutations(),null})(n,e,t,r):n instanceof fi?(function(a,l,d,f){if(!Ld(a.precondition,l))return d;const m=Iw(a.fieldTransforms,f,l),v=l.data;return v.setAll(RI(a)),v.setAll(m),l.convertToFoundDocument(l.version,v).setHasLocalMutations(),d===null?null:d.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map((w=>w.field)))})(n,e,t,r):(function(a,l,d){return Ld(a.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):d})(n,e,t)}function RR(n,e){let t=null;for(const r of n.fieldTransforms){const s=e.data.field(r.field),a=xI(r.transform,s||null);a!=null&&(t===null&&(t=Kt.empty()),t.set(r.field,a))}return t||null}function ww(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Aa(r,s,((a,l)=>kR(a,l)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Ya extends Mh{constructor(e,t,r,s=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class fi extends Mh{constructor(e,t,r,s,a=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=s,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function RI(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function Ew(n,e,t){const r=new Map;ye(n.length===t.length,32656,{Ae:t.length,Re:n.length});for(let s=0;s<t.length;s++){const a=n[s],l=a.transform,d=e.data.field(a.field);r.set(a.field,SR(l,d,t[s]))}return r}function Iw(n,e,t){const r=new Map;for(const s of n){const a=s.transform,l=t.data.field(s.field);r.set(s.field,TR(a,l,e))}return r}class jh extends Mh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class CI extends Mh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cg{constructor(e,t,r,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const a=this.mutations[s];a.key.isEqual(e.key)&&AR(a,e,r[s])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=_u(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=_u(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=EI();return this.mutations.forEach((s=>{const a=e.get(s.key),l=a.overlayedDocument;let d=this.applyToLocalView(l,a.mutatedFields);d=t.has(s.key)?null:d;const f=AI(l,d);f!==null&&r.set(s.key,f),l.isValidDocument()||l.convertToNoDocument(_e.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Ae())}isEqual(e){return this.batchId===e.batchId&&Aa(this.mutations,e.mutations,((t,r)=>ww(t,r)))&&Aa(this.baseMutations,e.baseMutations,((t,r)=>ww(t,r)))}}class dg{constructor(e,t,r,s){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=s}static from(e,t,r){ye(e.mutations.length===r.length,58842,{Ve:e.mutations.length,me:r.length});let s=(function(){return _R})();const a=e.mutations;for(let l=0;l<a.length;l++)s=s.insert(a[l].key,r[l].version);return new dg(e,t,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hg{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CR{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var yt,Me;function PR(n){switch(n){case Q.OK:return pe(64938);case Q.CANCELLED:case Q.UNKNOWN:case Q.DEADLINE_EXCEEDED:case Q.RESOURCE_EXHAUSTED:case Q.INTERNAL:case Q.UNAVAILABLE:case Q.UNAUTHENTICATED:return!1;case Q.INVALID_ARGUMENT:case Q.NOT_FOUND:case Q.ALREADY_EXISTS:case Q.PERMISSION_DENIED:case Q.FAILED_PRECONDITION:case Q.ABORTED:case Q.OUT_OF_RANGE:case Q.UNIMPLEMENTED:case Q.DATA_LOSS:return!0;default:return pe(15467,{code:n})}}function PI(n){if(n===void 0)return tn("GRPC error has no .code"),Q.UNKNOWN;switch(n){case yt.OK:return Q.OK;case yt.CANCELLED:return Q.CANCELLED;case yt.UNKNOWN:return Q.UNKNOWN;case yt.DEADLINE_EXCEEDED:return Q.DEADLINE_EXCEEDED;case yt.RESOURCE_EXHAUSTED:return Q.RESOURCE_EXHAUSTED;case yt.INTERNAL:return Q.INTERNAL;case yt.UNAVAILABLE:return Q.UNAVAILABLE;case yt.UNAUTHENTICATED:return Q.UNAUTHENTICATED;case yt.INVALID_ARGUMENT:return Q.INVALID_ARGUMENT;case yt.NOT_FOUND:return Q.NOT_FOUND;case yt.ALREADY_EXISTS:return Q.ALREADY_EXISTS;case yt.PERMISSION_DENIED:return Q.PERMISSION_DENIED;case yt.FAILED_PRECONDITION:return Q.FAILED_PRECONDITION;case yt.ABORTED:return Q.ABORTED;case yt.OUT_OF_RANGE:return Q.OUT_OF_RANGE;case yt.UNIMPLEMENTED:return Q.UNIMPLEMENTED;case yt.DATA_LOSS:return Q.DATA_LOSS;default:return pe(39323,{code:n})}}(Me=yt||(yt={}))[Me.OK=0]="OK",Me[Me.CANCELLED=1]="CANCELLED",Me[Me.UNKNOWN=2]="UNKNOWN",Me[Me.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Me[Me.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Me[Me.NOT_FOUND=5]="NOT_FOUND",Me[Me.ALREADY_EXISTS=6]="ALREADY_EXISTS",Me[Me.PERMISSION_DENIED=7]="PERMISSION_DENIED",Me[Me.UNAUTHENTICATED=16]="UNAUTHENTICATED",Me[Me.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Me[Me.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Me[Me.ABORTED=10]="ABORTED",Me[Me.OUT_OF_RANGE=11]="OUT_OF_RANGE",Me[Me.UNIMPLEMENTED=12]="UNIMPLEMENTED",Me[Me.INTERNAL=13]="INTERNAL",Me[Me.UNAVAILABLE=14]="UNAVAILABLE",Me[Me.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NR=new es([4294967295,4294967295],0);function xw(n){const e=OE().encode(n),t=new bE;return t.update(e),new Uint8Array(t.digest())}function Tw(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new es([t,r],0),new es([s,a],0)]}class fg{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new lu(`Invalid padding: ${t}`);if(r<0)throw new lu(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new lu(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new lu(`Invalid padding when bitmap length is 0: ${t}`);this.fe=8*e.length-t,this.ge=es.fromNumber(this.fe)}pe(e,t,r){let s=e.add(t.multiply(es.fromNumber(r)));return s.compare(NR)===1&&(s=new es([s.getBits(0),s.getBits(1)],0)),s.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;const t=xw(e),[r,s]=Tw(t);for(let a=0;a<this.hashCount;a++){const l=this.pe(r,s,a);if(!this.ye(l))return!1}return!0}static create(e,t,r){const s=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),l=new fg(a,s,t);return r.forEach((d=>l.insert(d))),l}insert(e){if(this.fe===0)return;const t=xw(e),[r,s]=Tw(t);for(let a=0;a<this.hashCount;a++){const l=this.pe(r,s,a);this.we(l)}}we(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class lu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fh{constructor(e,t,r,s,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const s=new Map;return s.set(e,Gu.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Fh(_e.min(),s,new it(xe),xn(),Ae())}}class Gu{constructor(e,t,r,s,a){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Gu(r,t,Ae(),Ae(),Ae())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Md{constructor(e,t,r,s){this.Se=e,this.removedTargetIds=t,this.key=r,this.be=s}}class NI{constructor(e,t){this.targetId=e,this.De=t}}class DI{constructor(e,t,r=Et.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=s}}class Sw{constructor(){this.ve=0,this.Ce=kw(),this.Fe=Et.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=Ae(),t=Ae(),r=Ae();return this.Ce.forEach(((s,a)=>{switch(a){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:r=r.add(s);break;default:pe(38017,{changeType:a})}})),new Gu(this.Fe,this.Me,e,t,r)}ke(){this.xe=!1,this.Ce=kw()}qe(e,t){this.xe=!0,this.Ce=this.Ce.insert(e,t)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,ye(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class DR{constructor(e){this.We=e,this.Ge=new Map,this.ze=xn(),this.je=Ed(),this.Je=Ed(),this.He=new it(xe)}Ye(e){for(const t of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(t,e.be):this.Xe(t,e.key,e.be);for(const t of e.removedTargetIds)this.Xe(t,e.key,e.be)}et(e){this.forEachTarget(e,(t=>{const r=this.tt(t);switch(e.state){case 0:this.nt(t)&&r.Be(e.resumeToken);break;case 1:r.Ue(),r.Oe||r.ke(),r.Be(e.resumeToken);break;case 2:r.Ue(),r.Oe||this.removeTarget(t);break;case 3:this.nt(t)&&(r.Ke(),r.Be(e.resumeToken));break;case 4:this.nt(t)&&(this.rt(t),r.Be(e.resumeToken));break;default:pe(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ge.forEach(((r,s)=>{this.nt(s)&&t(s)}))}it(e){const t=e.targetId,r=e.De.count,s=this.st(t);if(s){const a=s.target;if(eh(a))if(r===0){const l=new le(a.path);this.Xe(t,l,ct.newNoDocument(l,_e.min()))}else ye(r===1,20013,{expectedCount:r});else{const l=this.ot(t);if(l!==r){const d=this._t(e),f=d?this.ut(d,e,l):1;if(f!==0){this.rt(t);const m=f===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(t,m)}}}}}_t(e){const t=e.De.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:a=0}=t;let l,d;try{l=ci(r).toUint8Array()}catch(f){if(f instanceof eI)return Dr("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw f}try{d=new fg(l,s,a)}catch(f){return Dr(f instanceof lu?"BloomFilter error: ":"Applying bloom filter failed: ",f),null}return d.fe===0?null:d}ut(e,t,r){return t.De.count===r-this.ht(e,t.targetId)?0:2}ht(e,t){const r=this.We.getRemoteKeysForTarget(t);let s=0;return r.forEach((a=>{const l=this.We.lt(),d=`projects/${l.projectId}/databases/${l.database}/documents/${a.path.canonicalString()}`;e.mightContain(d)||(this.Xe(t,a,null),s++)})),s}Pt(e){const t=new Map;this.Ge.forEach(((a,l)=>{const d=this.st(l);if(d){if(a.current&&eh(d.target)){const f=new le(d.target.path);this.Tt(f).has(l)||this.It(l,f)||this.Xe(l,f,ct.newNoDocument(f,e))}a.Ne&&(t.set(l,a.Le()),a.ke())}}));let r=Ae();this.Je.forEach(((a,l)=>{let d=!0;l.forEachWhile((f=>{const m=this.st(f);return!m||m.purpose==="TargetPurposeLimboResolution"||(d=!1,!1)})),d&&(r=r.add(a))})),this.ze.forEach(((a,l)=>l.setReadTime(e)));const s=new Fh(e,t,this.He,this.ze,r);return this.ze=xn(),this.je=Ed(),this.Je=Ed(),this.He=new it(xe),s}Ze(e,t){if(!this.nt(e))return;const r=this.It(e,t.key)?2:0;this.tt(e).qe(t.key,r),this.ze=this.ze.insert(t.key,t),this.je=this.je.insert(t.key,this.Tt(t.key).add(e)),this.Je=this.Je.insert(t.key,this.dt(t.key).add(e))}Xe(e,t,r){if(!this.nt(e))return;const s=this.tt(e);this.It(e,t)?s.qe(t,1):s.Qe(t),this.Je=this.Je.insert(t,this.dt(t).delete(e)),this.Je=this.Je.insert(t,this.dt(t).add(e)),r&&(this.ze=this.ze.insert(t,r))}removeTarget(e){this.Ge.delete(e)}ot(e){const t=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let t=this.Ge.get(e);return t||(t=new Sw,this.Ge.set(e,t)),t}dt(e){let t=this.Je.get(e);return t||(t=new We(xe),this.Je=this.Je.insert(e,t)),t}Tt(e){let t=this.je.get(e);return t||(t=new We(xe),this.je=this.je.insert(e,t)),t}nt(e){const t=this.st(e)!==null;return t||te("WatchChangeAggregator","Detected inactive target",e),t}st(e){const t=this.Ge.get(e);return t&&t.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new Sw),this.We.getRemoteKeysForTarget(e).forEach((t=>{this.Xe(e,t,null)}))}It(e,t){return this.We.getRemoteKeysForTarget(e).has(t)}}function Ed(){return new it(le.comparator)}function kw(){return new it(le.comparator)}const VR={asc:"ASCENDING",desc:"DESCENDING"},OR={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},LR={and:"AND",or:"OR"};class MR{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Em(n,e){return n.useProto3Json||Rh(e)?e:{value:e}}function Ua(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function VI(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function jR(n,e){return Ua(n,e.toTimestamp())}function rn(n){return ye(!!n,49232),_e.fromTimestamp((function(t){const r=ui(t);return new qe(r.seconds,r.nanos)})(n))}function pg(n,e){return Im(n,e).canonicalString()}function Im(n,e){const t=(function(s){return new ze(["projects",s.projectId,"databases",s.database])})(n).child("documents");return e===void 0?t:t.child(e)}function OI(n){const e=ze.fromString(n);return ye(qI(e),10190,{key:e.toString()}),e}function rh(n,e){return pg(n.databaseId,e.path)}function Zs(n,e){const t=OI(e);if(t.get(1)!==n.databaseId.projectId)throw new se(Q.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new se(Q.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new le(jI(t))}function LI(n,e){return pg(n.databaseId,e)}function MI(n){const e=OI(n);return e.length===4?ze.emptyPath():jI(e)}function xm(n){return new ze(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function jI(n){return ye(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function bw(n,e,t){return{name:rh(n,e),fields:t.value.mapValue.fields}}function FR(n,e,t){const r=Zs(n,e.name),s=rn(e.updateTime),a=e.createTime?rn(e.createTime):_e.min(),l=new Kt({mapValue:{fields:e.fields}}),d=ct.newFoundDocument(r,s,a,l);return t&&d.setHasCommittedMutations(),t?d.setHasCommittedMutations():d}function UR(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:pe(39313,{state:m})})(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],a=(function(m,v){return m.useProto3Json?(ye(v===void 0||typeof v=="string",58123),Et.fromBase64String(v||"")):(ye(v===void 0||v instanceof Buffer||v instanceof Uint8Array,16193),Et.fromUint8Array(v||new Uint8Array))})(n,e.targetChange.resumeToken),l=e.targetChange.cause,d=l&&(function(m){const v=m.code===void 0?Q.UNKNOWN:PI(m.code);return new se(v,m.message||"")})(l);t=new DI(r,s,a,d||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Zs(n,r.document.name),a=rn(r.document.updateTime),l=r.document.createTime?rn(r.document.createTime):_e.min(),d=new Kt({mapValue:{fields:r.document.fields}}),f=ct.newFoundDocument(s,a,l,d),m=r.targetIds||[],v=r.removedTargetIds||[];t=new Md(m,v,f.key,f)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Zs(n,r.document),a=r.readTime?rn(r.readTime):_e.min(),l=ct.newNoDocument(s,a),d=r.removedTargetIds||[];t=new Md([],d,l.key,l)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Zs(n,r.document),a=r.removedTargetIds||[];t=new Md([],a,s,null)}else{if(!("filter"in e))return pe(11601,{At:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:a}=r,l=new CR(s,a),d=r.targetId;t=new NI(d,l)}}return t}function ih(n,e){let t;if(e instanceof Ya)t={update:bw(n,e.key,e.value)};else if(e instanceof jh)t={delete:rh(n,e.key)};else if(e instanceof fi)t={update:bw(n,e.key,e.data),updateMask:WR(e.fieldMask)};else{if(!(e instanceof CI))return pe(16599,{Rt:e.type});t={verify:rh(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(a,l){const d=l.transform;if(d instanceof Ma)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(d instanceof ja)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:d.elements}};if(d instanceof Fa)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:d.elements}};if(d instanceof Ou)return{fieldPath:l.field.canonicalString(),increment:d.Ee};throw pe(20930,{transform:l.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(s,a){return a.updateTime!==void 0?{updateTime:jR(s,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:pe(27497)})(n,e.precondition)),t}function Tm(n,e){const t=e.currentDocument?(function(a){return a.updateTime!==void 0?Qt.updateTime(rn(a.updateTime)):a.exists!==void 0?Qt.exists(a.exists):Qt.none()})(e.currentDocument):Qt.none(),r=e.updateTransforms?e.updateTransforms.map((s=>(function(l,d){let f=null;if("setToServerValue"in d)ye(d.setToServerValue==="REQUEST_TIME",16630,{proto:d}),f=new Ma;else if("appendMissingElements"in d){const v=d.appendMissingElements.values||[];f=new ja(v)}else if("removeAllFromArray"in d){const v=d.removeAllFromArray.values||[];f=new Fa(v)}else"increment"in d?f=new Ou(l,d.increment):pe(16584,{proto:d});const m=at.fromServerFormat(d.fieldPath);return new bI(m,f)})(n,s))):[];if(e.update){e.update.name;const s=Zs(n,e.update.name),a=new Kt({mapValue:{fields:e.update.fields}});if(e.updateMask){const l=(function(f){const m=f.fieldPaths||[];return new fn(m.map((v=>at.fromServerFormat(v))))})(e.updateMask);return new fi(s,a,l,t,r)}return new Ya(s,a,t,r)}if(e.delete){const s=Zs(n,e.delete);return new jh(s,t)}if(e.verify){const s=Zs(n,e.verify);return new CI(s,t)}return pe(1463,{proto:e})}function BR(n,e){return n&&n.length>0?(ye(e!==void 0,14353),n.map((t=>(function(s,a){let l=s.updateTime?rn(s.updateTime):rn(a);return l.isEqual(_e.min())&&(l=rn(a)),new bR(l,s.transformResults||[])})(t,e)))):[]}function FI(n,e){return{documents:[LI(n,e.path)]}}function UI(n,e){const t={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=LI(n,s);const a=(function(m){if(m.length!==0)return $I(He.create(m,"and"))})(e.filters);a&&(t.structuredQuery.where=a);const l=(function(m){if(m.length!==0)return m.map((v=>(function(x){return{field:Ea(x.field),direction:$R(x.dir)}})(v)))})(e.orderBy);l&&(t.structuredQuery.orderBy=l);const d=Em(n,e.limit);return d!==null&&(t.structuredQuery.limit=d),e.startAt&&(t.structuredQuery.startAt=(function(m){return{before:m.inclusive,values:m.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(m){return{before:!m.inclusive,values:m.position}})(e.endAt)),{Vt:t,parent:s}}function BI(n){let e=MI(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let s=null;if(r>0){ye(r===1,65062);const v=t.from[0];v.allDescendants?s=v.collectionId:e=e.child(v.collectionId)}let a=[];t.where&&(a=(function(w){const x=zI(w);return x instanceof He&&lg(x)?x.getFilters():[x]})(t.where));let l=[];t.orderBy&&(l=(function(w){return w.map((x=>(function(D){return new Vu(Ia(D.field),(function(O){switch(O){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(D.direction))})(x)))})(t.orderBy));let d=null;t.limit&&(d=(function(w){let x;return x=typeof w=="object"?w.value:w,Rh(x)?null:x})(t.limit));let f=null;t.startAt&&(f=(function(w){const x=!!w.before,S=w.values||[];return new Oa(S,x)})(t.startAt));let m=null;return t.endAt&&(m=(function(w){const x=!w.before,S=w.values||[];return new Oa(S,x)})(t.endAt)),pR(e,s,l,a,d,"F",f,m)}function zR(n,e){const t=(function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return pe(28987,{purpose:s})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function zI(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=Ia(t.unaryFilter.field);return De.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Ia(t.unaryFilter.field);return De.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=Ia(t.unaryFilter.field);return De.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=Ia(t.unaryFilter.field);return De.create(l,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return pe(61313);default:return pe(60726)}})(n):n.fieldFilter!==void 0?(function(t){return De.create(Ia(t.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return pe(58110);default:return pe(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return He.create(t.compositeFilter.filters.map((r=>zI(r))),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return pe(1026)}})(t.compositeFilter.op))})(n):pe(30097,{filter:n})}function $R(n){return VR[n]}function qR(n){return OR[n]}function HR(n){return LR[n]}function Ea(n){return{fieldPath:n.canonicalString()}}function Ia(n){return at.fromServerFormat(n.fieldPath)}function $I(n){return n instanceof De?(function(t){if(t.op==="=="){if(dw(t.value))return{unaryFilter:{field:Ea(t.field),op:"IS_NAN"}};if(cw(t.value))return{unaryFilter:{field:Ea(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(dw(t.value))return{unaryFilter:{field:Ea(t.field),op:"IS_NOT_NAN"}};if(cw(t.value))return{unaryFilter:{field:Ea(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ea(t.field),op:qR(t.op),value:t.value}}})(n):n instanceof He?(function(t){const r=t.getFilters().map((s=>$I(s)));return r.length===1?r[0]:{compositeFilter:{op:HR(t.op),filters:r}}})(n):pe(54877,{filter:n})}function WR(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function qI(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ri{constructor(e,t,r,s,a=_e.min(),l=_e.min(),d=Et.EMPTY_BYTE_STRING,f=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=d,this.expectedCount=f}withSequenceNumber(e){return new ri(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new ri(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ri(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ri(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HI{constructor(e){this.gt=e}}function GR(n,e){let t;if(e.document)t=FR(n.gt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=le.fromSegments(e.noDocument.path),s=ao(e.noDocument.readTime);t=ct.newNoDocument(r,s),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return pe(56709);{const r=le.fromSegments(e.unknownDocument.path),s=ao(e.unknownDocument.version);t=ct.newUnknownDocument(r,s)}}return e.readTime&&t.setReadTime((function(s){const a=new qe(s[0],s[1]);return _e.fromTimestamp(a)})(e.readTime)),t}function Aw(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:sh(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=(function(a,l){return{name:rh(a,l.key),fields:l.data.value.mapValue.fields,updateTime:Ua(a,l.version.toTimestamp()),createTime:Ua(a,l.createTime.toTimestamp())}})(n.gt,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:oo(e.version)};else{if(!e.isUnknownDocument())return pe(57904,{document:e});r.unknownDocument={path:t.path.toArray(),version:oo(e.version)}}return r}function sh(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function oo(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function ao(n){const e=new qe(n.seconds,n.nanoseconds);return _e.fromTimestamp(e)}function Hs(n,e){const t=(e.baseMutations||[]).map((a=>Tm(n.gt,a)));for(let a=0;a<e.mutations.length-1;++a){const l=e.mutations[a];if(a+1<e.mutations.length&&e.mutations[a+1].transform!==void 0){const d=e.mutations[a+1];l.updateTransforms=d.transform.fieldTransforms,e.mutations.splice(a+1,1),++a}}const r=e.mutations.map((a=>Tm(n.gt,a))),s=qe.fromMillis(e.localWriteTimeMs);return new cg(e.batchId,s,t,r)}function uu(n){const e=ao(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?ao(n.lastLimboFreeSnapshotVersion):_e.min();let r;return r=(function(a){return a.documents!==void 0})(n.query)?(function(a){const l=a.documents.length;return ye(l===1,1966,{count:l}),Un(Hu(MI(a.documents[0])))})(n.query):(function(a){return Un(BI(a))})(n.query),new ri(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,Et.fromBase64String(n.resumeToken))}function WI(n,e){const t=oo(e.snapshotVersion),r=oo(e.lastLimboFreeSnapshotVersion);let s;s=eh(e.target)?FI(n.gt,e.target):UI(n.gt,e.target).Vt;const a=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:so(e.target),readTime:t,resumeToken:a,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function GI(n){const e=BI({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?nh(e,e.limit,"L"):e}function qp(n,e){return new hg(e.largestBatchId,Tm(n.gt,e.overlayMutation))}function Rw(n,e){const t=e.path.lastSegment();return[n,Xt(e.path.popLast()),t]}function Cw(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:oo(r.readTime),documentKey:Xt(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KR{getBundleMetadata(e,t){return Pw(e).get(t).next((r=>{if(r)return(function(a){return{id:a.bundleId,createTime:ao(a.createTime),version:a.version}})(r)}))}saveBundleMetadata(e,t){return Pw(e).put((function(s){return{bundleId:s.id,createTime:oo(rn(s.createTime)),version:s.version}})(t))}getNamedQuery(e,t){return Nw(e).get(t).next((r=>{if(r)return(function(a){return{name:a.name,query:GI(a.bundledQuery),readTime:ao(a.readTime)}})(r)}))}saveNamedQuery(e,t){return Nw(e).put((function(s){return{name:s.name,readTime:oo(rn(s.readTime)),bundledQuery:s.bundledQuery}})(t))}}function Pw(n){return At(n,Ch)}function Nw(n){return At(n,Ph)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uh{constructor(e,t){this.serializer=e,this.userId=t}static yt(e,t){const r=t.uid||"";return new Uh(e,r)}getOverlay(e,t){return eu(e).get(Rw(this.userId,t)).next((r=>r?qp(this.serializer,r):null))}getOverlays(e,t){const r=br();return B.forEach(t,(s=>this.getOverlay(e,s).next((a=>{a!==null&&r.set(s,a)})))).next((()=>r))}saveOverlays(e,t,r){const s=[];return r.forEach(((a,l)=>{const d=new hg(t,l);s.push(this.wt(e,d))})),B.waitFor(s)}removeOverlaysForBatchId(e,t,r){const s=new Set;t.forEach((l=>s.add(Xt(l.getCollectionPath()))));const a=[];return s.forEach((l=>{const d=IDBKeyRange.bound([this.userId,l,r],[this.userId,l,r+1],!1,!0);a.push(eu(e).Y(fm,d))})),B.waitFor(a)}getOverlaysForCollection(e,t,r){const s=br(),a=Xt(t),l=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,Number.POSITIVE_INFINITY],!0);return eu(e).j(fm,l).next((d=>{for(const f of d){const m=qp(this.serializer,f);s.set(m.getKey(),m)}return s}))}getOverlaysForCollectionGroup(e,t,r,s){const a=br();let l;const d=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return eu(e).X({index:KE,range:d},((f,m,v)=>{const w=qp(this.serializer,m);a.size()<s||w.largestBatchId===l?(a.set(w.getKey(),w),l=w.largestBatchId):v.done()})).next((()=>a))}wt(e,t){return eu(e).put((function(s,a,l){const[d,f,m]=Rw(a,l.mutation.key);return{userId:a,collectionPath:f,documentId:m,collectionGroup:l.mutation.key.getCollectionGroup(),largestBatchId:l.largestBatchId,overlayMutation:ih(s.gt,l.mutation)}})(this.serializer,this.userId,t))}}function eu(n){return At(n,Nh)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QR{St(e){return At(e,rg)}getSessionToken(e){return this.St(e).get("sessionToken").next((t=>{const r=t==null?void 0:t.value;return r?Et.fromUint8Array(r):Et.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.St(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ws{constructor(){}bt(e,t){this.Dt(e,t),t.vt()}Dt(e,t){if("nullValue"in e)this.Ct(t,5);else if("booleanValue"in e)this.Ct(t,10),t.Ft(e.booleanValue?1:0);else if("integerValue"in e)this.Ct(t,15),t.Ft(nt(e.integerValue));else if("doubleValue"in e){const r=nt(e.doubleValue);isNaN(r)?this.Ct(t,13):(this.Ct(t,15),ku(r)?t.Ft(0):t.Ft(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ct(t,20),typeof r=="string"&&(r=ui(r)),t.Mt(`${r.seconds||""}`),t.Ft(r.nanos||0)}else if("stringValue"in e)this.xt(e.stringValue,t),this.Ot(t);else if("bytesValue"in e)this.Ct(t,30),t.Nt(ci(e.bytesValue)),this.Ot(t);else if("referenceValue"in e)this.Bt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ct(t,45),t.Ft(r.latitude||0),t.Ft(r.longitude||0)}else"mapValue"in e?oI(e)?this.Ct(t,Number.MAX_SAFE_INTEGER):Vh(e)?this.Lt(e.mapValue,t):(this.kt(e.mapValue,t),this.Ot(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Ot(t)):pe(19022,{Qt:e})}xt(e,t){this.Ct(t,25),this.$t(e,t)}$t(e,t){t.Mt(e)}kt(e,t){const r=e.fields||{};this.Ct(t,55);for(const s of Object.keys(r))this.xt(s,t),this.Dt(r[s],t)}Lt(e,t){var r,s;const a=e.fields||{};this.Ct(t,53);const l=Da,d=((s=(r=a[l].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.length)||0;this.Ct(t,15),t.Ft(nt(d)),this.xt(l,t),this.Dt(a[l],t)}qt(e,t){const r=e.values||[];this.Ct(t,50);for(const s of r)this.Dt(s,t)}Bt(e,t){this.Ct(t,37),le.fromName(e).path.forEach((r=>{this.Ct(t,60),this.$t(r,t)}))}Ct(e,t){e.Ft(t)}Ot(e){e.Ft(2)}}Ws.Ut=new Ws;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ma=255;function XR(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function Dw(n){const e=64-(function(r){let s=0;for(let a=0;a<8;++a){const l=XR(255&r[a]);if(s+=l,l!==8)break}return s})(n);return Math.ceil(e/8)}class YR{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Kt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Wt(r.value),r=t.next();this.Gt()}zt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.jt(r.value),r=t.next();this.Jt()}Ht(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Wt(r);else if(r<2048)this.Wt(960|r>>>6),this.Wt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Wt(480|r>>>12),this.Wt(128|63&r>>>6),this.Wt(128|63&r);else{const s=t.codePointAt(0);this.Wt(240|s>>>18),this.Wt(128|63&s>>>12),this.Wt(128|63&s>>>6),this.Wt(128|63&s)}}this.Gt()}Yt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.jt(r);else if(r<2048)this.jt(960|r>>>6),this.jt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.jt(480|r>>>12),this.jt(128|63&r>>>6),this.jt(128|63&r);else{const s=t.codePointAt(0);this.jt(240|s>>>18),this.jt(128|63&s>>>12),this.jt(128|63&s>>>6),this.jt(128|63&s)}}this.Jt()}Zt(e){const t=this.Xt(e),r=Dw(t);this.en(1+r),this.buffer[this.position++]=255&r;for(let s=t.length-r;s<t.length;++s)this.buffer[this.position++]=255&t[s]}tn(e){const t=this.Xt(e),r=Dw(t);this.en(1+r),this.buffer[this.position++]=~(255&r);for(let s=t.length-r;s<t.length;++s)this.buffer[this.position++]=~(255&t[s])}nn(){this.rn(ma),this.rn(255)}sn(){this._n(ma),this._n(255)}reset(){this.position=0}seed(e){this.en(e.length),this.buffer.set(e,this.position),this.position+=e.length}an(){return this.buffer.slice(0,this.position)}Xt(e){const t=(function(a){const l=new DataView(new ArrayBuffer(8));return l.setFloat64(0,a,!1),new Uint8Array(l.buffer)})(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let s=1;s<t.length;++s)t[s]^=r?255:0;return t}Wt(e){const t=255&e;t===0?(this.rn(0),this.rn(255)):t===ma?(this.rn(ma),this.rn(0)):this.rn(t)}jt(e){const t=255&e;t===0?(this._n(0),this._n(255)):t===ma?(this._n(ma),this._n(0)):this._n(e)}Gt(){this.rn(0),this.rn(1)}Jt(){this._n(0),this._n(1)}rn(e){this.en(1),this.buffer[this.position++]=e}_n(e){this.en(1),this.buffer[this.position++]=~e}en(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class JR{constructor(e){this.un=e}Nt(e){this.un.Kt(e)}Mt(e){this.un.Ht(e)}Ft(e){this.un.Zt(e)}vt(){this.un.nn()}}class ZR{constructor(e){this.un=e}Nt(e){this.un.zt(e)}Mt(e){this.un.Yt(e)}Ft(e){this.un.tn(e)}vt(){this.un.sn()}}class tu{constructor(){this.un=new YR,this.cn=new JR(this.un),this.ln=new ZR(this.un)}seed(e){this.un.seed(e)}hn(e){return e===0?this.cn:this.ln}an(){return this.un.an()}reset(){this.un.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gs{constructor(e,t,r,s){this.Pn=e,this.Tn=t,this.In=r,this.dn=s}En(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.dn,0),t!==e?r.set([0],this.dn.length):++r[r.length-1],new Gs(this.Pn,this.Tn,this.In,r)}An(e,t,r){return{indexId:this.Pn,uid:e,arrayValue:jd(this.In),directionalValue:jd(this.dn),orderedDocumentKey:jd(t),documentKey:r.path.toArray()}}Rn(e,t,r){const s=this.An(e,t,r);return[s.indexId,s.uid,s.arrayValue,s.directionalValue,s.orderedDocumentKey,s.documentKey]}}function Bi(n,e){let t=n.Pn-e.Pn;return t!==0?t:(t=Vw(n.In,e.In),t!==0?t:(t=Vw(n.dn,e.dn),t!==0?t:le.comparator(n.Tn,e.Tn)))}function Vw(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}function jd(n){return _E()?(function(t){let r="";for(let s=0;s<t.length;s++)r+=String.fromCharCode(t[s]);return r})(n):n}function Ow(n){return typeof n!="string"?n:(function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r})(n)}class Lw{constructor(e){this.Vn=new We(((t,r)=>at.comparator(t.field,r.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.mn=e.orderBy,this.fn=[];for(const t of e.filters){const r=t;r.isInequality()?this.Vn=this.Vn.add(r):this.fn.push(r)}}get gn(){return this.Vn.size>1}pn(e){if(ye(e.collectionGroup===this.collectionId,49279),this.gn)return!1;const t=cm(e);if(t!==void 0&&!this.yn(t))return!1;const r=zs(e);let s=new Set,a=0,l=0;for(;a<r.length&&this.yn(r[a]);++a)s=s.add(r[a].fieldPath.canonicalString());if(a===r.length)return!0;if(this.Vn.size>0){const d=this.Vn.getIterator().getNext();if(!s.has(d.field.canonicalString())){const f=r[a];if(!this.wn(d,f)||!this.Sn(this.mn[l++],f))return!1}++a}for(;a<r.length;++a){const d=r[a];if(l>=this.mn.length||!this.Sn(this.mn[l++],d))return!1}return!0}bn(){if(this.gn)return null;let e=new We(at.comparator);const t=[];for(const r of this.fn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new Cd(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new Cd(r.field,0))}for(const r of this.mn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new Cd(r.field,r.dir==="asc"?0:1)));return new Qd(Qd.UNKNOWN_ID,this.collectionId,t,Su.empty())}yn(e){for(const t of this.fn)if(this.wn(t,e))return!0;return!1}wn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}Sn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KI(n){var e,t;if(ye(n instanceof De||n instanceof He,20012),n instanceof De){if(n instanceof mI){const s=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map((a=>De.create(n.field,"==",a))))||[];return He.create(s,"or")}return n}const r=n.filters.map((s=>KI(s)));return He.create(r,n.op)}function eC(n){if(n.getFilters().length===0)return[];const e=bm(KI(n));return ye(QI(e),7391),Sm(e)||km(e)?[e]:e.getFilters()}function Sm(n){return n instanceof De}function km(n){return n instanceof He&&lg(n)}function QI(n){return Sm(n)||km(n)||(function(t){if(t instanceof He&&ym(t)){for(const r of t.getFilters())if(!Sm(r)&&!km(r))return!1;return!0}return!1})(n)}function bm(n){if(ye(n instanceof De||n instanceof He,34018),n instanceof De)return n;if(n.filters.length===1)return bm(n.filters[0]);const e=n.filters.map((r=>bm(r)));let t=He.create(e,n.op);return t=oh(t),QI(t)?t:(ye(t instanceof He,64498),ye(La(t),40251),ye(t.filters.length>1,57927),t.filters.reduce(((r,s)=>mg(r,s))))}function mg(n,e){let t;return ye(n instanceof De||n instanceof He,38388),ye(e instanceof De||e instanceof He,25473),t=n instanceof De?e instanceof De?(function(s,a){return He.create([s,a],"and")})(n,e):Mw(n,e):e instanceof De?Mw(e,n):(function(s,a){if(ye(s.filters.length>0&&a.filters.length>0,48005),La(s)&&La(a))return hI(s,a.getFilters());const l=ym(s)?s:a,d=ym(s)?a:s,f=l.filters.map((m=>mg(m,d)));return He.create(f,"or")})(n,e),oh(t)}function Mw(n,e){if(La(e))return hI(e,n.getFilters());{const t=e.filters.map((r=>mg(n,r)));return He.create(t,"or")}}function oh(n){if(ye(n instanceof De||n instanceof He,11850),n instanceof De)return n;const e=n.getFilters();if(e.length===1)return oh(e[0]);if(cI(n))return n;const t=e.map((s=>oh(s))),r=[];return t.forEach((s=>{s instanceof De?r.push(s):s instanceof He&&(s.op===n.op?r.push(...s.filters):r.push(s))})),r.length===1?r[0]:He.create(r,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tC{constructor(){this.Dn=new gg}addToCollectionParentIndex(e,t){return this.Dn.add(t),B.resolve()}getCollectionParents(e,t){return B.resolve(this.Dn.getEntries(t))}addFieldIndex(e,t){return B.resolve()}deleteFieldIndex(e,t){return B.resolve()}deleteAllFieldIndexes(e){return B.resolve()}createTargetIndexes(e,t){return B.resolve()}getDocumentsMatchingTarget(e,t){return B.resolve(null)}getIndexType(e,t){return B.resolve(0)}getFieldIndexes(e,t){return B.resolve([])}getNextCollectionGroupToUpdate(e){return B.resolve(null)}getMinOffset(e,t){return B.resolve(Sn.min())}getMinOffsetFromCollectionGroup(e,t){return B.resolve(Sn.min())}updateCollectionGroup(e,t,r){return B.resolve()}updateIndexEntries(e,t){return B.resolve()}}class gg{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t]||new We(ze.comparator),a=!s.has(r);return this.index[t]=s.add(r),a}has(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t];return s&&s.has(r)}getEntries(e){return(this.index[e]||new We(ze.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jw="IndexedDbIndexManager",Id=new Uint8Array(0);class nC{constructor(e,t){this.databaseId=t,this.vn=new gg,this.Cn=new hi((r=>so(r)),((r,s)=>qu(r,s))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const r=t.lastSegment(),s=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const a={collectionId:r,parent:Xt(s)};return Fw(e).put(a)}return B.resolve()}getCollectionParents(e,t){const r=[],s=IDBKeyRange.bound([t,""],[LE(t),""],!1,!0);return Fw(e).j(s).next((a=>{for(const l of a){if(l.collectionId!==t)break;r.push(kr(l.parent))}return r}))}addFieldIndex(e,t){const r=nu(e),s=(function(d){return{indexId:d.indexId,collectionGroup:d.collectionGroup,fields:d.fields.map((f=>[f.fieldPath.canonicalString(),f.kind]))}})(t);delete s.indexId;const a=r.add(s);if(t.indexState){const l=ya(e);return a.next((d=>{l.put(Cw(d,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return a.next()}deleteFieldIndex(e,t){const r=nu(e),s=ya(e),a=ga(e);return r.delete(t.indexId).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=nu(e),r=ga(e),s=ya(e);return t.Y().next((()=>r.Y())).next((()=>s.Y()))}createTargetIndexes(e,t){return B.forEach(this.Fn(t),(r=>this.getIndexType(e,r).next((s=>{if(s===0||s===1){const a=new Lw(r).bn();if(a!=null)return this.addFieldIndex(e,a)}}))))}getDocumentsMatchingTarget(e,t){const r=ga(e);let s=!0;const a=new Map;return B.forEach(this.Fn(t),(l=>this.Mn(e,l).next((d=>{s&&(s=!!d),a.set(l,d)})))).next((()=>{if(s){let l=Ae();const d=[];return B.forEach(a,((f,m)=>{te(jw,`Using index ${(function(q){return`id=${q.indexId}|cg=${q.collectionGroup}|f=${q.fields.map((re=>`${re.fieldPath}:${re.kind}`)).join(",")}`})(f)} to execute ${so(t)}`);const v=(function(q,re){const de=cm(re);if(de===void 0)return null;for(const ne of th(q,de.fieldPath))switch(ne.op){case"array-contains-any":return ne.value.arrayValue.values||[];case"array-contains":return[ne.value]}return null})(m,f),w=(function(q,re){const de=new Map;for(const ne of zs(re))for(const P of th(q,ne.fieldPath))switch(P.op){case"==":case"in":de.set(ne.fieldPath.canonicalString(),P.value);break;case"not-in":case"!=":return de.set(ne.fieldPath.canonicalString(),P.value),Array.from(de.values())}return null})(m,f),x=(function(q,re){const de=[];let ne=!0;for(const P of zs(re)){const k=P.kind===0?gw(q,P.fieldPath,q.startAt):yw(q,P.fieldPath,q.startAt);de.push(k.value),ne&&(ne=k.inclusive)}return new Oa(de,ne)})(m,f),S=(function(q,re){const de=[];let ne=!0;for(const P of zs(re)){const k=P.kind===0?yw(q,P.fieldPath,q.endAt):gw(q,P.fieldPath,q.endAt);de.push(k.value),ne&&(ne=k.inclusive)}return new Oa(de,ne)})(m,f),D=this.xn(f,m,x),F=this.xn(f,m,S),O=this.On(f,m,w),K=this.Nn(f.indexId,v,D,x.inclusive,F,S.inclusive,O);return B.forEach(K,(X=>r.H(X,t.limit).next((q=>{q.forEach((re=>{const de=le.fromSegments(re.documentKey);l.has(de)||(l=l.add(de),d.push(de))}))}))))})).next((()=>d))}return B.resolve(null)}))}Fn(e){let t=this.Cn.get(e);return t||(e.filters.length===0?t=[e]:t=eC(He.create(e.filters,"and")).map((r=>_m(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt))),this.Cn.set(e,t),t)}Nn(e,t,r,s,a,l,d){const f=(t!=null?t.length:1)*Math.max(r.length,a.length),m=f/(t!=null?t.length:1),v=[];for(let w=0;w<f;++w){const x=t?this.Bn(t[w/m]):Id,S=this.Ln(e,x,r[w%m],s),D=this.kn(e,x,a[w%m],l),F=d.map((O=>this.Ln(e,x,O,!0)));v.push(...this.createRange(S,D,F))}return v}Ln(e,t,r,s){const a=new Gs(e,le.empty(),t,r);return s?a:a.En()}kn(e,t,r,s){const a=new Gs(e,le.empty(),t,r);return s?a.En():a}Mn(e,t){const r=new Lw(t),s=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,s).next((a=>{let l=null;for(const d of a)r.pn(d)&&(!l||d.fields.length>l.fields.length)&&(l=d);return l}))}getIndexType(e,t){let r=2;const s=this.Fn(t);return B.forEach(s,(a=>this.Mn(e,a).next((l=>{l?r!==0&&l.fields.length<(function(f){let m=new We(at.comparator),v=!1;for(const w of f.filters)for(const x of w.getFlattenedFilters())x.field.isKeyField()||(x.op==="array-contains"||x.op==="array-contains-any"?v=!0:m=m.add(x.field));for(const w of f.orderBy)w.field.isKeyField()||(m=m.add(w.field));return m.size+(v?1:0)})(a)&&(r=1):r=0})))).next((()=>(function(l){return l.limit!==null})(t)&&s.length>1&&r===2?1:r))}qn(e,t){const r=new tu;for(const s of zs(e)){const a=t.data.field(s.fieldPath);if(a==null)return null;const l=r.hn(s.kind);Ws.Ut.bt(a,l)}return r.an()}Bn(e){const t=new tu;return Ws.Ut.bt(e,t.hn(0)),t.an()}Qn(e,t){const r=new tu;return Ws.Ut.bt(Nu(this.databaseId,t),r.hn((function(a){const l=zs(a);return l.length===0?0:l[l.length-1].kind})(e))),r.an()}On(e,t,r){if(r===null)return[];let s=[];s.push(new tu);let a=0;for(const l of zs(e)){const d=r[a++];for(const f of s)if(this.$n(t,l.fieldPath)&&Du(d))s=this.Un(s,l,d);else{const m=f.hn(l.kind);Ws.Ut.bt(d,m)}}return this.Kn(s)}xn(e,t,r){return this.On(e,t,r.position)}Kn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].an();return t}Un(e,t,r){const s=[...e],a=[];for(const l of r.arrayValue.values||[])for(const d of s){const f=new tu;f.seed(d.an()),Ws.Ut.bt(l,f.hn(t.kind)),a.push(f)}return a}$n(e,t){return!!e.filters.find((r=>r instanceof De&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in")))}getFieldIndexes(e,t){const r=nu(e),s=ya(e);return(t?r.j(hm,IDBKeyRange.bound(t,t)):r.j()).next((a=>{const l=[];return B.forEach(a,(d=>s.get([d.indexId,this.uid]).next((f=>{l.push((function(v,w){const x=w?new Su(w.sequenceNumber,new Sn(ao(w.readTime),new le(kr(w.documentKey)),w.largestBatchId)):Su.empty(),S=v.fields.map((([D,F])=>new Cd(at.fromServerFormat(D),F)));return new Qd(v.indexId,v.collectionGroup,S,x)})(d,f))})))).next((()=>l))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((r,s)=>{const a=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return a!==0?a:xe(r.collectionGroup,s.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,r){const s=nu(e),a=ya(e);return this.Wn(e).next((l=>s.j(hm,IDBKeyRange.bound(t,t)).next((d=>B.forEach(d,(f=>a.put(Cw(f.indexId,this.uid,l,r))))))))}updateIndexEntries(e,t){const r=new Map;return B.forEach(t,((s,a)=>{const l=r.get(s.collectionGroup);return(l?B.resolve(l):this.getFieldIndexes(e,s.collectionGroup)).next((d=>(r.set(s.collectionGroup,d),B.forEach(d,(f=>this.Gn(e,s,f).next((m=>{const v=this.zn(a,f);return m.isEqual(v)?B.resolve():this.jn(e,a,f,m,v)})))))))}))}Jn(e,t,r,s){return ga(e).put(s.An(this.uid,this.Qn(r,t.key),t.key))}Hn(e,t,r,s){return ga(e).delete(s.Rn(this.uid,this.Qn(r,t.key),t.key))}Gn(e,t,r){const s=ga(e);let a=new We(Bi);return s.X({index:GE,range:IDBKeyRange.only([r.indexId,this.uid,jd(this.Qn(r,t))])},((l,d)=>{a=a.add(new Gs(r.indexId,t,Ow(d.arrayValue),Ow(d.directionalValue)))})).next((()=>a))}zn(e,t){let r=new We(Bi);const s=this.qn(t,e);if(s==null)return r;const a=cm(t);if(a!=null){const l=e.data.field(a.fieldPath);if(Du(l))for(const d of l.arrayValue.values||[])r=r.add(new Gs(t.indexId,e.key,this.Bn(d),s))}else r=r.add(new Gs(t.indexId,e.key,Id,s));return r}jn(e,t,r,s,a){te(jw,"Updating index entries for document '%s'",t.key);const l=[];return(function(f,m,v,w,x){const S=f.getIterator(),D=m.getIterator();let F=pa(S),O=pa(D);for(;F||O;){let K=!1,X=!1;if(F&&O){const q=v(F,O);q<0?X=!0:q>0&&(K=!0)}else F!=null?X=!0:K=!0;K?(w(O),O=pa(D)):X?(x(F),F=pa(S)):(F=pa(S),O=pa(D))}})(s,a,Bi,(d=>{l.push(this.Jn(e,t,r,d))}),(d=>{l.push(this.Hn(e,t,r,d))})),B.waitFor(l)}Wn(e){let t=1;return ya(e).X({index:WE,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((r,s,a)=>{a.done(),t=s.sequenceNumber+1})).next((()=>t))}createRange(e,t,r){r=r.sort(((l,d)=>Bi(l,d))).filter(((l,d,f)=>!d||Bi(l,f[d-1])!==0));const s=[];s.push(e);for(const l of r){const d=Bi(l,e),f=Bi(l,t);if(d===0)s[0]=e.En();else if(d>0&&f<0)s.push(l),s.push(l.En());else if(f>0)break}s.push(t);const a=[];for(let l=0;l<s.length;l+=2){if(this.Yn(s[l],s[l+1]))return[];const d=s[l].Rn(this.uid,Id,le.empty()),f=s[l+1].Rn(this.uid,Id,le.empty());a.push(IDBKeyRange.bound(d,f))}return a}Yn(e,t){return Bi(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Uw)}getMinOffset(e,t){return B.mapArray(this.Fn(t),(r=>this.Mn(e,r).next((s=>s||pe(44426))))).next(Uw)}}function Fw(n){return At(n,Ru)}function ga(n){return At(n,mu)}function nu(n){return At(n,ng)}function ya(n){return At(n,pu)}function Uw(n){ye(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const s=n[r].indexState.offset;Zm(s,e)<0&&(e=s),t<s.largestBatchId&&(t=s.largestBatchId)}return new Sn(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bw={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},XI=41943040;class Gt{static withCacheSize(e){return new Gt(e,Gt.DEFAULT_COLLECTION_PERCENTILE,Gt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YI(n,e,t){const r=n.store(sr),s=n.store(Ra),a=[],l=IDBKeyRange.only(t.batchId);let d=0;const f=r.X({range:l},((v,w,x)=>(d++,x.delete())));a.push(f.next((()=>{ye(d===1,47070,{batchId:t.batchId})})));const m=[];for(const v of t.mutations){const w=$E(e,v.key.path,t.batchId);a.push(s.delete(w)),m.push(v.key)}return B.waitFor(a).next((()=>m))}function ah(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw pe(14731);e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Gt.DEFAULT_COLLECTION_PERCENTILE=10,Gt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Gt.DEFAULT=new Gt(XI,Gt.DEFAULT_COLLECTION_PERCENTILE,Gt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Gt.DISABLED=new Gt(-1,0,0);class Bh{constructor(e,t,r,s){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=s,this.Zn={}}static yt(e,t,r,s){ye(e.uid!=="",64387);const a=e.isAuthenticated()?e.uid:"";return new Bh(a,t,r,s)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return zi(e).X({index:Ks,range:r},((s,a,l)=>{t=!1,l.done()})).next((()=>t))}addMutationBatch(e,t,r,s){const a=xa(e),l=zi(e);return l.add({}).next((d=>{ye(typeof d=="number",49019);const f=new cg(d,t,r,s),m=(function(S,D,F){const O=F.baseMutations.map((X=>ih(S.gt,X))),K=F.mutations.map((X=>ih(S.gt,X)));return{userId:D,batchId:F.batchId,localWriteTimeMs:F.localWriteTime.toMillis(),baseMutations:O,mutations:K}})(this.serializer,this.userId,f),v=[];let w=new We(((x,S)=>xe(x.canonicalString(),S.canonicalString())));for(const x of s){const S=$E(this.userId,x.key.path,d);w=w.add(x.key.path.popLast()),v.push(l.put(m)),v.push(a.put(S,NA))}return w.forEach((x=>{v.push(this.indexManager.addToCollectionParentIndex(e,x))})),e.addOnCommittedListener((()=>{this.Zn[d]=f.keys()})),B.waitFor(v).next((()=>f))}))}lookupMutationBatch(e,t){return zi(e).get(t).next((r=>r?(ye(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:t}),Hs(this.serializer,r)):null))}Xn(e,t){return this.Zn[t]?B.resolve(this.Zn[t]):this.lookupMutationBatch(e,t).next((r=>{if(r){const s=r.keys();return this.Zn[t]=s,s}return null}))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=IDBKeyRange.lowerBound([this.userId,r]);let a=null;return zi(e).X({index:Ks,range:s},((l,d,f)=>{d.userId===this.userId&&(ye(d.batchId>=r,47524,{er:r}),a=Hs(this.serializer,d)),f.done()})).next((()=>a))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=Ys;return zi(e).X({index:Ks,range:t,reverse:!0},((s,a,l)=>{r=a.batchId,l.done()})).next((()=>r))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Ys],[this.userId,Number.POSITIVE_INFINITY]);return zi(e).j(Ks,t).next((r=>r.map((s=>Hs(this.serializer,s)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=Pd(this.userId,t.path),s=IDBKeyRange.lowerBound(r),a=[];return xa(e).X({range:s},((l,d,f)=>{const[m,v,w]=l,x=kr(v);if(m===this.userId&&t.path.isEqual(x))return zi(e).get(w).next((S=>{if(!S)throw pe(61480,{tr:l,batchId:w});ye(S.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:S.userId,batchId:w}),a.push(Hs(this.serializer,S))}));f.done()})).next((()=>a))}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new We(xe);const s=[];return t.forEach((a=>{const l=Pd(this.userId,a.path),d=IDBKeyRange.lowerBound(l),f=xa(e).X({range:d},((m,v,w)=>{const[x,S,D]=m,F=kr(S);x===this.userId&&a.path.isEqual(F)?r=r.add(D):w.done()}));s.push(f)})),B.waitFor(s).next((()=>this.nr(e,r)))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1,a=Pd(this.userId,r),l=IDBKeyRange.lowerBound(a);let d=new We(xe);return xa(e).X({range:l},((f,m,v)=>{const[w,x,S]=f,D=kr(x);w===this.userId&&r.isPrefixOf(D)?D.length===s&&(d=d.add(S)):v.done()})).next((()=>this.nr(e,d)))}nr(e,t){const r=[],s=[];return t.forEach((a=>{s.push(zi(e).get(a).next((l=>{if(l===null)throw pe(35274,{batchId:a});ye(l.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:l.userId,batchId:a}),r.push(Hs(this.serializer,l))})))})),B.waitFor(s).next((()=>r))}removeMutationBatch(e,t){return YI(e.ce,this.userId,t).next((r=>(e.addOnCommittedListener((()=>{this.rr(t.batchId)})),B.forEach(r,(s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))))}rr(e){delete this.Zn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return B.resolve();const r=IDBKeyRange.lowerBound((function(l){return[l]})(this.userId)),s=[];return xa(e).X({range:r},((a,l,d)=>{if(a[0]===this.userId){const f=kr(a[1]);s.push(f)}else d.done()})).next((()=>{ye(s.length===0,56720,{ir:s.map((a=>a.canonicalString()))})}))}))}containsKey(e,t){return JI(e,this.userId,t)}sr(e){return ZI(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:Ys,lastStreamToken:""}))}}function JI(n,e,t){const r=Pd(e,t.path),s=r[1],a=IDBKeyRange.lowerBound(r);let l=!1;return xa(n).X({range:a,Z:!0},((d,f,m)=>{const[v,w,x]=d;v===e&&w===s&&(l=!0),m.done()})).next((()=>l))}function zi(n){return At(n,sr)}function xa(n){return At(n,Ra)}function ZI(n){return At(n,bu)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lo{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new lo(0)}static ur(){return new lo(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rC{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.cr(e).next((t=>{const r=new lo(t.highestTargetId);return t.highestTargetId=r.next(),this.lr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.cr(e).next((t=>_e.fromTimestamp(new qe(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.cr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,r){return this.cr(e).next((s=>(s.highestListenSequenceNumber=t,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),t>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=t),this.lr(e,s))))}addTargetData(e,t){return this.hr(e,t).next((()=>this.cr(e).next((r=>(r.targetCount+=1,this.Pr(t,r),this.lr(e,r))))))}updateTargetData(e,t){return this.hr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>va(e).delete(t.targetId))).next((()=>this.cr(e))).next((r=>(ye(r.targetCount>0,8065),r.targetCount-=1,this.lr(e,r))))}removeTargets(e,t,r){let s=0;const a=[];return va(e).X(((l,d)=>{const f=uu(d);f.sequenceNumber<=t&&r.get(f.targetId)===null&&(s++,a.push(this.removeTargetData(e,f)))})).next((()=>B.waitFor(a))).next((()=>s))}forEachTarget(e,t){return va(e).X(((r,s)=>{const a=uu(s);t(a)}))}cr(e){return zw(e).get(Jd).next((t=>(ye(t!==null,2888),t)))}lr(e,t){return zw(e).put(Jd,t)}hr(e,t){return va(e).put(WI(this.serializer,t))}Pr(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.cr(e).next((t=>t.targetCount))}getTargetData(e,t){const r=so(t),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let a=null;return va(e).X({range:s,index:HE},((l,d,f)=>{const m=uu(d);qu(t,m.target)&&(a=m,f.done())})).next((()=>a))}addMatchingKeys(e,t,r){const s=[],a=Gi(e);return t.forEach((l=>{const d=Xt(l.path);s.push(a.put({targetId:r,path:d})),s.push(this.referenceDelegate.addReference(e,r,l))})),B.waitFor(s)}removeMatchingKeys(e,t,r){const s=Gi(e);return B.forEach(t,(a=>{const l=Xt(a.path);return B.waitFor([s.delete([r,l]),this.referenceDelegate.removeReference(e,r,a)])}))}removeMatchingKeysForTargetId(e,t){const r=Gi(e),s=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),s=Gi(e);let a=Ae();return s.X({range:r,Z:!0},((l,d,f)=>{const m=kr(l[1]),v=new le(m);a=a.add(v)})).next((()=>a))}containsKey(e,t){const r=Xt(t.path),s=IDBKeyRange.bound([r],[LE(r)],!1,!0);let a=0;return Gi(e).X({index:tg,Z:!0,range:s},(([l,d],f,m)=>{l!==0&&(a++,m.done())})).next((()=>a>0))}Et(e,t){return va(e).get(t).next((r=>r?uu(r):null))}}function va(n){return At(n,Ca)}function zw(n){return At(n,Js)}function Gi(n){return At(n,Pa)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $w="LruGarbageCollector",iC=1048576;function qw([n,e],[t,r]){const s=xe(n,t);return s===0?xe(e,r):s}class sC{constructor(e){this.Tr=e,this.buffer=new We(qw),this.Ir=0}dr(){return++this.Ir}Er(e){const t=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();qw(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class ex{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){te($w,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){cs(t)?te($w,"Ignoring IndexedDB error during garbage collection: ",t):await vo(t)}await this.Rr(3e5)}))}}class oC{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.mr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return B.resolve(jn.ue);const r=new sC(t);return this.Vr.forEachTarget(e,(s=>r.Er(s.sequenceNumber))).next((()=>this.Vr.gr(e,(s=>r.Er(s))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.Vr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(te("LruGarbageCollector","Garbage collection skipped; disabled"),B.resolve(Bw)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(te("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Bw):this.pr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,t){let r,s,a,l,d,f,m;const v=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((w=>(w>this.params.maximumSequenceNumbersToCollect?(te("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${w}`),s=this.params.maximumSequenceNumbersToCollect):s=w,l=Date.now(),this.nthSequenceNumber(e,s)))).next((w=>(r=w,d=Date.now(),this.removeTargets(e,r,t)))).next((w=>(a=w,f=Date.now(),this.removeOrphanedDocuments(e,r)))).next((w=>(m=Date.now(),_a()<=Ne.DEBUG&&te("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${l-v}ms
	Determined least recently used ${s} in `+(d-l)+`ms
	Removed ${a} targets in `+(f-d)+`ms
	Removed ${w} documents in `+(m-f)+`ms
Total Duration: ${m-v}ms`),B.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:a,documentsRemoved:w}))))}}function tx(n,e){return new oC(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aC{constructor(e,t){this.db=e,this.garbageCollector=tx(this,t)}mr(e){const t=this.yr(e);return this.db.getTargetCache().getTargetCount(e).next((r=>t.next((s=>r+s))))}yr(e){let t=0;return this.gr(e,(r=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}gr(e,t){return this.wr(e,((r,s)=>t(s)))}addReference(e,t,r){return xd(e,r)}removeReference(e,t,r){return xd(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return xd(e,t)}Sr(e,t){return(function(s,a){let l=!1;return ZI(s).ee((d=>JI(s,d,a).next((f=>(f&&(l=!0),B.resolve(!f)))))).next((()=>l))})(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let a=0;return this.wr(e,((l,d)=>{if(d<=t){const f=this.Sr(e,l).next((m=>{if(!m)return a++,r.getEntry(e,l).next((()=>(r.removeEntry(l,_e.min()),Gi(e).delete((function(w){return[0,Xt(w.path)]})(l)))))}));s.push(f)}})).next((()=>B.waitFor(s))).next((()=>r.apply(e))).next((()=>a))}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return xd(e,t)}wr(e,t){const r=Gi(e);let s,a=jn.ue;return r.X({index:tg},(([l,d],{path:f,sequenceNumber:m})=>{l===0?(a!==jn.ue&&t(new le(kr(s)),a),a=m,s=f):a=jn.ue})).next((()=>{a!==jn.ue&&t(new le(kr(s)),a)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function xd(n,e){return Gi(n).put((function(r,s){return{targetId:0,path:Xt(r.path),sequenceNumber:s}})(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nx{constructor(){this.changes=new hi((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ct.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?B.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lC{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Us(e).put(r)}removeEntry(e,t,r){return Us(e).delete((function(a,l){const d=a.path.toArray();return[d.slice(0,d.length-2),d[d.length-2],sh(l),d[d.length-1]]})(t,r))}updateMetadata(e,t){return this.getMetadata(e).next((r=>(r.byteSize+=t,this.br(e,r))))}getEntry(e,t){let r=ct.newInvalidDocument(t);return Us(e).X({index:Nd,range:IDBKeyRange.only(ru(t))},((s,a)=>{r=this.Dr(t,a)})).next((()=>r))}vr(e,t){let r={size:0,document:ct.newInvalidDocument(t)};return Us(e).X({index:Nd,range:IDBKeyRange.only(ru(t))},((s,a)=>{r={document:this.Dr(t,a),size:ah(a)}})).next((()=>r))}getEntries(e,t){let r=xn();return this.Cr(e,t,((s,a)=>{const l=this.Dr(s,a);r=r.insert(s,l)})).next((()=>r))}Fr(e,t){let r=xn(),s=new it(le.comparator);return this.Cr(e,t,((a,l)=>{const d=this.Dr(a,l);r=r.insert(a,d),s=s.insert(a,ah(l))})).next((()=>({documents:r,Mr:s})))}Cr(e,t,r){if(t.isEmpty())return B.resolve();let s=new We(Gw);t.forEach((f=>s=s.add(f)));const a=IDBKeyRange.bound(ru(s.first()),ru(s.last())),l=s.getIterator();let d=l.getNext();return Us(e).X({index:Nd,range:a},((f,m,v)=>{const w=le.fromSegments([...m.prefixPath,m.collectionGroup,m.documentId]);for(;d&&Gw(d,w)<0;)r(d,null),d=l.getNext();d&&d.isEqual(w)&&(r(d,m),d=l.hasNext()?l.getNext():null),d?v.G(ru(d)):v.done()})).next((()=>{for(;d;)r(d,null),d=l.hasNext()?l.getNext():null}))}getDocumentsMatchingQuery(e,t,r,s,a){const l=t.path,d=[l.popLast().toArray(),l.lastSegment(),sh(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],f=[l.popLast().toArray(),l.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Us(e).j(IDBKeyRange.bound(d,f,!0)).next((m=>{a==null||a.incrementDocumentReadCount(m.length);let v=xn();for(const w of m){const x=this.Dr(le.fromSegments(w.prefixPath.concat(w.collectionGroup,w.documentId)),w);x.isFoundDocument()&&(Wu(t,x)||s.has(x.key))&&(v=v.insert(x.key,x))}return v}))}getAllFromCollectionGroup(e,t,r,s){let a=xn();const l=Ww(t,r),d=Ww(t,Sn.max());return Us(e).X({index:qE,range:IDBKeyRange.bound(l,d,!0)},((f,m,v)=>{const w=this.Dr(le.fromSegments(m.prefixPath.concat(m.collectionGroup,m.documentId)),m);a=a.insert(w.key,w),a.size===s&&v.done()})).next((()=>a))}newChangeBuffer(e){return new uC(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return Hw(e).get(dm).next((t=>(ye(!!t,20021),t)))}br(e,t){return Hw(e).put(dm,t)}Dr(e,t){if(t){const r=GR(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(_e.min())))return r}return ct.newInvalidDocument(e)}}function rx(n){return new lC(n)}class uC extends nx{constructor(e,t){super(),this.Or=e,this.trackRemovals=t,this.Nr=new hi((r=>r.toString()),((r,s)=>r.isEqual(s)))}applyChanges(e){const t=[];let r=0,s=new We(((a,l)=>xe(a.canonicalString(),l.canonicalString())));return this.changes.forEach(((a,l)=>{const d=this.Nr.get(a);if(t.push(this.Or.removeEntry(e,a,d.readTime)),l.isValidDocument()){const f=Aw(this.Or.serializer,l);s=s.add(a.path.popLast());const m=ah(f);r+=m-d.size,t.push(this.Or.addEntry(e,a,f))}else if(r-=d.size,this.trackRemovals){const f=Aw(this.Or.serializer,l.convertToNoDocument(_e.min()));t.push(this.Or.addEntry(e,a,f))}})),s.forEach((a=>{t.push(this.Or.indexManager.addToCollectionParentIndex(e,a))})),t.push(this.Or.updateMetadata(e,r)),B.waitFor(t)}getFromCache(e,t){return this.Or.vr(e,t).next((r=>(this.Nr.set(t,{size:r.size,readTime:r.document.readTime}),r.document)))}getAllFromCache(e,t){return this.Or.Fr(e,t).next((({documents:r,Mr:s})=>(s.forEach(((a,l)=>{this.Nr.set(a,{size:l,readTime:r.get(a).readTime})})),r)))}}function Hw(n){return At(n,Au)}function Us(n){return At(n,Yd)}function ru(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Ww(n,e){const t=e.documentKey.path.toArray();return[n,sh(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function Gw(n,e){const t=n.path.toArray(),r=e.path.toArray();let s=0;for(let a=0;a<t.length-2&&a<r.length-2;++a)if(s=xe(t[a],r[a]),s)return s;return s=xe(t.length,r.length),s||(s=xe(t[t.length-2],r[r.length-2]),s||xe(t[t.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cC{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ix{constructor(e,t,r,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((s=>(r=s,this.remoteDocumentCache.getEntry(e,t)))).next((s=>(r!==null&&_u(r.mutation,s,fn.empty(),qe.now()),s)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,Ae()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=Ae()){const s=br();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,r).next((a=>{let l=au();return a.forEach(((d,f)=>{l=l.insert(d,f.overlayedDocument)})),l}))))}getOverlayedDocuments(e,t){const r=br();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,Ae())))}populateOverlays(e,t,r){const s=[];return r.forEach((a=>{t.has(a)||s.push(a)})),this.documentOverlayCache.getOverlays(e,s).next((a=>{a.forEach(((l,d)=>{t.set(l,d)}))}))}computeViews(e,t,r,s){let a=xn();const l=vu(),d=(function(){return vu()})();return t.forEach(((f,m)=>{const v=r.get(m.key);s.has(m.key)&&(v===void 0||v.mutation instanceof fi)?a=a.insert(m.key,m):v!==void 0?(l.set(m.key,v.mutation.getFieldMask()),_u(v.mutation,m,v.mutation.getFieldMask(),qe.now())):l.set(m.key,fn.empty())})),this.recalculateAndSaveOverlays(e,a).next((f=>(f.forEach(((m,v)=>l.set(m,v))),t.forEach(((m,v)=>{var w;return d.set(m,new cC(v,(w=l.get(m))!==null&&w!==void 0?w:null))})),d)))}recalculateAndSaveOverlays(e,t){const r=vu();let s=new it(((l,d)=>l-d)),a=Ae();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((l=>{for(const d of l)d.keys().forEach((f=>{const m=t.get(f);if(m===null)return;let v=r.get(f)||fn.empty();v=d.applyToLocalView(m,v),r.set(f,v);const w=(s.get(d.batchId)||Ae()).add(f);s=s.insert(d.batchId,w)}))})).next((()=>{const l=[],d=s.getReverseIterator();for(;d.hasNext();){const f=d.getNext(),m=f.key,v=f.value,w=EI();v.forEach((x=>{if(!a.has(x)){const S=AI(t.get(x),r.get(x));S!==null&&w.set(x,S),a=a.add(x)}})),l.push(this.documentOverlayCache.saveOverlays(e,m,w))}return B.waitFor(l)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,s){return(function(l){return le.isDocumentKey(l.path)&&l.collectionGroup===null&&l.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):gI(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,s):this.getDocumentsMatchingCollectionQuery(e,t,r,s)}getNextDocuments(e,t,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,s).next((a=>{const l=s-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,s-a.size):B.resolve(br());let d=Tu,f=a;return l.next((m=>B.forEach(m,((v,w)=>(d<w.largestBatchId&&(d=w.largestBatchId),a.get(v)?B.resolve():this.remoteDocumentCache.getEntry(e,v).next((x=>{f=f.insert(v,x)}))))).next((()=>this.populateOverlays(e,m,a))).next((()=>this.computeViews(e,f,m,Ae()))).next((v=>({batchId:d,changes:wI(v)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new le(t)).next((r=>{let s=au();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,s){const a=t.collectionGroup;let l=au();return this.indexManager.getCollectionParents(e,a).next((d=>B.forEach(d,(f=>{const m=(function(w,x){return new Xa(x,null,w.explicitOrderBy.slice(),w.filters.slice(),w.limit,w.limitType,w.startAt,w.endAt)})(t,f.child(a));return this.getDocumentsMatchingCollectionQuery(e,m,r,s).next((v=>{v.forEach(((w,x)=>{l=l.insert(w,x)}))}))})).next((()=>l))))}getDocumentsMatchingCollectionQuery(e,t,r,s){let a;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((l=>(a=l,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,a,s)))).next((l=>{a.forEach(((f,m)=>{const v=m.getKey();l.get(v)===null&&(l=l.insert(v,ct.newInvalidDocument(v)))}));let d=au();return l.forEach(((f,m)=>{const v=a.get(f);v!==void 0&&_u(v.mutation,m,fn.empty(),qe.now()),Wu(t,m)&&(d=d.insert(f,m))})),d}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dC{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,t){return B.resolve(this.Br.get(t))}saveBundleMetadata(e,t){return this.Br.set(t.id,(function(s){return{id:s.id,version:s.version,createTime:rn(s.createTime)}})(t)),B.resolve()}getNamedQuery(e,t){return B.resolve(this.Lr.get(t))}saveNamedQuery(e,t){return this.Lr.set(t.name,(function(s){return{name:s.name,query:GI(s.bundledQuery),readTime:rn(s.readTime)}})(t)),B.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hC{constructor(){this.overlays=new it(le.comparator),this.kr=new Map}getOverlay(e,t){return B.resolve(this.overlays.get(t))}getOverlays(e,t){const r=br();return B.forEach(t,(s=>this.getOverlay(e,s).next((a=>{a!==null&&r.set(s,a)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((s,a)=>{this.wt(e,t,a)})),B.resolve()}removeOverlaysForBatchId(e,t,r){const s=this.kr.get(r);return s!==void 0&&(s.forEach((a=>this.overlays=this.overlays.remove(a))),this.kr.delete(r)),B.resolve()}getOverlaysForCollection(e,t,r){const s=br(),a=t.length+1,l=new le(t.child("")),d=this.overlays.getIteratorFrom(l);for(;d.hasNext();){const f=d.getNext().value,m=f.getKey();if(!t.isPrefixOf(m.path))break;m.path.length===a&&f.largestBatchId>r&&s.set(f.getKey(),f)}return B.resolve(s)}getOverlaysForCollectionGroup(e,t,r,s){let a=new it(((m,v)=>m-v));const l=this.overlays.getIterator();for(;l.hasNext();){const m=l.getNext().value;if(m.getKey().getCollectionGroup()===t&&m.largestBatchId>r){let v=a.get(m.largestBatchId);v===null&&(v=br(),a=a.insert(m.largestBatchId,v)),v.set(m.getKey(),m)}}const d=br(),f=a.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach(((m,v)=>d.set(m,v))),!(d.size()>=s)););return B.resolve(d)}wt(e,t,r){const s=this.overlays.get(r.key);if(s!==null){const l=this.kr.get(s.largestBatchId).delete(r.key);this.kr.set(s.largestBatchId,l)}this.overlays=this.overlays.insert(r.key,new hg(t,r));let a=this.kr.get(t);a===void 0&&(a=Ae(),this.kr.set(t,a)),this.kr.set(t,a.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fC{constructor(){this.sessionToken=Et.EMPTY_BYTE_STRING}getSessionToken(e){return B.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,B.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yg{constructor(){this.qr=new We(Ot.Qr),this.$r=new We(Ot.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,t){const r=new Ot(e,t);this.qr=this.qr.add(r),this.$r=this.$r.add(r)}Kr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Wr(new Ot(e,t))}Gr(e,t){e.forEach((r=>this.removeReference(r,t)))}zr(e){const t=new le(new ze([])),r=new Ot(t,e),s=new Ot(t,e+1),a=[];return this.$r.forEachInRange([r,s],(l=>{this.Wr(l),a.push(l.key)})),a}jr(){this.qr.forEach((e=>this.Wr(e)))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const t=new le(new ze([])),r=new Ot(t,e),s=new Ot(t,e+1);let a=Ae();return this.$r.forEachInRange([r,s],(l=>{a=a.add(l.key)})),a}containsKey(e){const t=new Ot(e,0),r=this.qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class Ot{constructor(e,t){this.key=e,this.Hr=t}static Qr(e,t){return le.comparator(e.key,t.key)||xe(e.Hr,t.Hr)}static Ur(e,t){return xe(e.Hr,t.Hr)||le.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pC{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.er=1,this.Yr=new We(Ot.Qr)}checkEmpty(e){return B.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,s){const a=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const l=new cg(a,t,r,s);this.mutationQueue.push(l);for(const d of s)this.Yr=this.Yr.add(new Ot(d.key,a)),this.indexManager.addToCollectionParentIndex(e,d.key.path.popLast());return B.resolve(l)}lookupMutationBatch(e,t){return B.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=this.Xr(r),a=s<0?0:s;return B.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return B.resolve(this.mutationQueue.length===0?Ys:this.er-1)}getAllMutationBatches(e){return B.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Ot(t,0),s=new Ot(t,Number.POSITIVE_INFINITY),a=[];return this.Yr.forEachInRange([r,s],(l=>{const d=this.Zr(l.Hr);a.push(d)})),B.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new We(xe);return t.forEach((s=>{const a=new Ot(s,0),l=new Ot(s,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([a,l],(d=>{r=r.add(d.Hr)}))})),B.resolve(this.ei(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1;let a=r;le.isDocumentKey(a)||(a=a.child(""));const l=new Ot(new le(a),0);let d=new We(xe);return this.Yr.forEachWhile((f=>{const m=f.key.path;return!!r.isPrefixOf(m)&&(m.length===s&&(d=d.add(f.Hr)),!0)}),l),B.resolve(this.ei(d))}ei(e){const t=[];return e.forEach((r=>{const s=this.Zr(r);s!==null&&t.push(s)})),t}removeMutationBatch(e,t){ye(this.ti(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Yr;return B.forEach(t.mutations,(s=>{const a=new Ot(s.key,t.batchId);return r=r.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)})).next((()=>{this.Yr=r}))}rr(e){}containsKey(e,t){const r=new Ot(t,0),s=this.Yr.firstAfterOrEqual(r);return B.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,B.resolve()}ti(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mC{constructor(e){this.ni=e,this.docs=(function(){return new it(le.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,s=this.docs.get(r),a=s?s.size:0,l=this.ni(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:l}),this.size+=l-a,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return B.resolve(r?r.document.mutableCopy():ct.newInvalidDocument(t))}getEntries(e,t){let r=xn();return t.forEach((s=>{const a=this.docs.get(s);r=r.insert(s,a?a.document.mutableCopy():ct.newInvalidDocument(s))})),B.resolve(r)}getDocumentsMatchingQuery(e,t,r,s){let a=xn();const l=t.path,d=new le(l.child("__id-9223372036854775808__")),f=this.docs.getIteratorFrom(d);for(;f.hasNext();){const{key:m,value:{document:v}}=f.getNext();if(!l.isPrefixOf(m.path))break;m.path.length>l.length+1||Zm(FE(v),r)<=0||(s.has(v.key)||Wu(t,v))&&(a=a.insert(v.key,v.mutableCopy()))}return B.resolve(a)}getAllFromCollectionGroup(e,t,r,s){pe(9500)}ri(e,t){return B.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new gC(this)}getSize(e){return B.resolve(this.size)}}class gC extends nx{constructor(e){super(),this.Or=e}applyChanges(e){const t=[];return this.changes.forEach(((r,s)=>{s.isValidDocument()?t.push(this.Or.addEntry(e,s)):this.Or.removeEntry(r)})),B.waitFor(t)}getFromCache(e,t){return this.Or.getEntry(e,t)}getAllFromCache(e,t){return this.Or.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yC{constructor(e){this.persistence=e,this.ii=new hi((t=>so(t)),qu),this.lastRemoteSnapshotVersion=_e.min(),this.highestTargetId=0,this.si=0,this.oi=new yg,this.targetCount=0,this._i=lo.ar()}forEachTarget(e,t){return this.ii.forEach(((r,s)=>t(s))),B.resolve()}getLastRemoteSnapshotVersion(e){return B.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return B.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),B.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.si&&(this.si=t),B.resolve()}hr(e){this.ii.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this._i=new lo(t),this.highestTargetId=t),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,t){return this.hr(t),this.targetCount+=1,B.resolve()}updateTargetData(e,t){return this.hr(t),B.resolve()}removeTargetData(e,t){return this.ii.delete(t.target),this.oi.zr(t.targetId),this.targetCount-=1,B.resolve()}removeTargets(e,t,r){let s=0;const a=[];return this.ii.forEach(((l,d)=>{d.sequenceNumber<=t&&r.get(d.targetId)===null&&(this.ii.delete(l),a.push(this.removeMatchingKeysForTargetId(e,d.targetId)),s++)})),B.waitFor(a).next((()=>s))}getTargetCount(e){return B.resolve(this.targetCount)}getTargetData(e,t){const r=this.ii.get(t)||null;return B.resolve(r)}addMatchingKeys(e,t,r){return this.oi.Kr(t,r),B.resolve()}removeMatchingKeys(e,t,r){this.oi.Gr(t,r);const s=this.persistence.referenceDelegate,a=[];return s&&t.forEach((l=>{a.push(s.markPotentiallyOrphaned(e,l))})),B.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this.oi.zr(t),B.resolve()}getMatchingKeysForTargetId(e,t){const r=this.oi.Jr(t);return B.resolve(r)}containsKey(e,t){return B.resolve(this.oi.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vg{constructor(e,t){this.ai={},this.overlays={},this.ui=new jn(0),this.ci=!1,this.ci=!0,this.li=new fC,this.referenceDelegate=e(this),this.hi=new yC(this),this.indexManager=new tC,this.remoteDocumentCache=(function(s){return new mC(s)})((r=>this.referenceDelegate.Pi(r))),this.serializer=new HI(t),this.Ti=new dC(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new hC,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ai[e.toKey()];return r||(r=new pC(t,this.referenceDelegate),this.ai[e.toKey()]=r),r}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,t,r){te("MemoryPersistence","Starting transaction:",e);const s=new vC(this.ui.next());return this.referenceDelegate.Ii(),r(s).next((a=>this.referenceDelegate.di(s).next((()=>a)))).toPromise().then((a=>(s.raiseOnCommittedEvent(),a)))}Ei(e,t){return B.or(Object.values(this.ai).map((r=>()=>r.containsKey(e,t))))}}class vC extends BE{constructor(e){super(),this.currentSequenceNumber=e}}class zh{constructor(e){this.persistence=e,this.Ai=new yg,this.Ri=null}static Vi(e){return new zh(e)}get mi(){if(this.Ri)return this.Ri;throw pe(60996)}addReference(e,t,r){return this.Ai.addReference(r,t),this.mi.delete(r.toString()),B.resolve()}removeReference(e,t,r){return this.Ai.removeReference(r,t),this.mi.add(r.toString()),B.resolve()}markPotentiallyOrphaned(e,t){return this.mi.add(t.toString()),B.resolve()}removeTarget(e,t){this.Ai.zr(t.targetId).forEach((s=>this.mi.add(s.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((s=>{s.forEach((a=>this.mi.add(a.toString())))})).next((()=>r.removeTargetData(e,t)))}Ii(){this.Ri=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return B.forEach(this.mi,(r=>{const s=le.fromPath(r);return this.fi(e,s).next((a=>{a||t.removeEntry(s,_e.min())}))})).next((()=>(this.Ri=null,t.apply(e))))}updateLimboDocument(e,t){return this.fi(e,t).next((r=>{r?this.mi.delete(t.toString()):this.mi.add(t.toString())}))}Pi(e){return 0}fi(e,t){return B.or([()=>B.resolve(this.Ai.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class lh{constructor(e,t){this.persistence=e,this.gi=new hi((r=>Xt(r.path)),((r,s)=>r.isEqual(s))),this.garbageCollector=tx(this,t)}static Vi(e,t){return new lh(e,t)}Ii(){}di(e){return B.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}mr(e){const t=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((s=>r+s))))}yr(e){let t=0;return this.gr(e,(r=>{t++})).next((()=>t))}gr(e,t){return B.forEach(this.gi,((r,s)=>this.Sr(e,r,s).next((a=>a?B.resolve():t(s)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const s=this.persistence.getRemoteDocumentCache(),a=s.newChangeBuffer();return s.ri(e,(l=>this.Sr(e,l,t).next((d=>{d||(r++,a.removeEntry(l,_e.min()))})))).next((()=>a.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.gi.set(t,e.currentSequenceNumber),B.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.gi.set(r,e.currentSequenceNumber),B.resolve()}removeReference(e,t,r){return this.gi.set(r,e.currentSequenceNumber),B.resolve()}updateLimboDocument(e,t){return this.gi.set(t,e.currentSequenceNumber),B.resolve()}Pi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Vd(e.data.value)),t}Sr(e,t,r){return B.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.gi.get(t);return B.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _C{constructor(e){this.serializer=e}q(e,t,r,s){const a=new Ah("createOrUpgrade",t);r<1&&s>=1&&((function(f){f.createObjectStore($u)})(e),(function(f){f.createObjectStore(bu,{keyPath:PA}),f.createObjectStore(sr,{keyPath:iw,autoIncrement:!0}).createIndex(Ks,sw,{unique:!0}),f.createObjectStore(Ra)})(e),Kw(e),(function(f){f.createObjectStore($s)})(e));let l=B.resolve();return r<3&&s>=3&&(r!==0&&((function(f){f.deleteObjectStore(Pa),f.deleteObjectStore(Ca),f.deleteObjectStore(Js)})(e),Kw(e)),l=l.next((()=>(function(f){const m=f.store(Js),v={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:_e.min().toTimestamp(),targetCount:0};return m.put(Jd,v)})(a)))),r<4&&s>=4&&(r!==0&&(l=l.next((()=>(function(f,m){return m.store(sr).j().next((w=>{f.deleteObjectStore(sr),f.createObjectStore(sr,{keyPath:iw,autoIncrement:!0}).createIndex(Ks,sw,{unique:!0});const x=m.store(sr),S=w.map((D=>x.put(D)));return B.waitFor(S)}))})(e,a)))),l=l.next((()=>{(function(f){f.createObjectStore(Na,{keyPath:UA})})(e)}))),r<5&&s>=5&&(l=l.next((()=>this.pi(a)))),r<6&&s>=6&&(l=l.next((()=>((function(f){f.createObjectStore(Au)})(e),this.yi(a))))),r<7&&s>=7&&(l=l.next((()=>this.wi(a)))),r<8&&s>=8&&(l=l.next((()=>this.Si(e,a)))),r<9&&s>=9&&(l=l.next((()=>{(function(f){f.objectStoreNames.contains("remoteDocumentChanges")&&f.deleteObjectStore("remoteDocumentChanges")})(e)}))),r<10&&s>=10&&(l=l.next((()=>this.bi(a)))),r<11&&s>=11&&(l=l.next((()=>{(function(f){f.createObjectStore(Ch,{keyPath:BA})})(e),(function(f){f.createObjectStore(Ph,{keyPath:zA})})(e)}))),r<12&&s>=12&&(l=l.next((()=>{(function(f){const m=f.createObjectStore(Nh,{keyPath:QA});m.createIndex(fm,XA,{unique:!1}),m.createIndex(KE,YA,{unique:!1})})(e)}))),r<13&&s>=13&&(l=l.next((()=>(function(f){const m=f.createObjectStore(Yd,{keyPath:DA});m.createIndex(Nd,VA),m.createIndex(qE,OA)})(e))).next((()=>this.Di(e,a))).next((()=>e.deleteObjectStore($s)))),r<14&&s>=14&&(l=l.next((()=>this.Ci(e,a)))),r<15&&s>=15&&(l=l.next((()=>(function(f){f.createObjectStore(ng,{keyPath:$A,autoIncrement:!0}).createIndex(hm,qA,{unique:!1}),f.createObjectStore(pu,{keyPath:HA}).createIndex(WE,WA,{unique:!1}),f.createObjectStore(mu,{keyPath:GA}).createIndex(GE,KA,{unique:!1})})(e)))),r<16&&s>=16&&(l=l.next((()=>{t.objectStore(pu).clear()})).next((()=>{t.objectStore(mu).clear()}))),r<17&&s>=17&&(l=l.next((()=>{(function(f){f.createObjectStore(rg,{keyPath:JA})})(e)}))),r<18&&s>=18&&_E()&&(l=l.next((()=>{t.objectStore(pu).clear()})).next((()=>{t.objectStore(mu).clear()}))),l}yi(e){let t=0;return e.store($s).X(((r,s)=>{t+=ah(s)})).next((()=>{const r={byteSize:t};return e.store(Au).put(dm,r)}))}pi(e){const t=e.store(bu),r=e.store(sr);return t.j().next((s=>B.forEach(s,(a=>{const l=IDBKeyRange.bound([a.userId,Ys],[a.userId,a.lastAcknowledgedBatchId]);return r.j(Ks,l).next((d=>B.forEach(d,(f=>{ye(f.userId===a.userId,18650,"Cannot process batch from unexpected user",{batchId:f.batchId});const m=Hs(this.serializer,f);return YI(e,a.userId,m).next((()=>{}))}))))}))))}wi(e){const t=e.store(Pa),r=e.store($s);return e.store(Js).get(Jd).next((s=>{const a=[];return r.X(((l,d)=>{const f=new ze(l),m=(function(w){return[0,Xt(w)]})(f);a.push(t.get(m).next((v=>v?B.resolve():(w=>t.put({targetId:0,path:Xt(w),sequenceNumber:s.highestListenSequenceNumber}))(f))))})).next((()=>B.waitFor(a)))}))}Si(e,t){e.createObjectStore(Ru,{keyPath:FA});const r=t.store(Ru),s=new gg,a=l=>{if(s.add(l)){const d=l.lastSegment(),f=l.popLast();return r.put({collectionId:d,parent:Xt(f)})}};return t.store($s).X({Z:!0},((l,d)=>{const f=new ze(l);return a(f.popLast())})).next((()=>t.store(Ra).X({Z:!0},(([l,d,f],m)=>{const v=kr(d);return a(v.popLast())}))))}bi(e){const t=e.store(Ca);return t.X(((r,s)=>{const a=uu(s),l=WI(this.serializer,a);return t.put(l)}))}Di(e,t){const r=t.store($s),s=[];return r.X(((a,l)=>{const d=t.store(Yd),f=(function(w){return w.document?new le(ze.fromString(w.document.name).popFirst(5)):w.noDocument?le.fromSegments(w.noDocument.path):w.unknownDocument?le.fromSegments(w.unknownDocument.path):pe(36783)})(l).path.toArray(),m={prefixPath:f.slice(0,f.length-2),collectionGroup:f[f.length-2],documentId:f[f.length-1],readTime:l.readTime||[0,0],unknownDocument:l.unknownDocument,noDocument:l.noDocument,document:l.document,hasCommittedMutations:!!l.hasCommittedMutations};s.push(d.put(m))})).next((()=>B.waitFor(s)))}Ci(e,t){const r=t.store(sr),s=rx(this.serializer),a=new vg(zh.Vi,this.serializer.gt);return r.j().next((l=>{const d=new Map;return l.forEach((f=>{var m;let v=(m=d.get(f.userId))!==null&&m!==void 0?m:Ae();Hs(this.serializer,f).keys().forEach((w=>v=v.add(w))),d.set(f.userId,v)})),B.forEach(d,((f,m)=>{const v=new Ut(m),w=Uh.yt(this.serializer,v),x=a.getIndexManager(v),S=Bh.yt(v,this.serializer,x,a.referenceDelegate);return new ix(s,S,w,x).recalculateAndSaveOverlaysForDocumentKeys(new pm(t,jn.ue),f).next()}))}))}}function Kw(n){n.createObjectStore(Pa,{keyPath:MA}).createIndex(tg,jA,{unique:!0}),n.createObjectStore(Ca,{keyPath:"targetId"}).createIndex(HE,LA,{unique:!0}),n.createObjectStore(Js)}const $i="IndexedDbPersistence",Hp=18e5,Wp=5e3,Gp="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",wC="main";class _g{constructor(e,t,r,s,a,l,d,f,m,v,w=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Fi=a,this.window=l,this.document=d,this.Mi=m,this.xi=v,this.Oi=w,this.ui=null,this.ci=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Ni=null,this.inForeground=!1,this.Bi=null,this.Li=null,this.ki=Number.NEGATIVE_INFINITY,this.qi=x=>Promise.resolve(),!_g.C())throw new se(Q.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new aC(this,s),this.Qi=t+wC,this.serializer=new HI(f),this.$i=new ts(this.Qi,this.Oi,new _C(this.serializer)),this.li=new QR,this.hi=new rC(this.referenceDelegate,this.serializer),this.remoteDocumentCache=rx(this.serializer),this.Ti=new KR,this.window&&this.window.localStorage?this.Ui=this.window.localStorage:(this.Ui=null,v===!1&&tn($i,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ki().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new se(Q.FAILED_PRECONDITION,Gp);return this.Wi(),this.Gi(),this.zi(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.hi.getHighestSequenceNumber(e)))})).then((e=>{this.ui=new jn(e,this.Mi)})).then((()=>{this.ci=!0})).catch((e=>(this.$i&&this.$i.close(),Promise.reject(e))))}ji(e){return this.qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.$i.setDatabaseDeletedListener(e)}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Fi.enqueueAndForget((async()=>{this.started&&await this.Ki()})))}Ki(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>Td(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Ji(e).next((t=>{t||(this.isPrimary=!1,this.Fi.enqueueRetryable((()=>this.qi(!1))))}))})).next((()=>this.Hi(e))).next((t=>this.isPrimary&&!t?this.Yi(e).next((()=>!1)):!!t&&this.Zi(e).next((()=>!0)))))).catch((e=>{if(cs(e))return te($i,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return te($i,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Fi.enqueueRetryable((()=>this.qi(e))),this.isPrimary=e}))}Ji(e){return iu(e).get(fa).next((t=>B.resolve(this.Xi(t))))}es(e){return Td(e).delete(this.clientId)}async ts(){if(this.isPrimary&&!this.ns(this.ki,Hp)){this.ki=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const r=At(t,Na);return r.j().next((s=>{const a=this.rs(s,Hp),l=s.filter((d=>a.indexOf(d)===-1));return B.forEach(l,(d=>r.delete(d.clientId))).next((()=>l))}))})).catch((()=>[]));if(this.Ui)for(const t of e)this.Ui.removeItem(this.ss(t.clientId))}}zi(){this.Li=this.Fi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Ki().then((()=>this.ts())).then((()=>this.zi()))))}Xi(e){return!!e&&e.ownerId===this.clientId}Hi(e){return this.xi?B.resolve(!0):iu(e).get(fa).next((t=>{if(t!==null&&this.ns(t.leaseTimestampMs,Wp)&&!this._s(t.ownerId)){if(this.Xi(t)&&this.networkEnabled)return!0;if(!this.Xi(t)){if(!t.allowTabSynchronization)throw new se(Q.FAILED_PRECONDITION,Gp);return!1}}return!(!this.networkEnabled||!this.inForeground)||Td(e).j().next((r=>this.rs(r,Wp).find((s=>{if(this.clientId!==s.clientId){const a=!this.networkEnabled&&s.networkEnabled,l=!this.inForeground&&s.inForeground,d=this.networkEnabled===s.networkEnabled;if(a||l&&d)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&te($i,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.ci=!1,this.us(),this.Li&&(this.Li.cancel(),this.Li=null),this.cs(),this.ls(),await this.$i.runTransaction("shutdown","readwrite",[$u,Na],(e=>{const t=new pm(e,jn.ue);return this.Yi(t).next((()=>this.es(t)))})),this.$i.close(),this.hs()}rs(e,t){return e.filter((r=>this.ns(r.updateTimeMs,t)&&!this._s(r.clientId)))}Ps(){return this.runTransaction("getActiveClients","readonly",(e=>Td(e).j().next((t=>this.rs(t,Hp).map((r=>r.clientId))))))}get started(){return this.ci}getGlobalsCache(){return this.li}getMutationQueue(e,t){return Bh.yt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new nC(e,this.serializer.gt.databaseId)}getDocumentOverlayCache(e){return Uh.yt(this.serializer,e)}getBundleCache(){return this.Ti}runTransaction(e,t,r){te($i,"Starting transaction:",e);const s=t==="readonly"?"readonly":"readwrite",a=(function(f){return f===18?tR:f===17?JE:f===16?eR:f===15?ig:f===14?YE:f===13?XE:f===12?ZA:f===11?QE:void pe(60245)})(this.Oi);let l;return this.$i.runTransaction(e,s,a,(d=>(l=new pm(d,this.ui?this.ui.next():jn.ue),t==="readwrite-primary"?this.Ji(l).next((f=>!!f||this.Hi(l))).next((f=>{if(!f)throw tn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Fi.enqueueRetryable((()=>this.qi(!1))),new se(Q.FAILED_PRECONDITION,UE);return r(l)})).next((f=>this.Zi(l).next((()=>f)))):this.Ts(l).next((()=>r(l)))))).then((d=>(l.raiseOnCommittedEvent(),d)))}Ts(e){return iu(e).get(fa).next((t=>{if(t!==null&&this.ns(t.leaseTimestampMs,Wp)&&!this._s(t.ownerId)&&!this.Xi(t)&&!(this.xi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new se(Q.FAILED_PRECONDITION,Gp)}))}Zi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return iu(e).put(fa,t)}static C(){return ts.C()}Yi(e){const t=iu(e);return t.get(fa).next((r=>this.Xi(r)?(te($i,"Releasing primary lease."),t.delete(fa)):B.resolve()))}ns(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(tn(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Wi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Bi=()=>{this.Fi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Ki())))},this.document.addEventListener("visibilitychange",this.Bi),this.inForeground=this.document.visibilityState==="visible")}cs(){this.Bi&&(this.document.removeEventListener("visibilitychange",this.Bi),this.Bi=null)}Gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Ni=()=>{this.us();const t=/(?:Version|Mobile)\/1[456]/;vE()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.Fi.enterRestrictedMode(!0),this.Fi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Ni))}ls(){this.Ni&&(this.window.removeEventListener("pagehide",this.Ni),this.Ni=null)}_s(e){var t;try{const r=((t=this.Ui)===null||t===void 0?void 0:t.getItem(this.ss(e)))!==null;return te($i,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return tn($i,"Failed to get zombied client id.",r),!1}}us(){if(this.Ui)try{this.Ui.setItem(this.ss(this.clientId),String(Date.now()))}catch(e){tn("Failed to set zombie client id.",e)}}hs(){if(this.Ui)try{this.Ui.removeItem(this.ss(this.clientId))}catch{}}ss(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function iu(n){return At(n,$u)}function Td(n){return At(n,Na)}function EC(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wg{constructor(e,t,r,s){this.targetId=e,this.fromCache=t,this.Is=r,this.ds=s}static Es(e,t){let r=Ae(),s=Ae();for(const a of t.docChanges)switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:s=s.add(a.doc.key)}return new wg(e,t.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IC{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sx{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=(function(){return vE()?8:zE(bt())>0?6:4})()}initialize(e,t){this.gs=e,this.indexManager=t,this.As=!0}getDocumentsMatchingQuery(e,t,r,s){const a={result:null};return this.ps(e,t).next((l=>{a.result=l})).next((()=>{if(!a.result)return this.ys(e,t,s,r).next((l=>{a.result=l}))})).next((()=>{if(a.result)return;const l=new IC;return this.ws(e,t,l).next((d=>{if(a.result=d,this.Rs)return this.Ss(e,t,l,d.size)}))})).next((()=>a.result))}Ss(e,t,r,s){return r.documentReadCount<this.Vs?(_a()<=Ne.DEBUG&&te("QueryEngine","SDK will not create cache indexes for query:",wa(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),B.resolve()):(_a()<=Ne.DEBUG&&te("QueryEngine","Query:",wa(t),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.fs*s?(_a()<=Ne.DEBUG&&te("QueryEngine","The SDK decides to create cache indexes for query:",wa(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Un(t))):B.resolve())}ps(e,t){if(vw(t))return B.resolve(null);let r=Un(t);return this.indexManager.getIndexType(e,r).next((s=>s===0?null:(t.limit!==null&&s===1&&(t=nh(t,null,"F"),r=Un(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((a=>{const l=Ae(...a);return this.gs.getDocuments(e,l).next((d=>this.indexManager.getMinOffset(e,r).next((f=>{const m=this.bs(t,d);return this.Ds(t,m,l,f.readTime)?this.ps(e,nh(t,null,"F")):this.vs(e,m,t,f)}))))})))))}ys(e,t,r,s){return vw(t)||s.isEqual(_e.min())?B.resolve(null):this.gs.getDocuments(e,r).next((a=>{const l=this.bs(t,a);return this.Ds(t,l,r,s)?B.resolve(null):(_a()<=Ne.DEBUG&&te("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),wa(t)),this.vs(e,l,t,TA(s,Tu)).next((d=>d)))}))}bs(e,t){let r=new We(vI(e));return t.forEach(((s,a)=>{Wu(e,a)&&(r=r.add(a))})),r}Ds(e,t,r,s){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const a=e.limitType==="F"?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(s)>0)}ws(e,t,r){return _a()<=Ne.DEBUG&&te("QueryEngine","Using full collection scan to execute query:",wa(t)),this.gs.getDocumentsMatchingQuery(e,t,Sn.min(),r)}vs(e,t,r,s){return this.gs.getDocumentsMatchingQuery(e,r,s).next((a=>(t.forEach((l=>{a=a.insert(l.key,l)})),a)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Eg="LocalStore",xC=3e8;class TC{constructor(e,t,r,s){this.persistence=e,this.Cs=t,this.serializer=s,this.Fs=new it(xe),this.Ms=new hi((a=>so(a)),qu),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(r)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new ix(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Fs)))}}function ox(n,e,t,r){return new TC(n,e,t,r)}async function ax(n,e){const t=ke(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next((a=>(s=a,t.Ns(e),t.mutationQueue.getAllMutationBatches(r)))).next((a=>{const l=[],d=[];let f=Ae();for(const m of s){l.push(m.batchId);for(const v of m.mutations)f=f.add(v.key)}for(const m of a){d.push(m.batchId);for(const v of m.mutations)f=f.add(v.key)}return t.localDocuments.getDocuments(r,f).next((m=>({Bs:m,removedBatchIds:l,addedBatchIds:d})))}))}))}function SC(n,e){const t=ke(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const s=e.batch.keys(),a=t.Os.newChangeBuffer({trackRemovals:!0});return(function(d,f,m,v){const w=m.batch,x=w.keys();let S=B.resolve();return x.forEach((D=>{S=S.next((()=>v.getEntry(f,D))).next((F=>{const O=m.docVersions.get(D);ye(O!==null,48541),F.version.compareTo(O)<0&&(w.applyToRemoteDocument(F,m),F.isValidDocument()&&(F.setReadTime(m.commitVersion),v.addEntry(F)))}))})),S.next((()=>d.mutationQueue.removeMutationBatch(f,w)))})(t,r,e,a).next((()=>a.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(d){let f=Ae();for(let m=0;m<d.mutationResults.length;++m)d.mutationResults[m].transformResults.length>0&&(f=f.add(d.batch.mutations[m].key));return f})(e)))).next((()=>t.localDocuments.getDocuments(r,s)))}))}function lx(n){const e=ke(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.hi.getLastRemoteSnapshotVersion(t)))}function kC(n,e){const t=ke(n),r=e.snapshotVersion;let s=t.Fs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(a=>{const l=t.Os.newChangeBuffer({trackRemovals:!0});s=t.Fs;const d=[];e.targetChanges.forEach(((v,w)=>{const x=s.get(w);if(!x)return;d.push(t.hi.removeMatchingKeys(a,v.removedDocuments,w).next((()=>t.hi.addMatchingKeys(a,v.addedDocuments,w))));let S=x.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(w)!==null?S=S.withResumeToken(Et.EMPTY_BYTE_STRING,_e.min()).withLastLimboFreeSnapshotVersion(_e.min()):v.resumeToken.approximateByteSize()>0&&(S=S.withResumeToken(v.resumeToken,r)),s=s.insert(w,S),(function(F,O,K){return F.resumeToken.approximateByteSize()===0||O.snapshotVersion.toMicroseconds()-F.snapshotVersion.toMicroseconds()>=xC?!0:K.addedDocuments.size+K.modifiedDocuments.size+K.removedDocuments.size>0})(x,S,v)&&d.push(t.hi.updateTargetData(a,S))}));let f=xn(),m=Ae();if(e.documentUpdates.forEach((v=>{e.resolvedLimboDocuments.has(v)&&d.push(t.persistence.referenceDelegate.updateLimboDocument(a,v))})),d.push(bC(a,l,e.documentUpdates).next((v=>{f=v.Ls,m=v.ks}))),!r.isEqual(_e.min())){const v=t.hi.getLastRemoteSnapshotVersion(a).next((w=>t.hi.setTargetsMetadata(a,a.currentSequenceNumber,r)));d.push(v)}return B.waitFor(d).next((()=>l.apply(a))).next((()=>t.localDocuments.getLocalViewOfDocuments(a,f,m))).next((()=>f))})).then((a=>(t.Fs=s,a)))}function bC(n,e,t){let r=Ae(),s=Ae();return t.forEach((a=>r=r.add(a))),e.getEntries(n,r).next((a=>{let l=xn();return t.forEach(((d,f)=>{const m=a.get(d);f.isFoundDocument()!==m.isFoundDocument()&&(s=s.add(d)),f.isNoDocument()&&f.version.isEqual(_e.min())?(e.removeEntry(d,f.readTime),l=l.insert(d,f)):!m.isValidDocument()||f.version.compareTo(m.version)>0||f.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(f),l=l.insert(d,f)):te(Eg,"Ignoring outdated watch update for ",d,". Current version:",m.version," Watch version:",f.version)})),{Ls:l,ks:s}}))}function AC(n,e){const t=ke(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=Ys),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function RC(n,e){const t=ke(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let s;return t.hi.getTargetData(r,e).next((a=>a?(s=a,B.resolve(s)):t.hi.allocateTargetId(r).next((l=>(s=new ri(e,l,"TargetPurposeListen",r.currentSequenceNumber),t.hi.addTargetData(r,s).next((()=>s)))))))})).then((r=>{const s=t.Fs.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.Fs=t.Fs.insert(r.targetId,r),t.Ms.set(e,r.targetId)),r}))}async function Am(n,e,t){const r=ke(n),s=r.Fs.get(e),a=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",a,(l=>r.persistence.referenceDelegate.removeTarget(l,s)))}catch(l){if(!cs(l))throw l;te(Eg,`Failed to update sequence numbers for target ${e}: ${l}`)}r.Fs=r.Fs.remove(e),r.Ms.delete(s.target)}function Qw(n,e,t){const r=ke(n);let s=_e.min(),a=Ae();return r.persistence.runTransaction("Execute query","readwrite",(l=>(function(f,m,v){const w=ke(f),x=w.Ms.get(v);return x!==void 0?B.resolve(w.Fs.get(x)):w.hi.getTargetData(m,v)})(r,l,Un(e)).next((d=>{if(d)return s=d.lastLimboFreeSnapshotVersion,r.hi.getMatchingKeysForTargetId(l,d.targetId).next((f=>{a=f}))})).next((()=>r.Cs.getDocumentsMatchingQuery(l,e,t?s:_e.min(),t?a:Ae()))).next((d=>(CC(r,gR(e),d),{documents:d,qs:a})))))}function CC(n,e,t){let r=n.xs.get(e)||_e.min();t.forEach(((s,a)=>{a.readTime.compareTo(r)>0&&(r=a.readTime)})),n.xs.set(e,r)}class Xw{constructor(){this.activeTargetIds=IR()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class ux{constructor(){this.Fo=new Xw,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,t,r){this.Mo[e]=t}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new Xw,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PC{xo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yw="ConnectivityMonitor";class Jw{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){te(Yw,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){te(Yw,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Sd=null;function Rm(){return Sd===null?Sd=(function(){return 268435456+Math.round(2147483648*Math.random())})():Sd++,"0x"+Sd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kp="RestConnection",NC={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class DC{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.$o=t+"://"+e.host,this.Uo=`projects/${r}/databases/${s}`,this.Ko=this.databaseId.database===Zd?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Wo(e,t,r,s,a){const l=Rm(),d=this.Go(e,t.toUriEncodedString());te(Kp,`Sending RPC '${e}' ${l}:`,d,r);const f={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(f,s,a);const{host:m}=new URL(d),v=Ga(m);return this.jo(e,d,f,r,v).then((w=>(te(Kp,`Received RPC '${e}' ${l}: `,w),w)),(w=>{throw Dr(Kp,`RPC '${e}' ${l} failed with error: `,w,"url: ",d,"request:",r),w}))}Jo(e,t,r,s,a,l){return this.Wo(e,t,r,s,a)}zo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Qa})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((s,a)=>e[a]=s)),r&&r.headers.forEach(((s,a)=>e[a]=s))}Go(e,t){const r=NC[e];return`${this.$o}/v1/${t}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VC{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wt="WebChannelConnection";class OC extends DC{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,t,r,s,a){const l=Rm();return new Promise(((d,f)=>{const m=new AE;m.setWithCredentials(!0),m.listenOnce(RE.COMPLETE,(()=>{try{switch(m.getLastErrorCode()){case Rd.NO_ERROR:const w=m.getResponseJson();te(Wt,`XHR for RPC '${e}' ${l} received:`,JSON.stringify(w)),d(w);break;case Rd.TIMEOUT:te(Wt,`RPC '${e}' ${l} timed out`),f(new se(Q.DEADLINE_EXCEEDED,"Request time out"));break;case Rd.HTTP_ERROR:const x=m.getStatus();if(te(Wt,`RPC '${e}' ${l} failed with status:`,x,"response text:",m.getResponseText()),x>0){let S=m.getResponseJson();Array.isArray(S)&&(S=S[0]);const D=S==null?void 0:S.error;if(D&&D.status&&D.message){const F=(function(K){const X=K.toLowerCase().replace(/_/g,"-");return Object.values(Q).indexOf(X)>=0?X:Q.UNKNOWN})(D.status);f(new se(F,D.message))}else f(new se(Q.UNKNOWN,"Server responded with status "+m.getStatus()))}else f(new se(Q.UNAVAILABLE,"Connection failed."));break;default:pe(9055,{c_:e,streamId:l,l_:m.getLastErrorCode(),h_:m.getLastError()})}}finally{te(Wt,`RPC '${e}' ${l} completed.`)}}));const v=JSON.stringify(s);te(Wt,`RPC '${e}' ${l} sending request:`,s),m.send(t,"POST",v,r,15)}))}P_(e,t,r){const s=Rm(),a=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],l=NE(),d=PE(),f={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;m!==void 0&&(f.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(f.useFetchStreams=!0),this.zo(f.initMessageHeaders,t,r),f.encodeInitMessageHeaders=!0;const v=a.join("");te(Wt,`Creating RPC '${e}' stream ${s}: ${v}`,f);const w=l.createWebChannel(v,f);this.T_(w);let x=!1,S=!1;const D=new VC({Ho:O=>{S?te(Wt,`Not sending because RPC '${e}' stream ${s} is closed:`,O):(x||(te(Wt,`Opening RPC '${e}' stream ${s} transport.`),w.open(),x=!0),te(Wt,`RPC '${e}' stream ${s} sending:`,O),w.send(O))},Yo:()=>w.close()}),F=(O,K,X)=>{O.listen(K,(q=>{try{X(q)}catch(re){setTimeout((()=>{throw re}),0)}}))};return F(w,ou.EventType.OPEN,(()=>{S||(te(Wt,`RPC '${e}' stream ${s} transport opened.`),D.s_())})),F(w,ou.EventType.CLOSE,(()=>{S||(S=!0,te(Wt,`RPC '${e}' stream ${s} transport closed`),D.__(),this.I_(w))})),F(w,ou.EventType.ERROR,(O=>{S||(S=!0,Dr(Wt,`RPC '${e}' stream ${s} transport errored. Name:`,O.name,"Message:",O.message),D.__(new se(Q.UNAVAILABLE,"The operation could not be completed")))})),F(w,ou.EventType.MESSAGE,(O=>{var K;if(!S){const X=O.data[0];ye(!!X,16349);const q=X,re=(q==null?void 0:q.error)||((K=q[0])===null||K===void 0?void 0:K.error);if(re){te(Wt,`RPC '${e}' stream ${s} received error:`,re);const de=re.status;let ne=(function(R){const A=yt[R];if(A!==void 0)return PI(A)})(de),P=re.message;ne===void 0&&(ne=Q.INTERNAL,P="Unknown error status: "+de+" with message "+re.message),S=!0,D.__(new se(ne,P)),w.close()}else te(Wt,`RPC '${e}' stream ${s} received:`,X),D.a_(X)}})),F(d,CE.STAT_EVENT,(O=>{O.stat===lm.PROXY?te(Wt,`RPC '${e}' stream ${s} detected buffering proxy`):O.stat===lm.NOPROXY&&te(Wt,`RPC '${e}' stream ${s} detected no buffering proxy`)})),setTimeout((()=>{D.o_()}),0),D}terminate(){this.u_.forEach((e=>e.close())),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter((t=>t===e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LC(){return typeof window<"u"?window:null}function Fd(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $h(n){return new MR(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cx{constructor(e,t,r=1e3,s=1.5,a=6e4){this.Fi=e,this.timerId=t,this.d_=r,this.E_=s,this.A_=a,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const t=Math.floor(this.R_+this.p_()),r=Math.max(0,Date.now()-this.m_),s=Math.max(0,t-r);s>0&&te("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.R_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,s,(()=>(this.m_=Date.now(),e()))),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zw="PersistentStream";class dx{constructor(e,t,r,s,a,l,d,f){this.Fi=e,this.w_=r,this.S_=s,this.connection=a,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=d,this.listener=f,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new cx(e,t)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,(()=>this.L_())))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():t&&t.code===Q.RESOURCE_EXHAUSTED?(tn(t.toString()),tn("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):t&&t.code===Q.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(t)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),t=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,s])=>{this.b_===t&&this.W_(r,s)}),(r=>{e((()=>{const s=new se(Q.UNKNOWN,"Fetching auth token failed: "+r.message);return this.G_(s)}))}))}W_(e,t){const r=this.K_(this.b_);this.stream=this.z_(e,t),this.stream.Zo((()=>{r((()=>this.listener.Zo()))})),this.stream.e_((()=>{r((()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,(()=>(this.x_()&&(this.state=3),Promise.resolve()))),this.listener.e_())))})),this.stream.n_((s=>{r((()=>this.G_(s)))})),this.stream.onMessage((s=>{r((()=>++this.C_==1?this.j_(s):this.onNext(s)))}))}O_(){this.state=5,this.F_.g_((async()=>{this.state=0,this.start()}))}G_(e){return te(Zw,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return t=>{this.Fi.enqueueAndForget((()=>this.b_===e?t():(te(Zw,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class MC extends dx{constructor(e,t,r,s,a,l){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,s,l),this.serializer=a}z_(e,t){return this.connection.P_("Listen",e,t)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const t=UR(this.serializer,e),r=(function(a){if(!("targetChange"in a))return _e.min();const l=a.targetChange;return l.targetIds&&l.targetIds.length?_e.min():l.readTime?rn(l.readTime):_e.min()})(e);return this.listener.J_(t,r)}H_(e){const t={};t.database=xm(this.serializer),t.addTarget=(function(a,l){let d;const f=l.target;if(d=eh(f)?{documents:FI(a,f)}:{query:UI(a,f).Vt},d.targetId=l.targetId,l.resumeToken.approximateByteSize()>0){d.resumeToken=VI(a,l.resumeToken);const m=Em(a,l.expectedCount);m!==null&&(d.expectedCount=m)}else if(l.snapshotVersion.compareTo(_e.min())>0){d.readTime=Ua(a,l.snapshotVersion.toTimestamp());const m=Em(a,l.expectedCount);m!==null&&(d.expectedCount=m)}return d})(this.serializer,e);const r=zR(this.serializer,e);r&&(t.labels=r),this.k_(t)}Y_(e){const t={};t.database=xm(this.serializer),t.removeTarget=e,this.k_(t)}}class jC extends dx{constructor(e,t,r,s,a,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,s,l),this.serializer=a}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,t){return this.connection.P_("Write",e,t)}j_(e){return ye(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ye(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){ye(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const t=BR(e.writeResults,e.commitTime),r=rn(e.commitTime);return this.listener.ta(r,t)}na(){const e={};e.database=xm(this.serializer),this.k_(e)}X_(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>ih(this.serializer,r)))};this.k_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FC{}class UC extends FC{constructor(e,t,r,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=s,this.ra=!1}ia(){if(this.ra)throw new se(Q.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,r,s){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,l])=>this.connection.Wo(e,Im(t,r),s,a,l))).catch((a=>{throw a.name==="FirebaseError"?(a.code===Q.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new se(Q.UNKNOWN,a.toString())}))}Jo(e,t,r,s,a){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,d])=>this.connection.Jo(e,Im(t,r),s,l,d,a))).catch((l=>{throw l.name==="FirebaseError"?(l.code===Q.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new se(Q.UNKNOWN,l.toString())}))}terminate(){this.ra=!0,this.connection.terminate()}}class BC{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve()))))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(tn(t),this._a=!1):te("OnlineStateTracker",t)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uo="RemoteStore";class zC{constructor(e,t,r,s,a){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=a,this.Ea.xo((l=>{r.enqueueAndForget((async()=>{_o(this)&&(te(uo,"Restarting streams for network reachability change."),await(async function(f){const m=ke(f);m.Ia.add(4),await Ku(m),m.Aa.set("Unknown"),m.Ia.delete(4),await qh(m)})(this))}))})),this.Aa=new BC(r,s)}}async function qh(n){if(_o(n))for(const e of n.da)await e(!0)}async function Ku(n){for(const e of n.da)await e(!1)}function hx(n,e){const t=ke(n);t.Ta.has(e.targetId)||(t.Ta.set(e.targetId,e),Sg(t)?Tg(t):Ja(t).x_()&&xg(t,e))}function Ig(n,e){const t=ke(n),r=Ja(t);t.Ta.delete(e),r.x_()&&fx(t,e),t.Ta.size===0&&(r.x_()?r.B_():_o(t)&&t.Aa.set("Unknown"))}function xg(n,e){if(n.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(_e.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Ja(n).H_(e)}function fx(n,e){n.Ra.$e(e),Ja(n).Y_(e)}function Tg(n){n.Ra=new DR({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>n.Ta.get(e)||null,lt:()=>n.datastore.serializer.databaseId}),Ja(n).start(),n.Aa.aa()}function Sg(n){return _o(n)&&!Ja(n).M_()&&n.Ta.size>0}function _o(n){return ke(n).Ia.size===0}function px(n){n.Ra=void 0}async function $C(n){n.Aa.set("Online")}async function qC(n){n.Ta.forEach(((e,t)=>{xg(n,e)}))}async function HC(n,e){px(n),Sg(n)?(n.Aa.la(e),Tg(n)):n.Aa.set("Unknown")}async function WC(n,e,t){if(n.Aa.set("Online"),e instanceof DI&&e.state===2&&e.cause)try{await(async function(s,a){const l=a.cause;for(const d of a.targetIds)s.Ta.has(d)&&(await s.remoteSyncer.rejectListen(d,l),s.Ta.delete(d),s.Ra.removeTarget(d))})(n,e)}catch(r){te(uo,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await uh(n,r)}else if(e instanceof Md?n.Ra.Ye(e):e instanceof NI?n.Ra.it(e):n.Ra.et(e),!t.isEqual(_e.min()))try{const r=await lx(n.localStore);t.compareTo(r)>=0&&await(function(a,l){const d=a.Ra.Pt(l);return d.targetChanges.forEach(((f,m)=>{if(f.resumeToken.approximateByteSize()>0){const v=a.Ta.get(m);v&&a.Ta.set(m,v.withResumeToken(f.resumeToken,l))}})),d.targetMismatches.forEach(((f,m)=>{const v=a.Ta.get(f);if(!v)return;a.Ta.set(f,v.withResumeToken(Et.EMPTY_BYTE_STRING,v.snapshotVersion)),fx(a,f);const w=new ri(v.target,f,m,v.sequenceNumber);xg(a,w)})),a.remoteSyncer.applyRemoteEvent(d)})(n,t)}catch(r){te(uo,"Failed to raise snapshot:",r),await uh(n,r)}}async function uh(n,e,t){if(!cs(e))throw e;n.Ia.add(1),await Ku(n),n.Aa.set("Offline"),t||(t=()=>lx(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{te(uo,"Retrying IndexedDB access"),await t(),n.Ia.delete(1),await qh(n)}))}function mx(n,e){return e().catch((t=>uh(n,t,e)))}async function Qu(n){const e=ke(n),t=as(e);let r=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:Ys;for(;GC(e);)try{const s=await AC(e.localStore,r);if(s===null){e.Pa.length===0&&t.B_();break}r=s.batchId,KC(e,s)}catch(s){await uh(e,s)}gx(e)&&yx(e)}function GC(n){return _o(n)&&n.Pa.length<10}function KC(n,e){n.Pa.push(e);const t=as(n);t.x_()&&t.Z_&&t.X_(e.mutations)}function gx(n){return _o(n)&&!as(n).M_()&&n.Pa.length>0}function yx(n){as(n).start()}async function QC(n){as(n).na()}async function XC(n){const e=as(n);for(const t of n.Pa)e.X_(t.mutations)}async function YC(n,e,t){const r=n.Pa.shift(),s=dg.from(r,e,t);await mx(n,(()=>n.remoteSyncer.applySuccessfulWrite(s))),await Qu(n)}async function JC(n,e){e&&as(n).Z_&&await(async function(r,s){if((function(l){return PR(l)&&l!==Q.ABORTED})(s.code)){const a=r.Pa.shift();as(r).N_(),await mx(r,(()=>r.remoteSyncer.rejectFailedWrite(a.batchId,s))),await Qu(r)}})(n,e),gx(n)&&yx(n)}async function e0(n,e){const t=ke(n);t.asyncQueue.verifyOperationInProgress(),te(uo,"RemoteStore received new credentials");const r=_o(t);t.Ia.add(3),await Ku(t),r&&t.Aa.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ia.delete(3),await qh(t)}async function ZC(n,e){const t=ke(n);e?(t.Ia.delete(2),await qh(t)):e||(t.Ia.add(2),await Ku(t),t.Aa.set("Unknown"))}function Ja(n){return n.Va||(n.Va=(function(t,r,s){const a=ke(t);return a.ia(),new MC(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)})(n.datastore,n.asyncQueue,{Zo:$C.bind(null,n),e_:qC.bind(null,n),n_:HC.bind(null,n),J_:WC.bind(null,n)}),n.da.push((async e=>{e?(n.Va.N_(),Sg(n)?Tg(n):n.Aa.set("Unknown")):(await n.Va.stop(),px(n))}))),n.Va}function as(n){return n.ma||(n.ma=(function(t,r,s){const a=ke(t);return a.ia(),new jC(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),e_:QC.bind(null,n),n_:JC.bind(null,n),ea:XC.bind(null,n),ta:YC.bind(null,n)}),n.da.push((async e=>{e?(n.ma.N_(),await Qu(n)):(await n.ma.stop(),n.Pa.length>0&&(te(uo,`Stopping write stream with ${n.Pa.length} pending writes`),n.Pa=[]))}))),n.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kg{constructor(e,t,r,s,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=s,this.removalCallback=a,this.deferred=new Ar,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((l=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,s,a){const l=Date.now()+r,d=new kg(e,t,l,s,a);return d.start(r),d}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new se(Q.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function bg(n,e){if(tn("AsyncQueue",`${e}: ${n}`),cs(n))return new se(Q.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ta{static emptySet(e){return new Ta(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||le.comparator(t.key,r.key):(t,r)=>le.comparator(t.key,r.key),this.keyedMap=au(),this.sortedSet=new it(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Ta)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,a=r.getNext().key;if(!s.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new Ta;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t0{constructor(){this.fa=new it(le.comparator)}track(e){const t=e.doc.key,r=this.fa.get(t);r?e.type!==0&&r.type===3?this.fa=this.fa.insert(t,e):e.type===3&&r.type!==1?this.fa=this.fa.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.fa=this.fa.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.fa=this.fa.remove(t):e.type===1&&r.type===2?this.fa=this.fa.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):pe(63341,{At:e,ga:r}):this.fa=this.fa.insert(t,e)}pa(){const e=[];return this.fa.inorderTraversal(((t,r)=>{e.push(r)})),e}}class Ba{constructor(e,t,r,s,a,l,d,f,m){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=a,this.fromCache=l,this.syncStateChanged=d,this.excludesMetadataChanges=f,this.hasCachedResults=m}static fromInitialDocuments(e,t,r,s,a){const l=[];return t.forEach((d=>{l.push({type:0,doc:d})})),new Ba(e,t,Ta.emptySet(t),l,r,s,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Oh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==r[s].type||!t[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eP{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some((e=>e.ba()))}}class tP{constructor(){this.queries=n0(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(t,r){const s=ke(t),a=s.queries;s.queries=n0(),a.forEach(((l,d)=>{for(const f of d.wa)f.onError(r)}))})(this,new se(Q.ABORTED,"Firestore shutting down"))}}function n0(){return new hi((n=>yI(n)),Oh)}async function Ag(n,e){const t=ke(n);let r=3;const s=e.query;let a=t.queries.get(s);a?!a.Sa()&&e.ba()&&(r=2):(a=new eP,r=e.ba()?0:1);try{switch(r){case 0:a.ya=await t.onListen(s,!0);break;case 1:a.ya=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(l){const d=bg(l,`Initialization of query '${wa(e.query)}' failed`);return void e.onError(d)}t.queries.set(s,a),a.wa.push(e),e.va(t.onlineState),a.ya&&e.Ca(a.ya)&&Cg(t)}async function Rg(n,e){const t=ke(n),r=e.query;let s=3;const a=t.queries.get(r);if(a){const l=a.wa.indexOf(e);l>=0&&(a.wa.splice(l,1),a.wa.length===0?s=e.ba()?0:1:!a.Sa()&&e.ba()&&(s=2))}switch(s){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function nP(n,e){const t=ke(n);let r=!1;for(const s of e){const a=s.query,l=t.queries.get(a);if(l){for(const d of l.wa)d.Ca(s)&&(r=!0);l.ya=s}}r&&Cg(t)}function rP(n,e,t){const r=ke(n),s=r.queries.get(e);if(s)for(const a of s.wa)a.onError(t);r.queries.delete(e)}function Cg(n){n.Da.forEach((e=>{e.next()}))}var Cm,r0;(r0=Cm||(Cm={})).Fa="default",r0.Cache="cache";class Pg{constructor(e,t,r){this.query=e,this.Ma=t,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=r||{}}Ca(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Ba(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),t=!0):this.Ba(e,this.onlineState)&&(this.La(e),t=!0),this.Oa=e,t}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let t=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),t=!0),t}Ba(e,t){if(!e.fromCache||!this.ba())return!0;const r=t!=="Offline";return(!this.options.ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Na(e){if(e.docChanges.length>0)return!0;const t=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}La(e){e=Ba.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==Cm.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vx{constructor(e){this.key=e}}class _x{constructor(e){this.key=e}}class iP{constructor(e,t){this.query=e,this.Ha=t,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=Ae(),this.mutatedKeys=Ae(),this.Xa=vI(e),this.eu=new Ta(this.Xa)}get tu(){return this.Ha}nu(e,t){const r=t?t.ru:new t0,s=t?t.eu:this.eu;let a=t?t.mutatedKeys:this.mutatedKeys,l=s,d=!1;const f=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,m=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal(((v,w)=>{const x=s.get(v),S=Wu(this.query,w)?w:null,D=!!x&&this.mutatedKeys.has(x.key),F=!!S&&(S.hasLocalMutations||this.mutatedKeys.has(S.key)&&S.hasCommittedMutations);let O=!1;x&&S?x.data.isEqual(S.data)?D!==F&&(r.track({type:3,doc:S}),O=!0):this.iu(x,S)||(r.track({type:2,doc:S}),O=!0,(f&&this.Xa(S,f)>0||m&&this.Xa(S,m)<0)&&(d=!0)):!x&&S?(r.track({type:0,doc:S}),O=!0):x&&!S&&(r.track({type:1,doc:x}),O=!0,(f||m)&&(d=!0)),O&&(S?(l=l.add(S),a=F?a.add(v):a.delete(v)):(l=l.delete(v),a=a.delete(v)))})),this.query.limit!==null)for(;l.size>this.query.limit;){const v=this.query.limitType==="F"?l.last():l.first();l=l.delete(v.key),a=a.delete(v.key),r.track({type:1,doc:v})}return{eu:l,ru:r,Ds:d,mutatedKeys:a}}iu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,s){const a=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const l=e.ru.pa();l.sort(((v,w)=>(function(S,D){const F=O=>{switch(O){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return pe(20277,{At:O})}};return F(S)-F(D)})(v.type,w.type)||this.Xa(v.doc,w.doc))),this.su(r),s=s!=null&&s;const d=t&&!s?this.ou():[],f=this.Za.size===0&&this.current&&!s?1:0,m=f!==this.Ya;return this.Ya=f,l.length!==0||m?{snapshot:new Ba(this.query,e.eu,a,l,e.mutatedKeys,f===0,m,!1,!!r&&r.resumeToken.approximateByteSize()>0),_u:d}:{_u:d}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new t0,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach((t=>this.Ha=this.Ha.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ha=this.Ha.delete(t))),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=Ae(),this.eu.forEach((r=>{this.au(r.key)&&(this.Za=this.Za.add(r.key))}));const t=[];return e.forEach((r=>{this.Za.has(r)||t.push(new _x(r))})),this.Za.forEach((r=>{e.has(r)||t.push(new vx(r))})),t}uu(e){this.Ha=e.qs,this.Za=Ae();const t=this.nu(e.documents);return this.applyChanges(t,!0)}cu(){return Ba.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const Ng="SyncEngine";class sP{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class oP{constructor(e){this.key=e,this.lu=!1}}class aP{constructor(e,t,r,s,a,l){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=s,this.currentUser=a,this.maxConcurrentLimboResolutions=l,this.hu={},this.Pu=new hi((d=>yI(d)),Oh),this.Tu=new Map,this.Iu=new Set,this.du=new it(le.comparator),this.Eu=new Map,this.Au=new yg,this.Ru={},this.Vu=new Map,this.mu=lo.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function lP(n,e,t=!0){const r=Sx(n);let s;const a=r.Pu.get(e);return a?(r.sharedClientState.addLocalQueryTarget(a.targetId),s=a.view.cu()):s=await wx(r,e,t,!0),s}async function uP(n,e){const t=Sx(n);await wx(t,e,!0,!1)}async function wx(n,e,t,r){const s=await RC(n.localStore,Un(e)),a=s.targetId,l=n.sharedClientState.addLocalQueryTarget(a,t);let d;return r&&(d=await cP(n,e,a,l==="current",s.resumeToken)),n.isPrimaryClient&&t&&hx(n.remoteStore,s),d}async function cP(n,e,t,r,s){n.gu=(w,x,S)=>(async function(F,O,K,X){let q=O.view.nu(K);q.Ds&&(q=await Qw(F.localStore,O.query,!1).then((({documents:P})=>O.view.nu(P,q))));const re=X&&X.targetChanges.get(O.targetId),de=X&&X.targetMismatches.get(O.targetId)!=null,ne=O.view.applyChanges(q,F.isPrimaryClient,re,de);return s0(F,O.targetId,ne._u),ne.snapshot})(n,w,x,S);const a=await Qw(n.localStore,e,!0),l=new iP(e,a.qs),d=l.nu(a.documents),f=Gu.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",s),m=l.applyChanges(d,n.isPrimaryClient,f);s0(n,t,m._u);const v=new sP(e,t,l);return n.Pu.set(e,v),n.Tu.has(t)?n.Tu.get(t).push(e):n.Tu.set(t,[e]),m.snapshot}async function dP(n,e,t){const r=ke(n),s=r.Pu.get(e),a=r.Tu.get(s.targetId);if(a.length>1)return r.Tu.set(s.targetId,a.filter((l=>!Oh(l,e)))),void r.Pu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Am(r.localStore,s.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(s.targetId),t&&Ig(r.remoteStore,s.targetId),Pm(r,s.targetId)})).catch(vo)):(Pm(r,s.targetId),await Am(r.localStore,s.targetId,!0))}async function hP(n,e){const t=ke(n),r=t.Pu.get(e),s=t.Tu.get(r.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),Ig(t.remoteStore,r.targetId))}async function fP(n,e,t){const r=kx(n);try{const s=await(function(l,d){const f=ke(l),m=qe.now(),v=d.reduce(((S,D)=>S.add(D.key)),Ae());let w,x;return f.persistence.runTransaction("Locally write mutations","readwrite",(S=>{let D=xn(),F=Ae();return f.Os.getEntries(S,v).next((O=>{D=O,D.forEach(((K,X)=>{X.isValidDocument()||(F=F.add(K))}))})).next((()=>f.localDocuments.getOverlayedDocuments(S,D))).next((O=>{w=O;const K=[];for(const X of d){const q=RR(X,w.get(X.key).overlayedDocument);q!=null&&K.push(new fi(X.key,q,lI(q.value.mapValue),Qt.exists(!0)))}return f.mutationQueue.addMutationBatch(S,m,K,d)})).next((O=>{x=O;const K=O.applyToLocalDocumentSet(w,F);return f.documentOverlayCache.saveOverlays(S,O.batchId,K)}))})).then((()=>({batchId:x.batchId,changes:wI(w)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),(function(l,d,f){let m=l.Ru[l.currentUser.toKey()];m||(m=new it(xe)),m=m.insert(d,f),l.Ru[l.currentUser.toKey()]=m})(r,s.batchId,t),await Xu(r,s.changes),await Qu(r.remoteStore)}catch(s){const a=bg(s,"Failed to persist write");t.reject(a)}}async function Ex(n,e){const t=ke(n);try{const r=await kC(t.localStore,e);e.targetChanges.forEach(((s,a)=>{const l=t.Eu.get(a);l&&(ye(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?l.lu=!0:s.modifiedDocuments.size>0?ye(l.lu,14607):s.removedDocuments.size>0&&(ye(l.lu,42227),l.lu=!1))})),await Xu(t,r,e)}catch(r){await vo(r)}}function i0(n,e,t){const r=ke(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const s=[];r.Pu.forEach(((a,l)=>{const d=l.view.va(e);d.snapshot&&s.push(d.snapshot)})),(function(l,d){const f=ke(l);f.onlineState=d;let m=!1;f.queries.forEach(((v,w)=>{for(const x of w.wa)x.va(d)&&(m=!0)})),m&&Cg(f)})(r.eventManager,e),s.length&&r.hu.J_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function pP(n,e,t){const r=ke(n);r.sharedClientState.updateQueryState(e,"rejected",t);const s=r.Eu.get(e),a=s&&s.key;if(a){let l=new it(le.comparator);l=l.insert(a,ct.newNoDocument(a,_e.min()));const d=Ae().add(a),f=new Fh(_e.min(),new Map,new it(xe),l,d);await Ex(r,f),r.du=r.du.remove(a),r.Eu.delete(e),Dg(r)}else await Am(r.localStore,e,!1).then((()=>Pm(r,e,t))).catch(vo)}async function mP(n,e){const t=ke(n),r=e.batch.batchId;try{const s=await SC(t.localStore,e);xx(t,r,null),Ix(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Xu(t,s)}catch(s){await vo(s)}}async function gP(n,e,t){const r=ke(n);try{const s=await(function(l,d){const f=ke(l);return f.persistence.runTransaction("Reject batch","readwrite-primary",(m=>{let v;return f.mutationQueue.lookupMutationBatch(m,d).next((w=>(ye(w!==null,37113),v=w.keys(),f.mutationQueue.removeMutationBatch(m,w)))).next((()=>f.mutationQueue.performConsistencyCheck(m))).next((()=>f.documentOverlayCache.removeOverlaysForBatchId(m,v,d))).next((()=>f.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,v))).next((()=>f.localDocuments.getDocuments(m,v)))}))})(r.localStore,e);xx(r,e,t),Ix(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Xu(r,s)}catch(s){await vo(s)}}function Ix(n,e){(n.Vu.get(e)||[]).forEach((t=>{t.resolve()})),n.Vu.delete(e)}function xx(n,e,t){const r=ke(n);let s=r.Ru[r.currentUser.toKey()];if(s){const a=s.get(e);a&&(t?a.reject(t):a.resolve(),s=s.remove(e)),r.Ru[r.currentUser.toKey()]=s}}function Pm(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Tu.get(e))n.Pu.delete(r),t&&n.hu.pu(r,t);n.Tu.delete(e),n.isPrimaryClient&&n.Au.zr(e).forEach((r=>{n.Au.containsKey(r)||Tx(n,r)}))}function Tx(n,e){n.Iu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(Ig(n.remoteStore,t),n.du=n.du.remove(e),n.Eu.delete(t),Dg(n))}function s0(n,e,t){for(const r of t)r instanceof vx?(n.Au.addReference(r.key,e),yP(n,r)):r instanceof _x?(te(Ng,"Document no longer in limbo: "+r.key),n.Au.removeReference(r.key,e),n.Au.containsKey(r.key)||Tx(n,r.key)):pe(19791,{yu:r})}function yP(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Iu.has(r)||(te(Ng,"New document in limbo: "+t),n.Iu.add(r),Dg(n))}function Dg(n){for(;n.Iu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Iu.values().next().value;n.Iu.delete(e);const t=new le(ze.fromString(e)),r=n.mu.next();n.Eu.set(r,new oP(t)),n.du=n.du.insert(t,r),hx(n.remoteStore,new ri(Un(Hu(t.path)),r,"TargetPurposeLimboResolution",jn.ue))}}async function Xu(n,e,t){const r=ke(n),s=[],a=[],l=[];r.Pu.isEmpty()||(r.Pu.forEach(((d,f)=>{l.push(r.gu(f,e,t).then((m=>{var v;if((m||t)&&r.isPrimaryClient){const w=m?!m.fromCache:(v=t==null?void 0:t.targetChanges.get(f.targetId))===null||v===void 0?void 0:v.current;r.sharedClientState.updateQueryState(f.targetId,w?"current":"not-current")}if(m){s.push(m);const w=wg.Es(f.targetId,m);a.push(w)}})))})),await Promise.all(l),r.hu.J_(s),await(async function(f,m){const v=ke(f);try{await v.persistence.runTransaction("notifyLocalViewChanges","readwrite",(w=>B.forEach(m,(x=>B.forEach(x.Is,(S=>v.persistence.referenceDelegate.addReference(w,x.targetId,S))).next((()=>B.forEach(x.ds,(S=>v.persistence.referenceDelegate.removeReference(w,x.targetId,S)))))))))}catch(w){if(!cs(w))throw w;te(Eg,"Failed to update sequence numbers: "+w)}for(const w of m){const x=w.targetId;if(!w.fromCache){const S=v.Fs.get(x),D=S.snapshotVersion,F=S.withLastLimboFreeSnapshotVersion(D);v.Fs=v.Fs.insert(x,F)}}})(r.localStore,a))}async function vP(n,e){const t=ke(n);if(!t.currentUser.isEqual(e)){te(Ng,"User change. New user:",e.toKey());const r=await ax(t.localStore,e);t.currentUser=e,(function(a,l){a.Vu.forEach((d=>{d.forEach((f=>{f.reject(new se(Q.CANCELLED,l))}))})),a.Vu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Xu(t,r.Bs)}}function _P(n,e){const t=ke(n),r=t.Eu.get(e);if(r&&r.lu)return Ae().add(r.key);{let s=Ae();const a=t.Tu.get(e);if(!a)return s;for(const l of a){const d=t.Pu.get(l);s=s.unionWith(d.view.tu)}return s}}function Sx(n){const e=ke(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=Ex.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=_P.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=pP.bind(null,e),e.hu.J_=nP.bind(null,e.eventManager),e.hu.pu=rP.bind(null,e.eventManager),e}function kx(n){const e=ke(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=mP.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=gP.bind(null,e),e}class Lu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=$h(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,t){return null}Fu(e,t){return null}vu(e){return ox(this.persistence,new sx,e.initialUser,this.serializer)}Du(e){return new vg(zh.Vi,this.serializer)}bu(e){return new ux}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Lu.provider={build:()=>new Lu};class wP extends Lu{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,t){ye(this.persistence.referenceDelegate instanceof lh,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new ex(r,e.asyncQueue,t)}Du(e){const t=this.cacheSizeBytes!==void 0?Gt.withCacheSize(this.cacheSizeBytes):Gt.DEFAULT;return new vg((r=>lh.Vi(r,t)),this.serializer)}}class EP extends Lu{constructor(e,t,r){super(),this.Mu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Mu.initialize(this,e),await kx(this.Mu.syncEngine),await Qu(this.Mu.remoteStore),await this.persistence.ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return ox(this.persistence,new sx,e.initialUser,this.serializer)}Cu(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new ex(r,e.asyncQueue,t)}Fu(e,t){const r=new AA(t,this.persistence);return new bA(e.asyncQueue,r)}Du(e){const t=EC(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Gt.withCacheSize(this.cacheSizeBytes):Gt.DEFAULT;return new _g(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,LC(),Fd(),this.serializer,this.sharedClientState,!!this.forceOwnership)}bu(e){return new ux}}class ch{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>i0(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=vP.bind(null,this.syncEngine),await ZC(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new tP})()}createDatastore(e){const t=$h(e.databaseInfo.databaseId),r=(function(a){return new OC(a)})(e.databaseInfo);return(function(a,l,d,f){return new UC(a,l,d,f)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,s,a,l,d){return new zC(r,s,a,l,d)})(this.localStore,this.datastore,e.asyncQueue,(t=>i0(this.syncEngine,t,0)),(function(){return Jw.C()?new Jw:new PC})())}createSyncEngine(e,t){return(function(s,a,l,d,f,m,v){const w=new aP(s,a,l,d,f,m);return v&&(w.fu=!0),w})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(s){const a=ke(s);te(uo,"RemoteStore shutting down."),a.Ia.add(5),await Ku(a),a.Ea.shutdown(),a.Aa.set("Unknown")})(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}ch.provider={build:()=>new ch};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vg{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):tn("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ls="FirestoreClient";class IP{constructor(e,t,r,s,a){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=s,this.user=Ut.UNAUTHENTICATED,this.clientId=Jm.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(r,(async l=>{te(ls,"Received user=",l.uid),await this.authCredentialListener(l),this.user=l})),this.appCheckCredentials.start(r,(l=>(te(ls,"Received new app check token=",l),this.appCheckCredentialListener(l,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ar;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=bg(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function Qp(n,e){n.asyncQueue.verifyOperationInProgress(),te(ls,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async s=>{r.isEqual(s)||(await ax(e.localStore,s),r=s)})),e.persistence.setDatabaseDeletedListener((()=>{Dr("Terminating Firestore due to IndexedDb database deletion"),n.terminate().then((()=>{te("Terminating Firestore due to IndexedDb database deletion completed successfully")})).catch((s=>{Dr("Terminating Firestore due to IndexedDb database deletion failed",s)}))})),n._offlineComponents=e}async function o0(n,e){n.asyncQueue.verifyOperationInProgress();const t=await xP(n);te(ls,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>e0(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,s)=>e0(e.remoteStore,s))),n._onlineComponents=e}async function xP(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){te(ls,"Using user provided OfflineComponentProvider");try{await Qp(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(s){return s.name==="FirebaseError"?s.code===Q.FAILED_PRECONDITION||s.code===Q.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11})(t))throw t;Dr("Error using user provided cache. Falling back to memory cache: "+t),await Qp(n,new Lu)}}else te(ls,"Using default OfflineComponentProvider"),await Qp(n,new wP(void 0));return n._offlineComponents}async function bx(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(te(ls,"Using user provided OnlineComponentProvider"),await o0(n,n._uninitializedComponentsProvider._online)):(te(ls,"Using default OnlineComponentProvider"),await o0(n,new ch))),n._onlineComponents}function TP(n){return bx(n).then((e=>e.syncEngine))}async function dh(n){const e=await bx(n),t=e.eventManager;return t.onListen=lP.bind(null,e.syncEngine),t.onUnlisten=dP.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=uP.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=hP.bind(null,e.syncEngine),t}function SP(n,e,t={}){const r=new Ar;return n.asyncQueue.enqueueAndForget((async()=>(function(a,l,d,f,m){const v=new Vg({next:x=>{v.Ou(),l.enqueueAndForget((()=>Rg(a,w)));const S=x.docs.has(d);!S&&x.fromCache?m.reject(new se(Q.UNAVAILABLE,"Failed to get document because the client is offline.")):S&&x.fromCache&&f&&f.source==="server"?m.reject(new se(Q.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(x)},error:x=>m.reject(x)}),w=new Pg(Hu(d.path),v,{includeMetadataChanges:!0,ka:!0});return Ag(a,w)})(await dh(n),n.asyncQueue,e,t,r))),r.promise}function kP(n,e,t={}){const r=new Ar;return n.asyncQueue.enqueueAndForget((async()=>(function(a,l,d,f,m){const v=new Vg({next:x=>{v.Ou(),l.enqueueAndForget((()=>Rg(a,w))),x.fromCache&&f.source==="server"?m.reject(new se(Q.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(x)},error:x=>m.reject(x)}),w=new Pg(d,v,{includeMetadataChanges:!0,ka:!0});return Ag(a,w)})(await dh(n),n.asyncQueue,e,t,r))),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ax(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a0=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rx="firestore.googleapis.com",l0=!0;class u0{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new se(Q.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Rx,this.ssl=l0}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:l0;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=XI;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<iC)throw new se(Q.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}IA("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Ax((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),(function(a){if(a.timeoutSeconds!==void 0){if(isNaN(a.timeoutSeconds))throw new se(Q.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (must not be NaN)`);if(a.timeoutSeconds<5)throw new se(Q.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (minimum allowed value is 5)`);if(a.timeoutSeconds>30)throw new se(Q.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,s){return r.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Hh{constructor(e,t,r,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new u0({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new se(Q.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new se(Q.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new u0(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new fA;switch(r.type){case"firstParty":return new yA(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new se(Q.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=a0.get(t);r&&(te("ComponentProvider","Removing Datastore"),a0.delete(t),r.terminate())})(this),Promise.resolve()}}function bP(n,e,t,r={}){var s;n=nn(n,Hh);const a=Ga(e),l=n._getSettings(),d=Object.assign(Object.assign({},l),{emulatorOptions:n._getEmulatorOptions()}),f=`${e}:${t}`;a&&(mE(`https://${f}`),gE("Firestore",!0)),l.host!==Rx&&l.host!==f&&Dr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const m=Object.assign(Object.assign({},l),{host:f,ssl:a,emulatorOptions:r});if(!is(m,d)&&(n._setSettings(m),r.mockUserToken)){let v,w;if(typeof r.mockUserToken=="string")v=r.mockUserToken,w=Ut.MOCK_USER;else{v=z1(r.mockUserToken,(s=n._app)===null||s===void 0?void 0:s.options.projectId);const x=r.mockUserToken.sub||r.mockUserToken.user_id;if(!x)throw new se(Q.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");w=new Ut(x)}n._authCredentials=new pA(new VE(v,w))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pi{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new pi(this.firestore,e,this._query)}}class dt{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ns(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new dt(this.firestore,e,this._key)}toJSON(){return{type:dt._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(zu(t,dt._jsonSchema))return new dt(e,r||null,new le(ze.fromString(t.referencePath)))}}dt._jsonSchemaVersion="firestore/documentReference/1.0",dt._jsonSchema={type:vt("string",dt._jsonSchemaVersion),referencePath:vt("string")};class ns extends pi{constructor(e,t,r){super(e,t,Hu(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new dt(this.firestore,null,new le(e))}withConverter(e){return new ns(this.firestore,e,this._path)}}function kn(n,e,...t){if(n=wt(n),ME("collection","path",e),n instanceof Hh){const r=ze.fromString(e,...t);return Z_(r),new ns(n,null,r)}{if(!(n instanceof dt||n instanceof ns))throw new se(Q.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(ze.fromString(e,...t));return Z_(r),new ns(n.firestore,null,r)}}function Or(n,e,...t){if(n=wt(n),arguments.length===1&&(e=Jm.newId()),ME("doc","path",e),n instanceof Hh){const r=ze.fromString(e,...t);return J_(r),new dt(n,null,new le(r))}{if(!(n instanceof dt||n instanceof ns))throw new se(Q.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(ze.fromString(e,...t));return J_(r),new dt(n.firestore,n instanceof ns?n.converter:null,new le(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c0="AsyncQueue";class d0{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new cx(this,"async_queue_retry"),this.oc=()=>{const r=Fd();r&&te(c0,"Visibility state changed to "+r.visibilityState),this.F_.y_()},this._c=e;const t=Fd();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const t=Fd();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise((()=>{}));const t=new Ar;return this.uc((()=>this.Xu&&this.rc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Zu.push(e),this.cc())))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!cs(e))throw e;te(c0,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_((()=>this.cc()))}}uc(e){const t=this._c.then((()=>(this.nc=!0,e().catch((r=>{throw this.tc=r,this.nc=!1,tn("INTERNAL UNHANDLED ERROR: ",h0(r)),r})).then((r=>(this.nc=!1,r))))));return this._c=t,t}enqueueAfterDelay(e,t,r){this.ac(),this.sc.indexOf(e)>-1&&(t=0);const s=kg.createAndSchedule(this,e,t,r,(a=>this.lc(a)));return this.ec.push(s),s}ac(){this.tc&&pe(47125,{hc:h0(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(const t of this.ec)if(t.timerId===e)return!0;return!1}Ic(e){return this.Pc().then((()=>{this.ec.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.ec)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Pc()}))}dc(e){this.sc.push(e)}lc(e){const t=this.ec.indexOf(e);this.ec.splice(t,1)}}function h0(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f0(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;const s=t;for(const a of r)if(a in s&&typeof s[a]=="function")return!0;return!1})(n,["next","error","complete"])}class Lr extends Hh{constructor(e,t,r,s){super(e,t,r,s),this.type="firestore",this._queue=new d0,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new d0(e),this._firestoreClient=void 0,await e}}}function AP(n,e){const t=typeof n=="object"?n:Xm(),r=typeof n=="string"?n:Zd,s=yo(t,"firestore").getImmediate({identifier:r});if(!s._initialized){const a=U1("firestore");a&&bP(s,...a)}return s}function Wh(n){if(n._terminated)throw new se(Q.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||Cx(n),n._firestoreClient}function Cx(n){var e,t,r;const s=n._freezeSettings(),a=(function(d,f,m,v){return new rR(d,f,m,v.host,v.ssl,v.experimentalForceLongPolling,v.experimentalAutoDetectLongPolling,Ax(v.experimentalLongPollingOptions),v.useFetchStreams,v.isUsingEmulator)})(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,s);n._componentsProvider||!((t=s.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),n._firestoreClient=new IP(n._authCredentials,n._appCheckCredentials,n._queue,a,n._componentsProvider&&(function(d){const f=d==null?void 0:d._online.build();return{_offline:d==null?void 0:d._offline.build(f),_online:f}})(n._componentsProvider))}function RP(n,e){Dr("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return CP(n,ch.provider,{build:r=>new EP(r,t.cacheSizeBytes,void 0)}),Promise.resolve()}function CP(n,e,t){if((n=nn(n,Lr))._firestoreClient||n._terminated)throw new se(Q.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new se(Q.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},Cx(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Mn(Et.fromBase64String(e))}catch(t){throw new se(Q.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Mn(Et.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Mn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(zu(e,Mn._jsonSchema))return Mn.fromBase64String(e.bytes)}}Mn._jsonSchemaVersion="firestore/bytes/1.0",Mn._jsonSchema={type:vt("string",Mn._jsonSchemaVersion),bytes:vt("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gh{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new se(Q.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new at(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kh{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rr{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new se(Q.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new se(Q.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return xe(this._lat,e._lat)||xe(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Rr._jsonSchemaVersion}}static fromJSON(e){if(zu(e,Rr._jsonSchema))return new Rr(e.latitude,e.longitude)}}Rr._jsonSchemaVersion="firestore/geoPoint/1.0",Rr._jsonSchema={type:vt("string",Rr._jsonSchemaVersion),latitude:vt("number"),longitude:vt("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cr{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,s){if(r.length!==s.length)return!1;for(let a=0;a<r.length;++a)if(r[a]!==s[a])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Cr._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(zu(e,Cr._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Cr(e.vectorValues);throw new se(Q.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Cr._jsonSchemaVersion="firestore/vectorValue/1.0",Cr._jsonSchema={type:vt("string",Cr._jsonSchemaVersion),vectorValues:vt("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PP=/^__.*__$/;class NP{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new fi(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ya(e,this.data,t,this.fieldTransforms)}}class Px{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new fi(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function Nx(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw pe(40011,{Ec:n})}}class Og{constructor(e,t,r,s,a,l){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=s,a===void 0&&this.Ac(),this.fieldTransforms=a||[],this.fieldMask=l||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new Og(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Rc({path:r,mc:!1});return s.fc(e),s}gc(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Rc({path:r,mc:!1});return s.Ac(),s}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return hh(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(Nx(this.Ec)&&PP.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class DP{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||$h(e)}Dc(e,t,r,s=!1){return new Og({Ec:e,methodName:t,bc:r,path:at.emptyPath(),mc:!1,Sc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Qh(n){const e=n._freezeSettings(),t=$h(n._databaseId);return new DP(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Dx(n,e,t,r,s,a={}){const l=n.Dc(a.merge||a.mergeFields?2:0,e,t,s);Mg("Data must be an object, but it was:",l,r);const d=Vx(r,l);let f,m;if(a.merge)f=new fn(l.fieldMask),m=l.fieldTransforms;else if(a.mergeFields){const v=[];for(const w of a.mergeFields){const x=Nm(e,w,t);if(!l.contains(x))throw new se(Q.INVALID_ARGUMENT,`Field '${x}' is specified in your field mask but missing from your input data.`);Lx(v,x)||v.push(x)}f=new fn(v),m=l.fieldTransforms.filter((w=>f.covers(w.field)))}else f=null,m=l.fieldTransforms;return new NP(new Kt(d),f,m)}class Xh extends Kh{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Xh}}class Lg extends Kh{_toFieldTransform(e){return new bI(e.path,new Ma)}isEqual(e){return e instanceof Lg}}function VP(n,e,t,r){const s=n.Dc(1,e,t);Mg("Data must be an object, but it was:",s,r);const a=[],l=Kt.empty();ds(r,((f,m)=>{const v=jg(e,f,t);m=wt(m);const w=s.gc(v);if(m instanceof Xh)a.push(v);else{const x=Yu(m,w);x!=null&&(a.push(v),l.set(v,x))}}));const d=new fn(a);return new Px(l,d,s.fieldTransforms)}function OP(n,e,t,r,s,a){const l=n.Dc(1,e,t),d=[Nm(e,r,t)],f=[s];if(a.length%2!=0)throw new se(Q.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let x=0;x<a.length;x+=2)d.push(Nm(e,a[x])),f.push(a[x+1]);const m=[],v=Kt.empty();for(let x=d.length-1;x>=0;--x)if(!Lx(m,d[x])){const S=d[x];let D=f[x];D=wt(D);const F=l.gc(S);if(D instanceof Xh)m.push(S);else{const O=Yu(D,F);O!=null&&(m.push(S),v.set(S,O))}}const w=new fn(m);return new Px(v,w,l.fieldTransforms)}function LP(n,e,t,r=!1){return Yu(t,n.Dc(r?4:3,e))}function Yu(n,e){if(Ox(n=wt(n)))return Mg("Unsupported field value:",e,n),Vx(n,e);if(n instanceof Kh)return(function(r,s){if(!Nx(s.Ec))throw s.wc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.wc(`${r._methodName}() is not currently supported inside arrays`);const a=r._toFieldTransform(s);a&&s.fieldTransforms.push(a)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return(function(r,s){const a=[];let l=0;for(const d of r){let f=Yu(d,s.yc(l));f==null&&(f={nullValue:"NULL_VALUE"}),a.push(f),l++}return{arrayValue:{values:a}}})(n,e)}return(function(r,s){if((r=wt(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return xR(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const a=qe.fromDate(r);return{timestampValue:Ua(s.serializer,a)}}if(r instanceof qe){const a=new qe(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ua(s.serializer,a)}}if(r instanceof Rr)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Mn)return{bytesValue:VI(s.serializer,r._byteString)};if(r instanceof dt){const a=s.databaseId,l=r.firestore._databaseId;if(!l.isEqual(a))throw s.wc(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:pg(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Cr)return(function(l,d){return{mapValue:{fields:{[og]:{stringValue:ag},[Da]:{arrayValue:{values:l.toArray().map((m=>{if(typeof m!="number")throw d.wc("VectorValues must only contain numeric values.");return ug(d.serializer,m)}))}}}}}})(r,s);throw s.wc(`Unsupported field value: ${bh(r)}`)})(n,e)}function Vx(n,e){const t={};return ZE(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ds(n,((r,s)=>{const a=Yu(s,e.Vc(r));a!=null&&(t[r]=a)})),{mapValue:{fields:t}}}function Ox(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof qe||n instanceof Rr||n instanceof Mn||n instanceof dt||n instanceof Kh||n instanceof Cr)}function Mg(n,e,t){if(!Ox(t)||!jE(t)){const r=bh(t);throw r==="an object"?e.wc(n+" a custom object"):e.wc(n+" "+r)}}function Nm(n,e,t){if((e=wt(e))instanceof Gh)return e._internalPath;if(typeof e=="string")return jg(n,e);throw hh("Field path arguments must be of type string or ",n,!1,void 0,t)}const MP=new RegExp("[~\\*/\\[\\]]");function jg(n,e,t){if(e.search(MP)>=0)throw hh(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Gh(...e.split("."))._internalPath}catch{throw hh(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function hh(n,e,t,r,s){const a=r&&!r.isEmpty(),l=s!==void 0;let d=`Function ${e}() called with invalid data`;t&&(d+=" (via `toFirestore()`)"),d+=". ";let f="";return(a||l)&&(f+=" (found",a&&(f+=` in field ${r}`),l&&(f+=` in document ${s}`),f+=")"),new se(Q.INVALID_ARGUMENT,d+n+f)}function Lx(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mx{constructor(e,t,r,s,a){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=s,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new dt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new jP(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Yh("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class jP extends Mx{data(){return super.data()}}function Yh(n,e){return typeof e=="string"?jg(n,e):e instanceof Gh?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jx(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new se(Q.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Fg{}class Ug extends Fg{}function hr(n,e,...t){let r=[];e instanceof Fg&&r.push(e),r=r.concat(t),(function(a){const l=a.filter((f=>f instanceof Bg)).length,d=a.filter((f=>f instanceof Jh)).length;if(l>1||l>0&&d>0)throw new se(Q.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const s of r)n=s._apply(n);return n}class Jh extends Ug{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new Jh(e,t,r)}_apply(e){const t=this._parse(e);return Fx(e._query,t),new pi(e.firestore,e.converter,wm(e._query,t))}_parse(e){const t=Qh(e.firestore);return(function(a,l,d,f,m,v,w){let x;if(m.isKeyField()){if(v==="array-contains"||v==="array-contains-any")throw new se(Q.INVALID_ARGUMENT,`Invalid Query. You can't perform '${v}' queries on documentId().`);if(v==="in"||v==="not-in"){m0(w,v);const D=[];for(const F of w)D.push(p0(f,a,F));x={arrayValue:{values:D}}}else x=p0(f,a,w)}else v!=="in"&&v!=="not-in"&&v!=="array-contains-any"||m0(w,v),x=LP(d,l,w,v==="in"||v==="not-in");return De.create(m,v,x)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function _t(n,e,t){const r=e,s=Yh("where",n);return Jh._create(s,r,t)}class Bg extends Fg{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Bg(e,t)}_parse(e){const t=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return t.length===1?t[0]:He.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(s,a){let l=s;const d=a.getFlattenedFilters();for(const f of d)Fx(l,f),l=wm(l,f)})(e._query,t),new pi(e.firestore,e.converter,wm(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class zg extends Ug{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new zg(e,t)}_apply(e){const t=(function(s,a,l){if(s.startAt!==null)throw new se(Q.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new se(Q.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Vu(a,l)})(e._query,this._field,this._direction);return new pi(e.firestore,e.converter,(function(s,a){const l=s.explicitOrderBy.concat([a]);return new Xa(s.path,s.collectionGroup,l,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)})(e._query,t))}}function Za(n,e="asc"){const t=e,r=Yh("orderBy",n);return zg._create(r,t)}class $g extends Ug{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new $g(e,t,r)}_apply(e){return new pi(e.firestore,e.converter,nh(e._query,this._limit,this._limitType))}}function FP(n){return xA("limit",n),$g._create("limit",n,"F")}function p0(n,e,t){if(typeof(t=wt(t))=="string"){if(t==="")throw new se(Q.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!gI(e)&&t.indexOf("/")!==-1)throw new se(Q.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(ze.fromString(t));if(!le.isDocumentKey(r))throw new se(Q.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Nu(n,new le(r))}if(t instanceof dt)return Nu(n,t._key);throw new se(Q.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${bh(t)}.`)}function m0(n,e){if(!Array.isArray(n)||n.length===0)throw new se(Q.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Fx(n,e){const t=(function(s,a){for(const l of s)for(const d of l.getFlattenedFilters())if(a.indexOf(d.op)>=0)return d.op;return null})(n.filters,(function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new se(Q.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new se(Q.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class UP{convertValue(e,t="none"){switch(ss(e)){case 0:return null;case 1:return e.booleanValue;case 2:return nt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ci(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw pe(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return ds(e,((s,a)=>{r[s]=this.convertValue(a,t)})),r}convertVectorValue(e){var t,r,s;const a=(s=(r=(t=e.fields)===null||t===void 0?void 0:t[Da].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map((l=>nt(l.doubleValue)));return new Cr(a)}convertGeoPoint(e){return new Rr(nt(e.latitude),nt(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Dh(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Cu(e));default:return null}}convertTimestamp(e){const t=ui(e);return new qe(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=ze.fromString(e);ye(qI(r),9688,{name:e});const s=new io(r.get(1),r.get(3)),a=new le(r.popFirst(5));return s.isEqual(t)||tn(`Document ${a} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ux(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class cu{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class eo extends Mx{constructor(e,t,r,s,a,l){super(e,t,r,s,l),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Ud(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Yh("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new se(Q.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=eo._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}eo._jsonSchemaVersion="firestore/documentSnapshot/1.0",eo._jsonSchema={type:vt("string",eo._jsonSchemaVersion),bundleSource:vt("string","DocumentSnapshot"),bundleName:vt("string"),bundle:vt("string")};class Ud extends eo{data(e={}){return super.data(e)}}class to{constructor(e,t,r,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new cu(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new Ud(this._firestore,this._userDataWriter,r.key,r,new cu(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new se(Q.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(s,a){if(s._snapshot.oldDocs.isEmpty()){let l=0;return s._snapshot.docChanges.map((d=>{const f=new Ud(s._firestore,s._userDataWriter,d.doc.key,d.doc,new cu(s._snapshot.mutatedKeys.has(d.doc.key),s._snapshot.fromCache),s.query.converter);return d.doc,{type:"added",doc:f,oldIndex:-1,newIndex:l++}}))}{let l=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((d=>a||d.type!==3)).map((d=>{const f=new Ud(s._firestore,s._userDataWriter,d.doc.key,d.doc,new cu(s._snapshot.mutatedKeys.has(d.doc.key),s._snapshot.fromCache),s.query.converter);let m=-1,v=-1;return d.type!==0&&(m=l.indexOf(d.doc.key),l=l.delete(d.doc.key)),d.type!==1&&(l=l.add(d.doc),v=l.indexOf(d.doc.key)),{type:BP(d.type),doc:f,oldIndex:m,newIndex:v}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new se(Q.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=to._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=Jm.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],s=[];return this.docs.forEach((a=>{a._document!==null&&(t.push(a._document),r.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),s.push(a.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function BP(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return pe(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function za(n){n=nn(n,dt);const e=nn(n.firestore,Lr);return SP(Wh(e),n._key).then((t=>qx(e,n,t)))}to._jsonSchemaVersion="firestore/querySnapshot/1.0",to._jsonSchema={type:vt("string",to._jsonSchemaVersion),bundleSource:vt("string","QuerySnapshot"),bundleName:vt("string"),bundle:vt("string")};class qg extends UP{constructor(e){super(),this.firestore=e}convertBytes(e){return new Mn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new dt(this.firestore,null,t)}}function mi(n){n=nn(n,pi);const e=nn(n.firestore,Lr),t=Wh(e),r=new qg(e);return jx(n._query),kP(t,n._query).then((s=>new to(e,r,n,s)))}function Bx(n,e,t){n=nn(n,dt);const r=nn(n.firestore,Lr),s=Ux(n.converter,e,t);return Zh(r,[Dx(Qh(r),"setDoc",n._key,s,n.converter!==null,t).toMutation(n._key,Qt.none())])}function zP(n,e,t,...r){n=nn(n,dt);const s=nn(n.firestore,Lr),a=Qh(s);let l;return l=typeof(e=wt(e))=="string"||e instanceof Gh?OP(a,"updateDoc",n._key,e,t,r):VP(a,"updateDoc",n._key,e),Zh(s,[l.toMutation(n._key,Qt.exists(!0))])}function Hg(n){return Zh(nn(n.firestore,Lr),[new jh(n._key,Qt.none())])}function zx(n,e){const t=nn(n.firestore,Lr),r=Or(n),s=Ux(n.converter,e);return Zh(t,[Dx(Qh(n.firestore),"addDoc",r._key,s,n.converter!==null,{}).toMutation(r._key,Qt.exists(!1))]).then((()=>r))}function $x(n,...e){var t,r,s;n=wt(n);let a={includeMetadataChanges:!1,source:"default"},l=0;typeof e[l]!="object"||f0(e[l])||(a=e[l++]);const d={includeMetadataChanges:a.includeMetadataChanges,source:a.source};if(f0(e[l])){const w=e[l];e[l]=(t=w.next)===null||t===void 0?void 0:t.bind(w),e[l+1]=(r=w.error)===null||r===void 0?void 0:r.bind(w),e[l+2]=(s=w.complete)===null||s===void 0?void 0:s.bind(w)}let f,m,v;if(n instanceof dt)m=nn(n.firestore,Lr),v=Hu(n._key.path),f={next:w=>{e[l]&&e[l](qx(m,n,w))},error:e[l+1],complete:e[l+2]};else{const w=nn(n,pi);m=nn(w.firestore,Lr),v=w._query;const x=new qg(m);f={next:S=>{e[l]&&e[l](new to(m,x,w,S))},error:e[l+1],complete:e[l+2]},jx(n._query)}return(function(x,S,D,F){const O=new Vg(F),K=new Pg(S,O,D);return x.asyncQueue.enqueueAndForget((async()=>Ag(await dh(x),K))),()=>{O.Ou(),x.asyncQueue.enqueueAndForget((async()=>Rg(await dh(x),K)))}})(Wh(m),v,d,f)}function Zh(n,e){return(function(r,s){const a=new Ar;return r.asyncQueue.enqueueAndForget((async()=>fP(await TP(r),s,a))),a.promise})(Wh(n),e)}function qx(n,e,t){const r=t.docs.get(e._key),s=new qg(n);return new eo(n,s,e._key,r,new cu(t.hasPendingWrites,t.fromCache),e.converter)}function Mu(){return new Lg("serverTimestamp")}(function(e,t=!0){(function(s){Qa=s})(Ka),Nr(new ur("firestore",((r,{instanceIdentifier:s,options:a})=>{const l=r.getProvider("app").getImmediate(),d=new Lr(new mA(r.getProvider("auth-internal")),new vA(l,r.getProvider("app-check-internal")),(function(m,v){if(!Object.prototype.hasOwnProperty.apply(m.options,["projectId"]))throw new se(Q.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new io(m.options.projectId,v)})(l,s),l);return a=Object.assign({useFetchStreams:t},a),d._setSettings(a),d}),"PUBLIC").setMultipleInstances(!0)),Fn(G_,K_,e),Fn(G_,K_,"esm2017")})();var $P="firebase",qP="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Fn($P,qP,"app");function Wg(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t}function Hx(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const HP=Hx,Wx=new go("auth","Firebase",Hx());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fh=new kh("@firebase/auth");function WP(n,...e){fh.logLevel<=Ne.WARN&&fh.warn(`Auth (${Ka}): ${n}`,...e)}function Bd(n,...e){fh.logLevel<=Ne.ERROR&&fh.error(`Auth (${Ka}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mr(n,...e){throw Kg(n,...e)}function lr(n,...e){return Kg(n,...e)}function Gg(n,e,t){const r=Object.assign(Object.assign({},HP()),{[e]:t});return new go("auth","Firebase",r).create(e,{appName:n.name})}function no(n){return Gg(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function GP(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&Mr(n,"argument-error"),Gg(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Kg(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return Wx.create(n,...e)}function Se(n,e,...t){if(!n)throw Kg(e,...t)}function ii(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Bd(e),new Error(e)}function di(n,e){n||ii(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dm(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function KP(){return g0()==="http:"||g0()==="https:"}function g0(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QP(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(KP()||Gm()||"connection"in navigator)?navigator.onLine:!0}function XP(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ju{constructor(e,t){this.shortDelay=e,this.longDelay=t,di(t>e,"Short delay should be less than long delay!"),this.isMobile=H1()||G1()}get(){return QP()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qg(n,e){di(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gx{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ii("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ii("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ii("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YP={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JP=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],ZP=new Ju(3e4,6e4);function Xg(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function el(n,e,t,r,s={}){return Kx(n,s,async()=>{let a={},l={};r&&(e==="GET"?l=r:a={body:JSON.stringify(r)});const d=Bu(Object.assign({key:n.config.apiKey},l)).slice(1),f=await n._getAdditionalHeaders();f["Content-Type"]="application/json",n.languageCode&&(f["X-Firebase-Locale"]=n.languageCode);const m=Object.assign({method:e,headers:f},a);return W1()||(m.referrerPolicy="no-referrer"),n.emulatorConfig&&Ga(n.emulatorConfig.host)&&(m.credentials="include"),Gx.fetch()(await Qx(n,n.config.apiHost,t,d),m)})}async function Kx(n,e,t){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},YP),e);try{const s=new tN(n),a=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const l=await a.json();if("needConfirmation"in l)throw kd(n,"account-exists-with-different-credential",l);if(a.ok&&!("errorMessage"in l))return l;{const d=a.ok?l.errorMessage:l.error.message,[f,m]=d.split(" : ");if(f==="FEDERATED_USER_ID_ALREADY_LINKED")throw kd(n,"credential-already-in-use",l);if(f==="EMAIL_EXISTS")throw kd(n,"email-already-in-use",l);if(f==="USER_DISABLED")throw kd(n,"user-disabled",l);const v=r[f]||f.toLowerCase().replace(/[_\s]+/g,"-");if(m)throw Gg(n,v,m);Mr(n,v)}}catch(s){if(s instanceof dr)throw s;Mr(n,"network-request-failed",{message:String(s)})}}async function eN(n,e,t,r,s={}){const a=await el(n,e,t,r,s);return"mfaPendingCredential"in a&&Mr(n,"multi-factor-auth-required",{_serverResponse:a}),a}async function Qx(n,e,t,r){const s=`${e}${t}?${r}`,a=n,l=a.config.emulator?Qg(n.config,s):`${n.config.apiScheme}://${s}`;return JP.includes(t)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(l).toString():l}class tN{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(lr(this.auth,"network-request-failed")),ZP.get())})}}function kd(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const s=lr(n,e,r);return s.customData._tokenResponse=t,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nN(n,e){return el(n,"POST","/v1/accounts:delete",e)}async function ph(n,e){return el(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wu(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function rN(n,e=!1){const t=wt(n),r=await t.getIdToken(e),s=Yg(r);Se(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const a=typeof s.firebase=="object"?s.firebase:void 0,l=a==null?void 0:a.sign_in_provider;return{claims:s,token:r,authTime:wu(Xp(s.auth_time)),issuedAtTime:wu(Xp(s.iat)),expirationTime:wu(Xp(s.exp)),signInProvider:l||null,signInSecondFactor:(a==null?void 0:a.sign_in_second_factor)||null}}function Xp(n){return Number(n)*1e3}function Yg(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Bd("JWT malformed, contained fewer than 3 sections"),null;try{const s=cE(t);return s?JSON.parse(s):(Bd("Failed to decode base64 JWT payload"),null)}catch(s){return Bd("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function y0(n){const e=Yg(n);return Se(e,"internal-error"),Se(typeof e.exp<"u","internal-error"),Se(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ju(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof dr&&iN(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function iN({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sN{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vm{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=wu(this.lastLoginAt),this.creationTime=wu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mh(n){var e;const t=n.auth,r=await n.getIdToken(),s=await ju(n,ph(t,{idToken:r}));Se(s==null?void 0:s.users.length,t,"internal-error");const a=s.users[0];n._notifyReloadListener(a);const l=!((e=a.providerUserInfo)===null||e===void 0)&&e.length?Xx(a.providerUserInfo):[],d=aN(n.providerData,l),f=n.isAnonymous,m=!(n.email&&a.passwordHash)&&!(d!=null&&d.length),v=f?m:!1,w={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:d,metadata:new Vm(a.createdAt,a.lastLoginAt),isAnonymous:v};Object.assign(n,w)}async function oN(n){const e=wt(n);await mh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function aN(n,e){return[...n.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function Xx(n){return n.map(e=>{var{providerId:t}=e,r=Wg(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lN(n,e){const t=await Kx(n,{},async()=>{const r=Bu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:a}=n.config,l=await Qx(n,s,"/v1/token",`key=${a}`),d=await n._getAdditionalHeaders();d["Content-Type"]="application/x-www-form-urlencoded";const f={method:"POST",headers:d,body:r};return n.emulatorConfig&&Ga(n.emulatorConfig.host)&&(f.credentials="include"),Gx.fetch()(l,f)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function uN(n,e){return el(n,"POST","/v2/accounts:revokeToken",Xg(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sa{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Se(e.idToken,"internal-error"),Se(typeof e.idToken<"u","internal-error"),Se(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):y0(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Se(e.length!==0,"internal-error");const t=y0(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(Se(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:s,expiresIn:a}=await lN(e,t);this.updateTokensAndExpiration(r,s,Number(a))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:s,expirationTime:a}=t,l=new Sa;return r&&(Se(typeof r=="string","internal-error",{appName:e}),l.refreshToken=r),s&&(Se(typeof s=="string","internal-error",{appName:e}),l.accessToken=s),a&&(Se(typeof a=="number","internal-error",{appName:e}),l.expirationTime=a),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Sa,this.toJSON())}_performRefresh(){return ii("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qi(n,e){Se(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class ar{constructor(e){var{uid:t,auth:r,stsTokenManager:s}=e,a=Wg(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new sN(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new Vm(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const t=await ju(this,this.stsTokenManager.getToken(this.auth,e));return Se(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return rN(this,e)}reload(){return oN(this)}_assign(e){this!==e&&(Se(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new ar(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Se(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await mh(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(or(this.auth.app))return Promise.reject(no(this.auth));const e=await this.getIdToken();return await ju(this,nN(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,s,a,l,d,f,m,v;const w=(r=t.displayName)!==null&&r!==void 0?r:void 0,x=(s=t.email)!==null&&s!==void 0?s:void 0,S=(a=t.phoneNumber)!==null&&a!==void 0?a:void 0,D=(l=t.photoURL)!==null&&l!==void 0?l:void 0,F=(d=t.tenantId)!==null&&d!==void 0?d:void 0,O=(f=t._redirectEventId)!==null&&f!==void 0?f:void 0,K=(m=t.createdAt)!==null&&m!==void 0?m:void 0,X=(v=t.lastLoginAt)!==null&&v!==void 0?v:void 0,{uid:q,emailVerified:re,isAnonymous:de,providerData:ne,stsTokenManager:P}=t;Se(q&&P,e,"internal-error");const k=Sa.fromJSON(this.name,P);Se(typeof q=="string",e,"internal-error"),qi(w,e.name),qi(x,e.name),Se(typeof re=="boolean",e,"internal-error"),Se(typeof de=="boolean",e,"internal-error"),qi(S,e.name),qi(D,e.name),qi(F,e.name),qi(O,e.name),qi(K,e.name),qi(X,e.name);const R=new ar({uid:q,auth:e,email:x,emailVerified:re,displayName:w,isAnonymous:de,photoURL:D,phoneNumber:S,tenantId:F,stsTokenManager:k,createdAt:K,lastLoginAt:X});return ne&&Array.isArray(ne)&&(R.providerData=ne.map(A=>Object.assign({},A))),O&&(R._redirectEventId=O),R}static async _fromIdTokenResponse(e,t,r=!1){const s=new Sa;s.updateFromServerResponse(t);const a=new ar({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await mh(a),a}static async _fromGetAccountInfoResponse(e,t,r){const s=t.users[0];Se(s.localId!==void 0,"internal-error");const a=s.providerUserInfo!==void 0?Xx(s.providerUserInfo):[],l=!(s.email&&s.passwordHash)&&!(a!=null&&a.length),d=new Sa;d.updateFromIdToken(r);const f=new ar({uid:s.localId,auth:e,stsTokenManager:d,isAnonymous:l}),m={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Vm(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(a!=null&&a.length)};return Object.assign(f,m),f}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v0=new Map;function si(n){di(n instanceof Function,"Expected a class definition");let e=v0.get(n);return e?(di(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,v0.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yx{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Yx.type="NONE";const _0=Yx;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zd(n,e,t){return`firebase:${n}:${e}:${t}`}class ka{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:s,name:a}=this.auth;this.fullUserKey=zd(this.userKey,s.apiKey,a),this.fullPersistenceKey=zd("persistence",s.apiKey,a),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await ph(this.auth,{idToken:e}).catch(()=>{});return t?ar._fromGetAccountInfoResponse(this.auth,t,e):null}return ar._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new ka(si(_0),e,r);const s=(await Promise.all(t.map(async m=>{if(await m._isAvailable())return m}))).filter(m=>m);let a=s[0]||si(_0);const l=zd(r,e.config.apiKey,e.name);let d=null;for(const m of t)try{const v=await m._get(l);if(v){let w;if(typeof v=="string"){const x=await ph(e,{idToken:v}).catch(()=>{});if(!x)break;w=await ar._fromGetAccountInfoResponse(e,x,v)}else w=ar._fromJSON(e,v);m!==a&&(d=w),a=m;break}}catch{}const f=s.filter(m=>m._shouldAllowMigration);return!a._shouldAllowMigration||!f.length?new ka(a,e,r):(a=f[0],d&&await a._set(l,d.toJSON()),await Promise.all(t.map(async m=>{if(m!==a)try{await m._remove(l)}catch{}})),new ka(a,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w0(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(tT(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Jx(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(rT(e))return"Blackberry";if(iT(e))return"Webos";if(Zx(e))return"Safari";if((e.includes("chrome/")||eT(e))&&!e.includes("edge/"))return"Chrome";if(nT(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function Jx(n=bt()){return/firefox\//i.test(n)}function Zx(n=bt()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function eT(n=bt()){return/crios\//i.test(n)}function tT(n=bt()){return/iemobile/i.test(n)}function nT(n=bt()){return/android/i.test(n)}function rT(n=bt()){return/blackberry/i.test(n)}function iT(n=bt()){return/webos/i.test(n)}function Jg(n=bt()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function cN(n=bt()){var e;return Jg(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function dN(){return K1()&&document.documentMode===10}function sT(n=bt()){return Jg(n)||nT(n)||iT(n)||rT(n)||/windows phone/i.test(n)||tT(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oT(n,e=[]){let t;switch(n){case"Browser":t=w0(bt());break;case"Worker":t=`${w0(bt())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Ka}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hN{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=a=>new Promise((l,d)=>{try{const f=e(a);l(f)}catch(f){d(f)}});r.onAbort=t,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fN(n,e={}){return el(n,"GET","/v2/passwordPolicy",Xg(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pN=6;class mN{constructor(e){var t,r,s,a;const l=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=l.minPasswordLength)!==null&&t!==void 0?t:pN,l.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=l.maxPasswordLength),l.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=l.containsLowercaseCharacter),l.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=l.containsUppercaseCharacter),l.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=l.containsNumericCharacter),l.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=l.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(a=e.forceUpgradeOnSignin)!==null&&a!==void 0?a:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,s,a,l,d;const f={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,f),this.validatePasswordCharacterOptions(e,f),f.isValid&&(f.isValid=(t=f.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),f.isValid&&(f.isValid=(r=f.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),f.isValid&&(f.isValid=(s=f.containsLowercaseLetter)!==null&&s!==void 0?s:!0),f.isValid&&(f.isValid=(a=f.containsUppercaseLetter)!==null&&a!==void 0?a:!0),f.isValid&&(f.isValid=(l=f.containsNumericCharacter)!==null&&l!==void 0?l:!0),f.isValid&&(f.isValid=(d=f.containsNonAlphanumericCharacter)!==null&&d!==void 0?d:!0),f}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,s,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gN{constructor(e,t,r,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new E0(this),this.idTokenSubscription=new E0(this),this.beforeStateQueue=new hN(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Wx,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=si(t)),this._initializationPromise=this.queue(async()=>{var r,s,a;if(!this._deleted&&(this.persistenceManager=await ka.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((s=this._popupRedirectResolver)===null||s===void 0)&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((a=this.currentUser)===null||a===void 0?void 0:a.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await ph(this,{idToken:e}),r=await ar._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(or(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(d,d))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,d=s==null?void 0:s._redirectEventId,f=await this.tryRedirectSignIn(e);(!l||l===d)&&(f!=null&&f.user)&&(s=f.user,a=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(s)}catch(l){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return Se(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await mh(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=XP()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(or(this.app))return Promise.reject(no(this));const t=e?wt(e):null;return t&&Se(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Se(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return or(this.app)?Promise.reject(no(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return or(this.app)?Promise.reject(no(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(si(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await fN(this),t=new mN(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new go("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await uN(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&si(e)||this._popupRedirectResolver;Se(t,this,"argument-error"),this.redirectPersistenceManager=await ka.create(this,[si(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,s){if(this._deleted)return()=>{};const a=typeof t=="function"?t:t.next.bind(t);let l=!1;const d=this._isInitialized?Promise.resolve():this._initializationPromise;if(Se(d,this,"internal-error"),d.then(()=>{l||a(this.currentUser)}),typeof t=="function"){const f=e.addObserver(t,r,s);return()=>{l=!0,f()}}else{const f=e.addObserver(t);return()=>{l=!0,f()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Se(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=oT(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(t["X-Firebase-AppCheck"]=s),t}async _getAppCheckToken(){var e;if(or(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&WP(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function ef(n){return wt(n)}class E0{constructor(e){this.auth=e,this.observer=null,this.addObserver=Z1(t=>this.observer=t)}get next(){return Se(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zg={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function yN(n){Zg=n}function vN(n){return Zg.loadJS(n)}function _N(){return Zg.gapiScript}function wN(n){return`__${n}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EN(n,e){const t=yo(n,"auth");if(t.isInitialized()){const s=t.getImmediate(),a=t.getOptions();if(is(a,e??{}))return s;Mr(s,"already-initialized")}return t.initialize({options:e})}function IN(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(si);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function xN(n,e,t){const r=ef(n);Se(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,a=aT(e),{host:l,port:d}=TN(e),f=d===null?"":`:${d}`,m={url:`${a}//${l}${f}/`},v=Object.freeze({host:l,port:d,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){Se(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Se(is(m,r.config.emulator)&&is(v,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=m,r.emulatorConfig=v,r.settings.appVerificationDisabledForTesting=!0,Ga(l)?(mE(`${a}//${l}${f}`),gE("Auth",!0)):SN()}function aT(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function TN(n){const e=aT(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const a=s[1];return{host:a,port:I0(r.substr(a.length+1))}}else{const[a,l]=r.split(":");return{host:a,port:I0(l)}}}function I0(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function SN(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lT{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ii("not implemented")}_getIdTokenResponse(e){return ii("not implemented")}_linkToIdToken(e,t){return ii("not implemented")}_getReauthenticationResolver(e){return ii("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ba(n,e){return eN(n,"POST","/v1/accounts:signInWithIdp",Xg(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kN="http://localhost";class co extends lT{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new co(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Mr("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=t,a=Wg(t,["providerId","signInMethod"]);if(!r||!s)return null;const l=new co(r,s);return l.idToken=a.idToken||void 0,l.accessToken=a.accessToken||void 0,l.secret=a.secret,l.nonce=a.nonce,l.pendingToken=a.pendingToken||null,l}_getIdTokenResponse(e){const t=this.buildRequest();return ba(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,ba(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,ba(e,t)}buildRequest(){const e={requestUri:kN,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Bu(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ey{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zu extends ey{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ki extends Zu{constructor(){super("facebook.com")}static credential(e){return co._fromParams({providerId:Ki.PROVIDER_ID,signInMethod:Ki.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ki.credentialFromTaggedObject(e)}static credentialFromError(e){return Ki.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ki.credential(e.oauthAccessToken)}catch{return null}}}Ki.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ki.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ni extends Zu{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return co._fromParams({providerId:ni.PROVIDER_ID,signInMethod:ni.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return ni.credentialFromTaggedObject(e)}static credentialFromError(e){return ni.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return ni.credential(t,r)}catch{return null}}}ni.GOOGLE_SIGN_IN_METHOD="google.com";ni.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qi extends Zu{constructor(){super("github.com")}static credential(e){return co._fromParams({providerId:Qi.PROVIDER_ID,signInMethod:Qi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Qi.credentialFromTaggedObject(e)}static credentialFromError(e){return Qi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Qi.credential(e.oauthAccessToken)}catch{return null}}}Qi.GITHUB_SIGN_IN_METHOD="github.com";Qi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xi extends Zu{constructor(){super("twitter.com")}static credential(e,t){return co._fromParams({providerId:Xi.PROVIDER_ID,signInMethod:Xi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Xi.credentialFromTaggedObject(e)}static credentialFromError(e){return Xi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return Xi.credential(t,r)}catch{return null}}}Xi.TWITTER_SIGN_IN_METHOD="twitter.com";Xi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $a{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,s=!1){const a=await ar._fromIdTokenResponse(e,r,s),l=x0(r);return new $a({user:a,providerId:l,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const s=x0(r);return new $a({user:e,providerId:s,_tokenResponse:r,operationType:t})}}function x0(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gh extends dr{constructor(e,t,r,s){var a;super(t.code,t.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,gh.prototype),this.customData={appName:e.name,tenantId:(a=e.tenantId)!==null&&a!==void 0?a:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,s){return new gh(e,t,r,s)}}function uT(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?gh._fromErrorAndOperation(n,a,e,r):a})}async function bN(n,e,t=!1){const r=await ju(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return $a._forOperation(n,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AN(n,e,t=!1){const{auth:r}=n;if(or(r.app))return Promise.reject(no(r));const s="reauthenticate";try{const a=await ju(n,uT(r,s,e,n),t);Se(a.idToken,r,"internal-error");const l=Yg(a.idToken);Se(l,r,"internal-error");const{sub:d}=l;return Se(n.uid===d,r,"user-mismatch"),$a._forOperation(n,s,a)}catch(a){throw(a==null?void 0:a.code)==="auth/user-not-found"&&Mr(r,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function RN(n,e,t=!1){if(or(n.app))return Promise.reject(no(n));const r="signIn",s=await uT(n,r,e),a=await $a._fromIdTokenResponse(n,r,s);return t||await n._updateCurrentUser(a.user),a}function CN(n,e,t,r){return wt(n).onIdTokenChanged(e,t,r)}function PN(n,e,t){return wt(n).beforeAuthStateChanged(e,t)}function NN(n,e,t,r){return wt(n).onAuthStateChanged(e,t,r)}function DN(n){return wt(n).signOut()}const yh="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cT{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(yh,"1"),this.storage.removeItem(yh),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VN=1e3,ON=10;class dT extends cT{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=sT(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),s=this.localCache[t];r!==s&&e(t,s,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((l,d,f)=>{this.notifyListeners(l,f)});return}const r=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const l=this.storage.getItem(r);!t&&this.localCache[r]===l||this.notifyListeners(r,l)},a=this.storage.getItem(r);dN()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,ON):s()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},VN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}dT.type="LOCAL";const LN=dT;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hT extends cT{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}hT.type="SESSION";const fT=hT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function MN(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const r=new tf(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:s,data:a}=t.data,l=this.handlersMap[s];if(!(l!=null&&l.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const d=Array.from(l).map(async m=>m(t.origin,a)),f=await MN(d);t.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:f})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}tf.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ty(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jN{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let a,l;return new Promise((d,f)=>{const m=ty("",20);s.port1.start();const v=setTimeout(()=>{f(new Error("unsupported_event"))},r);l={messageChannel:s,onMessage(w){const x=w;if(x.data.eventId===m)switch(x.data.status){case"ack":clearTimeout(v),a=setTimeout(()=>{f(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),d(x.data.response);break;default:clearTimeout(v),clearTimeout(a),f(new Error("invalid_response"));break}}},this.handlers.add(l),s.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:e,eventId:m,data:t},[s.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pr(){return window}function FN(n){Pr().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pT(){return typeof Pr().WorkerGlobalScope<"u"&&typeof Pr().importScripts=="function"}async function UN(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function BN(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function zN(){return pT()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mT="firebaseLocalStorageDb",$N=1,vh="firebaseLocalStorage",gT="fbase_key";class ec{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function nf(n,e){return n.transaction([vh],e?"readwrite":"readonly").objectStore(vh)}function qN(){const n=indexedDB.deleteDatabase(mT);return new ec(n).toPromise()}function Om(){const n=indexedDB.open(mT,$N);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(vh,{keyPath:gT})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(vh)?e(r):(r.close(),await qN(),e(await Om()))})})}async function T0(n,e,t){const r=nf(n,!0).put({[gT]:e,value:t});return new ec(r).toPromise()}async function HN(n,e){const t=nf(n,!1).get(e),r=await new ec(t).toPromise();return r===void 0?null:r.value}function S0(n,e){const t=nf(n,!0).delete(e);return new ec(t).toPromise()}const WN=800,GN=3;class yT{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Om(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>GN)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return pT()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=tf._getInstance(zN()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await UN(),!this.activeServiceWorker)return;this.sender=new jN(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((t=r[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||BN()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Om();return await T0(e,yh,"1"),await S0(e,yh),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>T0(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>HN(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>S0(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const a=nf(s,!1).getAll();return new ec(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:a}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(a)&&(this.notifyListeners(s,a),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),WN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}yT.type="LOCAL";const KN=yT;new Ju(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vT(n,e){return e?si(e):(Se(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ny extends lT{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ba(e,this._buildIdpRequest())}_linkToIdToken(e,t){return ba(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return ba(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function QN(n){return RN(n.auth,new ny(n),n.bypassAuthState)}function XN(n){const{auth:e,user:t}=n;return Se(t,e,"internal-error"),AN(t,new ny(n),n.bypassAuthState)}async function YN(n){const{auth:e,user:t}=n;return Se(t,e,"internal-error"),bN(t,new ny(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _T{constructor(e,t,r,s,a=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:s,tenantId:a,error:l,type:d}=e;if(l){this.reject(l);return}const f={auth:this.auth,requestUri:t,sessionId:r,tenantId:a||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(d)(f))}catch(m){this.reject(m)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return QN;case"linkViaPopup":case"linkViaRedirect":return YN;case"reauthViaPopup":case"reauthViaRedirect":return XN;default:Mr(this.auth,"internal-error")}}resolve(e){di(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){di(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JN=new Ju(2e3,1e4);async function ZN(n,e,t){if(or(n.app))return Promise.reject(lr(n,"operation-not-supported-in-this-environment"));const r=ef(n);GP(n,e,ey);const s=vT(r,t);return new Qs(r,"signInViaPopup",e,s).executeNotNull()}class Qs extends _T{constructor(e,t,r,s,a){super(e,t,s,a),this.provider=r,this.authWindow=null,this.pollId=null,Qs.currentPopupAction&&Qs.currentPopupAction.cancel(),Qs.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Se(e,this.auth,"internal-error"),e}async onExecution(){di(this.filter.length===1,"Popup operations only handle one event");const e=ty();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(lr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(lr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Qs.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if(!((r=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(lr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,JN.get())};e()}}Qs.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eD="pendingRedirect",$d=new Map;class tD extends _T{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=$d.get(this.auth._key());if(!e){try{const r=await nD(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}$d.set(this.auth._key(),e)}return this.bypassAuthState||$d.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function nD(n,e){const t=sD(e),r=iD(n);if(!await r._isAvailable())return!1;const s=await r._get(t)==="true";return await r._remove(t),s}function rD(n,e){$d.set(n._key(),e)}function iD(n){return si(n._redirectPersistence)}function sD(n){return zd(eD,n.config.apiKey,n.name)}async function oD(n,e,t=!1){if(or(n.app))return Promise.reject(no(n));const r=ef(n),s=vT(r,e),l=await new tD(r,s,t).execute();return l&&!t&&(delete l.user._redirectEventId,await r._persistUserIfCurrent(l.user),await r._setRedirectUser(null,e)),l}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aD=600*1e3;class lD{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!uD(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!wT(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(lr(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=aD&&this.cachedEventUids.clear(),this.cachedEventUids.has(k0(e))}saveEventToCache(e){this.cachedEventUids.add(k0(e)),this.lastProcessedEventTime=Date.now()}}function k0(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function wT({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function uD(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return wT(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cD(n,e={}){return el(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dD=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,hD=/^https?/;async function fD(n){if(n.config.emulator)return;const{authorizedDomains:e}=await cD(n);for(const t of e)try{if(pD(t))return}catch{}Mr(n,"unauthorized-domain")}function pD(n){const e=Dm(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const l=new URL(n);return l.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&l.hostname===r}if(!hD.test(t))return!1;if(dD.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mD=new Ju(3e4,6e4);function b0(){const n=Pr().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function gD(n){return new Promise((e,t)=>{var r,s,a;function l(){b0(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{b0(),t(lr(n,"network-request-failed"))},timeout:mD.get()})}if(!((s=(r=Pr().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((a=Pr().gapi)===null||a===void 0)&&a.load)l();else{const d=wN("iframefcb");return Pr()[d]=()=>{gapi.load?l():t(lr(n,"network-request-failed"))},vN(`${_N()}?onload=${d}`).catch(f=>t(f))}}).catch(e=>{throw qd=null,e})}let qd=null;function yD(n){return qd=qd||gD(n),qd}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vD=new Ju(5e3,15e3),_D="__/auth/iframe",wD="emulator/auth/iframe",ED={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},ID=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function xD(n){const e=n.config;Se(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?Qg(e,wD):`https://${n.config.authDomain}/${_D}`,r={apiKey:e.apiKey,appName:n.name,v:Ka},s=ID.get(n.config.apiHost);s&&(r.eid=s);const a=n._getFrameworks();return a.length&&(r.fw=a.join(",")),`${t}?${Bu(r).slice(1)}`}async function TD(n){const e=await yD(n),t=Pr().gapi;return Se(t,n,"internal-error"),e.open({where:document.body,url:xD(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:ED,dontclear:!0},r=>new Promise(async(s,a)=>{await r.restyle({setHideOnLeave:!1});const l=lr(n,"network-request-failed"),d=Pr().setTimeout(()=>{a(l)},vD.get());function f(){Pr().clearTimeout(d),s(r)}r.ping(f).then(f,()=>{a(l)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SD={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},kD=500,bD=600,AD="_blank",RD="http://localhost";class A0{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function CD(n,e,t,r=kD,s=bD){const a=Math.max((window.screen.availHeight-s)/2,0).toString(),l=Math.max((window.screen.availWidth-r)/2,0).toString();let d="";const f=Object.assign(Object.assign({},SD),{width:r.toString(),height:s.toString(),top:a,left:l}),m=bt().toLowerCase();t&&(d=eT(m)?AD:t),Jx(m)&&(e=e||RD,f.scrollbars="yes");const v=Object.entries(f).reduce((x,[S,D])=>`${x}${S}=${D},`,"");if(cN(m)&&d!=="_self")return PD(e||"",d),new A0(null);const w=window.open(e||"",d,v);Se(w,n,"popup-blocked");try{w.focus()}catch{}return new A0(w)}function PD(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ND="__/auth/handler",DD="emulator/auth/handler",VD=encodeURIComponent("fac");async function R0(n,e,t,r,s,a){Se(n.config.authDomain,n,"auth-domain-config-required"),Se(n.config.apiKey,n,"invalid-api-key");const l={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Ka,eventId:s};if(e instanceof ey){e.setDefaultLanguage(n.languageCode),l.providerId=e.providerId||"",J1(e.getCustomParameters())||(l.customParameters=JSON.stringify(e.getCustomParameters()));for(const[v,w]of Object.entries({}))l[v]=w}if(e instanceof Zu){const v=e.getScopes().filter(w=>w!=="");v.length>0&&(l.scopes=v.join(","))}n.tenantId&&(l.tid=n.tenantId);const d=l;for(const v of Object.keys(d))d[v]===void 0&&delete d[v];const f=await n._getAppCheckToken(),m=f?`#${VD}=${encodeURIComponent(f)}`:"";return`${OD(n)}?${Bu(d).slice(1)}${m}`}function OD({config:n}){return n.emulator?Qg(n,DD):`https://${n.authDomain}/${ND}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yp="webStorageSupport";class LD{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=fT,this._completeRedirectFn=oD,this._overrideRedirectResult=rD}async _openPopup(e,t,r,s){var a;di((a=this.eventManagers[e._key()])===null||a===void 0?void 0:a.manager,"_initialize() not called before _openPopup()");const l=await R0(e,t,r,Dm(),s);return CD(e,l,ty())}async _openRedirect(e,t,r,s){await this._originValidation(e);const a=await R0(e,t,r,Dm(),s);return FN(a),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:a}=this.eventManagers[t];return s?Promise.resolve(s):(di(a,"If manager is not set, promise should be"),a)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await TD(e),r=new lD(e);return t.register("authEvent",s=>(Se(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Yp,{type:Yp},s=>{var a;const l=(a=s==null?void 0:s[0])===null||a===void 0?void 0:a[Yp];l!==void 0&&t(!!l),Mr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=fD(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return sT()||Zx()||Jg()}}const MD=LD;var C0="@firebase/auth",P0="1.10.8";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jD{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Se(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FD(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function UD(n){Nr(new ur("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:l,authDomain:d}=r.options;Se(l&&!l.includes(":"),"invalid-api-key",{appName:r.name});const f={apiKey:l,authDomain:d,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:oT(n)},m=new gN(r,s,a,f);return IN(m,t),m},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Nr(new ur("auth-internal",e=>{const t=ef(e.getProvider("auth").getImmediate());return(r=>new jD(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Fn(C0,P0,FD(n)),Fn(C0,P0,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BD=300,zD=pE("authIdTokenMaxAge")||BD;let N0=null;const $D=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>zD)return;const s=t==null?void 0:t.token;N0!==s&&(N0=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function qD(n=Xm()){const e=yo(n,"auth");if(e.isInitialized())return e.getImmediate();const t=EN(n,{popupRedirectResolver:MD,persistence:[KN,LN,fT]}),r=pE("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(r,location.origin);if(location.origin===a.origin){const l=$D(a.toString());PN(t,l,()=>l(t.currentUser)),CN(t,d=>l(d))}}const s=hE("auth");return s&&xN(t,`http://${s}`),t}function HD(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}yN({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=s=>{const a=lr("internal-error");a.customData=s,t(a)},r.type="text/javascript",r.charset="UTF-8",HD().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});UD("Browser");const ET="@firebase/installations",ry="0.6.18";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IT=1e4,xT=`w:${ry}`,TT="FIS_v2",WD="https://firebaseinstallations.googleapis.com/v1",GD=3600*1e3,KD="installations",QD="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XD={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},ho=new go(KD,QD,XD);function ST(n){return n instanceof dr&&n.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kT({projectId:n}){return`${WD}/projects/${n}/installations`}function bT(n){return{token:n.token,requestStatus:2,expiresIn:JD(n.expiresIn),creationTime:Date.now()}}async function AT(n,e){const r=(await e.json()).error;return ho.create("request-failed",{requestName:n,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function RT({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function YD(n,{refreshToken:e}){const t=RT(n);return t.append("Authorization",ZD(e)),t}async function CT(n){const e=await n();return e.status>=500&&e.status<600?n():e}function JD(n){return Number(n.replace("s","000"))}function ZD(n){return`${TT} ${n}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function e2({appConfig:n,heartbeatServiceProvider:e},{fid:t}){const r=kT(n),s=RT(n),a=e.getImmediate({optional:!0});if(a){const m=await a.getHeartbeatsHeader();m&&s.append("x-firebase-client",m)}const l={fid:t,authVersion:TT,appId:n.appId,sdkVersion:xT},d={method:"POST",headers:s,body:JSON.stringify(l)},f=await CT(()=>fetch(r,d));if(f.ok){const m=await f.json();return{fid:m.fid||t,registrationStatus:2,refreshToken:m.refreshToken,authToken:bT(m.authToken)}}else throw await AT("Create Installation",f)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PT(n){return new Promise(e=>{setTimeout(e,n)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t2(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n2=/^[cdef][\w-]{21}$/,Lm="";function r2(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const t=i2(n);return n2.test(t)?t:Lm}catch{return Lm}}function i2(n){return t2(n).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rf(n){return`${n.appName}!${n.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NT=new Map;function DT(n,e){const t=rf(n);VT(t,e),s2(t,e)}function VT(n,e){const t=NT.get(n);if(t)for(const r of t)r(e)}function s2(n,e){const t=o2();t&&t.postMessage({key:n,fid:e}),a2()}let Xs=null;function o2(){return!Xs&&"BroadcastChannel"in self&&(Xs=new BroadcastChannel("[Firebase] FID Change"),Xs.onmessage=n=>{VT(n.data.key,n.data.fid)}),Xs}function a2(){NT.size===0&&Xs&&(Xs.close(),Xs=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l2="firebase-installations-database",u2=1,fo="firebase-installations-store";let Jp=null;function iy(){return Jp||(Jp=xE(l2,u2,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(fo)}}})),Jp}async function _h(n,e){const t=rf(n),s=(await iy()).transaction(fo,"readwrite"),a=s.objectStore(fo),l=await a.get(t);return await a.put(e,t),await s.done,(!l||l.fid!==e.fid)&&DT(n,e.fid),e}async function OT(n){const e=rf(n),r=(await iy()).transaction(fo,"readwrite");await r.objectStore(fo).delete(e),await r.done}async function sf(n,e){const t=rf(n),s=(await iy()).transaction(fo,"readwrite"),a=s.objectStore(fo),l=await a.get(t),d=e(l);return d===void 0?await a.delete(t):await a.put(d,t),await s.done,d&&(!l||l.fid!==d.fid)&&DT(n,d.fid),d}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sy(n){let e;const t=await sf(n.appConfig,r=>{const s=c2(r),a=d2(n,s);return e=a.registrationPromise,a.installationEntry});return t.fid===Lm?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function c2(n){const e=n||{fid:r2(),registrationStatus:0};return LT(e)}function d2(n,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(ho.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=h2(n,t);return{installationEntry:t,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:f2(n)}:{installationEntry:e}}async function h2(n,e){try{const t=await e2(n,e);return _h(n.appConfig,t)}catch(t){throw ST(t)&&t.customData.serverCode===409?await OT(n.appConfig):await _h(n.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function f2(n){let e=await D0(n.appConfig);for(;e.registrationStatus===1;)await PT(100),e=await D0(n.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:r}=await sy(n);return r||t}return e}function D0(n){return sf(n,e=>{if(!e)throw ho.create("installation-not-found");return LT(e)})}function LT(n){return p2(n)?{fid:n.fid,registrationStatus:0}:n}function p2(n){return n.registrationStatus===1&&n.registrationTime+IT<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function m2({appConfig:n,heartbeatServiceProvider:e},t){const r=g2(n,t),s=YD(n,t),a=e.getImmediate({optional:!0});if(a){const m=await a.getHeartbeatsHeader();m&&s.append("x-firebase-client",m)}const l={installation:{sdkVersion:xT,appId:n.appId}},d={method:"POST",headers:s,body:JSON.stringify(l)},f=await CT(()=>fetch(r,d));if(f.ok){const m=await f.json();return bT(m)}else throw await AT("Generate Auth Token",f)}function g2(n,{fid:e}){return`${kT(n)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oy(n,e=!1){let t;const r=await sf(n.appConfig,a=>{if(!MT(a))throw ho.create("not-registered");const l=a.authToken;if(!e&&_2(l))return a;if(l.requestStatus===1)return t=y2(n,e),a;{if(!navigator.onLine)throw ho.create("app-offline");const d=E2(a);return t=v2(n,d),d}});return t?await t:r.authToken}async function y2(n,e){let t=await V0(n.appConfig);for(;t.authToken.requestStatus===1;)await PT(100),t=await V0(n.appConfig);const r=t.authToken;return r.requestStatus===0?oy(n,e):r}function V0(n){return sf(n,e=>{if(!MT(e))throw ho.create("not-registered");const t=e.authToken;return I2(t)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function v2(n,e){try{const t=await m2(n,e),r=Object.assign(Object.assign({},e),{authToken:t});return await _h(n.appConfig,r),t}catch(t){if(ST(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await OT(n.appConfig);else{const r=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await _h(n.appConfig,r)}throw t}}function MT(n){return n!==void 0&&n.registrationStatus===2}function _2(n){return n.requestStatus===2&&!w2(n)}function w2(n){const e=Date.now();return e<n.creationTime||n.creationTime+n.expiresIn<e+GD}function E2(n){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},n),{authToken:e})}function I2(n){return n.requestStatus===1&&n.requestTime+IT<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function x2(n){const e=n,{installationEntry:t,registrationPromise:r}=await sy(e);return r?r.catch(console.error):oy(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function T2(n,e=!1){const t=n;return await S2(t),(await oy(t,e)).token}async function S2(n){const{registrationPromise:e}=await sy(n);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k2(n){if(!n||!n.options)throw Zp("App Configuration");if(!n.name)throw Zp("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!n.options[t])throw Zp(t);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}function Zp(n){return ho.create("missing-app-config-values",{valueName:n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jT="installations",b2="installations-internal",A2=n=>{const e=n.getProvider("app").getImmediate(),t=k2(e),r=yo(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},R2=n=>{const e=n.getProvider("app").getImmediate(),t=yo(e,jT).getImmediate();return{getId:()=>x2(t),getToken:s=>T2(t,s)}};function C2(){Nr(new ur(jT,A2,"PUBLIC")),Nr(new ur(b2,R2,"PRIVATE"))}C2();Fn(ET,ry);Fn(ET,ry,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wh="analytics",P2="firebase_id",N2="origin",D2=60*1e3,V2="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",ay="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pn=new kh("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O2={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Tn=new go("analytics","Analytics",O2);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L2(n){if(!n.startsWith(ay)){const e=Tn.create("invalid-gtag-resource",{gtagURL:n});return pn.warn(e.message),""}return n}function FT(n){return Promise.all(n.map(e=>e.catch(t=>t)))}function M2(n,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(n,e)),t}function j2(n,e){const t=M2("firebase-js-sdk-policy",{createScriptURL:L2}),r=document.createElement("script"),s=`${ay}?l=${n}&id=${e}`;r.src=t?t==null?void 0:t.createScriptURL(s):s,r.async=!0,document.head.appendChild(r)}function F2(n){let e=[];return Array.isArray(window[n])?e=window[n]:window[n]=e,e}async function U2(n,e,t,r,s,a){const l=r[s];try{if(l)await e[l];else{const f=(await FT(t)).find(m=>m.measurementId===s);f&&await e[f.appId]}}catch(d){pn.error(d)}n("config",s,a)}async function B2(n,e,t,r,s){try{let a=[];if(s&&s.send_to){let l=s.send_to;Array.isArray(l)||(l=[l]);const d=await FT(t);for(const f of l){const m=d.find(w=>w.measurementId===f),v=m&&e[m.appId];if(v)a.push(v);else{a=[];break}}}a.length===0&&(a=Object.values(e)),await Promise.all(a),n("event",r,s||{})}catch(a){pn.error(a)}}function z2(n,e,t,r){async function s(a,...l){try{if(a==="event"){const[d,f]=l;await B2(n,e,t,d,f)}else if(a==="config"){const[d,f]=l;await U2(n,e,t,r,d,f)}else if(a==="consent"){const[d,f]=l;n("consent",d,f)}else if(a==="get"){const[d,f,m]=l;n("get",d,f,m)}else if(a==="set"){const[d]=l;n("set",d)}else n(a,...l)}catch(d){pn.error(d)}}return s}function $2(n,e,t,r,s){let a=function(...l){window[r].push(arguments)};return window[s]&&typeof window[s]=="function"&&(a=window[s]),window[s]=z2(a,n,e,t),{gtagCore:a,wrappedGtag:window[s]}}function q2(n){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(ay)&&t.src.includes(n))return t;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const H2=30,W2=1e3;class G2{constructor(e={},t=W2){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const UT=new G2;function K2(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}async function Q2(n){var e;const{appId:t,apiKey:r}=n,s={method:"GET",headers:K2(r)},a=V2.replace("{app-id}",t),l=await fetch(a,s);if(l.status!==200&&l.status!==304){let d="";try{const f=await l.json();!((e=f.error)===null||e===void 0)&&e.message&&(d=f.error.message)}catch{}throw Tn.create("config-fetch-failed",{httpStatus:l.status,responseMessage:d})}return l.json()}async function X2(n,e=UT,t){const{appId:r,apiKey:s,measurementId:a}=n.options;if(!r)throw Tn.create("no-app-id");if(!s){if(a)return{measurementId:a,appId:r};throw Tn.create("no-api-key")}const l=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},d=new Z2;return setTimeout(async()=>{d.abort()},D2),BT({appId:r,apiKey:s,measurementId:a},l,d,e)}async function BT(n,{throttleEndTimeMillis:e,backoffCount:t},r,s=UT){var a;const{appId:l,measurementId:d}=n;try{await Y2(r,e)}catch(f){if(d)return pn.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${d} provided in the "measurementId" field in the local Firebase config. [${f==null?void 0:f.message}]`),{appId:l,measurementId:d};throw f}try{const f=await Q2(n);return s.deleteThrottleMetadata(l),f}catch(f){const m=f;if(!J2(m)){if(s.deleteThrottleMetadata(l),d)return pn.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${d} provided in the "measurementId" field in the local Firebase config. [${m==null?void 0:m.message}]`),{appId:l,measurementId:d};throw f}const v=Number((a=m==null?void 0:m.customData)===null||a===void 0?void 0:a.httpStatus)===503?M_(t,s.intervalMillis,H2):M_(t,s.intervalMillis),w={throttleEndTimeMillis:Date.now()+v,backoffCount:t+1};return s.setThrottleMetadata(l,w),pn.debug(`Calling attemptFetch again in ${v} millis`),BT(n,w,r,s)}}function Y2(n,e){return new Promise((t,r)=>{const s=Math.max(e-Date.now(),0),a=setTimeout(t,s);n.addEventListener(()=>{clearTimeout(a),r(Tn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function J2(n){if(!(n instanceof dr)||!n.customData)return!1;const e=Number(n.customData.httpStatus);return e===429||e===500||e===503||e===504}class Z2{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function eV(n,e,t,r,s){if(s&&s.global){n("event",t,r);return}else{const a=await e,l=Object.assign(Object.assign({},r),{send_to:a});n("event",t,l)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tV(){if(Sh())try{await Km()}catch(n){return pn.warn(Tn.create("indexeddb-unavailable",{errorInfo:n==null?void 0:n.toString()}).message),!1}else return pn.warn(Tn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function nV(n,e,t,r,s,a,l){var d;const f=X2(n);f.then(S=>{t[S.measurementId]=S.appId,n.options.measurementId&&S.measurementId!==n.options.measurementId&&pn.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${S.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(S=>pn.error(S)),e.push(f);const m=tV().then(S=>{if(S)return r.getId()}),[v,w]=await Promise.all([f,m]);q2(a)||j2(a,v.measurementId),s("js",new Date);const x=(d=l==null?void 0:l.config)!==null&&d!==void 0?d:{};return x[N2]="firebase",x.update=!0,w!=null&&(x[P2]=w),s("config",v.measurementId,x),v.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rV{constructor(e){this.app=e}_delete(){return delete Eu[this.app.options.appId],Promise.resolve()}}let Eu={},O0=[];const L0={};let em="dataLayer",iV="gtag",M0,zT,j0=!1;function sV(){const n=[];if(Gm()&&n.push("This is a browser extension environment."),wE()||n.push("Cookies are not available."),n.length>0){const e=n.map((r,s)=>`(${s+1}) ${r}`).join(" "),t=Tn.create("invalid-analytics-context",{errorInfo:e});pn.warn(t.message)}}function oV(n,e,t){sV();const r=n.options.appId;if(!r)throw Tn.create("no-app-id");if(!n.options.apiKey)if(n.options.measurementId)pn.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Tn.create("no-api-key");if(Eu[r]!=null)throw Tn.create("already-exists",{id:r});if(!j0){F2(em);const{wrappedGtag:a,gtagCore:l}=$2(Eu,O0,L0,em,iV);zT=a,M0=l,j0=!0}return Eu[r]=nV(n,O0,L0,e,M0,em,t),new rV(n)}function aV(n=Xm()){n=wt(n);const e=yo(n,wh);return e.isInitialized()?e.getImmediate():lV(n)}function lV(n,e={}){const t=yo(n,wh);if(t.isInitialized()){const s=t.getImmediate();if(is(e,t.getOptions()))return s;throw Tn.create("already-initialized")}return t.initialize({options:e})}async function uV(){if(Gm()||!wE()||!Sh())return!1;try{return await Km()}catch{return!1}}function cV(n,e,t,r){n=wt(n),eV(zT,Eu[n.app.options.appId],e,t,r).catch(s=>pn.error(s))}const F0="@firebase/analytics",U0="0.10.17";function dV(){Nr(new ur(wh,(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("installations-internal").getImmediate();return oV(r,s,t)},"PUBLIC")),Nr(new ur("analytics-internal",n,"PRIVATE")),Fn(F0,U0),Fn(F0,U0,"esm2017");function n(e){try{const t=e.getProvider(wh).getImmediate();return{logEvent:(r,s,a)=>cV(t,r,s,a)}}catch(t){throw Tn.create("interop-component-reg-failed",{reason:t})}}}dV();const hV={apiKey:"AIzaSyD2bnfNTNjJ4XyVFlM_1PzvGMmnc69VqX8",authDomain:"habit-tracker-pwa-e5a97.firebaseapp.com",projectId:"habit-tracker-pwa-e5a97",storageBucket:"habit-tracker-pwa-e5a97.firebasestorage.app",messagingSenderId:"600484609036",appId:"1:600484609036:web:0650ca5337d57f1b02c229",measurementId:"G-M990KPRLXC"},ly=TE(hV);uV().then(n=>{n&&aV(ly)});const uy=qD(ly),lt=AP(ly);RP(lt).catch(n=>{n.code=="failed-precondition"?console.warn("Persistence failed: Multiple tabs open"):n.code=="unimplemented"&&console.warn("Persistence failed: Browser not supported")});const tl="habits";async function fV(n,e){try{const t=kn(lt,tl);return{id:(await zx(t,{...e,userId:n,currentStreak:0,createdAt:Mu(),updatedAt:Mu()})).id,...e,userId:n,currentStreak:0}}catch(t){throw console.error("Error creating habit:",t),t}}async function pV(n){try{const e=kn(lt,tl),t=hr(e,_t("userId","==",n),Za("createdAt","desc"));return(await mi(t)).docs.map(s=>({id:s.id,...s.data()}))}catch(e){throw console.error("Error getting habits:",e),e}}async function B0(n,e){try{const t=Or(lt,tl,n);return await zP(t,{...e,updatedAt:Mu()}),{id:n,...e}}catch(t){throw console.error("Error updating habit:",t),t}}async function mV(n){try{const e=Or(lt,tl,n);return await Hg(e),n}catch(e){throw console.error("Error deleting habit:",e),e}}function gV(n,e){const t=kn(lt,tl),r=hr(t,_t("userId","==",n),Za("createdAt","desc"));return $x(r,s=>{const a=s.docs.map(l=>({id:l.id,...l.data()}));e(a)},s=>{console.error("Error in habits subscription:",s)})}async function yV(n){try{const e=kn(lt,tl),t=hr(e,_t("userId","==",n),_t("isPublic","==",!0),Za("createdAt","desc"));return(await mi(t)).docs.map(s=>({id:s.id,...s.data()}))}catch(e){throw console.error("Error getting user public habits:",e),e}}function Wi(n){const e=new Date(n),t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");return`${t}-${r}-${s}`}function z0(n=new Date){const e=new Date(n);e.setDate(e.getDate()-e.getDay()),e.setHours(0,0,0,0);const t=new Date(e);return t.setDate(t.getDate()+6),t.setHours(23,59,59,999),{start:e,end:t}}const nl="completions";async function Mm(n,e,t,r=!0){try{const s=kn(lt,nl);return{id:(await zx(s,{habitId:n,userId:e,date:t,value:r,timestamp:Mu()})).id,habitId:n,userId:e,date:t,value:r}}catch(s){throw console.error("Error adding completion:",s),s}}async function $T(n,e,t){try{const r=kn(lt,nl),s=hr(r,_t("habitId","==",n),_t("userId","==",e),_t("date","==",t)),l=(await mi(s)).docs.map(d=>Hg(d.ref));return await Promise.all(l),{habitId:n,userId:e,date:t}}catch(r){throw console.error("Error removing completion:",r),r}}async function vV(n,e,t,r=!0){try{const s=kn(lt,nl),a=hr(s,_t("habitId","==",n),_t("userId","==",e),_t("date","==",t));return(await mi(a)).empty?await Mm(n,e,t,r):(await $T(n,e,t),null)}catch(s){throw console.error("Error toggling completion:",s),s}}async function _V(n,e,t,r){try{if(r<=0)return await $T(n,e,t),null;const s=kn(lt,nl),a=hr(s,_t("habitId","==",n),_t("userId","==",e),_t("date","==",t)),l=await mi(a);if(l.empty)return await Mm(n,e,t,r);{const d=l.docs[0].ref;return await Hg(d),await Mm(n,e,t,r)}}catch(s){throw console.error("Error updating completion value:",s),s}}async function wV(n,e){try{const t=kn(lt,nl),r=hr(t,_t("userId","==",n),_t("date","==",e));return(await mi(r)).docs.map(a=>({id:a.id,...a.data()}))}catch(t){throw console.error("Error getting completions:",t),t}}async function EV(n,e,t){try{const r=kn(lt,nl),s=hr(r,_t("userId","==",n),_t("date",">=",e),_t("date","<=",t));return(await mi(s)).docs.map(l=>({id:l.id,...l.data()}))}catch(r){throw console.error("Error getting completions range:",r),r}}const cy="weeklyStats",qT="users";function tc(n=new Date){const e=new Date(n);e.setHours(0,0,0,0),e.setDate(e.getDate()+3-(e.getDay()+6)%7);const t=new Date(e.getFullYear(),0,4),r=Math.ceil(((e.getTime()-t.getTime())/864e5+t.getDay()+1)/7);return`${e.getFullYear()}-W${String(r).padStart(2,"0")}`}async function IV(n,e,t){try{const r=tc(),s=e>0?Math.round(t/e*100):0,a=Or(lt,cy,`${r}_${n}`);return await Bx(a,{weekId:r,userId:n,totalScheduled:e,totalCompleted:t,percentage:s,lastUpdated:new Date().toISOString()},{merge:!0}),{weekId:r,userId:n,percentage:s}}catch(r){throw console.error("Error updating weekly stats:",r),r}}async function xV(n=null){try{const e=n||tc(),t=kn(lt,cy),r=hr(t,_t("weekId","==",e),Za("percentage","desc")),a=(await mi(r)).docs.map(d=>({id:d.id,...d.data()}));return await Promise.all(a.map(async(d,f)=>{try{const m=Or(lt,qT,d.userId),v=await za(m),w=v.exists()?v.data():{};return{...d,rank:f+1,displayName:w.displayName||"Anonymous",photoURL:w.photoURL||null,email:w.email||null}}catch{return{...d,rank:f+1,displayName:"Anonymous",photoURL:null}}}))}catch(e){throw console.error("Error getting leaderboard:",e),e}}async function TV(n,e=null){try{const t=await xV(e);return t.find(s=>s.userId===n)||{rank:t.length+1,percentage:0}}catch(t){return console.error("Error getting user rank:",t),{rank:0,percentage:0}}}function SV(){const n=new Date;return n.setDate(n.getDate()-7),tc(n)}function kV(n,e){const t=n||tc(),r=kn(lt,cy),s=hr(r,_t("weekId","==",t),Za("percentage","desc"));return $x(s,async a=>{const l=a.docs.map(f=>({id:f.id,...f.data()})),d=await Promise.all(l.map(async(f,m)=>{try{const v=Or(lt,qT,f.userId),w=await za(v),x=w.exists()?w.data():{};return{...f,rank:m+1,displayName:x.displayName||"Anonymous",photoURL:x.photoURL||null}}catch{return{...f,rank:m+1,displayName:"Anonymous",photoURL:null}}}));e(d)},a=>{console.error("Error in leaderboard subscription:",a)})}const po=aE((n,e)=>({habits:[],completions:{},isLoading:!1,error:null,setHabits:t=>n({habits:t}),setLoading:t=>n({isLoading:t}),setError:t=>n({error:t}),addHabit:async(t,r)=>{const s="temp_"+Date.now(),a={id:s,...r,userId:t,currentStreak:0,createdAt:new Date,updatedAt:new Date,isTemp:!0};return n(l=>({habits:[a,...l.habits],isLoading:!1})),fV(t,r).then(l=>{n(d=>({habits:d.habits.map(f=>f.id===s?l:f)}))}).catch(l=>{console.error("Background create failed:",l),n(d=>({error:"Failed to sync new habit. It may disappear on reload.",habits:d.habits.map(f=>f.id===s?{...f,syncError:!0}:f)}))}),a},updateHabit:async(t,r)=>{n(s=>({habits:s.habits.map(a=>a.id===t?{...a,...r}:a)}));try{await B0(t,r)}catch(s){console.error("Error in updateHabit:",s),n({error:s.message})}},deleteHabit:async t=>{n(r=>({habits:r.habits.filter(s=>s.id!==t)}));try{await mV(t)}catch(r){console.error("Error in deleteHabit:",r)}},loadHabits:async t=>{n({isLoading:!0,error:null});try{const r=await pV(t);return n({habits:r,isLoading:!1}),r}catch(r){throw console.error("Error in loadHabits:",r),n({error:r.message,isLoading:!1,habits:[]}),r}},subscribeToHabits:t=>(e().habits.length===0&&n({isLoading:!0}),gV(t,r=>{n({habits:r,isLoading:!1})})),setCompletions:(t,r)=>n(s=>({completions:{...s.completions,[t]:r}})),loadCompletionsForWeek:async t=>{try{const{start:r,end:s}=z0(new Date),a=Wi(s),l=Wi(r),d=await EV(t,l,a),f={};return d.forEach(m=>{f[m.date]||(f[m.date]=[]),f[m.date].push(m)}),n(m=>({completions:{...m.completions,...f}})),f}catch(r){return console.error("Error loading completions:",r),{}}},loadCompletionsForDate:async(t,r)=>{try{const s=await wV(t,r);return n(a=>({completions:{...a.completions,[r]:s}})),s}catch(s){return console.error("Error loading completions:",s),[]}},toggleCompletion:async(t,r,s)=>{const{completions:a,habits:l}=e(),d=a[s]||[],f=l.find(S=>S.id===t),m=Wi(new Date);if(s>m){console.warn("Cannot mark future habits as done");return}const w=!d.find(S=>S.habitId===t);let x;if(w?x=[...d,{habitId:t,userId:r,date:s,value:!0,isOptimistic:!0}]:x=d.filter(S=>S.habitId!==t),n(S=>({completions:{...S.completions,[s]:x}})),f){let S=f.currentStreak;w?S=(f.currentStreak||0)+1:S=Math.max(0,(f.currentStreak||0)-1),n(D=>({habits:D.habits.map(F=>F.id===t?{...F,currentStreak:S}:F)})),B0(t,{currentStreak:S}).catch(D=>console.error("Background streak update failed:",D))}try{const{start:S,end:D}=z0(new Date);let F=0,O=0;const K=new Date(S),X=e().completions;for(;K<=D;){const q=Wi(K),re=e().getTodaysHabits(K);F+=re.length;const de=X[q]||[];O+=de.length,K.setDate(K.getDate()+1)}IV(r,F,O).catch(q=>console.error("Background leaderboard update failed:",q))}catch(S){console.error("Error updating weekly stats:",S)}try{await vV(t,r,s,w)}catch(S){throw console.error("Error toggling completion in Firestore:",S),S}},updateHabitProgress:async(t,r,s,a)=>{const{completions:l,habits:d}=e(),f=l[s]||[];d.find(x=>x.id===t);const m=Wi(new Date);if(s>m)return;const v=f.find(x=>x.habitId===t);let w;a>0?v?w=f.map(x=>x.habitId===t?{...x,value:a}:x):w=[...f,{habitId:t,userId:r,date:s,value:a,isOptimistic:!0}]:w=f.filter(x=>x.habitId!==t),n(x=>({completions:{...x.completions,[s]:w}}));try{await _V(t,r,s,a)}catch(x){console.error("Error updating progress:",x)}},isHabitCompleted:(t,r)=>{const{completions:s,habits:a}=e(),d=(s[r]||[]).find(m=>m.habitId===t),f=a.find(m=>m.id===t);return d?(f==null?void 0:f.completionType)==="numerical"&&f.targetValue?(d.value||0)>=f.targetValue:!0:!1},getHabitValue:(t,r)=>{const{completions:s}=e(),l=(s[r]||[]).find(d=>d.habitId===t);return(l==null?void 0:l.value)||0},getTodaysHabits:(t=null)=>{const{habits:r}=e(),a=(t?new Date(t):new Date).getDay();return r.filter(l=>{var d,f;return l.frequency==="daily"?!0:l.frequency==="custom"&&l.customDays?l.customDays.includes(a):l.frequency==="weekly"?(((f=(d=l.createdAt)==null?void 0:d.toDate)==null?void 0:f.call(d))||new Date(l.createdAt)).getDay()===a:!0})},getStatsForDate:t=>{const{completions:r,habits:s}=e(),a=e().getTodaysHabits(t),l=typeof t=="string"?t:Wi(t),d=r[l]||[],f=a.reduce((w,x)=>{const S=d.find(D=>D.habitId===x.id);if(!S)return w;if(x.completionType==="numerical"&&x.targetValue){if((S.value||0)>=x.targetValue)return w+1}else return w+1;return w},0),m=a.length,v=m>0?Math.round(f/m*100):0;return{completed:f,total:m,percentage:v}},clearAll:()=>n({habits:[],completions:{},isLoading:!1,error:null})}));async function bV(){return"Notification"in window?Notification.permission==="granted"?!0:Notification.permission!=="denied"?await Notification.requestPermission()==="granted":!1:(console.warn("This browser does not support desktop notification"),!1)}function AV(n,e,t="/pwa-192x192.png"){if(Notification.permission==="granted"){const r=new Notification(n,{body:e,icon:t,badge:"/pwa-192x192.png",vibrate:[100,50,100],data:{dateOfArrival:Date.now(),primaryKey:1}});r.onclick=function(s){s.preventDefault(),window.focus(),r.close()}}}function $0(){const n=JSON.parse(localStorage.getItem("habitParams"))||{},{notificationsEnabled:e,reminderTime:t}=n;if(!e||!t)return;const r=new Date,s=localStorage.getItem("lastReminderDate"),a=r.toDateString();if(s===a)return;const[l,d]=t.split(":").map(Number),f=new Date;f.setHours(l,d,0,0),r>=f&&(AV("Time to check your habits!","Don't forget to log your progress for today."),localStorage.setItem("lastReminderDate",a))}const RV=new ni;async function CV(){try{const e=(await ZN(uy,RV)).user,t=Or(lt,"users",e.uid);return(await za(t)).exists()||await Bx(t,{displayName:e.displayName,email:e.email,photoURL:e.photoURL,createdAt:Mu()}),e}catch(n){throw console.error("Error signing in with Google:",n),n}}async function PV(){try{await DN(uy)}catch(n){throw console.error("Error signing out:",n),n}}function wo({size:n="md",className:e=""}){const t={sm:"h-4 w-4",md:"h-6 w-6",lg:"h-10 w-10"};return E.jsxs("svg",{className:`animate-spin text-primary ${t[n]} ${e}`,fill:"none",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[E.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),E.jsx("path",{className:"opacity-75",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",fill:"currentColor"})]})}const NV={primary:"bg-primary text-text-light-primary shadow-[0_4px_14px_rgba(19,236,91,0.3)] hover:shadow-[0_4px_20px_rgba(19,236,91,0.4)]",secondary:"bg-transparent text-text-light-primary dark:text-text-dark-primary border border-border-light dark:border-border-dark hover:bg-gray-100 dark:hover:bg-gray-800",danger:"bg-transparent text-danger hover:bg-danger/10",google:"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50 shadow-sm"},DV={sm:"h-10 px-4 text-sm",md:"h-12 px-6 text-base",lg:"h-14 px-8 text-base"};function rs({children:n,variant:e="primary",size:t="md",fullWidth:r=!1,isLoading:s=!1,disabled:a=!1,icon:l,className:d="",...f}){return E.jsx("button",{className:`
        flex items-center justify-center gap-2.5 rounded-xl font-bold
        transition-all duration-200 ease-out
        disabled:opacity-50 disabled:cursor-not-allowed
        ${NV[e]}
        ${DV[t]}
        ${r?"w-full":""}
        ${d}
      `,disabled:a||s,...f,children:s?E.jsx(wo,{size:"sm"}):E.jsxs(E.Fragment,{children:[l&&E.jsx("span",{className:"material-symbols-outlined text-xl",children:l}),n]})})}function VV(){const[n,e]=$.useState(!1),[t,r]=$.useState(null),s=$n(),{isAuthenticated:a}=mo();$.useEffect(()=>{a&&s("/dashboard",{replace:!0})},[a,s]);const l=async()=>{e(!0),r(null);try{await CV(),s("/dashboard")}catch(f){console.error("Sign in error:",f),r("Failed to sign in. Please try again.")}finally{e(!1)}},d=[{icon:"local_fire_department",title:"Track Streaks",description:"Never miss a day and watch your streaks grow."},{icon:"leaderboard",title:"Join Leaderboards",description:"Compete weekly and celebrate wins."},{icon:"share",title:"Share Progress",description:"Share your journey or keep it private."}];return a?null:E.jsx("div",{className:"relative flex h-auto min-h-screen w-full flex-col bg-background-light dark:bg-background-dark font-display overflow-x-hidden",children:E.jsxs("div",{className:"flex flex-col grow justify-between",children:[E.jsxs("div",{className:"flex flex-col",children:[E.jsx("div",{className:"p-4",children:E.jsx("div",{className:"w-full bg-center bg-no-repeat bg-cover flex flex-col justify-end overflow-hidden rounded-xl min-h-80",style:{backgroundImage:`linear-gradient(135deg, 
                  rgba(19, 236, 91, 0.3) 0%, 
                  rgba(16, 34, 22, 0.5) 50%, 
                  rgba(19, 236, 91, 0.2) 100%),
                  url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 400 300'%3E%3Cdefs%3E%3ClinearGradient id='grad' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' style='stop-color:%2313ec5b;stop-opacity:0.3'/%3E%3Cstop offset='100%25' style='stop-color:%23102216;stop-opacity:0.8'/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect fill='url(%23grad)' width='400' height='300'/%3E%3Ccircle cx='100' cy='150' r='60' fill='%2313ec5b' opacity='0.2'/%3E%3Ccircle cx='300' cy='100' r='80' fill='%2313ec5b' opacity='0.15'/%3E%3Ccircle cx='250' cy='220' r='50' fill='%2313ec5b' opacity='0.25'/%3E%3C/svg%3E")`},children:E.jsx("div",{className:"p-6 flex items-center justify-center",children:E.jsx("span",{className:"material-symbols-outlined text-primary text-6xl",children:"eco"})})})}),E.jsx("h1",{className:"text-text-light-primary dark:text-gray-100 tracking-tight text-[32px] font-bold leading-tight px-4 text-center pb-3 pt-6",children:"Build Better Habits, Together."}),E.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-base font-normal leading-normal pb-3 pt-1 px-4 text-center",children:"Track your progress, compete with friends, and stay motivated every day."}),E.jsx("div",{className:"flex overflow-x-auto no-scrollbar",children:E.jsx("div",{className:"flex items-stretch p-4 gap-4 w-full",children:d.map(f=>E.jsxs("div",{className:"flex h-full flex-1 flex-col items-center gap-2 text-center rounded-lg min-w-32 pt-4",children:[E.jsx("div",{className:"flex items-center justify-center bg-primary/20 dark:bg-primary/30 h-14 w-14 rounded-full",children:E.jsx("span",{className:"material-symbols-outlined text-primary text-3xl",children:f.icon})}),E.jsxs("div",{children:[E.jsx("p",{className:"text-text-light-primary dark:text-gray-100 text-base font-medium leading-normal",children:f.title}),E.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm font-normal leading-normal",children:f.description})]})]},f.title))})}),E.jsxs("div",{className:"flex w-full flex-row items-center justify-center gap-3 py-5",children:[E.jsx("div",{className:"h-2 w-2 rounded-full bg-primary"}),E.jsx("div",{className:"h-2 w-2 rounded-full bg-gray-300 dark:bg-gray-600"}),E.jsx("div",{className:"h-2 w-2 rounded-full bg-gray-300 dark:bg-gray-600"})]})]}),E.jsxs("div",{className:"p-4 flex flex-col gap-4",children:[t&&E.jsx("p",{className:"text-danger text-sm text-center",children:t}),E.jsx("button",{onClick:l,disabled:n,className:"flex h-12 w-full items-center justify-center gap-2.5 rounded-lg bg-primary px-6 text-base font-bold text-gray-900 dark:text-black disabled:opacity-50 transition-all hover:shadow-lg",children:n?E.jsx("span",{className:"animate-spin",children:""}):E.jsxs(E.Fragment,{children:[E.jsxs("svg",{"aria-hidden":"true",className:"h-6 w-6",fill:"none",height:"24",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",children:[E.jsx("path",{d:"M22.56 12.25C22.56 11.45 22.49 10.68 22.36 9.92H12V14.3H18.05C17.78 15.68 17.06 16.85 15.96 17.65V20.12H19.64C21.55 18.35 22.56 15.54 22.56 12.25Z",fill:"#4285F4"}),E.jsx("path",{d:"M12 23C14.97 23 17.52 22.02 19.64 20.12L15.96 17.65C14.99 18.31 13.62 18.72 12 18.72C9.09 18.72 6.6 16.83 5.75 14.15H1.97V16.7C3.86 20.48 7.64 23 12 23Z",fill:"#34A853"}),E.jsx("path",{d:"M5.75 14.15C5.55 13.59 5.45 12.98 5.45 12.35C5.45 11.72 5.55 11.11 5.75 10.55V7.98H1.97C1.22 9.38 0.77 10.83 0.77 12.35C0.77 13.87 1.22 15.32 1.97 16.7L5.75 14.15Z",fill:"#FBBC05"}),E.jsx("path",{d:"M12 5.98C13.72 5.98 15.14 6.58 16.22 7.59L19.71 4.1C17.52 2.19 14.97 1 12 1C7.64 1 3.86 3.52 1.97 7.98L5.75 10.55C6.6 7.87 9.09 5.98 12 5.98Z",fill:"#EA4335"})]}),"Continue with Google"]})})]})]})})}const OV=[{path:"/dashboard",icon:"home",label:"Dashboard"},{path:"/leaderboard",icon:"leaderboard",label:"Leaderboard"},{path:"/feed",icon:"feed",label:"Feed"},{path:"/settings",icon:"settings",label:"Settings"}];function rl(){return E.jsx("nav",{className:"fixed bottom-0 left-0 right-0 h-20 bg-content-light/80 dark:bg-content-dark/80 backdrop-blur-lg border-t border-border-light dark:border-border-dark z-20",children:E.jsx("div",{className:"flex justify-around items-center h-full max-w-md mx-auto",children:OV.map(n=>E.jsx(sE,{to:n.path,className:({isActive:e})=>`flex flex-col items-center justify-center gap-1 transition-colors ${e?"text-primary":"text-text-light-secondary dark:text-text-dark-secondary"}`,children:({isActive:e})=>E.jsxs(E.Fragment,{children:[E.jsx("span",{className:`material-symbols-outlined ${e?"filled":""}`,style:e?{fontVariationSettings:"'FILL' 1, 'wght' 400"}:{},children:n.icon}),E.jsx("span",{className:`text-xs ${e?"font-bold":""}`,children:n.label})]})},n.path))})})}const LV=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];function MV({selectedDate:n,onDateSelect:e,completionsByDate:t={}}){const r=new Date;r.setHours(0,0,0,0);const s=$.useMemo(()=>{const v=[],w=new Date(r),x=r.getDay();w.setDate(r.getDate()-x);for(let S=0;S<7;S++){const D=new Date(w);D.setDate(w.getDate()+S),v.push(D)}return v},[]),a=v=>v.toDateString()===r.toDateString(),l=v=>n?v.toDateString()===new Date(n).toDateString():a(v),d=v=>v.toISOString().split("T")[0],f=v=>{const w=d(v);return t[w]&&t[w].length>0},m=v=>v<r&&!a(v);return E.jsx("div",{className:"flex overflow-x-auto no-scrollbar pt-2 pb-4 px-4",children:E.jsx("div",{className:"flex space-x-3",children:s.map(v=>{const w=l(v),x=f(v),S=m(v);return E.jsxs("button",{onClick:()=>e==null?void 0:e(v),className:`
                flex flex-col items-center justify-center w-14 h-24 rounded-xl flex-shrink-0 transition-all
                ${w?"bg-primary":"bg-content-light dark:bg-content-dark border border-border-light dark:border-border-dark"}
              `,children:[E.jsx("p",{className:`text-sm font-medium ${w?"text-text-light-primary":"text-text-light-secondary dark:text-text-dark-secondary"}`,children:LV[v.getDay()]}),E.jsx("p",{className:`text-lg font-bold mt-1 ${w?"text-text-light-primary":"text-text-light-primary dark:text-text-dark-primary"}`,children:v.getDate()}),E.jsx("div",{className:`w-2 h-2 rounded-full mt-2 ${w?"bg-text-light-primary":x?"bg-primary":S?"bg-text-light-secondary/30 dark:bg-text-dark-secondary/30":"bg-text-light-secondary dark:bg-text-dark-secondary/50"}`})]},v.toISOString())})})})}function jV({streak:n,size:e="md"}){if(!n||n===0)return null;const t={sm:"text-xs",md:"text-sm",lg:"text-base"};return E.jsxs("span",{className:`text-text-light-secondary dark:text-text-dark-secondary ${t[e]}`,children:[" ",n," ",n===1?"day":"days"]})}function HT({habit:n,isCompleted:e,onToggle:t,currentValue:r,onUpdateProgress:s,showCheckbox:a=!0,disabled:l=!1}){const d=$n(),f=()=>{d(`/habit/${n.id}`)},m=v=>{v.stopPropagation(),!l&&t(n.id)};return E.jsxs("div",{className:`flex items-center gap-x-4 p-4 rounded-lg bg-content-light dark:bg-content-dark cursor-pointer transition-colors ${l?"opacity-70 cursor-not-allowed":"hover:bg-gray-50 dark:hover:bg-gray-800/50"}`,onClick:l?void 0:f,children:[E.jsx("div",{className:"flex-grow",children:E.jsxs("p",{className:"text-text-light-primary dark:text-text-dark-primary text-base font-normal leading-normal",children:[n.title," ",n.currentStreak>0&&E.jsx(jV,{streak:n.currentStreak})]})}),E.jsx("span",{className:"material-symbols-outlined text-text-light-secondary dark:text-text-dark-secondary text-base",children:n.isPublic?"public":"lock"}),a&&(n.completionType==="numerical"?E.jsxs("div",{className:"flex items-center gap-2",onClick:v=>v.stopPropagation(),children:[E.jsx("button",{onClick:()=>!l&&s(n.id,Math.max(0,(r||0)-1)),disabled:l||(r||0)<=0,className:`size-8 rounded-full bg-gray-100 dark:bg-gray-800 flex items-center justify-center text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors ${l?"opacity-50 cursor-not-allowed":""}`,children:E.jsx("span",{className:"material-symbols-outlined text-lg",children:"remove"})}),E.jsxs("div",{className:"flex flex-col items-center min-w-[60px]",children:[E.jsx("span",{className:"text-sm font-bold text-gray-900 dark:text-white",children:r||0}),E.jsxs("span",{className:"text-[10px] text-gray-500 uppercase",children:["/ ",n.targetValue," ",n.unit]})]}),E.jsx("button",{onClick:()=>!l&&s(n.id,(r||0)+1),disabled:l,className:`size-8 rounded-full bg-primary/10 flex items-center justify-center text-primary hover:bg-primary/20 transition-colors ${l?"opacity-50 cursor-not-allowed":""}`,children:E.jsx("span",{className:"material-symbols-outlined text-lg",children:"add"})})]}):E.jsx("input",{type:"checkbox",checked:e,onChange:m,onClick:v=>v.stopPropagation(),disabled:l,className:`h-6 w-6 rounded-md border-border-light dark:border-border-dark border-2 bg-transparent text-primary checked:bg-primary checked:border-primary focus:ring-0 focus:ring-offset-0 focus:border-border-light dark:focus:border-border-dark focus:outline-none ${l?"cursor-not-allowed opacity-50":"cursor-pointer"}`}))]})}function FV(){var C;const n=$n(),{user:e}=mo(),{habits:t,completions:r,isLoading:s,getTodaysHabits:a,getStatsForDate:l,isHabitCompleted:d,toggleCompletion:f,updateHabitProgress:m,getHabitValue:v,loadCompletionsForDate:w,subscribeToHabits:x}=po(),[S,D]=$.useState(new Date),O=Wi(new Date),K=Wi(S),X=K===O,q=K>O,re=a(S),{completed:de,total:ne,percentage:P}=l(K);$.useEffect(()=>{e!=null&&e.uid&&w(e.uid,K)},[K,e==null?void 0:e.uid,w]),$.useEffect(()=>{if(e!=null&&e.uid){const Pe=x(e.uid);return()=>Pe()}},[e==null?void 0:e.uid,x]);const k=()=>{const Pe=new Date().getHours();return Pe<12?"Good Morning":Pe<18?"Good Afternoon":"Good Evening"},R=((C=e==null?void 0:e.displayName)==null?void 0:C.split(" ")[0])||"there",A=async Pe=>{if(e!=null&&e.uid)try{await f(Pe,e.uid,K)}catch(pt){console.error("Error toggling completion:",pt)}},L=async(Pe,pt)=>{if(e!=null&&e.uid)try{await m(Pe,e.uid,K,pt)}catch(Rt){console.error("Error updating progress:",Rt)}},M=Pe=>{D(Pe)};return E.jsxs("div",{className:"relative flex h-auto min-h-screen w-full flex-col overflow-x-hidden",children:[E.jsxs("div",{className:"flex-grow pb-40",children:[E.jsxs("div",{className:"md:min-h-[50vh] md:flex md:flex-col md:justify-center md:bg-gray-50/50 md:dark:bg-gray-900/50",children:[E.jsxs("div",{className:"flex items-center bg-background-light dark:bg-background-dark md:bg-transparent p-4 pb-2 justify-between sticky top-0 z-10 md:static",children:[E.jsxs("div",{className:"flex items-center gap-3",children:[E.jsx("div",{className:"flex size-12 shrink-0 items-center justify-center",children:e!=null&&e.photoURL?E.jsx("img",{src:e.photoURL,alt:"Profile",className:"rounded-full size-10 object-cover",referrerPolicy:"no-referrer"}):E.jsx("div",{className:"rounded-full size-10 bg-primary/20 flex items-center justify-center",children:E.jsx("span",{className:"material-symbols-outlined text-primary",children:"person"})})}),E.jsxs("h2",{className:"text-text-light-primary dark:text-text-dark-primary text-lg font-bold leading-tight tracking-[-0.015em] flex-1",children:[k(),", ",R,"!"]})]}),E.jsx("div",{className:"flex w-12 items-center justify-end",children:E.jsx("button",{className:"flex max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-12 bg-transparent text-text-light-primary dark:text-text-dark-primary gap-2 text-base font-bold leading-normal tracking-[0.015em] min-w-0 p-0",children:E.jsx("span",{className:"material-symbols-outlined",children:"calendar_today"})})})]}),E.jsxs("div",{className:"flex flex-col gap-3 p-4",children:[E.jsxs("div",{className:"flex gap-6 justify-between items-center",children:[E.jsxs("p",{className:"text-text-light-primary dark:text-text-dark-primary text-base font-medium leading-normal",children:[X?"You've completed":"Completed"," ",de," of ",ne," habits",X?" today":"","!"]}),E.jsxs("p",{className:"text-text-light-secondary dark:text-text-dark-secondary text-sm font-normal leading-normal",children:[P,"%"]})]}),E.jsx("div",{className:"rounded-full bg-border-light dark:bg-border-dark/50",children:E.jsx("div",{className:"h-2 rounded-full bg-primary transition-all duration-500 ease-out",style:{width:`${P}%`}})}),E.jsx("p",{className:"text-text-light-secondary dark:text-text-dark-secondary text-sm font-normal leading-normal",children:P>=100?" All done!":P>0?"Keep it up!":ne===0?"No habits scheduled":"Start completing your habits!"})]}),E.jsx(MV,{selectedDate:S,onDateSelect:M,completionsByDate:r})]}),E.jsx("h3",{className:"text-text-light-primary dark:text-text-dark-primary text-lg font-bold leading-tight tracking-[-0.015em] px-4 pb-2 pt-2",children:X?"Today's Habits":`Habits for ${S.toLocaleDateString("en-US",{weekday:"long"})}`}),E.jsx("div",{className:"px-4 flex flex-col gap-2",children:s?E.jsx("div",{className:"flex justify-center py-12",children:E.jsx(wo,{})}):re.length===0?E.jsxs("div",{className:"text-center py-12",children:[E.jsx("span",{className:"material-symbols-outlined text-4xl text-gray-400 mb-2 block",children:"checklist"}),E.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:t.length===0?"No habits yet":"No habits scheduled for this day"}),t.length===0&&E.jsx("button",{onClick:()=>n("/new-habit"),className:"text-primary font-medium hover:underline",children:"Create your first habit"})]}):re.map(Pe=>E.jsx(HT,{habit:Pe,isCompleted:d(Pe.id,K),currentValue:v(Pe.id,K),onToggle:A,onUpdateProgress:L,disabled:q},Pe.id))})]}),E.jsx("div",{className:"fixed bottom-24 right-4 z-20",children:E.jsx("button",{onClick:()=>n("/new-habit"),className:"flex items-center justify-center size-14 cursor-pointer overflow-hidden rounded-full bg-primary text-text-light-primary shadow-lg hover:shadow-xl transition-shadow animate-pulse-glow",children:E.jsx("span",{className:"material-symbols-outlined text-3xl",children:"add"})})}),E.jsx(rl,{})]})}function Hd({label:n,id:e,error:t,className:r="",...s}){return E.jsxs("div",{className:"flex flex-col",children:[n&&E.jsx("label",{htmlFor:e,className:"text-base font-medium leading-normal pb-2 text-gray-800 dark:text-gray-400 uppercase tracking-wide",children:n}),E.jsx("input",{id:e,className:`
          form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden 
          rounded-lg border border-gray-200 dark:border-gray-700 
          bg-white dark:bg-gray-800 
          h-14 p-4 
          text-base font-normal leading-normal 
          text-text-light-primary dark:text-white 
          placeholder:text-gray-400 dark:placeholder:text-gray-500 
          focus:border-primary focus:ring-primary/50 focus:ring-2 focus:outline-none
          transition-colors
          ${t?"border-danger focus:border-danger focus:ring-danger/50":""}
          ${r}
        `,...s}),t&&E.jsx("p",{className:"mt-1 text-sm text-danger",children:t})]})}function Eh({checked:n,onChange:e,label:t,description:r}){return E.jsxs("div",{className:"flex flex-col",children:[E.jsxs("div",{className:"flex items-center justify-between",children:[t&&E.jsx("h3",{className:"text-base font-medium leading-tight tracking-[-0.015em] text-gray-800 dark:text-gray-400 uppercase",children:t}),E.jsxs("label",{className:"relative inline-flex cursor-pointer items-center",children:[E.jsx("input",{type:"checkbox",checked:n,onChange:s=>e(s.target.checked),className:"peer sr-only"}),E.jsx("div",{className:"peer h-6 w-11 rounded-full bg-gray-200 dark:bg-gray-700 after:absolute after:top-[2px] after:left-[2px] after:h-5 after:w-5 after:rounded-full after:border after:border-gray-300 dark:after:border-gray-600 after:bg-white after:transition-all peer-checked:bg-primary peer-checked:after:translate-x-full peer-checked:after:border-white"})]})]}),r&&E.jsx("p",{className:"pt-2 text-sm text-gray-500 dark:text-gray-400",children:r})]})}const UV=[{key:0,label:"S",name:"Sunday"},{key:1,label:"M",name:"Monday"},{key:2,label:"T",name:"Tuesday"},{key:3,label:"W",name:"Wednesday"},{key:4,label:"T",name:"Thursday"},{key:5,label:"F",name:"Friday"},{key:6,label:"S",name:"Saturday"}];function WT({isOpen:n,onClose:e,selectedDays:t=[],onSave:r}){const[s,a]=$.useState(t),l=f=>{a(m=>m.includes(f)?m.filter(v=>v!==f):[...m,f])},d=()=>{r(s),e()};return n?E.jsx("div",{className:"fixed inset-0 z-50 flex items-end bg-black/50 backdrop-blur-sm animate-fade-in",children:E.jsxs("div",{className:"flex h-auto w-full flex-col rounded-t-xl bg-background-light dark:bg-gray-800 animate-slide-up",children:[E.jsxs("div",{className:"relative flex items-center justify-center border-b border-gray-200 p-4 dark:border-gray-700",children:[E.jsx("h2",{className:"text-lg font-bold text-text-light-primary dark:text-text-dark-primary",children:"Select Days"}),E.jsx("button",{onClick:e,className:"absolute right-4 top-1/2 -translate-y-1/2",children:E.jsx("span",{className:"material-symbols-outlined !text-2xl text-gray-500 dark:text-gray-400",children:"close"})})]}),E.jsxs("div",{className:"p-4",children:[E.jsx("p",{className:"mb-4 text-center text-sm text-gray-500 dark:text-gray-400",children:"Choose the specific days of the week you want to track this habit."}),E.jsx("div",{className:"flex justify-center gap-2",children:UV.map(f=>{const m=s.includes(f.key);return E.jsx("button",{onClick:()=>l(f.key),className:`
                    relative flex h-12 w-12 cursor-pointer flex-col items-center justify-center rounded-full border transition-all
                    ${m?"border-primary bg-primary text-black":"border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-800 text-text-light-primary dark:text-text-dark-primary hover:border-primary/50"}
                  `,title:f.name,children:E.jsx("span",{className:"font-bold",children:f.label})},f.key)})})]}),E.jsx("div",{className:"p-4 pt-2 pb-6",children:E.jsx(rs,{fullWidth:!0,onClick:d,disabled:s.length===0,children:"Save"})})]})}):null}const BV=[{value:"daily",label:"Daily"},{value:"weekly",label:"Weekly"},{value:"custom",label:"More"}],zV=[{value:"checkbox",icon:"check_box",label:"Checkbox"},{value:"numerical",icon:"pin",label:"Numerical"}];function $V(){const n=$n(),{user:e}=mo(),{addHabit:t}=po(),[r,s]=$.useState(""),[a,l]=$.useState("daily"),[d,f]=$.useState([]),[m,v]=$.useState("checkbox"),[w,x]=$.useState(""),[S,D]=$.useState(""),[F,O]=$.useState(!1),[K,X]=$.useState(!1),[q,re]=$.useState(!1),[de,ne]=$.useState(null),P=r.trim().length>0&&(m==="checkbox"||w>0&&S.trim().length>0),k=A=>{l(A),A==="custom"&&X(!0)},R=async()=>{if(!(!P||q||!(e!=null&&e.uid))){re(!0),ne(null);try{const A={title:r.trim(),description:"",frequency:a,customDays:a==="custom"?d:[],completionType:m,targetValue:m==="numerical"?Number(w):null,unit:m==="numerical"?S.trim():null,isPublic:!F};await t(e.uid,A),n("/dashboard")}catch(A){console.error("Failed to create habit:",A),ne("Failed to create habit. Please try again.")}finally{re(!1)}}};return E.jsxs("div",{className:"relative flex h-auto min-h-screen w-full flex-col bg-background-light dark:bg-background-dark overflow-x-hidden",children:[E.jsxs("header",{className:"flex items-center p-4",children:[E.jsx("button",{onClick:()=>n(-1),className:"flex size-12 shrink-0 items-center justify-start text-text-light-primary dark:text-gray-200",children:E.jsx("span",{className:"material-symbols-outlined !text-2xl",children:"arrow_back_ios_new"})}),E.jsx("h1",{className:"flex-1 text-center text-lg font-bold leading-tight tracking-[-0.015em] text-text-light-primary dark:text-gray-200",children:"New Habit"}),E.jsx("div",{className:"flex w-12 items-center justify-end",children:E.jsx("button",{onClick:R,disabled:!P||q,className:`text-base font-bold leading-normal tracking-[0.015em] shrink-0 ${P&&!q?"text-primary":"text-primary/50 dark:text-primary/70"}`,children:"Save"})})]}),E.jsxs("main",{className:"flex flex-col gap-6 px-4 pt-4 pb-6",children:[de&&E.jsx("div",{className:"p-3 rounded-lg bg-danger/10 text-danger text-sm",children:de}),E.jsx(Hd,{label:"Name",id:"habitName",placeholder:"e.g., Read for 15 minutes",value:r,onChange:A=>s(A.target.value)}),E.jsxs("div",{className:"flex flex-col",children:[E.jsx("h3",{className:"text-base font-medium leading-tight tracking-[-0.015em] pb-2 text-gray-800 dark:text-gray-400 uppercase",children:"Frequency"}),E.jsx("div",{className:"flex h-12 flex-1 items-center justify-center rounded-lg bg-gray-200/60 dark:bg-gray-800 p-1",children:BV.map(A=>E.jsxs("label",{className:`
                  flex h-full flex-1 cursor-pointer items-center justify-center overflow-hidden rounded-md px-2 
                  text-sm font-medium leading-normal transition-all
                  ${a===A.value?"bg-white dark:bg-gray-900 text-text-light-primary dark:text-white shadow-sm":"text-gray-600 dark:text-gray-400"}
                `,children:[E.jsxs("span",{className:"flex items-center gap-1",children:[A.label,A.value==="custom"&&E.jsx("span",{className:"material-symbols-outlined !text-base",children:"expand_more"})]}),E.jsx("input",{type:"radio",name:"frequency",value:A.value,checked:a===A.value,onChange:()=>k(A.value),className:"invisible w-0"})]},A.value))}),a==="custom"&&d.length>0&&E.jsxs("button",{onClick:()=>X(!0),className:"mt-2 text-sm text-primary hover:underline text-left",children:[d.length," days selected - tap to edit"]}),a==="custom"&&d.length===0&&E.jsx("button",{onClick:()=>X(!0),className:"mt-2 text-sm text-gray-500 hover:text-primary text-left",children:"Click to select days"})]}),E.jsxs("div",{className:"flex flex-col",children:[E.jsx("h3",{className:"text-base font-medium leading-tight tracking-[-0.015em] pb-2 text-gray-800 dark:text-gray-400 uppercase",children:"How will you track it?"}),E.jsx("div",{className:"grid grid-cols-2 gap-3 mb-4",children:zV.map(A=>E.jsxs("label",{className:`
                  flex cursor-pointer flex-col items-center justify-center gap-2 rounded-lg border-2 p-4 py-6 text-center transition-all
                  ${m===A.value?"border-primary bg-primary/10 dark:bg-primary/20 text-primary":"border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300"}
                `,children:[E.jsx("span",{className:"material-symbols-outlined !text-3xl",children:A.icon}),E.jsx("span",{className:"font-medium",children:A.label}),E.jsx("input",{type:"radio",name:"tracking_type",value:A.value,checked:m===A.value,onChange:()=>v(A.value),className:"invisible w-0"})]},A.value))}),m==="numerical"&&E.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4 animation-slide-down",children:[E.jsx(Hd,{label:"Target Goal",type:"number",placeholder:"e.g. 5",value:w,onChange:A=>x(A.target.value),min:"1"}),E.jsx(Hd,{label:"Unit",type:"text",placeholder:"e.g. cups",value:S,onChange:A=>D(A.target.value)})]})]}),E.jsx(Eh,{label:"Make it private?",description:"Private habits will not appear on the community feed or your profile.",checked:F,onChange:O})]}),E.jsx("footer",{className:"mt-auto px-4 pb-6 pt-4",children:E.jsx(rs,{fullWidth:!0,onClick:R,isLoading:q,disabled:!P,children:"Add Habit"})}),E.jsx(WT,{isOpen:K,onClose:()=>X(!1),selectedDays:d,onSave:f})]})}const qV=[{value:"daily",label:"Daily"},{value:"weekly",label:"Weekly"},{value:"custom",label:"More"}],HV=[{value:"checkbox",icon:"check_box",label:"Checkbox"},{value:"numerical",icon:"pin",label:"Numerical"}];function WV(){const{habitId:n}=zm(),e=$n(),{habits:t,updateHabit:r}=po(),s=t.find(ne=>ne.id===n),[a,l]=$.useState(""),[d,f]=$.useState("daily"),[m,v]=$.useState([]),[w,x]=$.useState("checkbox"),[S,D]=$.useState(!1),[F,O]=$.useState(!1),[K,X]=$.useState(!1);if($.useEffect(()=>{s&&(l(s.title||""),f(s.frequency||"daily"),v(s.customDays||[]),x(s.completionType||"checkbox"),D(!s.isPublic))},[s]),!s)return E.jsx("div",{className:"min-h-screen bg-background-light dark:bg-background-dark flex items-center justify-center",children:E.jsxs("div",{className:"text-center",children:[E.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"Habit not found"}),E.jsx(rs,{onClick:()=>e("/dashboard"),children:"Back to Dashboard"})]})});const q=a.trim().length>0,re=ne=>{f(ne),ne==="custom"&&O(!0)},de=async()=>{if(!(!q||K)){X(!0);try{await r(n,{title:a.trim(),frequency:d,customDays:d==="custom"?m:[],completionType:w,isPublic:!S}),e(`/habit/${n}`)}catch(ne){console.error("Failed to update habit:",ne)}finally{X(!1)}}};return E.jsxs("div",{className:"relative flex h-auto min-h-screen w-full flex-col bg-background-light dark:bg-background-dark overflow-x-hidden",children:[E.jsxs("header",{className:"flex items-center p-4",children:[E.jsx("button",{onClick:()=>e("/dashboard"),className:"flex size-12 shrink-0 items-center justify-start text-text-light-primary dark:text-gray-200",children:E.jsx("span",{className:"material-symbols-outlined !text-2xl",children:"arrow_back_ios_new"})}),E.jsx("h1",{className:"flex-1 text-center text-lg font-bold leading-tight tracking-[-0.015em] text-text-light-primary dark:text-gray-200",children:"Edit Habit"}),E.jsx("div",{className:"flex w-12 items-center justify-end",children:E.jsx("button",{onClick:de,disabled:!q||K,className:`text-base font-bold leading-normal tracking-[0.015em] shrink-0 ${q&&!K?"text-primary":"text-primary/50 dark:text-primary/70"}`,children:"Save"})})]}),E.jsxs("main",{className:"flex flex-col gap-6 px-4 pt-4 pb-6",children:[E.jsx(Hd,{label:"Name",id:"habitName",placeholder:"e.g., Read for 15 minutes",value:a,onChange:ne=>l(ne.target.value)}),E.jsxs("div",{className:"flex flex-col",children:[E.jsx("h3",{className:"text-base font-medium leading-tight tracking-[-0.015em] pb-2 text-gray-800 dark:text-gray-400 uppercase",children:"Frequency"}),E.jsx("div",{className:"flex h-12 flex-1 items-center justify-center rounded-lg bg-gray-200/60 dark:bg-gray-800 p-1",children:qV.map(ne=>E.jsxs("label",{className:`
                  flex h-full flex-1 cursor-pointer items-center justify-center overflow-hidden rounded-md px-2 
                  text-sm font-medium leading-normal transition-all
                  ${d===ne.value?"bg-white dark:bg-gray-900 text-text-light-primary dark:text-white shadow-sm":"text-gray-600 dark:text-gray-400"}
                `,children:[E.jsxs("span",{className:"flex items-center gap-1",children:[ne.label,ne.value==="custom"&&E.jsx("span",{className:"material-symbols-outlined !text-base",children:"expand_more"})]}),E.jsx("input",{type:"radio",name:"frequency",value:ne.value,checked:d===ne.value,onChange:()=>re(ne.value),className:"invisible w-0"})]},ne.value))}),d==="custom"&&m.length>0&&E.jsxs("button",{onClick:()=>O(!0),className:"mt-2 text-sm text-primary hover:underline text-left",children:[m.length," days selected - tap to edit"]})]}),E.jsxs("div",{className:"flex flex-col",children:[E.jsx("h3",{className:"text-base font-medium leading-tight tracking-[-0.015em] pb-2 text-gray-800 dark:text-gray-400 uppercase",children:"How will you track it?"}),E.jsx("div",{className:"grid grid-cols-2 gap-3",children:HV.map(ne=>E.jsxs("label",{className:`
                  flex cursor-pointer flex-col items-center justify-center gap-2 rounded-lg border-2 p-4 py-6 text-center transition-all
                  ${w===ne.value?"border-primary bg-primary/10 dark:bg-primary/20 text-primary":"border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300"}
                `,children:[E.jsx("span",{className:"material-symbols-outlined !text-3xl",children:ne.icon}),E.jsx("span",{className:"font-medium",children:ne.label}),E.jsx("input",{type:"radio",name:"tracking_type",value:ne.value,checked:w===ne.value,onChange:()=>x(ne.value),className:"invisible w-0"})]},ne.value))})]}),E.jsx(Eh,{label:"Make it private?",description:"Private habits will not appear on the community feed or your profile.",checked:S,onChange:D})]}),E.jsx("footer",{className:"mt-auto px-4 pb-6 pt-4",children:E.jsx(rs,{fullWidth:!0,onClick:de,isLoading:K,disabled:!q,children:"Save Changes"})}),E.jsx(WT,{isOpen:F,onClose:()=>O(!1),selectedDays:m,onSave:v})]})}const GV={daily:"Daily",weekly:"Weekly",custom:"Custom Days"},KV={checkbox:"Check-off",numerical:"Numerical"},QV=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];function XV(){const{habitId:n}=zm(),e=$n(),{habits:t,deleteHabit:r,isLoading:s}=po(),a=t.find(m=>m.id===n),l=async()=>{if(window.confirm("Are you sure you want to delete this habit? This action cannot be undone."))try{await r(n),e("/dashboard")}catch(m){console.error("Error deleting habit:",m),alert("Failed to delete habit. Please try again.")}};if(s)return E.jsx("div",{className:"min-h-screen bg-background-light dark:bg-background-dark flex items-center justify-center",children:E.jsx(wo,{size:"lg"})});if(!a)return E.jsx("div",{className:"min-h-screen bg-background-light dark:bg-background-dark flex items-center justify-center",children:E.jsxs("div",{className:"text-center",children:[E.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"Habit not found"}),E.jsx(rs,{onClick:()=>e("/dashboard"),children:"Back to Dashboard"})]})});const d=()=>{var m;return a.frequency!=="custom"||!((m=a.customDays)!=null&&m.length)?null:a.customDays.map(v=>QV[v]).join(", ")},f=[{icon:"event_repeat",label:"Frequency",value:a.frequency==="custom"?d():GV[a.frequency]||a.frequency},{icon:"task_alt",label:"Completion Type",value:KV[a.completionType]||a.completionType||"Check-off"},{icon:a.isPublic?"public":"lock",label:"Visibility",value:a.isPublic?"Public":"Private"}];return E.jsxs("div",{className:"relative flex h-auto min-h-screen w-full flex-col overflow-x-hidden font-display bg-background-light dark:bg-background-dark",children:[E.jsxs("div",{className:"flex-grow pb-28",children:[E.jsxs("header",{className:"flex items-center bg-background-light dark:bg-background-dark p-4 justify-between sticky top-0 z-10 border-b border-border-light dark:border-border-dark",children:[E.jsx("div",{className:"flex w-12 items-center justify-start",children:E.jsx("button",{onClick:()=>e(-1),className:"flex max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-12 bg-transparent text-text-light-primary dark:text-text-dark-primary gap-2 text-base font-bold leading-normal tracking-[0.015em] min-w-0 p-0",children:E.jsx("span",{className:"material-symbols-outlined",children:"arrow_back_ios_new"})})}),E.jsx("h1",{className:"text-text-light-primary dark:text-text-dark-primary text-lg font-bold leading-tight tracking-[-0.015em] text-center",children:"Habit Details"}),E.jsx("div",{className:"flex w-12 items-center justify-end",children:E.jsx("button",{className:"flex max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-12 bg-transparent text-text-light-primary dark:text-text-dark-primary gap-2 text-base font-bold leading-normal tracking-[0.015em] min-w-0 p-0",children:E.jsx("span",{className:"material-symbols-outlined",children:"more_vert"})})})]}),E.jsxs("main",{className:"p-4",children:[E.jsxs("div",{className:"bg-content-light dark:bg-content-dark rounded-xl p-6 flex flex-col items-center",children:[E.jsx("h2",{className:"text-2xl font-bold text-text-light-primary dark:text-text-dark-primary text-center",children:a.title}),(a.currentStreak||0)>0&&E.jsxs("div",{className:"mt-4 py-2 px-4 rounded-full bg-primary/20 text-primary flex items-center gap-2",children:[E.jsx("span",{className:"material-symbols-outlined text-base",style:{fontVariationSettings:"'FILL' 1, 'wght' 700"},children:"local_fire_department"}),E.jsxs("p",{className:"font-bold text-sm",children:["Current Streak: ",a.currentStreak," ",a.currentStreak===1?"day":"days"]})]})]}),E.jsx("div",{className:"mt-4 grid grid-cols-1 gap-4",children:f.map(m=>E.jsxs("div",{className:"bg-content-light dark:bg-content-dark rounded-xl p-4 flex items-center gap-4",children:[E.jsx("div",{className:"flex items-center justify-center size-10 rounded-lg bg-primary/20 text-primary",children:E.jsx("span",{className:"material-symbols-outlined",children:m.icon})}),E.jsxs("div",{children:[E.jsx("p",{className:"text-sm text-text-light-secondary dark:text-text-dark-secondary",children:m.label}),E.jsx("p",{className:"text-base font-medium text-text-light-primary dark:text-text-dark-primary",children:m.value})]})]},m.label))}),E.jsxs("div",{className:"mt-8 flex flex-col gap-3",children:[E.jsx(rs,{fullWidth:!0,icon:"edit",onClick:()=>e(`/edit-habit/${a.id}`),children:"Edit Habit"}),E.jsx(rs,{fullWidth:!0,variant:"danger",icon:"delete",onClick:l,children:"Delete Habit"})]})]})]}),E.jsx(rl,{})]})}function YV(){const n=$n(),{user:e}=mo(),[t,r]=$.useState("thisWeek"),[s,a]=$.useState([]),[l,d]=$.useState({rank:0,percentage:0}),[f,m]=$.useState(!0);$.useEffect(()=>{let D=()=>{};m(!0);try{const F=t==="thisWeek"?tc():SV();D=kV(F,O=>{if(a(O),e!=null&&e.uid){const K=O.find(X=>X.userId===e.uid);d(K?{rank:K.rank,percentage:K.percentage}:{rank:O.length+1,percentage:0})}m(!1)})}catch(F){console.error("Error in leaderboard subscription:",F),m(!1)}return()=>{D&&D()}},[t,e==null?void 0:e.uid]);const v=s.slice(0,3),w=s,x=D=>{switch(D){case 1:return"border-yellow-400";case 2:return"border-slate-300";case 3:return"border-amber-600";default:return"border-gray-300"}},S=D=>{switch(D){case 1:return"bg-yellow-400 text-yellow-900";case 2:return"bg-slate-300 text-slate-700";case 3:return"bg-amber-600 text-amber-100";default:return"bg-gray-300 text-gray-700"}};return E.jsxs("div",{className:"relative flex h-auto min-h-screen w-full flex-col overflow-x-hidden bg-background-light dark:bg-background-dark font-display text-slate-800 dark:text-slate-200",children:[E.jsxs("div",{className:"flex items-center p-4 pb-2 bg-background-light dark:bg-background-dark sticky top-0 z-10",children:[E.jsx("button",{onClick:()=>n(-1),className:"flex size-12 shrink-0 items-center justify-start",children:E.jsx("span",{className:"material-symbols-outlined",children:"arrow_back_ios_new"})}),E.jsx("h2",{className:"flex-1 text-center text-lg font-bold leading-tight tracking-[-0.015em]",children:"Weekly Leaderboard"}),E.jsx("div",{className:"flex w-12 items-center justify-end",children:E.jsx("button",{className:"flex h-12 cursor-pointer items-center justify-center gap-2 overflow-hidden rounded-lg bg-transparent min-w-0 p-0 text-base font-bold leading-normal tracking-[0.015em]",children:E.jsx("span",{className:"material-symbols-outlined",children:"ios_share"})})})]}),E.jsx("div",{className:"flex px-4 py-3",children:E.jsxs("div",{className:"flex h-10 flex-1 items-center justify-center rounded-lg bg-black/5 dark:bg-white/5 p-1",children:[E.jsxs("label",{className:`flex h-full grow cursor-pointer items-center justify-center overflow-hidden rounded-lg px-2 text-sm font-medium leading-normal transition-all ${t==="thisWeek"?"bg-background-light dark:bg-background-dark text-slate-900 dark:text-slate-100 shadow-sm":"text-slate-500 dark:text-slate-400"}`,children:[E.jsx("span",{className:"truncate",children:"This Week"}),E.jsx("input",{type:"radio",name:"time-period",value:"thisWeek",checked:t==="thisWeek",onChange:()=>r("thisWeek"),className:"invisible w-0"})]}),E.jsxs("label",{className:`flex h-full grow cursor-pointer items-center justify-center overflow-hidden rounded-lg px-2 text-sm font-medium leading-normal transition-all ${t==="lastWeek"?"bg-background-light dark:bg-background-dark text-slate-900 dark:text-slate-100 shadow-sm":"text-slate-500 dark:text-slate-400"}`,children:[E.jsx("span",{className:"truncate",children:"Last Week"}),E.jsx("input",{type:"radio",name:"time-period",value:"lastWeek",checked:t==="lastWeek",onChange:()=>r("lastWeek"),className:"invisible w-0"})]})]})}),f?E.jsx("div",{className:"flex-1 flex items-center justify-center py-12",children:E.jsx(wo,{size:"lg"})}):s.length===0?E.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center py-12 px-4",children:[E.jsx("span",{className:"material-symbols-outlined text-5xl text-gray-400 mb-4",children:"leaderboard"}),E.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center",children:"No leaderboard data yet."}),E.jsx("p",{className:"text-gray-400 dark:text-gray-500 text-sm text-center mt-2",children:"Complete habits to appear on the leaderboard!"})]}):E.jsxs(E.Fragment,{children:[E.jsxs("div",{className:"flex items-end justify-center gap-4 px-4 py-6",children:[v[1]&&E.jsxs("div",{className:"flex flex-col items-center gap-2 cursor-pointer transition-transform active:scale-95",onClick:()=>n(`/profile/${v[1].userId}`),children:[E.jsxs("div",{className:"relative",children:[v[1].photoURL?E.jsx("img",{src:v[1].photoURL,alt:v[1].displayName,className:`aspect-square w-16 rounded-full bg-cover bg-center border-2 ${x(2)} object-cover`,referrerPolicy:"no-referrer"}):E.jsx("div",{className:`aspect-square w-16 rounded-full border-2 ${x(2)} bg-primary/20 flex items-center justify-center`,children:E.jsx("span",{className:"material-symbols-outlined text-primary text-2xl",children:"person"})}),E.jsx("div",{className:`absolute -bottom-2 left-1/2 -translate-x-1/2 flex h-6 w-6 items-center justify-center rounded-full ${S(2)} text-sm font-bold`,children:"2"})]}),E.jsx("p",{className:"text-sm font-bold",children:v[1].displayName}),E.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:[v[1].percentage,"%"]})]}),v[0]&&E.jsxs("div",{className:"flex flex-col items-center gap-2 cursor-pointer transition-transform active:scale-95",onClick:()=>n(`/profile/${v[0].userId}`),children:[E.jsxs("div",{className:"relative",children:[v[0].photoURL?E.jsx("img",{src:v[0].photoURL,alt:v[0].displayName,className:`aspect-square w-24 rounded-full bg-cover bg-center border-4 ${x(1)} object-cover`,referrerPolicy:"no-referrer"}):E.jsx("div",{className:`aspect-square w-24 rounded-full border-4 ${x(1)} bg-primary/20 flex items-center justify-center`,children:E.jsx("span",{className:"material-symbols-outlined text-primary text-3xl",children:"person"})}),E.jsx("div",{className:`absolute -bottom-2 left-1/2 -translate-x-1/2 flex h-8 w-8 items-center justify-center rounded-full ${S(1)} text-base font-bold`,children:"1"})]}),E.jsx("p",{className:"text-base font-bold",children:v[0].displayName}),E.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:[v[0].percentage,"%"]})]}),v[2]&&E.jsxs("div",{className:"flex flex-col items-center gap-2 cursor-pointer transition-transform active:scale-95",onClick:()=>n(`/profile/${v[2].userId}`),children:[E.jsxs("div",{className:"relative",children:[v[2].photoURL?E.jsx("img",{src:v[2].photoURL,alt:v[2].displayName,className:`aspect-square w-16 rounded-full bg-cover bg-center border-2 ${x(3)} object-cover`,referrerPolicy:"no-referrer"}):E.jsx("div",{className:`aspect-square w-16 rounded-full border-2 ${x(3)} bg-primary/20 flex items-center justify-center`,children:E.jsx("span",{className:"material-symbols-outlined text-primary text-2xl",children:"person"})}),E.jsx("div",{className:`absolute -bottom-2 left-1/2 -translate-x-1/2 flex h-6 w-6 items-center justify-center rounded-full ${S(3)} text-sm font-bold`,children:"3"})]}),E.jsx("p",{className:"text-sm font-bold",children:v[2].displayName}),E.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:[v[2].percentage,"%"]})]})]}),e&&E.jsx("div",{className:"p-4",children:E.jsxs("div",{className:"flex items-center justify-between gap-4 rounded-xl bg-primary/20 dark:bg-primary/30 p-4 border border-primary",children:[E.jsxs("div",{className:"flex items-center gap-4",children:[E.jsx("p",{className:"text-lg font-bold w-6 text-center",children:l.rank||"-"}),e.photoURL?E.jsx("img",{src:e.photoURL,alt:"Your avatar",className:"w-12 h-12 rounded-full object-cover flex-shrink-0",referrerPolicy:"no-referrer"}):E.jsx("div",{className:"w-12 h-12 rounded-full bg-primary/30 flex items-center justify-center flex-shrink-0",children:E.jsx("span",{className:"material-symbols-outlined text-primary",children:"person"})}),E.jsxs("div",{className:"flex flex-col",children:[E.jsx("p",{className:"text-base font-bold leading-tight",children:"You"}),E.jsxs("p",{className:"text-sm font-normal leading-normal text-slate-600 dark:text-slate-300",children:[l.percentage||0,"% complete"]})]})]}),E.jsx("span",{className:"material-symbols-outlined text-primary",children:"workspace_premium"})]})}),E.jsx("div",{className:"flex flex-col gap-2 px-4 pb-24",children:w.map(D=>E.jsxs("div",{onClick:()=>n(`/profile/${D.userId}`),className:`flex items-center gap-4 rounded-xl p-3 shadow-sm cursor-pointer transition-colors hover:bg-black/5 dark:hover:bg-white/5 ${D.userId===(e==null?void 0:e.uid)?"bg-primary/10 dark:bg-primary/20 border border-primary/50":"bg-white dark:bg-background-dark"}`,children:[E.jsx("p",{className:"w-6 text-center font-semibold text-slate-500 dark:text-slate-400",children:D.rank}),D.photoURL?E.jsx("img",{src:D.photoURL,alt:D.displayName,className:"h-10 w-10 flex-shrink-0 rounded-full object-cover",referrerPolicy:"no-referrer"}):E.jsx("div",{className:"h-10 w-10 flex-shrink-0 rounded-full bg-primary/20 flex items-center justify-center",children:E.jsx("span",{className:"material-symbols-outlined text-primary text-xl",children:"person"})}),E.jsxs("div",{className:"flex-grow",children:[E.jsx("p",{className:"font-bold",children:D.displayName}),E.jsx("div",{className:"mt-1 h-1.5 w-full rounded-full bg-slate-200 dark:bg-slate-700",children:E.jsx("div",{className:"h-1.5 rounded-full bg-primary transition-all",style:{width:`${D.percentage}%`}})})]}),E.jsxs("p",{className:"font-bold text-sm",children:[D.percentage,"%"]})]},D.id))})]}),E.jsx(rl,{})]})}const JV="users";async function ZV(n){try{const e=Or(lt,JV,n),t=await za(e);return t.exists()?{id:t.id,...t.data()}:null}catch(e){throw console.error("Error getting user profile:",e),e}}function eO(){const{userId:n}=zm(),e=$n(),[t,r]=$.useState(null),[s,a]=$.useState([]),[l,d]=$.useState(null),[f,m]=$.useState(!0);return $.useEffect(()=>{(async()=>{if(n){m(!0);try{const[w,x,S]=await Promise.all([ZV(n),yV(n),TV(n)]);r(w),a(x),d(S)}catch(w){console.error("Failed to load user profile",w)}finally{m(!1)}}})()},[n]),f?E.jsx("div",{className:"flex h-screen items-center justify-center bg-background-light dark:bg-background-dark",children:E.jsx(wo,{})}):t?E.jsxs("div",{className:"relative flex h-auto min-h-screen w-full flex-col bg-background-light dark:bg-background-dark pb-24 font-display",children:[E.jsxs("header",{className:"flex items-center p-4 sticky top-0 bg-background-light dark:bg-background-dark z-10 transition-shadow",children:[E.jsx("button",{onClick:()=>e(-1),className:"flex size-12 shrink-0 items-center justify-start text-text-light-primary dark:text-gray-200",children:E.jsx("span",{className:"material-symbols-outlined !text-2xl",children:"arrow_back_ios_new"})}),E.jsx("h1",{className:"flex-1 text-center text-lg font-bold leading-tight tracking-[-0.015em] text-text-light-primary dark:text-gray-200",children:"Profile"}),E.jsx("div",{className:"w-12"})]}),E.jsxs("div",{className:"flex flex-col items-center p-6 gap-4",children:[E.jsx("div",{className:"size-24 rounded-full overflow-hidden border-4 border-primary/20",children:t.photoURL?E.jsx("img",{src:t.photoURL,alt:t.displayName,className:"size-full object-cover",referrerPolicy:"no-referrer"}):E.jsx("div",{className:"size-full bg-primary/20 flex items-center justify-center",children:E.jsx("span",{className:"material-symbols-outlined text-4xl text-primary",children:"person"})})}),E.jsxs("div",{className:"text-center",children:[E.jsx("h2",{className:"text-xl font-bold text-text-light-primary dark:text-white",children:t.displayName||"Anonymous User"}),l&&E.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:["Current Rank: #",l.rank,"  ",l.percentage,"% Completion"]})]})]}),E.jsxs("div",{className:"px-4 flex flex-col gap-4 mt-2",children:[E.jsx("h3",{className:"text-lg font-bold text-text-light-primary dark:text-white",children:"Public Habits"}),s.length===0?E.jsx("div",{className:"text-center py-8 text-gray-500",children:"No public habits shared."}):E.jsx("div",{className:"flex flex-col gap-3",children:s.map(v=>E.jsx(HT,{habit:v,isCompleted:!1,disabled:!0,showCheckbox:!1},v.id))})]}),E.jsx(rl,{})]}):E.jsxs("div",{className:"flex h-screen flex-col items-center justify-center bg-background-light dark:bg-background-dark text-text-light-primary dark:text-white gap-4",children:[E.jsx("p",{children:"User not found"}),E.jsx("button",{onClick:()=>e(-1),className:"text-primary hover:underline",children:"Go Back"})]})}const tO="completions",nO="habits",rO="users";async function iO(n=50){try{const e=kn(lt,tO),t=hr(e,Za("timestamp","desc"),FP(n*2)),s=(await mi(t)).docs.map(d=>({id:d.id,...d.data()})),a=[],l=new Set;for(const d of s){if(a.length>=n)break;if(!l.has(`${d.habitId}_${d.date}`))try{const f=Or(lt,nO,d.habitId),m=await za(f);if(!m.exists())continue;const v=m.data();if(!v.isPublic)continue;const w=Or(lt,rO,d.userId),x=await za(w),S=x.exists()?x.data():{};a.push({id:d.id,habitId:d.habitId,habitTitle:v.title,userId:d.userId,username:S.displayName||"Anonymous",photoURL:S.photoURL||null,streak:v.currentStreak||0,timestamp:d.timestamp,date:d.date,type:"completion"}),l.add(`${d.habitId}_${d.date}`)}catch(f){console.error("Error processing completion:",f);continue}}return a}catch(e){throw console.error("Error getting public feed:",e),e}}function sO(n){if(!n)return"";const e=n.toDate?n.toDate():new Date(n),r=new Date().getTime()-e.getTime(),s=Math.floor(r/6e4),a=Math.floor(r/36e5),l=Math.floor(r/864e5);return s<1?"just now":s<60?`${s}m ago`:a<24?`${a}h ago`:l<7?`${l}d ago`:e.toLocaleDateString()}function oO(){const n=$n(),[e,t]=$.useState([]),[r,s]=$.useState(!0);return $.useEffect(()=>{(async()=>{s(!0);try{const l=await iO(50);t(l)}catch(l){console.error("Error loading feed:",l)}finally{s(!1)}})()},[]),E.jsxs("div",{className:"relative flex h-auto min-h-screen w-full flex-col overflow-x-hidden bg-background-light dark:bg-background-dark font-display",children:[E.jsxs("header",{className:"sticky top-0 z-10 flex items-center justify-between border-b border-gray-200/80 bg-background-light/80 p-4 pb-3 backdrop-blur-sm dark:border-gray-800/80 dark:bg-background-dark/80",children:[E.jsx("button",{onClick:()=>n(-1),className:"flex size-12 shrink-0 items-center justify-start",children:E.jsx("span",{className:"material-symbols-outlined text-text-light-primary dark:text-text-dark-primary",children:"arrow_back_ios_new"})}),E.jsx("h1",{className:"flex-1 text-center text-lg font-bold leading-tight tracking-[-0.015em] text-text-light-primary dark:text-text-dark-primary",children:"Progress Feed"}),E.jsx("div",{className:"flex w-12 items-center justify-end",children:E.jsx("button",{className:"flex h-12 cursor-pointer items-center justify-center gap-2 overflow-hidden rounded-lg bg-transparent text-base font-bold leading-normal tracking-[0.015em] text-text-light-primary dark:text-text-dark-primary",children:E.jsx("span",{className:"material-symbols-outlined",children:"search"})})})]}),E.jsx("main",{className:"flex-grow pb-24",children:r?E.jsx("div",{className:"flex justify-center py-12",children:E.jsx(wo,{size:"lg"})}):e.length===0?E.jsxs("div",{className:"flex flex-col items-center justify-center py-12 px-4",children:[E.jsx("span",{className:"material-symbols-outlined text-5xl text-gray-400 mb-4",children:"feed"}),E.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center",children:"No public activity yet."}),E.jsx("p",{className:"text-gray-400 dark:text-gray-500 text-sm text-center mt-2",children:"Complete public habits to appear in the feed!"})]}):e.map(a=>E.jsx("div",{className:"border-b border-gray-200/80 p-4 dark:border-gray-800/80",children:E.jsxs("div",{className:"flex items-start gap-3",children:[a.photoURL?E.jsx("img",{className:"h-10 w-10 rounded-full object-cover flex-shrink-0",alt:`${a.username}'s avatar`,src:a.photoURL,referrerPolicy:"no-referrer"}):E.jsx("div",{className:"h-10 w-10 rounded-full bg-primary/20 flex items-center justify-center flex-shrink-0",children:E.jsx("span",{className:"material-symbols-outlined text-primary text-xl",children:"person"})}),E.jsxs("div",{className:"flex flex-1 flex-col gap-2",children:[E.jsxs("div",{className:"flex items-center gap-2",children:[E.jsx("p",{className:"font-bold text-text-light-primary dark:text-text-dark-primary",children:a.username}),E.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[" ",sO(a.timestamp)]})]}),E.jsxs("p",{className:"text-base text-text-light-primary dark:text-text-dark-primary",children:["Completed: ",a.habitTitle]}),a.streak>0&&E.jsx("div",{className:"mt-2 flex items-center",children:E.jsxs("div",{className:"flex items-center gap-1 rounded-full bg-primary/20 px-3 py-1 text-sm font-medium",children:[E.jsx("span",{className:"material-symbols-outlined !text-[18px] !font-bold text-primary",children:"local_fire_department"}),E.jsx("span",{className:"font-bold text-text-light-primary dark:text-text-dark-primary",children:a.streak})]})})]})]})},a.id))}),E.jsx(rl,{})]})}function aO(){const n=$n(),{user:e,clearUser:t}=mo(),{habits:r,clearAll:s}=po(),[a,l]=$.useState(document.documentElement.classList.contains("dark")),[d,f]=$.useState(!1),[m,v]=$.useState(()=>(JSON.parse(localStorage.getItem("habitParams"))||{}).notificationsEnabled||!1),[w,x]=$.useState(()=>(JSON.parse(localStorage.getItem("habitParams"))||{}).reminderTime||"09:00"),S=q=>{const re=JSON.parse(localStorage.getItem("habitParams"))||{};localStorage.setItem("habitParams",JSON.stringify({...re,...q}))},D=q=>{l(q),q?(document.documentElement.classList.add("dark"),localStorage.setItem("theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("theme","light"))},F=async q=>{q?await bV()?(v(!0),S({notificationsEnabled:!0})):(v(!1),alert("Notification permission denied. Please enable it in your browser settings.")):(v(!1),S({notificationsEnabled:!1}))},O=q=>{const re=q.target.value;x(re),S({reminderTime:re})},K=async()=>{f(!0);try{await PV(),t(),s(),n("/")}catch(q){console.error("Logout error:",q),alert("Failed to sign out. Please try again.")}finally{f(!1)}},X={totalHabits:r.length,publicHabits:r.filter(q=>q.isPublic).length,privateHabits:r.filter(q=>!q.isPublic).length,totalStreak:r.reduce((q,re)=>q+(re.currentStreak||0),0)};return E.jsxs("div",{className:"relative flex h-auto min-h-screen w-full flex-col overflow-x-hidden bg-background-light dark:bg-background-dark font-display",children:[E.jsxs("div",{className:"flex-grow pb-28",children:[E.jsxs("header",{className:"flex items-center bg-background-light dark:bg-background-dark p-4 pb-2 sticky top-0 z-10",children:[E.jsx("button",{onClick:()=>n(-1),className:"flex size-12 shrink-0 items-center justify-start text-text-light-primary dark:text-text-dark-primary",children:E.jsx("span",{className:"material-symbols-outlined",children:"arrow_back_ios_new"})}),E.jsx("h1",{className:"flex-1 text-center text-lg font-bold leading-tight tracking-[-0.015em] text-text-light-primary dark:text-text-dark-primary",children:"Settings"}),E.jsx("div",{className:"w-12"})]}),E.jsxs("main",{className:"p-4 flex flex-col gap-6",children:[E.jsx("section",{className:"bg-content-light dark:bg-content-dark rounded-xl p-4",children:E.jsxs("div",{className:"flex items-center gap-4",children:[e!=null&&e.photoURL?E.jsx("img",{src:e.photoURL,alt:"Profile",className:"w-16 h-16 rounded-full object-cover",referrerPolicy:"no-referrer"}):E.jsx("div",{className:"w-16 h-16 rounded-full bg-primary/20 flex items-center justify-center",children:E.jsx("span",{className:"material-symbols-outlined text-primary text-3xl",children:"person"})}),E.jsxs("div",{children:[E.jsx("h2",{className:"text-lg font-bold text-text-light-primary dark:text-text-dark-primary",children:(e==null?void 0:e.displayName)||"User"}),E.jsx("p",{className:"text-sm text-text-light-secondary dark:text-text-dark-secondary",children:e==null?void 0:e.email})]})]})}),E.jsxs("section",{className:"bg-content-light dark:bg-content-dark rounded-xl p-4",children:[E.jsx("h3",{className:"text-sm font-medium text-text-light-secondary dark:text-text-dark-secondary uppercase mb-4",children:"Your Stats"}),E.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[E.jsxs("div",{className:"text-center p-3 bg-primary/10 dark:bg-primary/20 rounded-lg",children:[E.jsx("p",{className:"text-2xl font-bold text-primary",children:X.totalHabits}),E.jsx("p",{className:"text-xs text-text-light-secondary dark:text-text-dark-secondary",children:"Total Habits"})]}),E.jsxs("div",{className:"text-center p-3 bg-primary/10 dark:bg-primary/20 rounded-lg",children:[E.jsxs("p",{className:"text-2xl font-bold text-primary",children:[" ",X.totalStreak]}),E.jsx("p",{className:"text-xs text-text-light-secondary dark:text-text-dark-secondary",children:"Total Streak Days"})]}),E.jsxs("div",{className:"text-center",children:[E.jsx("p",{className:"text-xl font-bold text-primary",children:X.publicHabits}),E.jsx("p",{className:"text-xs text-text-light-secondary dark:text-text-dark-secondary",children:"Public"})]}),E.jsxs("div",{className:"text-center",children:[E.jsx("p",{className:"text-xl font-bold text-primary",children:X.privateHabits}),E.jsx("p",{className:"text-xs text-text-light-secondary dark:text-text-dark-secondary",children:"Private"})]})]})]}),E.jsxs("section",{className:"bg-content-light dark:bg-content-dark rounded-xl p-4",children:[E.jsx("h3",{className:"text-sm font-medium text-text-light-secondary dark:text-text-dark-secondary uppercase mb-4",children:"Preferences"}),E.jsx(Eh,{label:"Dark Mode",checked:a,onChange:D}),E.jsx("div",{className:"my-4 h-px bg-border-light dark:bg-border-dark/50"}),E.jsxs("div",{className:"flex flex-col gap-4",children:[E.jsx(Eh,{label:"Daily Reminders",checked:m,onChange:F}),m&&E.jsxs("div",{className:"flex items-center justify-between animation-slide-down",children:[E.jsx("span",{className:"text-text-light-primary dark:text-text-dark-primary",children:"Reminder Time"}),E.jsx("input",{type:"time",value:w,onChange:O,className:"bg-gray-100 dark:bg-gray-800 border-none rounded-lg p-2 text-text-light-primary dark:text-white focus:ring-2 focus:ring-primary"})]})]})]}),E.jsxs("section",{className:"bg-content-light dark:bg-content-dark rounded-xl p-4",children:[E.jsx("h3",{className:"text-sm font-medium text-text-light-secondary dark:text-text-dark-secondary uppercase mb-4",children:"About"}),E.jsxs("div",{className:"space-y-3",children:[E.jsxs("div",{className:"flex justify-between",children:[E.jsx("span",{className:"text-text-light-primary dark:text-text-dark-primary",children:"Version"}),E.jsx("span",{className:"text-text-light-secondary dark:text-text-dark-secondary",children:"1.0.0"})]}),E.jsxs("div",{className:"flex justify-between",children:[E.jsx("span",{className:"text-text-light-primary dark:text-text-dark-primary",children:"Build"}),E.jsx("span",{className:"text-text-light-secondary dark:text-text-dark-secondary",children:"PWA"})]})]})]}),E.jsx(rs,{fullWidth:!0,variant:"danger",onClick:K,isLoading:d,icon:"logout",children:"Sign Out"})]})]}),E.jsx(rl,{})]})}function Hi({children:n}){const{isAuthenticated:e,isLoading:t}=mo();return $.useEffect(()=>{$0();const r=setInterval($0,6e4);return()=>clearInterval(r)},[]),t?E.jsx("div",{className:"min-h-screen bg-background-light dark:bg-background-dark flex items-center justify-center",children:E.jsx(wo,{size:"lg"})}):e?n:E.jsx(Xk,{to:"/",replace:!0})}function lO(){const{user:n,setUser:e,setLoading:t}=mo(),{loadHabits:r,loadCompletionsForDate:s,subscribeToHabits:a,clearAll:l}=po();return $.useEffect(()=>{let d=null;const f=NN(uy,async m=>{if(m){e({uid:m.uid,displayName:m.displayName,email:m.email,photoURL:m.photoURL});try{const{loadCompletionsForWeek:v,subscribeToHabits:w}=po.getState();await v(m.uid),d=w(m.uid)}catch(v){console.error("Error loading user data:",v)}}else e(null),l(),d&&(d(),d=null);t(!1)});return()=>{f(),d&&d()}},[e,t,r,s,a,l]),$.useEffect(()=>{localStorage.getItem("theme")==="dark"&&document.documentElement.classList.add("dark")},[]),E.jsx(E1,{basename:"/habit-tracker-pwa/",children:E.jsx("div",{className:"min-h-screen bg-background-light dark:bg-background-dark font-display",children:E.jsxs(Jk,{children:[E.jsx(Tr,{path:"/",element:E.jsx(VV,{})}),E.jsx(Tr,{path:"/dashboard",element:E.jsx(Hi,{children:E.jsx(FV,{})})}),E.jsx(Tr,{path:"/new-habit",element:E.jsx(Hi,{children:E.jsx($V,{})})}),E.jsx(Tr,{path:"/edit-habit/:habitId",element:E.jsx(Hi,{children:E.jsx(WV,{})})}),E.jsx(Tr,{path:"/habit/:habitId",element:E.jsx(Hi,{children:E.jsx(XV,{})})}),E.jsx(Tr,{path:"/leaderboard",element:E.jsx(Hi,{children:E.jsx(YV,{})})}),E.jsx(Tr,{path:"/profile/:userId",element:E.jsx(Hi,{children:E.jsx(eO,{})})}),E.jsx(Tr,{path:"/feed",element:E.jsx(Hi,{children:E.jsx(oO,{})})}),E.jsx(Tr,{path:"/settings",element:E.jsx(Hi,{children:E.jsx(aO,{})})})]})})})}const uO=["habits-storage","auth-storage"];uO.forEach(n=>{localStorage.getItem(n)&&(localStorage.removeItem(n),console.log(`[Init] Cleared old localStorage: ${n}`))});const cO=Object.keys(localStorage);cO.forEach(n=>{(n.startsWith("zustand")||n.includes("habit")||n.includes("auth"))&&(localStorage.removeItem(n),console.log(`[Init] Cleared cached data: ${n}`))});sk.createRoot(document.getElementById("root")).render(E.jsx(su.StrictMode,{children:E.jsx(lO,{})}));
