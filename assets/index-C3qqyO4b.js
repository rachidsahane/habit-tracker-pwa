(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function t(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=t(s);fetch(s.href,a)}})();function X0(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var Vp={exports:{}},tu={},Op={exports:{}},Pe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var x_;function ak(){if(x_)return Pe;x_=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),d=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),_=Symbol.iterator;function x(F){return F===null||typeof F!="object"?null:(F=_&&F[_]||F["@@iterator"],typeof F=="function"?F:null)}var S={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},N=Object.assign,P={};function O(F,X,_e){this.props=F,this.context=X,this.refs=P,this.updater=_e||S}O.prototype.isReactComponent={},O.prototype.setState=function(F,X){if(typeof F!="object"&&typeof F!="function"&&F!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,F,X,"setState")},O.prototype.forceUpdate=function(F){this.updater.enqueueForceUpdate(this,F,"forceUpdate")};function K(){}K.prototype=O.prototype;function Q(F,X,_e){this.props=F,this.context=X,this.refs=P,this.updater=_e||S}var H=Q.prototype=new K;H.constructor=Q,N(H,O.prototype),H.isPureReactComponent=!0;var se=Array.isArray,ce=Object.prototype.hasOwnProperty,re={current:null},C={key:!0,ref:!0,__self:!0,__source:!0};function k(F,X,_e){var Ae,Ce={},Oe=null,Be=null;if(X!=null)for(Ae in X.ref!==void 0&&(Be=X.ref),X.key!==void 0&&(Oe=""+X.key),X)ce.call(X,Ae)&&!C.hasOwnProperty(Ae)&&(Ce[Ae]=X[Ae]);var ze=arguments.length-2;if(ze===1)Ce.children=_e;else if(1<ze){for(var Ye=Array(ze),Ct=0;Ct<ze;Ct++)Ye[Ct]=arguments[Ct+2];Ce.children=Ye}if(F&&F.defaultProps)for(Ae in ze=F.defaultProps,ze)Ce[Ae]===void 0&&(Ce[Ae]=ze[Ae]);return{$$typeof:n,type:F,key:Oe,ref:Be,props:Ce,_owner:re.current}}function A(F,X){return{$$typeof:n,type:F.type,key:X,ref:F.ref,props:F.props,_owner:F._owner}}function D(F){return typeof F=="object"&&F!==null&&F.$$typeof===n}function L(F){var X={"=":"=0",":":"=2"};return"$"+F.replace(/[=:]/g,function(_e){return X[_e]})}var j=/\/+/g;function R(F,X){return typeof F=="object"&&F!==null&&F.key!=null?L(""+F.key):X.toString(36)}function Ke(F,X,_e,Ae,Ce){var Oe=typeof F;(Oe==="undefined"||Oe==="boolean")&&(F=null);var Be=!1;if(F===null)Be=!0;else switch(Oe){case"string":case"number":Be=!0;break;case"object":switch(F.$$typeof){case n:case e:Be=!0}}if(Be)return Be=F,Ce=Ce(Be),F=Ae===""?"."+R(Be,0):Ae,se(Ce)?(_e="",F!=null&&(_e=F.replace(j,"$&/")+"/"),Ke(Ce,X,_e,"",function(Ct){return Ct})):Ce!=null&&(D(Ce)&&(Ce=A(Ce,_e+(!Ce.key||Be&&Be.key===Ce.key?"":(""+Ce.key).replace(j,"$&/")+"/")+F)),X.push(Ce)),1;if(Be=0,Ae=Ae===""?".":Ae+":",se(F))for(var ze=0;ze<F.length;ze++){Oe=F[ze];var Ye=Ae+R(Oe,ze);Be+=Ke(Oe,X,_e,Ye,Ce)}else if(Ye=x(F),typeof Ye=="function")for(F=Ye.call(F),ze=0;!(Oe=F.next()).done;)Oe=Oe.value,Ye=Ae+R(Oe,ze++),Be+=Ke(Oe,X,_e,Ye,Ce);else if(Oe==="object")throw X=String(F),Error("Objects are not valid as a React child (found: "+(X==="[object Object]"?"object with keys {"+Object.keys(F).join(", ")+"}":X)+"). If you meant to render a collection of children, use an array instead.");return Be}function Ze(F,X,_e){if(F==null)return F;var Ae=[],Ce=0;return Ke(F,Ae,"","",function(Oe){return X.call(_e,Oe,Ce++)}),Ae}function ee(F){if(F._status===-1){var X=F._result;X=X(),X.then(function(_e){(F._status===0||F._status===-1)&&(F._status=1,F._result=_e)},function(_e){(F._status===0||F._status===-1)&&(F._status=2,F._result=_e)}),F._status===-1&&(F._status=0,F._result=X)}if(F._status===1)return F._result.default;throw F._result}var Fe={current:null},le={transition:null},Ee={ReactCurrentDispatcher:Fe,ReactCurrentBatchConfig:le,ReactCurrentOwner:re};function he(){throw Error("act(...) is not supported in production builds of React.")}return Pe.Children={map:Ze,forEach:function(F,X,_e){Ze(F,function(){X.apply(this,arguments)},_e)},count:function(F){var X=0;return Ze(F,function(){X++}),X},toArray:function(F){return Ze(F,function(X){return X})||[]},only:function(F){if(!D(F))throw Error("React.Children.only expected to receive a single React element child.");return F}},Pe.Component=O,Pe.Fragment=t,Pe.Profiler=s,Pe.PureComponent=Q,Pe.StrictMode=r,Pe.Suspense=f,Pe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Ee,Pe.act=he,Pe.cloneElement=function(F,X,_e){if(F==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+F+".");var Ae=N({},F.props),Ce=F.key,Oe=F.ref,Be=F._owner;if(X!=null){if(X.ref!==void 0&&(Oe=X.ref,Be=re.current),X.key!==void 0&&(Ce=""+X.key),F.type&&F.type.defaultProps)var ze=F.type.defaultProps;for(Ye in X)ce.call(X,Ye)&&!C.hasOwnProperty(Ye)&&(Ae[Ye]=X[Ye]===void 0&&ze!==void 0?ze[Ye]:X[Ye])}var Ye=arguments.length-2;if(Ye===1)Ae.children=_e;else if(1<Ye){ze=Array(Ye);for(var Ct=0;Ct<Ye;Ct++)ze[Ct]=arguments[Ct+2];Ae.children=ze}return{$$typeof:n,type:F.type,key:Ce,ref:Oe,props:Ae,_owner:Be}},Pe.createContext=function(F){return F={$$typeof:l,_currentValue:F,_currentValue2:F,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},F.Provider={$$typeof:a,_context:F},F.Consumer=F},Pe.createElement=k,Pe.createFactory=function(F){var X=k.bind(null,F);return X.type=F,X},Pe.createRef=function(){return{current:null}},Pe.forwardRef=function(F){return{$$typeof:d,render:F}},Pe.isValidElement=D,Pe.lazy=function(F){return{$$typeof:v,_payload:{_status:-1,_result:F},_init:ee}},Pe.memo=function(F,X){return{$$typeof:p,type:F,compare:X===void 0?null:X}},Pe.startTransition=function(F){var X=le.transition;le.transition={};try{F()}finally{le.transition=X}},Pe.unstable_act=he,Pe.useCallback=function(F,X){return Fe.current.useCallback(F,X)},Pe.useContext=function(F){return Fe.current.useContext(F)},Pe.useDebugValue=function(){},Pe.useDeferredValue=function(F){return Fe.current.useDeferredValue(F)},Pe.useEffect=function(F,X){return Fe.current.useEffect(F,X)},Pe.useId=function(){return Fe.current.useId()},Pe.useImperativeHandle=function(F,X,_e){return Fe.current.useImperativeHandle(F,X,_e)},Pe.useInsertionEffect=function(F,X){return Fe.current.useInsertionEffect(F,X)},Pe.useLayoutEffect=function(F,X){return Fe.current.useLayoutEffect(F,X)},Pe.useMemo=function(F,X){return Fe.current.useMemo(F,X)},Pe.useReducer=function(F,X,_e){return Fe.current.useReducer(F,X,_e)},Pe.useRef=function(F){return Fe.current.useRef(F)},Pe.useState=function(F){return Fe.current.useState(F)},Pe.useSyncExternalStore=function(F,X,_e){return Fe.current.useSyncExternalStore(F,X,_e)},Pe.useTransition=function(){return Fe.current.useTransition()},Pe.version="18.3.1",Pe}var T_;function zm(){return T_||(T_=1,Op.exports=ak()),Op.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var S_;function lk(){if(S_)return tu;S_=1;var n=zm(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function l(d,f,p){var v,_={},x=null,S=null;p!==void 0&&(x=""+p),f.key!==void 0&&(x=""+f.key),f.ref!==void 0&&(S=f.ref);for(v in f)r.call(f,v)&&!a.hasOwnProperty(v)&&(_[v]=f[v]);if(d&&d.defaultProps)for(v in f=d.defaultProps,f)_[v]===void 0&&(_[v]=f[v]);return{$$typeof:e,type:d,key:x,ref:S,props:_,_owner:s.current}}return tu.Fragment=t,tu.jsx=l,tu.jsxs=l,tu}var k_;function uk(){return k_||(k_=1,Vp.exports=lk()),Vp.exports}var w=uk(),U=zm();const Sa=X0(U);var _d={},Lp={exports:{}},hn={},Mp={exports:{}},jp={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var b_;function ck(){return b_||(b_=1,(function(n){function e(le,Ee){var he=le.length;le.push(Ee);e:for(;0<he;){var F=he-1>>>1,X=le[F];if(0<s(X,Ee))le[F]=Ee,le[he]=X,he=F;else break e}}function t(le){return le.length===0?null:le[0]}function r(le){if(le.length===0)return null;var Ee=le[0],he=le.pop();if(he!==Ee){le[0]=he;e:for(var F=0,X=le.length,_e=X>>>1;F<_e;){var Ae=2*(F+1)-1,Ce=le[Ae],Oe=Ae+1,Be=le[Oe];if(0>s(Ce,he))Oe<X&&0>s(Be,Ce)?(le[F]=Be,le[Oe]=he,F=Oe):(le[F]=Ce,le[Ae]=he,F=Ae);else if(Oe<X&&0>s(Be,he))le[F]=Be,le[Oe]=he,F=Oe;else break e}}return Ee}function s(le,Ee){var he=le.sortIndex-Ee.sortIndex;return he!==0?he:le.id-Ee.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var l=Date,d=l.now();n.unstable_now=function(){return l.now()-d}}var f=[],p=[],v=1,_=null,x=3,S=!1,N=!1,P=!1,O=typeof setTimeout=="function"?setTimeout:null,K=typeof clearTimeout=="function"?clearTimeout:null,Q=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function H(le){for(var Ee=t(p);Ee!==null;){if(Ee.callback===null)r(p);else if(Ee.startTime<=le)r(p),Ee.sortIndex=Ee.expirationTime,e(f,Ee);else break;Ee=t(p)}}function se(le){if(P=!1,H(le),!N)if(t(f)!==null)N=!0,ee(ce);else{var Ee=t(p);Ee!==null&&Fe(se,Ee.startTime-le)}}function ce(le,Ee){N=!1,P&&(P=!1,K(k),k=-1),S=!0;var he=x;try{for(H(Ee),_=t(f);_!==null&&(!(_.expirationTime>Ee)||le&&!L());){var F=_.callback;if(typeof F=="function"){_.callback=null,x=_.priorityLevel;var X=F(_.expirationTime<=Ee);Ee=n.unstable_now(),typeof X=="function"?_.callback=X:_===t(f)&&r(f),H(Ee)}else r(f);_=t(f)}if(_!==null)var _e=!0;else{var Ae=t(p);Ae!==null&&Fe(se,Ae.startTime-Ee),_e=!1}return _e}finally{_=null,x=he,S=!1}}var re=!1,C=null,k=-1,A=5,D=-1;function L(){return!(n.unstable_now()-D<A)}function j(){if(C!==null){var le=n.unstable_now();D=le;var Ee=!0;try{Ee=C(!0,le)}finally{Ee?R():(re=!1,C=null)}}else re=!1}var R;if(typeof Q=="function")R=function(){Q(j)};else if(typeof MessageChannel<"u"){var Ke=new MessageChannel,Ze=Ke.port2;Ke.port1.onmessage=j,R=function(){Ze.postMessage(null)}}else R=function(){O(j,0)};function ee(le){C=le,re||(re=!0,R())}function Fe(le,Ee){k=O(function(){le(n.unstable_now())},Ee)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(le){le.callback=null},n.unstable_continueExecution=function(){N||S||(N=!0,ee(ce))},n.unstable_forceFrameRate=function(le){0>le||125<le?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<le?Math.floor(1e3/le):5},n.unstable_getCurrentPriorityLevel=function(){return x},n.unstable_getFirstCallbackNode=function(){return t(f)},n.unstable_next=function(le){switch(x){case 1:case 2:case 3:var Ee=3;break;default:Ee=x}var he=x;x=Ee;try{return le()}finally{x=he}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(le,Ee){switch(le){case 1:case 2:case 3:case 4:case 5:break;default:le=3}var he=x;x=le;try{return Ee()}finally{x=he}},n.unstable_scheduleCallback=function(le,Ee,he){var F=n.unstable_now();switch(typeof he=="object"&&he!==null?(he=he.delay,he=typeof he=="number"&&0<he?F+he:F):he=F,le){case 1:var X=-1;break;case 2:X=250;break;case 5:X=1073741823;break;case 4:X=1e4;break;default:X=5e3}return X=he+X,le={id:v++,callback:Ee,priorityLevel:le,startTime:he,expirationTime:X,sortIndex:-1},he>F?(le.sortIndex=he,e(p,le),t(f)===null&&le===t(p)&&(P?(K(k),k=-1):P=!0,Fe(se,he-F))):(le.sortIndex=X,e(f,le),N||S||(N=!0,ee(ce))),le},n.unstable_shouldYield=L,n.unstable_wrapCallback=function(le){var Ee=x;return function(){var he=x;x=Ee;try{return le.apply(this,arguments)}finally{x=he}}}})(jp)),jp}var A_;function dk(){return A_||(A_=1,Mp.exports=ck()),Mp.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var R_;function hk(){if(R_)return hn;R_=1;var n=zm(),e=dk();function t(i){for(var o="https://reactjs.org/docs/error-decoder.html?invariant="+i,u=1;u<arguments.length;u++)o+="&args[]="+encodeURIComponent(arguments[u]);return"Minified React error #"+i+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,s={};function a(i,o){l(i,o),l(i+"Capture",o)}function l(i,o){for(s[i]=o,i=0;i<o.length;i++)r.add(o[i])}var d=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),f=Object.prototype.hasOwnProperty,p=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,v={},_={};function x(i){return f.call(_,i)?!0:f.call(v,i)?!1:p.test(i)?_[i]=!0:(v[i]=!0,!1)}function S(i,o,u,h){if(u!==null&&u.type===0)return!1;switch(typeof o){case"function":case"symbol":return!0;case"boolean":return h?!1:u!==null?!u.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function N(i,o,u,h){if(o===null||typeof o>"u"||S(i,o,u,h))return!0;if(h)return!1;if(u!==null)switch(u.type){case 3:return!o;case 4:return o===!1;case 5:return isNaN(o);case 6:return isNaN(o)||1>o}return!1}function P(i,o,u,h,m,y,I){this.acceptsBooleans=o===2||o===3||o===4,this.attributeName=h,this.attributeNamespace=m,this.mustUseProperty=u,this.propertyName=i,this.type=o,this.sanitizeURL=y,this.removeEmptyString=I}var O={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){O[i]=new P(i,0,!1,i,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var o=i[0];O[o]=new P(o,1,!1,i[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(i){O[i]=new P(i,2,!1,i.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){O[i]=new P(i,2,!1,i,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){O[i]=new P(i,3,!1,i.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(i){O[i]=new P(i,3,!0,i,null,!1,!1)}),["capture","download"].forEach(function(i){O[i]=new P(i,4,!1,i,null,!1,!1)}),["cols","rows","size","span"].forEach(function(i){O[i]=new P(i,6,!1,i,null,!1,!1)}),["rowSpan","start"].forEach(function(i){O[i]=new P(i,5,!1,i.toLowerCase(),null,!1,!1)});var K=/[\-:]([a-z])/g;function Q(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var o=i.replace(K,Q);O[o]=new P(o,1,!1,i,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var o=i.replace(K,Q);O[o]=new P(o,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(i){var o=i.replace(K,Q);O[o]=new P(o,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(i){O[i]=new P(i,1,!1,i.toLowerCase(),null,!1,!1)}),O.xlinkHref=new P("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(i){O[i]=new P(i,1,!1,i.toLowerCase(),null,!0,!0)});function H(i,o,u,h){var m=O.hasOwnProperty(o)?O[o]:null;(m!==null?m.type!==0:h||!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(N(o,u,m,h)&&(u=null),h||m===null?x(o)&&(u===null?i.removeAttribute(o):i.setAttribute(o,""+u)):m.mustUseProperty?i[m.propertyName]=u===null?m.type===3?!1:"":u:(o=m.attributeName,h=m.attributeNamespace,u===null?i.removeAttribute(o):(m=m.type,u=m===3||m===4&&u===!0?"":""+u,h?i.setAttributeNS(h,o,u):i.setAttribute(o,u))))}var se=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ce=Symbol.for("react.element"),re=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),D=Symbol.for("react.provider"),L=Symbol.for("react.context"),j=Symbol.for("react.forward_ref"),R=Symbol.for("react.suspense"),Ke=Symbol.for("react.suspense_list"),Ze=Symbol.for("react.memo"),ee=Symbol.for("react.lazy"),Fe=Symbol.for("react.offscreen"),le=Symbol.iterator;function Ee(i){return i===null||typeof i!="object"?null:(i=le&&i[le]||i["@@iterator"],typeof i=="function"?i:null)}var he=Object.assign,F;function X(i){if(F===void 0)try{throw Error()}catch(u){var o=u.stack.trim().match(/\n( *(at )?)/);F=o&&o[1]||""}return`
`+F+i}var _e=!1;function Ae(i,o){if(!i||_e)return"";_e=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(o)if(o=function(){throw Error()},Object.defineProperty(o.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(o,[])}catch(W){var h=W}Reflect.construct(i,[],o)}else{try{o.call()}catch(W){h=W}i.call(o.prototype)}else{try{throw Error()}catch(W){h=W}i()}}catch(W){if(W&&h&&typeof W.stack=="string"){for(var m=W.stack.split(`
`),y=h.stack.split(`
`),I=m.length-1,b=y.length-1;1<=I&&0<=b&&m[I]!==y[b];)b--;for(;1<=I&&0<=b;I--,b--)if(m[I]!==y[b]){if(I!==1||b!==1)do if(I--,b--,0>b||m[I]!==y[b]){var V=`
`+m[I].replace(" at new "," at ");return i.displayName&&V.includes("<anonymous>")&&(V=V.replace("<anonymous>",i.displayName)),V}while(1<=I&&0<=b);break}}}finally{_e=!1,Error.prepareStackTrace=u}return(i=i?i.displayName||i.name:"")?X(i):""}function Ce(i){switch(i.tag){case 5:return X(i.type);case 16:return X("Lazy");case 13:return X("Suspense");case 19:return X("SuspenseList");case 0:case 2:case 15:return i=Ae(i.type,!1),i;case 11:return i=Ae(i.type.render,!1),i;case 1:return i=Ae(i.type,!0),i;default:return""}}function Oe(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case C:return"Fragment";case re:return"Portal";case A:return"Profiler";case k:return"StrictMode";case R:return"Suspense";case Ke:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case L:return(i.displayName||"Context")+".Consumer";case D:return(i._context.displayName||"Context")+".Provider";case j:var o=i.render;return i=i.displayName,i||(i=o.displayName||o.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case Ze:return o=i.displayName||null,o!==null?o:Oe(i.type)||"Memo";case ee:o=i._payload,i=i._init;try{return Oe(i(o))}catch{}}return null}function Be(i){var o=i.type;switch(i.tag){case 24:return"Cache";case 9:return(o.displayName||"Context")+".Consumer";case 10:return(o._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=o.render,i=i.displayName||i.name||"",o.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return o;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Oe(o);case 8:return o===k?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof o=="function")return o.displayName||o.name||null;if(typeof o=="string")return o}return null}function ze(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Ye(i){var o=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function Ct(i){var o=Ye(i)?"checked":"value",u=Object.getOwnPropertyDescriptor(i.constructor.prototype,o),h=""+i[o];if(!i.hasOwnProperty(o)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var m=u.get,y=u.set;return Object.defineProperty(i,o,{configurable:!0,get:function(){return m.call(this)},set:function(I){h=""+I,y.call(this,I)}}),Object.defineProperty(i,o,{enumerable:u.enumerable}),{getValue:function(){return h},setValue:function(I){h=""+I},stopTracking:function(){i._valueTracker=null,delete i[o]}}}}function Br(i){i._valueTracker||(i._valueTracker=Ct(i))}function Io(i){if(!i)return!1;var o=i._valueTracker;if(!o)return!0;var u=o.getValue(),h="";return i&&(h=Ye(i)?i.checked?"true":"false":i.value),i=h,i!==u?(o.setValue(i),!0):!1}function _i(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function ps(i,o){var u=o.checked;return he({},o,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:u??i._wrapperState.initialChecked})}function xo(i,o){var u=o.defaultValue==null?"":o.defaultValue,h=o.checked!=null?o.checked:o.defaultChecked;u=ze(o.value!=null?o.value:u),i._wrapperState={initialChecked:h,initialValue:u,controlled:o.type==="checkbox"||o.type==="radio"?o.checked!=null:o.value!=null}}function al(i,o){o=o.checked,o!=null&&H(i,"checked",o,!1)}function ll(i,o){al(i,o);var u=ze(o.value),h=o.type;if(u!=null)h==="number"?(u===0&&i.value===""||i.value!=u)&&(i.value=""+u):i.value!==""+u&&(i.value=""+u);else if(h==="submit"||h==="reset"){i.removeAttribute("value");return}o.hasOwnProperty("value")?To(i,o.type,u):o.hasOwnProperty("defaultValue")&&To(i,o.type,ze(o.defaultValue)),o.checked==null&&o.defaultChecked!=null&&(i.defaultChecked=!!o.defaultChecked)}function ic(i,o,u){if(o.hasOwnProperty("value")||o.hasOwnProperty("defaultValue")){var h=o.type;if(!(h!=="submit"&&h!=="reset"||o.value!==void 0&&o.value!==null))return;o=""+i._wrapperState.initialValue,u||o===i.value||(i.value=o),i.defaultValue=o}u=i.name,u!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,u!==""&&(i.name=u)}function To(i,o,u){(o!=="number"||_i(i.ownerDocument)!==i)&&(u==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+u&&(i.defaultValue=""+u))}var zr=Array.isArray;function $r(i,o,u,h){if(i=i.options,o){o={};for(var m=0;m<u.length;m++)o["$"+u[m]]=!0;for(u=0;u<i.length;u++)m=o.hasOwnProperty("$"+i[u].value),i[u].selected!==m&&(i[u].selected=m),m&&h&&(i[u].defaultSelected=!0)}else{for(u=""+ze(u),o=null,m=0;m<i.length;m++){if(i[m].value===u){i[m].selected=!0,h&&(i[m].defaultSelected=!0);return}o!==null||i[m].disabled||(o=i[m])}o!==null&&(o.selected=!0)}}function ul(i,o){if(o.dangerouslySetInnerHTML!=null)throw Error(t(91));return he({},o,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function So(i,o){var u=o.value;if(u==null){if(u=o.children,o=o.defaultValue,u!=null){if(o!=null)throw Error(t(92));if(zr(u)){if(1<u.length)throw Error(t(93));u=u[0]}o=u}o==null&&(o=""),u=o}i._wrapperState={initialValue:ze(u)}}function ko(i,o){var u=ze(o.value),h=ze(o.defaultValue);u!=null&&(u=""+u,u!==i.value&&(i.value=u),o.defaultValue==null&&i.defaultValue!==u&&(i.defaultValue=u)),h!=null&&(i.defaultValue=""+h)}function cl(i){var o=i.textContent;o===i._wrapperState.initialValue&&o!==""&&o!==null&&(i.value=o)}function xt(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Tt(i,o){return i==null||i==="http://www.w3.org/1999/xhtml"?xt(o):i==="http://www.w3.org/2000/svg"&&o==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var qr,dl=(function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(o,u,h,m){MSApp.execUnsafeLocalFunction(function(){return i(o,u,h,m)})}:i})(function(i,o){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=o;else{for(qr=qr||document.createElement("div"),qr.innerHTML="<svg>"+o.valueOf().toString()+"</svg>",o=qr.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;o.firstChild;)i.appendChild(o.firstChild)}});function wi(i,o){if(o){var u=i.firstChild;if(u&&u===i.lastChild&&u.nodeType===3){u.nodeValue=o;return}}i.textContent=o}var ms={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},gs=["Webkit","ms","Moz","O"];Object.keys(ms).forEach(function(i){gs.forEach(function(o){o=o+i.charAt(0).toUpperCase()+i.substring(1),ms[o]=ms[i]})});function hl(i,o,u){return o==null||typeof o=="boolean"||o===""?"":u||typeof o!="number"||o===0||ms.hasOwnProperty(i)&&ms[i]?(""+o).trim():o+"px"}function fl(i,o){i=i.style;for(var u in o)if(o.hasOwnProperty(u)){var h=u.indexOf("--")===0,m=hl(u,o[u],h);u==="float"&&(u="cssFloat"),h?i.setProperty(u,m):i[u]=m}}var pl=he({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ml(i,o){if(o){if(pl[i]&&(o.children!=null||o.dangerouslySetInnerHTML!=null))throw Error(t(137,i));if(o.dangerouslySetInnerHTML!=null){if(o.children!=null)throw Error(t(60));if(typeof o.dangerouslySetInnerHTML!="object"||!("__html"in o.dangerouslySetInnerHTML))throw Error(t(61))}if(o.style!=null&&typeof o.style!="object")throw Error(t(62))}}function gl(i,o){if(i.indexOf("-")===-1)return typeof o.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ys=null;function bo(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Ao=null,bn=null,mr=null;function Ro(i){if(i=Ul(i)){if(typeof Ao!="function")throw Error(t(280));var o=i.stateNode;o&&(o=Vc(o),Ao(i.stateNode,i.type,o))}}function gr(i){bn?mr?mr.push(i):mr=[i]:bn=i}function yl(){if(bn){var i=bn,o=mr;if(mr=bn=null,Ro(i),o)for(i=0;i<o.length;i++)Ro(o[i])}}function vs(i,o){return i(o)}function vl(){}var Hr=!1;function _l(i,o,u){if(Hr)return i(o,u);Hr=!0;try{return vs(i,o,u)}finally{Hr=!1,(bn!==null||mr!==null)&&(vl(),yl())}}function pt(i,o){var u=i.stateNode;if(u===null)return null;var h=Vc(u);if(h===null)return null;u=h[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(i=i.type,h=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!h;break e;default:i=!1}if(i)return null;if(u&&typeof u!="function")throw Error(t(231,o,typeof u));return u}var Co=!1;if(d)try{var Hn={};Object.defineProperty(Hn,"passive",{get:function(){Co=!0}}),window.addEventListener("test",Hn,Hn),window.removeEventListener("test",Hn,Hn)}catch{Co=!1}function _s(i,o,u,h,m,y,I,b,V){var W=Array.prototype.slice.call(arguments,3);try{o.apply(u,W)}catch(Z){this.onError(Z)}}var ws=!1,Po=null,Wn=!1,wl=null,lf={onError:function(i){ws=!0,Po=i}};function No(i,o,u,h,m,y,I,b,V){ws=!1,Po=null,_s.apply(lf,arguments)}function sc(i,o,u,h,m,y,I,b,V){if(No.apply(this,arguments),ws){if(ws){var W=Po;ws=!1,Po=null}else throw Error(t(198));Wn||(Wn=!0,wl=W)}}function Gn(i){var o=i,u=i;if(i.alternate)for(;o.return;)o=o.return;else{i=o;do o=i,(o.flags&4098)!==0&&(u=o.return),i=o.return;while(i)}return o.tag===3?u:null}function Es(i){if(i.tag===13){var o=i.memoizedState;if(o===null&&(i=i.alternate,i!==null&&(o=i.memoizedState)),o!==null)return o.dehydrated}return null}function Kn(i){if(Gn(i)!==i)throw Error(t(188))}function oc(i){var o=i.alternate;if(!o){if(o=Gn(i),o===null)throw Error(t(188));return o!==i?null:i}for(var u=i,h=o;;){var m=u.return;if(m===null)break;var y=m.alternate;if(y===null){if(h=m.return,h!==null){u=h;continue}break}if(m.child===y.child){for(y=m.child;y;){if(y===u)return Kn(m),i;if(y===h)return Kn(m),o;y=y.sibling}throw Error(t(188))}if(u.return!==h.return)u=m,h=y;else{for(var I=!1,b=m.child;b;){if(b===u){I=!0,u=m,h=y;break}if(b===h){I=!0,h=m,u=y;break}b=b.sibling}if(!I){for(b=y.child;b;){if(b===u){I=!0,u=y,h=m;break}if(b===h){I=!0,h=y,u=m;break}b=b.sibling}if(!I)throw Error(t(189))}}if(u.alternate!==h)throw Error(t(190))}if(u.tag!==3)throw Error(t(188));return u.stateNode.current===u?i:o}function El(i){return i=oc(i),i!==null?Do(i):null}function Do(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var o=Do(i);if(o!==null)return o;i=i.sibling}return null}var Vo=e.unstable_scheduleCallback,Il=e.unstable_cancelCallback,ac=e.unstable_shouldYield,uf=e.unstable_requestPaint,Xe=e.unstable_now,lc=e.unstable_getCurrentPriorityLevel,Is=e.unstable_ImmediatePriority,Ei=e.unstable_UserBlockingPriority,An=e.unstable_NormalPriority,xl=e.unstable_LowPriority,uc=e.unstable_IdlePriority,xs=null,mn=null;function cc(i){if(mn&&typeof mn.onCommitFiberRoot=="function")try{mn.onCommitFiberRoot(xs,i,void 0,(i.current.flags&128)===128)}catch{}}var Xt=Math.clz32?Math.clz32:hc,Tl=Math.log,dc=Math.LN2;function hc(i){return i>>>=0,i===0?32:31-(Tl(i)/dc|0)|0}var Oo=64,Lo=4194304;function Ii(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function Ts(i,o){var u=i.pendingLanes;if(u===0)return 0;var h=0,m=i.suspendedLanes,y=i.pingedLanes,I=u&268435455;if(I!==0){var b=I&~m;b!==0?h=Ii(b):(y&=I,y!==0&&(h=Ii(y)))}else I=u&~m,I!==0?h=Ii(I):y!==0&&(h=Ii(y));if(h===0)return 0;if(o!==0&&o!==h&&(o&m)===0&&(m=h&-h,y=o&-o,m>=y||m===16&&(y&4194240)!==0))return o;if((h&4)!==0&&(h|=u&16),o=i.entangledLanes,o!==0)for(i=i.entanglements,o&=h;0<o;)u=31-Xt(o),m=1<<u,h|=i[u],o&=~m;return h}function cf(i,o){switch(i){case 1:case 2:case 4:return o+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Wr(i,o){for(var u=i.suspendedLanes,h=i.pingedLanes,m=i.expirationTimes,y=i.pendingLanes;0<y;){var I=31-Xt(y),b=1<<I,V=m[I];V===-1?((b&u)===0||(b&h)!==0)&&(m[I]=cf(b,o)):V<=o&&(i.expiredLanes|=b),y&=~b}}function gn(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function Ss(){var i=Oo;return Oo<<=1,(Oo&4194240)===0&&(Oo=64),i}function xi(i){for(var o=[],u=0;31>u;u++)o.push(i);return o}function Ti(i,o,u){i.pendingLanes|=o,o!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,o=31-Xt(o),i[o]=u}function Qe(i,o){var u=i.pendingLanes&~o;i.pendingLanes=o,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=o,i.mutableReadLanes&=o,i.entangledLanes&=o,o=i.entanglements;var h=i.eventTimes;for(i=i.expirationTimes;0<u;){var m=31-Xt(u),y=1<<m;o[m]=0,h[m]=-1,i[m]=-1,u&=~y}}function Si(i,o){var u=i.entangledLanes|=o;for(i=i.entanglements;u;){var h=31-Xt(u),m=1<<h;m&o|i[h]&o&&(i[h]|=o),u&=~m}}var Ve=0;function ki(i){return i&=-i,1<i?4<i?(i&268435455)!==0?16:536870912:4:1}var fc,Mo,pc,mc,gc,Sl=!1,yr=[],Lt=null,Qn=null,Yn=null,bi=new Map,Rn=new Map,vr=[],df="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function yc(i,o){switch(i){case"focusin":case"focusout":Lt=null;break;case"dragenter":case"dragleave":Qn=null;break;case"mouseover":case"mouseout":Yn=null;break;case"pointerover":case"pointerout":bi.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rn.delete(o.pointerId)}}function sn(i,o,u,h,m,y){return i===null||i.nativeEvent!==y?(i={blockedOn:o,domEventName:u,eventSystemFlags:h,nativeEvent:y,targetContainers:[m]},o!==null&&(o=Ul(o),o!==null&&Mo(o)),i):(i.eventSystemFlags|=h,o=i.targetContainers,m!==null&&o.indexOf(m)===-1&&o.push(m),i)}function hf(i,o,u,h,m){switch(o){case"focusin":return Lt=sn(Lt,i,o,u,h,m),!0;case"dragenter":return Qn=sn(Qn,i,o,u,h,m),!0;case"mouseover":return Yn=sn(Yn,i,o,u,h,m),!0;case"pointerover":var y=m.pointerId;return bi.set(y,sn(bi.get(y)||null,i,o,u,h,m)),!0;case"gotpointercapture":return y=m.pointerId,Rn.set(y,sn(Rn.get(y)||null,i,o,u,h,m)),!0}return!1}function vc(i){var o=Cs(i.target);if(o!==null){var u=Gn(o);if(u!==null){if(o=u.tag,o===13){if(o=Es(u),o!==null){i.blockedOn=o,gc(i.priority,function(){pc(u)});return}}else if(o===3&&u.stateNode.current.memoizedState.isDehydrated){i.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Gr(i){if(i.blockedOn!==null)return!1;for(var o=i.targetContainers;0<o.length;){var u=jo(i.domEventName,i.eventSystemFlags,o[0],i.nativeEvent);if(u===null){u=i.nativeEvent;var h=new u.constructor(u.type,u);ys=h,u.target.dispatchEvent(h),ys=null}else return o=Ul(u),o!==null&&Mo(o),i.blockedOn=u,!1;o.shift()}return!0}function ks(i,o,u){Gr(i)&&u.delete(o)}function _c(){Sl=!1,Lt!==null&&Gr(Lt)&&(Lt=null),Qn!==null&&Gr(Qn)&&(Qn=null),Yn!==null&&Gr(Yn)&&(Yn=null),bi.forEach(ks),Rn.forEach(ks)}function Xn(i,o){i.blockedOn===o&&(i.blockedOn=null,Sl||(Sl=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,_c)))}function Jn(i){function o(m){return Xn(m,i)}if(0<yr.length){Xn(yr[0],i);for(var u=1;u<yr.length;u++){var h=yr[u];h.blockedOn===i&&(h.blockedOn=null)}}for(Lt!==null&&Xn(Lt,i),Qn!==null&&Xn(Qn,i),Yn!==null&&Xn(Yn,i),bi.forEach(o),Rn.forEach(o),u=0;u<vr.length;u++)h=vr[u],h.blockedOn===i&&(h.blockedOn=null);for(;0<vr.length&&(u=vr[0],u.blockedOn===null);)vc(u),u.blockedOn===null&&vr.shift()}var Kr=se.ReactCurrentBatchConfig,Ai=!0;function rt(i,o,u,h){var m=Ve,y=Kr.transition;Kr.transition=null;try{Ve=1,kl(i,o,u,h)}finally{Ve=m,Kr.transition=y}}function ff(i,o,u,h){var m=Ve,y=Kr.transition;Kr.transition=null;try{Ve=4,kl(i,o,u,h)}finally{Ve=m,Kr.transition=y}}function kl(i,o,u,h){if(Ai){var m=jo(i,o,u,h);if(m===null)Tf(i,o,h,bs,u),yc(i,h);else if(hf(m,i,o,u,h))h.stopPropagation();else if(yc(i,h),o&4&&-1<df.indexOf(i)){for(;m!==null;){var y=Ul(m);if(y!==null&&fc(y),y=jo(i,o,u,h),y===null&&Tf(i,o,h,bs,u),y===m)break;m=y}m!==null&&h.stopPropagation()}else Tf(i,o,h,null,u)}}var bs=null;function jo(i,o,u,h){if(bs=null,i=bo(h),i=Cs(i),i!==null)if(o=Gn(i),o===null)i=null;else if(u=o.tag,u===13){if(i=Es(o),i!==null)return i;i=null}else if(u===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;i=null}else o!==i&&(i=null);return bs=i,null}function bl(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(lc()){case Is:return 1;case Ei:return 4;case An:case xl:return 16;case uc:return 536870912;default:return 16}default:return 16}}var yn=null,Fo=null,on=null;function Al(){if(on)return on;var i,o=Fo,u=o.length,h,m="value"in yn?yn.value:yn.textContent,y=m.length;for(i=0;i<u&&o[i]===m[i];i++);var I=u-i;for(h=1;h<=I&&o[u-h]===m[y-h];h++);return on=m.slice(i,1<h?1-h:void 0)}function Uo(i){var o=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&o===13&&(i=13)):i=o,i===10&&(i=13),32<=i||i===13?i:0}function _r(){return!0}function Rl(){return!1}function Mt(i){function o(u,h,m,y,I){this._reactName=u,this._targetInst=m,this.type=h,this.nativeEvent=y,this.target=I,this.currentTarget=null;for(var b in i)i.hasOwnProperty(b)&&(u=i[b],this[b]=u?u(y):y[b]);return this.isDefaultPrevented=(y.defaultPrevented!=null?y.defaultPrevented:y.returnValue===!1)?_r:Rl,this.isPropagationStopped=Rl,this}return he(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=_r)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=_r)},persist:function(){},isPersistent:_r}),o}var Zn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Bo=Mt(Zn),wr=he({},Zn,{view:0,detail:0}),pf=Mt(wr),zo,Qr,Ri,As=he({},wr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Er,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Ri&&(Ri&&i.type==="mousemove"?(zo=i.screenX-Ri.screenX,Qr=i.screenY-Ri.screenY):Qr=zo=0,Ri=i),zo)},movementY:function(i){return"movementY"in i?i.movementY:Qr}}),$o=Mt(As),Cl=he({},As,{dataTransfer:0}),wc=Mt(Cl),qo=he({},wr,{relatedTarget:0}),Ho=Mt(qo),Ec=he({},Zn,{animationName:0,elapsedTime:0,pseudoElement:0}),Yr=Mt(Ec),Ic=he({},Zn,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),xc=Mt(Ic),Tc=he({},Zn,{data:0}),Pl=Mt(Tc),Wo={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Jt={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Sc={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function kc(i){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(i):(i=Sc[i])?!!o[i]:!1}function Er(){return kc}var c=he({},wr,{key:function(i){if(i.key){var o=Wo[i.key]||i.key;if(o!=="Unidentified")return o}return i.type==="keypress"?(i=Uo(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?Jt[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Er,charCode:function(i){return i.type==="keypress"?Uo(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Uo(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),g=Mt(c),E=he({},As,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),T=Mt(E),B=he({},wr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Er}),G=Mt(B),ae=he({},Zn,{propertyName:0,elapsedTime:0,pseudoElement:0}),qe=Mt(ae),St=he({},As,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Le=Mt(St),Pt=[9,13,27,32],gt=d&&"CompositionEvent"in window,Cn=null;d&&"documentMode"in document&&(Cn=document.documentMode);var vn=d&&"TextEvent"in window&&!Cn,Rs=d&&(!gt||Cn&&8<Cn&&11>=Cn),Go=" ",yy=!1;function vy(i,o){switch(i){case"keyup":return Pt.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function _y(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var Ko=!1;function iS(i,o){switch(i){case"compositionend":return _y(o);case"keypress":return o.which!==32?null:(yy=!0,Go);case"textInput":return i=o.data,i===Go&&yy?null:i;default:return null}}function sS(i,o){if(Ko)return i==="compositionend"||!gt&&vy(i,o)?(i=Al(),on=Fo=yn=null,Ko=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Rs&&o.locale!=="ko"?null:o.data;default:return null}}var oS={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function wy(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o==="input"?!!oS[i.type]:o==="textarea"}function Ey(i,o,u,h){gr(h),o=Pc(o,"onChange"),0<o.length&&(u=new Bo("onChange","change",null,u,h),i.push({event:u,listeners:o}))}var Nl=null,Dl=null;function aS(i){Fy(i,0)}function bc(i){var o=Zo(i);if(Io(o))return i}function lS(i,o){if(i==="change")return o}var Iy=!1;if(d){var mf;if(d){var gf="oninput"in document;if(!gf){var xy=document.createElement("div");xy.setAttribute("oninput","return;"),gf=typeof xy.oninput=="function"}mf=gf}else mf=!1;Iy=mf&&(!document.documentMode||9<document.documentMode)}function Ty(){Nl&&(Nl.detachEvent("onpropertychange",Sy),Dl=Nl=null)}function Sy(i){if(i.propertyName==="value"&&bc(Dl)){var o=[];Ey(o,Dl,i,bo(i)),_l(aS,o)}}function uS(i,o,u){i==="focusin"?(Ty(),Nl=o,Dl=u,Nl.attachEvent("onpropertychange",Sy)):i==="focusout"&&Ty()}function cS(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return bc(Dl)}function dS(i,o){if(i==="click")return bc(o)}function hS(i,o){if(i==="input"||i==="change")return bc(o)}function fS(i,o){return i===o&&(i!==0||1/i===1/o)||i!==i&&o!==o}var er=typeof Object.is=="function"?Object.is:fS;function Vl(i,o){if(er(i,o))return!0;if(typeof i!="object"||i===null||typeof o!="object"||o===null)return!1;var u=Object.keys(i),h=Object.keys(o);if(u.length!==h.length)return!1;for(h=0;h<u.length;h++){var m=u[h];if(!f.call(o,m)||!er(i[m],o[m]))return!1}return!0}function ky(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function by(i,o){var u=ky(i);i=0;for(var h;u;){if(u.nodeType===3){if(h=i+u.textContent.length,i<=o&&h>=o)return{node:u,offset:o-i};i=h}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=ky(u)}}function Ay(i,o){return i&&o?i===o?!0:i&&i.nodeType===3?!1:o&&o.nodeType===3?Ay(i,o.parentNode):"contains"in i?i.contains(o):i.compareDocumentPosition?!!(i.compareDocumentPosition(o)&16):!1:!1}function Ry(){for(var i=window,o=_i();o instanceof i.HTMLIFrameElement;){try{var u=typeof o.contentWindow.location.href=="string"}catch{u=!1}if(u)i=o.contentWindow;else break;o=_i(i.document)}return o}function yf(i){var o=i&&i.nodeName&&i.nodeName.toLowerCase();return o&&(o==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||o==="textarea"||i.contentEditable==="true")}function pS(i){var o=Ry(),u=i.focusedElem,h=i.selectionRange;if(o!==u&&u&&u.ownerDocument&&Ay(u.ownerDocument.documentElement,u)){if(h!==null&&yf(u)){if(o=h.start,i=h.end,i===void 0&&(i=o),"selectionStart"in u)u.selectionStart=o,u.selectionEnd=Math.min(i,u.value.length);else if(i=(o=u.ownerDocument||document)&&o.defaultView||window,i.getSelection){i=i.getSelection();var m=u.textContent.length,y=Math.min(h.start,m);h=h.end===void 0?y:Math.min(h.end,m),!i.extend&&y>h&&(m=h,h=y,y=m),m=by(u,y);var I=by(u,h);m&&I&&(i.rangeCount!==1||i.anchorNode!==m.node||i.anchorOffset!==m.offset||i.focusNode!==I.node||i.focusOffset!==I.offset)&&(o=o.createRange(),o.setStart(m.node,m.offset),i.removeAllRanges(),y>h?(i.addRange(o),i.extend(I.node,I.offset)):(o.setEnd(I.node,I.offset),i.addRange(o)))}}for(o=[],i=u;i=i.parentNode;)i.nodeType===1&&o.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof u.focus=="function"&&u.focus(),u=0;u<o.length;u++)i=o[u],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var mS=d&&"documentMode"in document&&11>=document.documentMode,Qo=null,vf=null,Ol=null,_f=!1;function Cy(i,o,u){var h=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;_f||Qo==null||Qo!==_i(h)||(h=Qo,"selectionStart"in h&&yf(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),Ol&&Vl(Ol,h)||(Ol=h,h=Pc(vf,"onSelect"),0<h.length&&(o=new Bo("onSelect","select",null,o,u),i.push({event:o,listeners:h}),o.target=Qo)))}function Ac(i,o){var u={};return u[i.toLowerCase()]=o.toLowerCase(),u["Webkit"+i]="webkit"+o,u["Moz"+i]="moz"+o,u}var Yo={animationend:Ac("Animation","AnimationEnd"),animationiteration:Ac("Animation","AnimationIteration"),animationstart:Ac("Animation","AnimationStart"),transitionend:Ac("Transition","TransitionEnd")},wf={},Py={};d&&(Py=document.createElement("div").style,"AnimationEvent"in window||(delete Yo.animationend.animation,delete Yo.animationiteration.animation,delete Yo.animationstart.animation),"TransitionEvent"in window||delete Yo.transitionend.transition);function Rc(i){if(wf[i])return wf[i];if(!Yo[i])return i;var o=Yo[i],u;for(u in o)if(o.hasOwnProperty(u)&&u in Py)return wf[i]=o[u];return i}var Ny=Rc("animationend"),Dy=Rc("animationiteration"),Vy=Rc("animationstart"),Oy=Rc("transitionend"),Ly=new Map,My="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ci(i,o){Ly.set(i,o),a(o,[i])}for(var Ef=0;Ef<My.length;Ef++){var If=My[Ef],gS=If.toLowerCase(),yS=If[0].toUpperCase()+If.slice(1);Ci(gS,"on"+yS)}Ci(Ny,"onAnimationEnd"),Ci(Dy,"onAnimationIteration"),Ci(Vy,"onAnimationStart"),Ci("dblclick","onDoubleClick"),Ci("focusin","onFocus"),Ci("focusout","onBlur"),Ci(Oy,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ll="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),vS=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ll));function jy(i,o,u){var h=i.type||"unknown-event";i.currentTarget=u,sc(h,o,void 0,i),i.currentTarget=null}function Fy(i,o){o=(o&4)!==0;for(var u=0;u<i.length;u++){var h=i[u],m=h.event;h=h.listeners;e:{var y=void 0;if(o)for(var I=h.length-1;0<=I;I--){var b=h[I],V=b.instance,W=b.currentTarget;if(b=b.listener,V!==y&&m.isPropagationStopped())break e;jy(m,b,W),y=V}else for(I=0;I<h.length;I++){if(b=h[I],V=b.instance,W=b.currentTarget,b=b.listener,V!==y&&m.isPropagationStopped())break e;jy(m,b,W),y=V}}}if(Wn)throw i=wl,Wn=!1,wl=null,i}function et(i,o){var u=o[Cf];u===void 0&&(u=o[Cf]=new Set);var h=i+"__bubble";u.has(h)||(Uy(o,i,2,!1),u.add(h))}function xf(i,o,u){var h=0;o&&(h|=4),Uy(u,i,h,o)}var Cc="_reactListening"+Math.random().toString(36).slice(2);function Ml(i){if(!i[Cc]){i[Cc]=!0,r.forEach(function(u){u!=="selectionchange"&&(vS.has(u)||xf(u,!1,i),xf(u,!0,i))});var o=i.nodeType===9?i:i.ownerDocument;o===null||o[Cc]||(o[Cc]=!0,xf("selectionchange",!1,o))}}function Uy(i,o,u,h){switch(bl(o)){case 1:var m=rt;break;case 4:m=ff;break;default:m=kl}u=m.bind(null,o,u,i),m=void 0,!Co||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(m=!0),h?m!==void 0?i.addEventListener(o,u,{capture:!0,passive:m}):i.addEventListener(o,u,!0):m!==void 0?i.addEventListener(o,u,{passive:m}):i.addEventListener(o,u,!1)}function Tf(i,o,u,h,m){var y=h;if((o&1)===0&&(o&2)===0&&h!==null)e:for(;;){if(h===null)return;var I=h.tag;if(I===3||I===4){var b=h.stateNode.containerInfo;if(b===m||b.nodeType===8&&b.parentNode===m)break;if(I===4)for(I=h.return;I!==null;){var V=I.tag;if((V===3||V===4)&&(V=I.stateNode.containerInfo,V===m||V.nodeType===8&&V.parentNode===m))return;I=I.return}for(;b!==null;){if(I=Cs(b),I===null)return;if(V=I.tag,V===5||V===6){h=y=I;continue e}b=b.parentNode}}h=h.return}_l(function(){var W=y,Z=bo(u),te=[];e:{var J=Ly.get(i);if(J!==void 0){var de=Bo,pe=i;switch(i){case"keypress":if(Uo(u)===0)break e;case"keydown":case"keyup":de=g;break;case"focusin":pe="focus",de=Ho;break;case"focusout":pe="blur",de=Ho;break;case"beforeblur":case"afterblur":de=Ho;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":de=$o;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":de=wc;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":de=G;break;case Ny:case Dy:case Vy:de=Yr;break;case Oy:de=qe;break;case"scroll":de=pf;break;case"wheel":de=Le;break;case"copy":case"cut":case"paste":de=xc;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":de=T}var ge=(o&4)!==0,mt=!ge&&i==="scroll",$=ge?J!==null?J+"Capture":null:J;ge=[];for(var M=W,q;M!==null;){q=M;var ie=q.stateNode;if(q.tag===5&&ie!==null&&(q=ie,$!==null&&(ie=pt(M,$),ie!=null&&ge.push(jl(M,ie,q)))),mt)break;M=M.return}0<ge.length&&(J=new de(J,pe,null,u,Z),te.push({event:J,listeners:ge}))}}if((o&7)===0){e:{if(J=i==="mouseover"||i==="pointerover",de=i==="mouseout"||i==="pointerout",J&&u!==ys&&(pe=u.relatedTarget||u.fromElement)&&(Cs(pe)||pe[Xr]))break e;if((de||J)&&(J=Z.window===Z?Z:(J=Z.ownerDocument)?J.defaultView||J.parentWindow:window,de?(pe=u.relatedTarget||u.toElement,de=W,pe=pe?Cs(pe):null,pe!==null&&(mt=Gn(pe),pe!==mt||pe.tag!==5&&pe.tag!==6)&&(pe=null)):(de=null,pe=W),de!==pe)){if(ge=$o,ie="onMouseLeave",$="onMouseEnter",M="mouse",(i==="pointerout"||i==="pointerover")&&(ge=T,ie="onPointerLeave",$="onPointerEnter",M="pointer"),mt=de==null?J:Zo(de),q=pe==null?J:Zo(pe),J=new ge(ie,M+"leave",de,u,Z),J.target=mt,J.relatedTarget=q,ie=null,Cs(Z)===W&&(ge=new ge($,M+"enter",pe,u,Z),ge.target=q,ge.relatedTarget=mt,ie=ge),mt=ie,de&&pe)t:{for(ge=de,$=pe,M=0,q=ge;q;q=Xo(q))M++;for(q=0,ie=$;ie;ie=Xo(ie))q++;for(;0<M-q;)ge=Xo(ge),M--;for(;0<q-M;)$=Xo($),q--;for(;M--;){if(ge===$||$!==null&&ge===$.alternate)break t;ge=Xo(ge),$=Xo($)}ge=null}else ge=null;de!==null&&By(te,J,de,ge,!1),pe!==null&&mt!==null&&By(te,mt,pe,ge,!0)}}e:{if(J=W?Zo(W):window,de=J.nodeName&&J.nodeName.toLowerCase(),de==="select"||de==="input"&&J.type==="file")var ye=lS;else if(wy(J))if(Iy)ye=hS;else{ye=cS;var Ie=uS}else(de=J.nodeName)&&de.toLowerCase()==="input"&&(J.type==="checkbox"||J.type==="radio")&&(ye=dS);if(ye&&(ye=ye(i,W))){Ey(te,ye,u,Z);break e}Ie&&Ie(i,J,W),i==="focusout"&&(Ie=J._wrapperState)&&Ie.controlled&&J.type==="number"&&To(J,"number",J.value)}switch(Ie=W?Zo(W):window,i){case"focusin":(wy(Ie)||Ie.contentEditable==="true")&&(Qo=Ie,vf=W,Ol=null);break;case"focusout":Ol=vf=Qo=null;break;case"mousedown":_f=!0;break;case"contextmenu":case"mouseup":case"dragend":_f=!1,Cy(te,u,Z);break;case"selectionchange":if(mS)break;case"keydown":case"keyup":Cy(te,u,Z)}var xe;if(gt)e:{switch(i){case"compositionstart":var Se="onCompositionStart";break e;case"compositionend":Se="onCompositionEnd";break e;case"compositionupdate":Se="onCompositionUpdate";break e}Se=void 0}else Ko?vy(i,u)&&(Se="onCompositionEnd"):i==="keydown"&&u.keyCode===229&&(Se="onCompositionStart");Se&&(Rs&&u.locale!=="ko"&&(Ko||Se!=="onCompositionStart"?Se==="onCompositionEnd"&&Ko&&(xe=Al()):(yn=Z,Fo="value"in yn?yn.value:yn.textContent,Ko=!0)),Ie=Pc(W,Se),0<Ie.length&&(Se=new Pl(Se,i,null,u,Z),te.push({event:Se,listeners:Ie}),xe?Se.data=xe:(xe=_y(u),xe!==null&&(Se.data=xe)))),(xe=vn?iS(i,u):sS(i,u))&&(W=Pc(W,"onBeforeInput"),0<W.length&&(Z=new Pl("onBeforeInput","beforeinput",null,u,Z),te.push({event:Z,listeners:W}),Z.data=xe))}Fy(te,o)})}function jl(i,o,u){return{instance:i,listener:o,currentTarget:u}}function Pc(i,o){for(var u=o+"Capture",h=[];i!==null;){var m=i,y=m.stateNode;m.tag===5&&y!==null&&(m=y,y=pt(i,u),y!=null&&h.unshift(jl(i,y,m)),y=pt(i,o),y!=null&&h.push(jl(i,y,m))),i=i.return}return h}function Xo(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function By(i,o,u,h,m){for(var y=o._reactName,I=[];u!==null&&u!==h;){var b=u,V=b.alternate,W=b.stateNode;if(V!==null&&V===h)break;b.tag===5&&W!==null&&(b=W,m?(V=pt(u,y),V!=null&&I.unshift(jl(u,V,b))):m||(V=pt(u,y),V!=null&&I.push(jl(u,V,b)))),u=u.return}I.length!==0&&i.push({event:o,listeners:I})}var _S=/\r\n?/g,wS=/\u0000|\uFFFD/g;function zy(i){return(typeof i=="string"?i:""+i).replace(_S,`
`).replace(wS,"")}function Nc(i,o,u){if(o=zy(o),zy(i)!==o&&u)throw Error(t(425))}function Dc(){}var Sf=null,kf=null;function bf(i,o){return i==="textarea"||i==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Af=typeof setTimeout=="function"?setTimeout:void 0,ES=typeof clearTimeout=="function"?clearTimeout:void 0,$y=typeof Promise=="function"?Promise:void 0,IS=typeof queueMicrotask=="function"?queueMicrotask:typeof $y<"u"?function(i){return $y.resolve(null).then(i).catch(xS)}:Af;function xS(i){setTimeout(function(){throw i})}function Rf(i,o){var u=o,h=0;do{var m=u.nextSibling;if(i.removeChild(u),m&&m.nodeType===8)if(u=m.data,u==="/$"){if(h===0){i.removeChild(m),Jn(o);return}h--}else u!=="$"&&u!=="$?"&&u!=="$!"||h++;u=m}while(u);Jn(o)}function Pi(i){for(;i!=null;i=i.nextSibling){var o=i.nodeType;if(o===1||o===3)break;if(o===8){if(o=i.data,o==="$"||o==="$!"||o==="$?")break;if(o==="/$")return null}}return i}function qy(i){i=i.previousSibling;for(var o=0;i;){if(i.nodeType===8){var u=i.data;if(u==="$"||u==="$!"||u==="$?"){if(o===0)return i;o--}else u==="/$"&&o++}i=i.previousSibling}return null}var Jo=Math.random().toString(36).slice(2),Ir="__reactFiber$"+Jo,Fl="__reactProps$"+Jo,Xr="__reactContainer$"+Jo,Cf="__reactEvents$"+Jo,TS="__reactListeners$"+Jo,SS="__reactHandles$"+Jo;function Cs(i){var o=i[Ir];if(o)return o;for(var u=i.parentNode;u;){if(o=u[Xr]||u[Ir]){if(u=o.alternate,o.child!==null||u!==null&&u.child!==null)for(i=qy(i);i!==null;){if(u=i[Ir])return u;i=qy(i)}return o}i=u,u=i.parentNode}return null}function Ul(i){return i=i[Ir]||i[Xr],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function Zo(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(t(33))}function Vc(i){return i[Fl]||null}var Pf=[],ea=-1;function Ni(i){return{current:i}}function tt(i){0>ea||(i.current=Pf[ea],Pf[ea]=null,ea--)}function Je(i,o){ea++,Pf[ea]=i.current,i.current=o}var Di={},zt=Ni(Di),an=Ni(!1),Ps=Di;function ta(i,o){var u=i.type.contextTypes;if(!u)return Di;var h=i.stateNode;if(h&&h.__reactInternalMemoizedUnmaskedChildContext===o)return h.__reactInternalMemoizedMaskedChildContext;var m={},y;for(y in u)m[y]=o[y];return h&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=o,i.__reactInternalMemoizedMaskedChildContext=m),m}function ln(i){return i=i.childContextTypes,i!=null}function Oc(){tt(an),tt(zt)}function Hy(i,o,u){if(zt.current!==Di)throw Error(t(168));Je(zt,o),Je(an,u)}function Wy(i,o,u){var h=i.stateNode;if(o=o.childContextTypes,typeof h.getChildContext!="function")return u;h=h.getChildContext();for(var m in h)if(!(m in o))throw Error(t(108,Be(i)||"Unknown",m));return he({},u,h)}function Lc(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||Di,Ps=zt.current,Je(zt,i),Je(an,an.current),!0}function Gy(i,o,u){var h=i.stateNode;if(!h)throw Error(t(169));u?(i=Wy(i,o,Ps),h.__reactInternalMemoizedMergedChildContext=i,tt(an),tt(zt),Je(zt,i)):tt(an),Je(an,u)}var Jr=null,Mc=!1,Nf=!1;function Ky(i){Jr===null?Jr=[i]:Jr.push(i)}function kS(i){Mc=!0,Ky(i)}function Vi(){if(!Nf&&Jr!==null){Nf=!0;var i=0,o=Ve;try{var u=Jr;for(Ve=1;i<u.length;i++){var h=u[i];do h=h(!0);while(h!==null)}Jr=null,Mc=!1}catch(m){throw Jr!==null&&(Jr=Jr.slice(i+1)),Vo(Is,Vi),m}finally{Ve=o,Nf=!1}}return null}var na=[],ra=0,jc=null,Fc=0,Pn=[],Nn=0,Ns=null,Zr=1,ei="";function Ds(i,o){na[ra++]=Fc,na[ra++]=jc,jc=i,Fc=o}function Qy(i,o,u){Pn[Nn++]=Zr,Pn[Nn++]=ei,Pn[Nn++]=Ns,Ns=i;var h=Zr;i=ei;var m=32-Xt(h)-1;h&=~(1<<m),u+=1;var y=32-Xt(o)+m;if(30<y){var I=m-m%5;y=(h&(1<<I)-1).toString(32),h>>=I,m-=I,Zr=1<<32-Xt(o)+m|u<<m|h,ei=y+i}else Zr=1<<y|u<<m|h,ei=i}function Df(i){i.return!==null&&(Ds(i,1),Qy(i,1,0))}function Vf(i){for(;i===jc;)jc=na[--ra],na[ra]=null,Fc=na[--ra],na[ra]=null;for(;i===Ns;)Ns=Pn[--Nn],Pn[Nn]=null,ei=Pn[--Nn],Pn[Nn]=null,Zr=Pn[--Nn],Pn[Nn]=null}var _n=null,wn=null,it=!1,tr=null;function Yy(i,o){var u=Ln(5,null,null,0);u.elementType="DELETED",u.stateNode=o,u.return=i,o=i.deletions,o===null?(i.deletions=[u],i.flags|=16):o.push(u)}function Xy(i,o){switch(i.tag){case 5:var u=i.type;return o=o.nodeType!==1||u.toLowerCase()!==o.nodeName.toLowerCase()?null:o,o!==null?(i.stateNode=o,_n=i,wn=Pi(o.firstChild),!0):!1;case 6:return o=i.pendingProps===""||o.nodeType!==3?null:o,o!==null?(i.stateNode=o,_n=i,wn=null,!0):!1;case 13:return o=o.nodeType!==8?null:o,o!==null?(u=Ns!==null?{id:Zr,overflow:ei}:null,i.memoizedState={dehydrated:o,treeContext:u,retryLane:1073741824},u=Ln(18,null,null,0),u.stateNode=o,u.return=i,i.child=u,_n=i,wn=null,!0):!1;default:return!1}}function Of(i){return(i.mode&1)!==0&&(i.flags&128)===0}function Lf(i){if(it){var o=wn;if(o){var u=o;if(!Xy(i,o)){if(Of(i))throw Error(t(418));o=Pi(u.nextSibling);var h=_n;o&&Xy(i,o)?Yy(h,u):(i.flags=i.flags&-4097|2,it=!1,_n=i)}}else{if(Of(i))throw Error(t(418));i.flags=i.flags&-4097|2,it=!1,_n=i}}}function Jy(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;_n=i}function Uc(i){if(i!==_n)return!1;if(!it)return Jy(i),it=!0,!1;var o;if((o=i.tag!==3)&&!(o=i.tag!==5)&&(o=i.type,o=o!=="head"&&o!=="body"&&!bf(i.type,i.memoizedProps)),o&&(o=wn)){if(Of(i))throw Zy(),Error(t(418));for(;o;)Yy(i,o),o=Pi(o.nextSibling)}if(Jy(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(t(317));e:{for(i=i.nextSibling,o=0;i;){if(i.nodeType===8){var u=i.data;if(u==="/$"){if(o===0){wn=Pi(i.nextSibling);break e}o--}else u!=="$"&&u!=="$!"&&u!=="$?"||o++}i=i.nextSibling}wn=null}}else wn=_n?Pi(i.stateNode.nextSibling):null;return!0}function Zy(){for(var i=wn;i;)i=Pi(i.nextSibling)}function ia(){wn=_n=null,it=!1}function Mf(i){tr===null?tr=[i]:tr.push(i)}var bS=se.ReactCurrentBatchConfig;function Bl(i,o,u){if(i=u.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(u._owner){if(u=u._owner,u){if(u.tag!==1)throw Error(t(309));var h=u.stateNode}if(!h)throw Error(t(147,i));var m=h,y=""+i;return o!==null&&o.ref!==null&&typeof o.ref=="function"&&o.ref._stringRef===y?o.ref:(o=function(I){var b=m.refs;I===null?delete b[y]:b[y]=I},o._stringRef=y,o)}if(typeof i!="string")throw Error(t(284));if(!u._owner)throw Error(t(290,i))}return i}function Bc(i,o){throw i=Object.prototype.toString.call(o),Error(t(31,i==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":i))}function ev(i){var o=i._init;return o(i._payload)}function tv(i){function o($,M){if(i){var q=$.deletions;q===null?($.deletions=[M],$.flags|=16):q.push(M)}}function u($,M){if(!i)return null;for(;M!==null;)o($,M),M=M.sibling;return null}function h($,M){for($=new Map;M!==null;)M.key!==null?$.set(M.key,M):$.set(M.index,M),M=M.sibling;return $}function m($,M){return $=zi($,M),$.index=0,$.sibling=null,$}function y($,M,q){return $.index=q,i?(q=$.alternate,q!==null?(q=q.index,q<M?($.flags|=2,M):q):($.flags|=2,M)):($.flags|=1048576,M)}function I($){return i&&$.alternate===null&&($.flags|=2),$}function b($,M,q,ie){return M===null||M.tag!==6?(M=Ap(q,$.mode,ie),M.return=$,M):(M=m(M,q),M.return=$,M)}function V($,M,q,ie){var ye=q.type;return ye===C?Z($,M,q.props.children,ie,q.key):M!==null&&(M.elementType===ye||typeof ye=="object"&&ye!==null&&ye.$$typeof===ee&&ev(ye)===M.type)?(ie=m(M,q.props),ie.ref=Bl($,M,q),ie.return=$,ie):(ie=dd(q.type,q.key,q.props,null,$.mode,ie),ie.ref=Bl($,M,q),ie.return=$,ie)}function W($,M,q,ie){return M===null||M.tag!==4||M.stateNode.containerInfo!==q.containerInfo||M.stateNode.implementation!==q.implementation?(M=Rp(q,$.mode,ie),M.return=$,M):(M=m(M,q.children||[]),M.return=$,M)}function Z($,M,q,ie,ye){return M===null||M.tag!==7?(M=Bs(q,$.mode,ie,ye),M.return=$,M):(M=m(M,q),M.return=$,M)}function te($,M,q){if(typeof M=="string"&&M!==""||typeof M=="number")return M=Ap(""+M,$.mode,q),M.return=$,M;if(typeof M=="object"&&M!==null){switch(M.$$typeof){case ce:return q=dd(M.type,M.key,M.props,null,$.mode,q),q.ref=Bl($,null,M),q.return=$,q;case re:return M=Rp(M,$.mode,q),M.return=$,M;case ee:var ie=M._init;return te($,ie(M._payload),q)}if(zr(M)||Ee(M))return M=Bs(M,$.mode,q,null),M.return=$,M;Bc($,M)}return null}function J($,M,q,ie){var ye=M!==null?M.key:null;if(typeof q=="string"&&q!==""||typeof q=="number")return ye!==null?null:b($,M,""+q,ie);if(typeof q=="object"&&q!==null){switch(q.$$typeof){case ce:return q.key===ye?V($,M,q,ie):null;case re:return q.key===ye?W($,M,q,ie):null;case ee:return ye=q._init,J($,M,ye(q._payload),ie)}if(zr(q)||Ee(q))return ye!==null?null:Z($,M,q,ie,null);Bc($,q)}return null}function de($,M,q,ie,ye){if(typeof ie=="string"&&ie!==""||typeof ie=="number")return $=$.get(q)||null,b(M,$,""+ie,ye);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case ce:return $=$.get(ie.key===null?q:ie.key)||null,V(M,$,ie,ye);case re:return $=$.get(ie.key===null?q:ie.key)||null,W(M,$,ie,ye);case ee:var Ie=ie._init;return de($,M,q,Ie(ie._payload),ye)}if(zr(ie)||Ee(ie))return $=$.get(q)||null,Z(M,$,ie,ye,null);Bc(M,ie)}return null}function pe($,M,q,ie){for(var ye=null,Ie=null,xe=M,Se=M=0,Vt=null;xe!==null&&Se<q.length;Se++){xe.index>Se?(Vt=xe,xe=null):Vt=xe.sibling;var Ue=J($,xe,q[Se],ie);if(Ue===null){xe===null&&(xe=Vt);break}i&&xe&&Ue.alternate===null&&o($,xe),M=y(Ue,M,Se),Ie===null?ye=Ue:Ie.sibling=Ue,Ie=Ue,xe=Vt}if(Se===q.length)return u($,xe),it&&Ds($,Se),ye;if(xe===null){for(;Se<q.length;Se++)xe=te($,q[Se],ie),xe!==null&&(M=y(xe,M,Se),Ie===null?ye=xe:Ie.sibling=xe,Ie=xe);return it&&Ds($,Se),ye}for(xe=h($,xe);Se<q.length;Se++)Vt=de(xe,$,Se,q[Se],ie),Vt!==null&&(i&&Vt.alternate!==null&&xe.delete(Vt.key===null?Se:Vt.key),M=y(Vt,M,Se),Ie===null?ye=Vt:Ie.sibling=Vt,Ie=Vt);return i&&xe.forEach(function($i){return o($,$i)}),it&&Ds($,Se),ye}function ge($,M,q,ie){var ye=Ee(q);if(typeof ye!="function")throw Error(t(150));if(q=ye.call(q),q==null)throw Error(t(151));for(var Ie=ye=null,xe=M,Se=M=0,Vt=null,Ue=q.next();xe!==null&&!Ue.done;Se++,Ue=q.next()){xe.index>Se?(Vt=xe,xe=null):Vt=xe.sibling;var $i=J($,xe,Ue.value,ie);if($i===null){xe===null&&(xe=Vt);break}i&&xe&&$i.alternate===null&&o($,xe),M=y($i,M,Se),Ie===null?ye=$i:Ie.sibling=$i,Ie=$i,xe=Vt}if(Ue.done)return u($,xe),it&&Ds($,Se),ye;if(xe===null){for(;!Ue.done;Se++,Ue=q.next())Ue=te($,Ue.value,ie),Ue!==null&&(M=y(Ue,M,Se),Ie===null?ye=Ue:Ie.sibling=Ue,Ie=Ue);return it&&Ds($,Se),ye}for(xe=h($,xe);!Ue.done;Se++,Ue=q.next())Ue=de(xe,$,Se,Ue.value,ie),Ue!==null&&(i&&Ue.alternate!==null&&xe.delete(Ue.key===null?Se:Ue.key),M=y(Ue,M,Se),Ie===null?ye=Ue:Ie.sibling=Ue,Ie=Ue);return i&&xe.forEach(function(ok){return o($,ok)}),it&&Ds($,Se),ye}function mt($,M,q,ie){if(typeof q=="object"&&q!==null&&q.type===C&&q.key===null&&(q=q.props.children),typeof q=="object"&&q!==null){switch(q.$$typeof){case ce:e:{for(var ye=q.key,Ie=M;Ie!==null;){if(Ie.key===ye){if(ye=q.type,ye===C){if(Ie.tag===7){u($,Ie.sibling),M=m(Ie,q.props.children),M.return=$,$=M;break e}}else if(Ie.elementType===ye||typeof ye=="object"&&ye!==null&&ye.$$typeof===ee&&ev(ye)===Ie.type){u($,Ie.sibling),M=m(Ie,q.props),M.ref=Bl($,Ie,q),M.return=$,$=M;break e}u($,Ie);break}else o($,Ie);Ie=Ie.sibling}q.type===C?(M=Bs(q.props.children,$.mode,ie,q.key),M.return=$,$=M):(ie=dd(q.type,q.key,q.props,null,$.mode,ie),ie.ref=Bl($,M,q),ie.return=$,$=ie)}return I($);case re:e:{for(Ie=q.key;M!==null;){if(M.key===Ie)if(M.tag===4&&M.stateNode.containerInfo===q.containerInfo&&M.stateNode.implementation===q.implementation){u($,M.sibling),M=m(M,q.children||[]),M.return=$,$=M;break e}else{u($,M);break}else o($,M);M=M.sibling}M=Rp(q,$.mode,ie),M.return=$,$=M}return I($);case ee:return Ie=q._init,mt($,M,Ie(q._payload),ie)}if(zr(q))return pe($,M,q,ie);if(Ee(q))return ge($,M,q,ie);Bc($,q)}return typeof q=="string"&&q!==""||typeof q=="number"?(q=""+q,M!==null&&M.tag===6?(u($,M.sibling),M=m(M,q),M.return=$,$=M):(u($,M),M=Ap(q,$.mode,ie),M.return=$,$=M),I($)):u($,M)}return mt}var sa=tv(!0),nv=tv(!1),zc=Ni(null),$c=null,oa=null,jf=null;function Ff(){jf=oa=$c=null}function Uf(i){var o=zc.current;tt(zc),i._currentValue=o}function Bf(i,o,u){for(;i!==null;){var h=i.alternate;if((i.childLanes&o)!==o?(i.childLanes|=o,h!==null&&(h.childLanes|=o)):h!==null&&(h.childLanes&o)!==o&&(h.childLanes|=o),i===u)break;i=i.return}}function aa(i,o){$c=i,jf=oa=null,i=i.dependencies,i!==null&&i.firstContext!==null&&((i.lanes&o)!==0&&(un=!0),i.firstContext=null)}function Dn(i){var o=i._currentValue;if(jf!==i)if(i={context:i,memoizedValue:o,next:null},oa===null){if($c===null)throw Error(t(308));oa=i,$c.dependencies={lanes:0,firstContext:i}}else oa=oa.next=i;return o}var Vs=null;function zf(i){Vs===null?Vs=[i]:Vs.push(i)}function rv(i,o,u,h){var m=o.interleaved;return m===null?(u.next=u,zf(o)):(u.next=m.next,m.next=u),o.interleaved=u,ti(i,h)}function ti(i,o){i.lanes|=o;var u=i.alternate;for(u!==null&&(u.lanes|=o),u=i,i=i.return;i!==null;)i.childLanes|=o,u=i.alternate,u!==null&&(u.childLanes|=o),u=i,i=i.return;return u.tag===3?u.stateNode:null}var Oi=!1;function $f(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function iv(i,o){i=i.updateQueue,o.updateQueue===i&&(o.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function ni(i,o){return{eventTime:i,lane:o,tag:0,payload:null,callback:null,next:null}}function Li(i,o,u){var h=i.updateQueue;if(h===null)return null;if(h=h.shared,(je&2)!==0){var m=h.pending;return m===null?o.next=o:(o.next=m.next,m.next=o),h.pending=o,ti(i,u)}return m=h.interleaved,m===null?(o.next=o,zf(h)):(o.next=m.next,m.next=o),h.interleaved=o,ti(i,u)}function qc(i,o,u){if(o=o.updateQueue,o!==null&&(o=o.shared,(u&4194240)!==0)){var h=o.lanes;h&=i.pendingLanes,u|=h,o.lanes=u,Si(i,u)}}function sv(i,o){var u=i.updateQueue,h=i.alternate;if(h!==null&&(h=h.updateQueue,u===h)){var m=null,y=null;if(u=u.firstBaseUpdate,u!==null){do{var I={eventTime:u.eventTime,lane:u.lane,tag:u.tag,payload:u.payload,callback:u.callback,next:null};y===null?m=y=I:y=y.next=I,u=u.next}while(u!==null);y===null?m=y=o:y=y.next=o}else m=y=o;u={baseState:h.baseState,firstBaseUpdate:m,lastBaseUpdate:y,shared:h.shared,effects:h.effects},i.updateQueue=u;return}i=u.lastBaseUpdate,i===null?u.firstBaseUpdate=o:i.next=o,u.lastBaseUpdate=o}function Hc(i,o,u,h){var m=i.updateQueue;Oi=!1;var y=m.firstBaseUpdate,I=m.lastBaseUpdate,b=m.shared.pending;if(b!==null){m.shared.pending=null;var V=b,W=V.next;V.next=null,I===null?y=W:I.next=W,I=V;var Z=i.alternate;Z!==null&&(Z=Z.updateQueue,b=Z.lastBaseUpdate,b!==I&&(b===null?Z.firstBaseUpdate=W:b.next=W,Z.lastBaseUpdate=V))}if(y!==null){var te=m.baseState;I=0,Z=W=V=null,b=y;do{var J=b.lane,de=b.eventTime;if((h&J)===J){Z!==null&&(Z=Z.next={eventTime:de,lane:0,tag:b.tag,payload:b.payload,callback:b.callback,next:null});e:{var pe=i,ge=b;switch(J=o,de=u,ge.tag){case 1:if(pe=ge.payload,typeof pe=="function"){te=pe.call(de,te,J);break e}te=pe;break e;case 3:pe.flags=pe.flags&-65537|128;case 0:if(pe=ge.payload,J=typeof pe=="function"?pe.call(de,te,J):pe,J==null)break e;te=he({},te,J);break e;case 2:Oi=!0}}b.callback!==null&&b.lane!==0&&(i.flags|=64,J=m.effects,J===null?m.effects=[b]:J.push(b))}else de={eventTime:de,lane:J,tag:b.tag,payload:b.payload,callback:b.callback,next:null},Z===null?(W=Z=de,V=te):Z=Z.next=de,I|=J;if(b=b.next,b===null){if(b=m.shared.pending,b===null)break;J=b,b=J.next,J.next=null,m.lastBaseUpdate=J,m.shared.pending=null}}while(!0);if(Z===null&&(V=te),m.baseState=V,m.firstBaseUpdate=W,m.lastBaseUpdate=Z,o=m.shared.interleaved,o!==null){m=o;do I|=m.lane,m=m.next;while(m!==o)}else y===null&&(m.shared.lanes=0);Ms|=I,i.lanes=I,i.memoizedState=te}}function ov(i,o,u){if(i=o.effects,o.effects=null,i!==null)for(o=0;o<i.length;o++){var h=i[o],m=h.callback;if(m!==null){if(h.callback=null,h=u,typeof m!="function")throw Error(t(191,m));m.call(h)}}}var zl={},xr=Ni(zl),$l=Ni(zl),ql=Ni(zl);function Os(i){if(i===zl)throw Error(t(174));return i}function qf(i,o){switch(Je(ql,o),Je($l,i),Je(xr,zl),i=o.nodeType,i){case 9:case 11:o=(o=o.documentElement)?o.namespaceURI:Tt(null,"");break;default:i=i===8?o.parentNode:o,o=i.namespaceURI||null,i=i.tagName,o=Tt(o,i)}tt(xr),Je(xr,o)}function la(){tt(xr),tt($l),tt(ql)}function av(i){Os(ql.current);var o=Os(xr.current),u=Tt(o,i.type);o!==u&&(Je($l,i),Je(xr,u))}function Hf(i){$l.current===i&&(tt(xr),tt($l))}var lt=Ni(0);function Wc(i){for(var o=i;o!==null;){if(o.tag===13){var u=o.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||u.data==="$?"||u.data==="$!"))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}var Wf=[];function Gf(){for(var i=0;i<Wf.length;i++)Wf[i]._workInProgressVersionPrimary=null;Wf.length=0}var Gc=se.ReactCurrentDispatcher,Kf=se.ReactCurrentBatchConfig,Ls=0,ut=null,kt=null,Nt=null,Kc=!1,Hl=!1,Wl=0,AS=0;function $t(){throw Error(t(321))}function Qf(i,o){if(o===null)return!1;for(var u=0;u<o.length&&u<i.length;u++)if(!er(i[u],o[u]))return!1;return!0}function Yf(i,o,u,h,m,y){if(Ls=y,ut=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,Gc.current=i===null||i.memoizedState===null?NS:DS,i=u(h,m),Hl){y=0;do{if(Hl=!1,Wl=0,25<=y)throw Error(t(301));y+=1,Nt=kt=null,o.updateQueue=null,Gc.current=VS,i=u(h,m)}while(Hl)}if(Gc.current=Xc,o=kt!==null&&kt.next!==null,Ls=0,Nt=kt=ut=null,Kc=!1,o)throw Error(t(300));return i}function Xf(){var i=Wl!==0;return Wl=0,i}function Tr(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Nt===null?ut.memoizedState=Nt=i:Nt=Nt.next=i,Nt}function Vn(){if(kt===null){var i=ut.alternate;i=i!==null?i.memoizedState:null}else i=kt.next;var o=Nt===null?ut.memoizedState:Nt.next;if(o!==null)Nt=o,kt=i;else{if(i===null)throw Error(t(310));kt=i,i={memoizedState:kt.memoizedState,baseState:kt.baseState,baseQueue:kt.baseQueue,queue:kt.queue,next:null},Nt===null?ut.memoizedState=Nt=i:Nt=Nt.next=i}return Nt}function Gl(i,o){return typeof o=="function"?o(i):o}function Jf(i){var o=Vn(),u=o.queue;if(u===null)throw Error(t(311));u.lastRenderedReducer=i;var h=kt,m=h.baseQueue,y=u.pending;if(y!==null){if(m!==null){var I=m.next;m.next=y.next,y.next=I}h.baseQueue=m=y,u.pending=null}if(m!==null){y=m.next,h=h.baseState;var b=I=null,V=null,W=y;do{var Z=W.lane;if((Ls&Z)===Z)V!==null&&(V=V.next={lane:0,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null}),h=W.hasEagerState?W.eagerState:i(h,W.action);else{var te={lane:Z,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null};V===null?(b=V=te,I=h):V=V.next=te,ut.lanes|=Z,Ms|=Z}W=W.next}while(W!==null&&W!==y);V===null?I=h:V.next=b,er(h,o.memoizedState)||(un=!0),o.memoizedState=h,o.baseState=I,o.baseQueue=V,u.lastRenderedState=h}if(i=u.interleaved,i!==null){m=i;do y=m.lane,ut.lanes|=y,Ms|=y,m=m.next;while(m!==i)}else m===null&&(u.lanes=0);return[o.memoizedState,u.dispatch]}function Zf(i){var o=Vn(),u=o.queue;if(u===null)throw Error(t(311));u.lastRenderedReducer=i;var h=u.dispatch,m=u.pending,y=o.memoizedState;if(m!==null){u.pending=null;var I=m=m.next;do y=i(y,I.action),I=I.next;while(I!==m);er(y,o.memoizedState)||(un=!0),o.memoizedState=y,o.baseQueue===null&&(o.baseState=y),u.lastRenderedState=y}return[y,h]}function lv(){}function uv(i,o){var u=ut,h=Vn(),m=o(),y=!er(h.memoizedState,m);if(y&&(h.memoizedState=m,un=!0),h=h.queue,ep(hv.bind(null,u,h,i),[i]),h.getSnapshot!==o||y||Nt!==null&&Nt.memoizedState.tag&1){if(u.flags|=2048,Kl(9,dv.bind(null,u,h,m,o),void 0,null),Dt===null)throw Error(t(349));(Ls&30)!==0||cv(u,o,m)}return m}function cv(i,o,u){i.flags|=16384,i={getSnapshot:o,value:u},o=ut.updateQueue,o===null?(o={lastEffect:null,stores:null},ut.updateQueue=o,o.stores=[i]):(u=o.stores,u===null?o.stores=[i]:u.push(i))}function dv(i,o,u,h){o.value=u,o.getSnapshot=h,fv(o)&&pv(i)}function hv(i,o,u){return u(function(){fv(o)&&pv(i)})}function fv(i){var o=i.getSnapshot;i=i.value;try{var u=o();return!er(i,u)}catch{return!0}}function pv(i){var o=ti(i,1);o!==null&&sr(o,i,1,-1)}function mv(i){var o=Tr();return typeof i=="function"&&(i=i()),o.memoizedState=o.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Gl,lastRenderedState:i},o.queue=i,i=i.dispatch=PS.bind(null,ut,i),[o.memoizedState,i]}function Kl(i,o,u,h){return i={tag:i,create:o,destroy:u,deps:h,next:null},o=ut.updateQueue,o===null?(o={lastEffect:null,stores:null},ut.updateQueue=o,o.lastEffect=i.next=i):(u=o.lastEffect,u===null?o.lastEffect=i.next=i:(h=u.next,u.next=i,i.next=h,o.lastEffect=i)),i}function gv(){return Vn().memoizedState}function Qc(i,o,u,h){var m=Tr();ut.flags|=i,m.memoizedState=Kl(1|o,u,void 0,h===void 0?null:h)}function Yc(i,o,u,h){var m=Vn();h=h===void 0?null:h;var y=void 0;if(kt!==null){var I=kt.memoizedState;if(y=I.destroy,h!==null&&Qf(h,I.deps)){m.memoizedState=Kl(o,u,y,h);return}}ut.flags|=i,m.memoizedState=Kl(1|o,u,y,h)}function yv(i,o){return Qc(8390656,8,i,o)}function ep(i,o){return Yc(2048,8,i,o)}function vv(i,o){return Yc(4,2,i,o)}function _v(i,o){return Yc(4,4,i,o)}function wv(i,o){if(typeof o=="function")return i=i(),o(i),function(){o(null)};if(o!=null)return i=i(),o.current=i,function(){o.current=null}}function Ev(i,o,u){return u=u!=null?u.concat([i]):null,Yc(4,4,wv.bind(null,o,i),u)}function tp(){}function Iv(i,o){var u=Vn();o=o===void 0?null:o;var h=u.memoizedState;return h!==null&&o!==null&&Qf(o,h[1])?h[0]:(u.memoizedState=[i,o],i)}function xv(i,o){var u=Vn();o=o===void 0?null:o;var h=u.memoizedState;return h!==null&&o!==null&&Qf(o,h[1])?h[0]:(i=i(),u.memoizedState=[i,o],i)}function Tv(i,o,u){return(Ls&21)===0?(i.baseState&&(i.baseState=!1,un=!0),i.memoizedState=u):(er(u,o)||(u=Ss(),ut.lanes|=u,Ms|=u,i.baseState=!0),o)}function RS(i,o){var u=Ve;Ve=u!==0&&4>u?u:4,i(!0);var h=Kf.transition;Kf.transition={};try{i(!1),o()}finally{Ve=u,Kf.transition=h}}function Sv(){return Vn().memoizedState}function CS(i,o,u){var h=Ui(i);if(u={lane:h,action:u,hasEagerState:!1,eagerState:null,next:null},kv(i))bv(o,u);else if(u=rv(i,o,u,h),u!==null){var m=en();sr(u,i,h,m),Av(u,o,h)}}function PS(i,o,u){var h=Ui(i),m={lane:h,action:u,hasEagerState:!1,eagerState:null,next:null};if(kv(i))bv(o,m);else{var y=i.alternate;if(i.lanes===0&&(y===null||y.lanes===0)&&(y=o.lastRenderedReducer,y!==null))try{var I=o.lastRenderedState,b=y(I,u);if(m.hasEagerState=!0,m.eagerState=b,er(b,I)){var V=o.interleaved;V===null?(m.next=m,zf(o)):(m.next=V.next,V.next=m),o.interleaved=m;return}}catch{}finally{}u=rv(i,o,m,h),u!==null&&(m=en(),sr(u,i,h,m),Av(u,o,h))}}function kv(i){var o=i.alternate;return i===ut||o!==null&&o===ut}function bv(i,o){Hl=Kc=!0;var u=i.pending;u===null?o.next=o:(o.next=u.next,u.next=o),i.pending=o}function Av(i,o,u){if((u&4194240)!==0){var h=o.lanes;h&=i.pendingLanes,u|=h,o.lanes=u,Si(i,u)}}var Xc={readContext:Dn,useCallback:$t,useContext:$t,useEffect:$t,useImperativeHandle:$t,useInsertionEffect:$t,useLayoutEffect:$t,useMemo:$t,useReducer:$t,useRef:$t,useState:$t,useDebugValue:$t,useDeferredValue:$t,useTransition:$t,useMutableSource:$t,useSyncExternalStore:$t,useId:$t,unstable_isNewReconciler:!1},NS={readContext:Dn,useCallback:function(i,o){return Tr().memoizedState=[i,o===void 0?null:o],i},useContext:Dn,useEffect:yv,useImperativeHandle:function(i,o,u){return u=u!=null?u.concat([i]):null,Qc(4194308,4,wv.bind(null,o,i),u)},useLayoutEffect:function(i,o){return Qc(4194308,4,i,o)},useInsertionEffect:function(i,o){return Qc(4,2,i,o)},useMemo:function(i,o){var u=Tr();return o=o===void 0?null:o,i=i(),u.memoizedState=[i,o],i},useReducer:function(i,o,u){var h=Tr();return o=u!==void 0?u(o):o,h.memoizedState=h.baseState=o,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:o},h.queue=i,i=i.dispatch=CS.bind(null,ut,i),[h.memoizedState,i]},useRef:function(i){var o=Tr();return i={current:i},o.memoizedState=i},useState:mv,useDebugValue:tp,useDeferredValue:function(i){return Tr().memoizedState=i},useTransition:function(){var i=mv(!1),o=i[0];return i=RS.bind(null,i[1]),Tr().memoizedState=i,[o,i]},useMutableSource:function(){},useSyncExternalStore:function(i,o,u){var h=ut,m=Tr();if(it){if(u===void 0)throw Error(t(407));u=u()}else{if(u=o(),Dt===null)throw Error(t(349));(Ls&30)!==0||cv(h,o,u)}m.memoizedState=u;var y={value:u,getSnapshot:o};return m.queue=y,yv(hv.bind(null,h,y,i),[i]),h.flags|=2048,Kl(9,dv.bind(null,h,y,u,o),void 0,null),u},useId:function(){var i=Tr(),o=Dt.identifierPrefix;if(it){var u=ei,h=Zr;u=(h&~(1<<32-Xt(h)-1)).toString(32)+u,o=":"+o+"R"+u,u=Wl++,0<u&&(o+="H"+u.toString(32)),o+=":"}else u=AS++,o=":"+o+"r"+u.toString(32)+":";return i.memoizedState=o},unstable_isNewReconciler:!1},DS={readContext:Dn,useCallback:Iv,useContext:Dn,useEffect:ep,useImperativeHandle:Ev,useInsertionEffect:vv,useLayoutEffect:_v,useMemo:xv,useReducer:Jf,useRef:gv,useState:function(){return Jf(Gl)},useDebugValue:tp,useDeferredValue:function(i){var o=Vn();return Tv(o,kt.memoizedState,i)},useTransition:function(){var i=Jf(Gl)[0],o=Vn().memoizedState;return[i,o]},useMutableSource:lv,useSyncExternalStore:uv,useId:Sv,unstable_isNewReconciler:!1},VS={readContext:Dn,useCallback:Iv,useContext:Dn,useEffect:ep,useImperativeHandle:Ev,useInsertionEffect:vv,useLayoutEffect:_v,useMemo:xv,useReducer:Zf,useRef:gv,useState:function(){return Zf(Gl)},useDebugValue:tp,useDeferredValue:function(i){var o=Vn();return kt===null?o.memoizedState=i:Tv(o,kt.memoizedState,i)},useTransition:function(){var i=Zf(Gl)[0],o=Vn().memoizedState;return[i,o]},useMutableSource:lv,useSyncExternalStore:uv,useId:Sv,unstable_isNewReconciler:!1};function nr(i,o){if(i&&i.defaultProps){o=he({},o),i=i.defaultProps;for(var u in i)o[u]===void 0&&(o[u]=i[u]);return o}return o}function np(i,o,u,h){o=i.memoizedState,u=u(h,o),u=u==null?o:he({},o,u),i.memoizedState=u,i.lanes===0&&(i.updateQueue.baseState=u)}var Jc={isMounted:function(i){return(i=i._reactInternals)?Gn(i)===i:!1},enqueueSetState:function(i,o,u){i=i._reactInternals;var h=en(),m=Ui(i),y=ni(h,m);y.payload=o,u!=null&&(y.callback=u),o=Li(i,y,m),o!==null&&(sr(o,i,m,h),qc(o,i,m))},enqueueReplaceState:function(i,o,u){i=i._reactInternals;var h=en(),m=Ui(i),y=ni(h,m);y.tag=1,y.payload=o,u!=null&&(y.callback=u),o=Li(i,y,m),o!==null&&(sr(o,i,m,h),qc(o,i,m))},enqueueForceUpdate:function(i,o){i=i._reactInternals;var u=en(),h=Ui(i),m=ni(u,h);m.tag=2,o!=null&&(m.callback=o),o=Li(i,m,h),o!==null&&(sr(o,i,h,u),qc(o,i,h))}};function Rv(i,o,u,h,m,y,I){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(h,y,I):o.prototype&&o.prototype.isPureReactComponent?!Vl(u,h)||!Vl(m,y):!0}function Cv(i,o,u){var h=!1,m=Di,y=o.contextType;return typeof y=="object"&&y!==null?y=Dn(y):(m=ln(o)?Ps:zt.current,h=o.contextTypes,y=(h=h!=null)?ta(i,m):Di),o=new o(u,y),i.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,o.updater=Jc,i.stateNode=o,o._reactInternals=i,h&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=m,i.__reactInternalMemoizedMaskedChildContext=y),o}function Pv(i,o,u,h){i=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(u,h),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(u,h),o.state!==i&&Jc.enqueueReplaceState(o,o.state,null)}function rp(i,o,u,h){var m=i.stateNode;m.props=u,m.state=i.memoizedState,m.refs={},$f(i);var y=o.contextType;typeof y=="object"&&y!==null?m.context=Dn(y):(y=ln(o)?Ps:zt.current,m.context=ta(i,y)),m.state=i.memoizedState,y=o.getDerivedStateFromProps,typeof y=="function"&&(np(i,o,y,u),m.state=i.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(o=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),o!==m.state&&Jc.enqueueReplaceState(m,m.state,null),Hc(i,u,m,h),m.state=i.memoizedState),typeof m.componentDidMount=="function"&&(i.flags|=4194308)}function ua(i,o){try{var u="",h=o;do u+=Ce(h),h=h.return;while(h);var m=u}catch(y){m=`
Error generating stack: `+y.message+`
`+y.stack}return{value:i,source:o,stack:m,digest:null}}function ip(i,o,u){return{value:i,source:null,stack:u??null,digest:o??null}}function sp(i,o){try{console.error(o.value)}catch(u){setTimeout(function(){throw u})}}var OS=typeof WeakMap=="function"?WeakMap:Map;function Nv(i,o,u){u=ni(-1,u),u.tag=3,u.payload={element:null};var h=o.value;return u.callback=function(){sd||(sd=!0,wp=h),sp(i,o)},u}function Dv(i,o,u){u=ni(-1,u),u.tag=3;var h=i.type.getDerivedStateFromError;if(typeof h=="function"){var m=o.value;u.payload=function(){return h(m)},u.callback=function(){sp(i,o)}}var y=i.stateNode;return y!==null&&typeof y.componentDidCatch=="function"&&(u.callback=function(){sp(i,o),typeof h!="function"&&(ji===null?ji=new Set([this]):ji.add(this));var I=o.stack;this.componentDidCatch(o.value,{componentStack:I!==null?I:""})}),u}function Vv(i,o,u){var h=i.pingCache;if(h===null){h=i.pingCache=new OS;var m=new Set;h.set(o,m)}else m=h.get(o),m===void 0&&(m=new Set,h.set(o,m));m.has(u)||(m.add(u),i=QS.bind(null,i,o,u),o.then(i,i))}function Ov(i){do{var o;if((o=i.tag===13)&&(o=i.memoizedState,o=o!==null?o.dehydrated!==null:!0),o)return i;i=i.return}while(i!==null);return null}function Lv(i,o,u,h,m){return(i.mode&1)===0?(i===o?i.flags|=65536:(i.flags|=128,u.flags|=131072,u.flags&=-52805,u.tag===1&&(u.alternate===null?u.tag=17:(o=ni(-1,1),o.tag=2,Li(u,o,1))),u.lanes|=1),i):(i.flags|=65536,i.lanes=m,i)}var LS=se.ReactCurrentOwner,un=!1;function Zt(i,o,u,h){o.child=i===null?nv(o,null,u,h):sa(o,i.child,u,h)}function Mv(i,o,u,h,m){u=u.render;var y=o.ref;return aa(o,m),h=Yf(i,o,u,h,y,m),u=Xf(),i!==null&&!un?(o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~m,ri(i,o,m)):(it&&u&&Df(o),o.flags|=1,Zt(i,o,h,m),o.child)}function jv(i,o,u,h,m){if(i===null){var y=u.type;return typeof y=="function"&&!bp(y)&&y.defaultProps===void 0&&u.compare===null&&u.defaultProps===void 0?(o.tag=15,o.type=y,Fv(i,o,y,h,m)):(i=dd(u.type,null,h,o,o.mode,m),i.ref=o.ref,i.return=o,o.child=i)}if(y=i.child,(i.lanes&m)===0){var I=y.memoizedProps;if(u=u.compare,u=u!==null?u:Vl,u(I,h)&&i.ref===o.ref)return ri(i,o,m)}return o.flags|=1,i=zi(y,h),i.ref=o.ref,i.return=o,o.child=i}function Fv(i,o,u,h,m){if(i!==null){var y=i.memoizedProps;if(Vl(y,h)&&i.ref===o.ref)if(un=!1,o.pendingProps=h=y,(i.lanes&m)!==0)(i.flags&131072)!==0&&(un=!0);else return o.lanes=i.lanes,ri(i,o,m)}return op(i,o,u,h,m)}function Uv(i,o,u){var h=o.pendingProps,m=h.children,y=i!==null?i.memoizedState:null;if(h.mode==="hidden")if((o.mode&1)===0)o.memoizedState={baseLanes:0,cachePool:null,transitions:null},Je(da,En),En|=u;else{if((u&1073741824)===0)return i=y!==null?y.baseLanes|u:u,o.lanes=o.childLanes=1073741824,o.memoizedState={baseLanes:i,cachePool:null,transitions:null},o.updateQueue=null,Je(da,En),En|=i,null;o.memoizedState={baseLanes:0,cachePool:null,transitions:null},h=y!==null?y.baseLanes:u,Je(da,En),En|=h}else y!==null?(h=y.baseLanes|u,o.memoizedState=null):h=u,Je(da,En),En|=h;return Zt(i,o,m,u),o.child}function Bv(i,o){var u=o.ref;(i===null&&u!==null||i!==null&&i.ref!==u)&&(o.flags|=512,o.flags|=2097152)}function op(i,o,u,h,m){var y=ln(u)?Ps:zt.current;return y=ta(o,y),aa(o,m),u=Yf(i,o,u,h,y,m),h=Xf(),i!==null&&!un?(o.updateQueue=i.updateQueue,o.flags&=-2053,i.lanes&=~m,ri(i,o,m)):(it&&h&&Df(o),o.flags|=1,Zt(i,o,u,m),o.child)}function zv(i,o,u,h,m){if(ln(u)){var y=!0;Lc(o)}else y=!1;if(aa(o,m),o.stateNode===null)ed(i,o),Cv(o,u,h),rp(o,u,h,m),h=!0;else if(i===null){var I=o.stateNode,b=o.memoizedProps;I.props=b;var V=I.context,W=u.contextType;typeof W=="object"&&W!==null?W=Dn(W):(W=ln(u)?Ps:zt.current,W=ta(o,W));var Z=u.getDerivedStateFromProps,te=typeof Z=="function"||typeof I.getSnapshotBeforeUpdate=="function";te||typeof I.UNSAFE_componentWillReceiveProps!="function"&&typeof I.componentWillReceiveProps!="function"||(b!==h||V!==W)&&Pv(o,I,h,W),Oi=!1;var J=o.memoizedState;I.state=J,Hc(o,h,I,m),V=o.memoizedState,b!==h||J!==V||an.current||Oi?(typeof Z=="function"&&(np(o,u,Z,h),V=o.memoizedState),(b=Oi||Rv(o,u,b,h,J,V,W))?(te||typeof I.UNSAFE_componentWillMount!="function"&&typeof I.componentWillMount!="function"||(typeof I.componentWillMount=="function"&&I.componentWillMount(),typeof I.UNSAFE_componentWillMount=="function"&&I.UNSAFE_componentWillMount()),typeof I.componentDidMount=="function"&&(o.flags|=4194308)):(typeof I.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=h,o.memoizedState=V),I.props=h,I.state=V,I.context=W,h=b):(typeof I.componentDidMount=="function"&&(o.flags|=4194308),h=!1)}else{I=o.stateNode,iv(i,o),b=o.memoizedProps,W=o.type===o.elementType?b:nr(o.type,b),I.props=W,te=o.pendingProps,J=I.context,V=u.contextType,typeof V=="object"&&V!==null?V=Dn(V):(V=ln(u)?Ps:zt.current,V=ta(o,V));var de=u.getDerivedStateFromProps;(Z=typeof de=="function"||typeof I.getSnapshotBeforeUpdate=="function")||typeof I.UNSAFE_componentWillReceiveProps!="function"&&typeof I.componentWillReceiveProps!="function"||(b!==te||J!==V)&&Pv(o,I,h,V),Oi=!1,J=o.memoizedState,I.state=J,Hc(o,h,I,m);var pe=o.memoizedState;b!==te||J!==pe||an.current||Oi?(typeof de=="function"&&(np(o,u,de,h),pe=o.memoizedState),(W=Oi||Rv(o,u,W,h,J,pe,V)||!1)?(Z||typeof I.UNSAFE_componentWillUpdate!="function"&&typeof I.componentWillUpdate!="function"||(typeof I.componentWillUpdate=="function"&&I.componentWillUpdate(h,pe,V),typeof I.UNSAFE_componentWillUpdate=="function"&&I.UNSAFE_componentWillUpdate(h,pe,V)),typeof I.componentDidUpdate=="function"&&(o.flags|=4),typeof I.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof I.componentDidUpdate!="function"||b===i.memoizedProps&&J===i.memoizedState||(o.flags|=4),typeof I.getSnapshotBeforeUpdate!="function"||b===i.memoizedProps&&J===i.memoizedState||(o.flags|=1024),o.memoizedProps=h,o.memoizedState=pe),I.props=h,I.state=pe,I.context=V,h=W):(typeof I.componentDidUpdate!="function"||b===i.memoizedProps&&J===i.memoizedState||(o.flags|=4),typeof I.getSnapshotBeforeUpdate!="function"||b===i.memoizedProps&&J===i.memoizedState||(o.flags|=1024),h=!1)}return ap(i,o,u,h,y,m)}function ap(i,o,u,h,m,y){Bv(i,o);var I=(o.flags&128)!==0;if(!h&&!I)return m&&Gy(o,u,!1),ri(i,o,y);h=o.stateNode,LS.current=o;var b=I&&typeof u.getDerivedStateFromError!="function"?null:h.render();return o.flags|=1,i!==null&&I?(o.child=sa(o,i.child,null,y),o.child=sa(o,null,b,y)):Zt(i,o,b,y),o.memoizedState=h.state,m&&Gy(o,u,!0),o.child}function $v(i){var o=i.stateNode;o.pendingContext?Hy(i,o.pendingContext,o.pendingContext!==o.context):o.context&&Hy(i,o.context,!1),qf(i,o.containerInfo)}function qv(i,o,u,h,m){return ia(),Mf(m),o.flags|=256,Zt(i,o,u,h),o.child}var lp={dehydrated:null,treeContext:null,retryLane:0};function up(i){return{baseLanes:i,cachePool:null,transitions:null}}function Hv(i,o,u){var h=o.pendingProps,m=lt.current,y=!1,I=(o.flags&128)!==0,b;if((b=I)||(b=i!==null&&i.memoizedState===null?!1:(m&2)!==0),b?(y=!0,o.flags&=-129):(i===null||i.memoizedState!==null)&&(m|=1),Je(lt,m&1),i===null)return Lf(o),i=o.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?((o.mode&1)===0?o.lanes=1:i.data==="$!"?o.lanes=8:o.lanes=1073741824,null):(I=h.children,i=h.fallback,y?(h=o.mode,y=o.child,I={mode:"hidden",children:I},(h&1)===0&&y!==null?(y.childLanes=0,y.pendingProps=I):y=hd(I,h,0,null),i=Bs(i,h,u,null),y.return=o,i.return=o,y.sibling=i,o.child=y,o.child.memoizedState=up(u),o.memoizedState=lp,i):cp(o,I));if(m=i.memoizedState,m!==null&&(b=m.dehydrated,b!==null))return MS(i,o,I,h,b,m,u);if(y){y=h.fallback,I=o.mode,m=i.child,b=m.sibling;var V={mode:"hidden",children:h.children};return(I&1)===0&&o.child!==m?(h=o.child,h.childLanes=0,h.pendingProps=V,o.deletions=null):(h=zi(m,V),h.subtreeFlags=m.subtreeFlags&14680064),b!==null?y=zi(b,y):(y=Bs(y,I,u,null),y.flags|=2),y.return=o,h.return=o,h.sibling=y,o.child=h,h=y,y=o.child,I=i.child.memoizedState,I=I===null?up(u):{baseLanes:I.baseLanes|u,cachePool:null,transitions:I.transitions},y.memoizedState=I,y.childLanes=i.childLanes&~u,o.memoizedState=lp,h}return y=i.child,i=y.sibling,h=zi(y,{mode:"visible",children:h.children}),(o.mode&1)===0&&(h.lanes=u),h.return=o,h.sibling=null,i!==null&&(u=o.deletions,u===null?(o.deletions=[i],o.flags|=16):u.push(i)),o.child=h,o.memoizedState=null,h}function cp(i,o){return o=hd({mode:"visible",children:o},i.mode,0,null),o.return=i,i.child=o}function Zc(i,o,u,h){return h!==null&&Mf(h),sa(o,i.child,null,u),i=cp(o,o.pendingProps.children),i.flags|=2,o.memoizedState=null,i}function MS(i,o,u,h,m,y,I){if(u)return o.flags&256?(o.flags&=-257,h=ip(Error(t(422))),Zc(i,o,I,h)):o.memoizedState!==null?(o.child=i.child,o.flags|=128,null):(y=h.fallback,m=o.mode,h=hd({mode:"visible",children:h.children},m,0,null),y=Bs(y,m,I,null),y.flags|=2,h.return=o,y.return=o,h.sibling=y,o.child=h,(o.mode&1)!==0&&sa(o,i.child,null,I),o.child.memoizedState=up(I),o.memoizedState=lp,y);if((o.mode&1)===0)return Zc(i,o,I,null);if(m.data==="$!"){if(h=m.nextSibling&&m.nextSibling.dataset,h)var b=h.dgst;return h=b,y=Error(t(419)),h=ip(y,h,void 0),Zc(i,o,I,h)}if(b=(I&i.childLanes)!==0,un||b){if(h=Dt,h!==null){switch(I&-I){case 4:m=2;break;case 16:m=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:m=32;break;case 536870912:m=268435456;break;default:m=0}m=(m&(h.suspendedLanes|I))!==0?0:m,m!==0&&m!==y.retryLane&&(y.retryLane=m,ti(i,m),sr(h,i,m,-1))}return kp(),h=ip(Error(t(421))),Zc(i,o,I,h)}return m.data==="$?"?(o.flags|=128,o.child=i.child,o=YS.bind(null,i),m._reactRetry=o,null):(i=y.treeContext,wn=Pi(m.nextSibling),_n=o,it=!0,tr=null,i!==null&&(Pn[Nn++]=Zr,Pn[Nn++]=ei,Pn[Nn++]=Ns,Zr=i.id,ei=i.overflow,Ns=o),o=cp(o,h.children),o.flags|=4096,o)}function Wv(i,o,u){i.lanes|=o;var h=i.alternate;h!==null&&(h.lanes|=o),Bf(i.return,o,u)}function dp(i,o,u,h,m){var y=i.memoizedState;y===null?i.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:h,tail:u,tailMode:m}:(y.isBackwards=o,y.rendering=null,y.renderingStartTime=0,y.last=h,y.tail=u,y.tailMode=m)}function Gv(i,o,u){var h=o.pendingProps,m=h.revealOrder,y=h.tail;if(Zt(i,o,h.children,u),h=lt.current,(h&2)!==0)h=h&1|2,o.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=o.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&Wv(i,u,o);else if(i.tag===19)Wv(i,u,o);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===o)break e;for(;i.sibling===null;){if(i.return===null||i.return===o)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}h&=1}if(Je(lt,h),(o.mode&1)===0)o.memoizedState=null;else switch(m){case"forwards":for(u=o.child,m=null;u!==null;)i=u.alternate,i!==null&&Wc(i)===null&&(m=u),u=u.sibling;u=m,u===null?(m=o.child,o.child=null):(m=u.sibling,u.sibling=null),dp(o,!1,m,u,y);break;case"backwards":for(u=null,m=o.child,o.child=null;m!==null;){if(i=m.alternate,i!==null&&Wc(i)===null){o.child=m;break}i=m.sibling,m.sibling=u,u=m,m=i}dp(o,!0,u,null,y);break;case"together":dp(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function ed(i,o){(o.mode&1)===0&&i!==null&&(i.alternate=null,o.alternate=null,o.flags|=2)}function ri(i,o,u){if(i!==null&&(o.dependencies=i.dependencies),Ms|=o.lanes,(u&o.childLanes)===0)return null;if(i!==null&&o.child!==i.child)throw Error(t(153));if(o.child!==null){for(i=o.child,u=zi(i,i.pendingProps),o.child=u,u.return=o;i.sibling!==null;)i=i.sibling,u=u.sibling=zi(i,i.pendingProps),u.return=o;u.sibling=null}return o.child}function jS(i,o,u){switch(o.tag){case 3:$v(o),ia();break;case 5:av(o);break;case 1:ln(o.type)&&Lc(o);break;case 4:qf(o,o.stateNode.containerInfo);break;case 10:var h=o.type._context,m=o.memoizedProps.value;Je(zc,h._currentValue),h._currentValue=m;break;case 13:if(h=o.memoizedState,h!==null)return h.dehydrated!==null?(Je(lt,lt.current&1),o.flags|=128,null):(u&o.child.childLanes)!==0?Hv(i,o,u):(Je(lt,lt.current&1),i=ri(i,o,u),i!==null?i.sibling:null);Je(lt,lt.current&1);break;case 19:if(h=(u&o.childLanes)!==0,(i.flags&128)!==0){if(h)return Gv(i,o,u);o.flags|=128}if(m=o.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),Je(lt,lt.current),h)break;return null;case 22:case 23:return o.lanes=0,Uv(i,o,u)}return ri(i,o,u)}var Kv,hp,Qv,Yv;Kv=function(i,o){for(var u=o.child;u!==null;){if(u.tag===5||u.tag===6)i.appendChild(u.stateNode);else if(u.tag!==4&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===o)break;for(;u.sibling===null;){if(u.return===null||u.return===o)return;u=u.return}u.sibling.return=u.return,u=u.sibling}},hp=function(){},Qv=function(i,o,u,h){var m=i.memoizedProps;if(m!==h){i=o.stateNode,Os(xr.current);var y=null;switch(u){case"input":m=ps(i,m),h=ps(i,h),y=[];break;case"select":m=he({},m,{value:void 0}),h=he({},h,{value:void 0}),y=[];break;case"textarea":m=ul(i,m),h=ul(i,h),y=[];break;default:typeof m.onClick!="function"&&typeof h.onClick=="function"&&(i.onclick=Dc)}ml(u,h);var I;u=null;for(W in m)if(!h.hasOwnProperty(W)&&m.hasOwnProperty(W)&&m[W]!=null)if(W==="style"){var b=m[W];for(I in b)b.hasOwnProperty(I)&&(u||(u={}),u[I]="")}else W!=="dangerouslySetInnerHTML"&&W!=="children"&&W!=="suppressContentEditableWarning"&&W!=="suppressHydrationWarning"&&W!=="autoFocus"&&(s.hasOwnProperty(W)?y||(y=[]):(y=y||[]).push(W,null));for(W in h){var V=h[W];if(b=m!=null?m[W]:void 0,h.hasOwnProperty(W)&&V!==b&&(V!=null||b!=null))if(W==="style")if(b){for(I in b)!b.hasOwnProperty(I)||V&&V.hasOwnProperty(I)||(u||(u={}),u[I]="");for(I in V)V.hasOwnProperty(I)&&b[I]!==V[I]&&(u||(u={}),u[I]=V[I])}else u||(y||(y=[]),y.push(W,u)),u=V;else W==="dangerouslySetInnerHTML"?(V=V?V.__html:void 0,b=b?b.__html:void 0,V!=null&&b!==V&&(y=y||[]).push(W,V)):W==="children"?typeof V!="string"&&typeof V!="number"||(y=y||[]).push(W,""+V):W!=="suppressContentEditableWarning"&&W!=="suppressHydrationWarning"&&(s.hasOwnProperty(W)?(V!=null&&W==="onScroll"&&et("scroll",i),y||b===V||(y=[])):(y=y||[]).push(W,V))}u&&(y=y||[]).push("style",u);var W=y;(o.updateQueue=W)&&(o.flags|=4)}},Yv=function(i,o,u,h){u!==h&&(o.flags|=4)};function Ql(i,o){if(!it)switch(i.tailMode){case"hidden":o=i.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?i.tail=null:u.sibling=null;break;case"collapsed":u=i.tail;for(var h=null;u!==null;)u.alternate!==null&&(h=u),u=u.sibling;h===null?o||i.tail===null?i.tail=null:i.tail.sibling=null:h.sibling=null}}function qt(i){var o=i.alternate!==null&&i.alternate.child===i.child,u=0,h=0;if(o)for(var m=i.child;m!==null;)u|=m.lanes|m.childLanes,h|=m.subtreeFlags&14680064,h|=m.flags&14680064,m.return=i,m=m.sibling;else for(m=i.child;m!==null;)u|=m.lanes|m.childLanes,h|=m.subtreeFlags,h|=m.flags,m.return=i,m=m.sibling;return i.subtreeFlags|=h,i.childLanes=u,o}function FS(i,o,u){var h=o.pendingProps;switch(Vf(o),o.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qt(o),null;case 1:return ln(o.type)&&Oc(),qt(o),null;case 3:return h=o.stateNode,la(),tt(an),tt(zt),Gf(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(i===null||i.child===null)&&(Uc(o)?o.flags|=4:i===null||i.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,tr!==null&&(xp(tr),tr=null))),hp(i,o),qt(o),null;case 5:Hf(o);var m=Os(ql.current);if(u=o.type,i!==null&&o.stateNode!=null)Qv(i,o,u,h,m),i.ref!==o.ref&&(o.flags|=512,o.flags|=2097152);else{if(!h){if(o.stateNode===null)throw Error(t(166));return qt(o),null}if(i=Os(xr.current),Uc(o)){h=o.stateNode,u=o.type;var y=o.memoizedProps;switch(h[Ir]=o,h[Fl]=y,i=(o.mode&1)!==0,u){case"dialog":et("cancel",h),et("close",h);break;case"iframe":case"object":case"embed":et("load",h);break;case"video":case"audio":for(m=0;m<Ll.length;m++)et(Ll[m],h);break;case"source":et("error",h);break;case"img":case"image":case"link":et("error",h),et("load",h);break;case"details":et("toggle",h);break;case"input":xo(h,y),et("invalid",h);break;case"select":h._wrapperState={wasMultiple:!!y.multiple},et("invalid",h);break;case"textarea":So(h,y),et("invalid",h)}ml(u,y),m=null;for(var I in y)if(y.hasOwnProperty(I)){var b=y[I];I==="children"?typeof b=="string"?h.textContent!==b&&(y.suppressHydrationWarning!==!0&&Nc(h.textContent,b,i),m=["children",b]):typeof b=="number"&&h.textContent!==""+b&&(y.suppressHydrationWarning!==!0&&Nc(h.textContent,b,i),m=["children",""+b]):s.hasOwnProperty(I)&&b!=null&&I==="onScroll"&&et("scroll",h)}switch(u){case"input":Br(h),ic(h,y,!0);break;case"textarea":Br(h),cl(h);break;case"select":case"option":break;default:typeof y.onClick=="function"&&(h.onclick=Dc)}h=m,o.updateQueue=h,h!==null&&(o.flags|=4)}else{I=m.nodeType===9?m:m.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=xt(u)),i==="http://www.w3.org/1999/xhtml"?u==="script"?(i=I.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof h.is=="string"?i=I.createElement(u,{is:h.is}):(i=I.createElement(u),u==="select"&&(I=i,h.multiple?I.multiple=!0:h.size&&(I.size=h.size))):i=I.createElementNS(i,u),i[Ir]=o,i[Fl]=h,Kv(i,o,!1,!1),o.stateNode=i;e:{switch(I=gl(u,h),u){case"dialog":et("cancel",i),et("close",i),m=h;break;case"iframe":case"object":case"embed":et("load",i),m=h;break;case"video":case"audio":for(m=0;m<Ll.length;m++)et(Ll[m],i);m=h;break;case"source":et("error",i),m=h;break;case"img":case"image":case"link":et("error",i),et("load",i),m=h;break;case"details":et("toggle",i),m=h;break;case"input":xo(i,h),m=ps(i,h),et("invalid",i);break;case"option":m=h;break;case"select":i._wrapperState={wasMultiple:!!h.multiple},m=he({},h,{value:void 0}),et("invalid",i);break;case"textarea":So(i,h),m=ul(i,h),et("invalid",i);break;default:m=h}ml(u,m),b=m;for(y in b)if(b.hasOwnProperty(y)){var V=b[y];y==="style"?fl(i,V):y==="dangerouslySetInnerHTML"?(V=V?V.__html:void 0,V!=null&&dl(i,V)):y==="children"?typeof V=="string"?(u!=="textarea"||V!=="")&&wi(i,V):typeof V=="number"&&wi(i,""+V):y!=="suppressContentEditableWarning"&&y!=="suppressHydrationWarning"&&y!=="autoFocus"&&(s.hasOwnProperty(y)?V!=null&&y==="onScroll"&&et("scroll",i):V!=null&&H(i,y,V,I))}switch(u){case"input":Br(i),ic(i,h,!1);break;case"textarea":Br(i),cl(i);break;case"option":h.value!=null&&i.setAttribute("value",""+ze(h.value));break;case"select":i.multiple=!!h.multiple,y=h.value,y!=null?$r(i,!!h.multiple,y,!1):h.defaultValue!=null&&$r(i,!!h.multiple,h.defaultValue,!0);break;default:typeof m.onClick=="function"&&(i.onclick=Dc)}switch(u){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break e;case"img":h=!0;break e;default:h=!1}}h&&(o.flags|=4)}o.ref!==null&&(o.flags|=512,o.flags|=2097152)}return qt(o),null;case 6:if(i&&o.stateNode!=null)Yv(i,o,i.memoizedProps,h);else{if(typeof h!="string"&&o.stateNode===null)throw Error(t(166));if(u=Os(ql.current),Os(xr.current),Uc(o)){if(h=o.stateNode,u=o.memoizedProps,h[Ir]=o,(y=h.nodeValue!==u)&&(i=_n,i!==null))switch(i.tag){case 3:Nc(h.nodeValue,u,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&Nc(h.nodeValue,u,(i.mode&1)!==0)}y&&(o.flags|=4)}else h=(u.nodeType===9?u:u.ownerDocument).createTextNode(h),h[Ir]=o,o.stateNode=h}return qt(o),null;case 13:if(tt(lt),h=o.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(it&&wn!==null&&(o.mode&1)!==0&&(o.flags&128)===0)Zy(),ia(),o.flags|=98560,y=!1;else if(y=Uc(o),h!==null&&h.dehydrated!==null){if(i===null){if(!y)throw Error(t(318));if(y=o.memoizedState,y=y!==null?y.dehydrated:null,!y)throw Error(t(317));y[Ir]=o}else ia(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;qt(o),y=!1}else tr!==null&&(xp(tr),tr=null),y=!0;if(!y)return o.flags&65536?o:null}return(o.flags&128)!==0?(o.lanes=u,o):(h=h!==null,h!==(i!==null&&i.memoizedState!==null)&&h&&(o.child.flags|=8192,(o.mode&1)!==0&&(i===null||(lt.current&1)!==0?bt===0&&(bt=3):kp())),o.updateQueue!==null&&(o.flags|=4),qt(o),null);case 4:return la(),hp(i,o),i===null&&Ml(o.stateNode.containerInfo),qt(o),null;case 10:return Uf(o.type._context),qt(o),null;case 17:return ln(o.type)&&Oc(),qt(o),null;case 19:if(tt(lt),y=o.memoizedState,y===null)return qt(o),null;if(h=(o.flags&128)!==0,I=y.rendering,I===null)if(h)Ql(y,!1);else{if(bt!==0||i!==null&&(i.flags&128)!==0)for(i=o.child;i!==null;){if(I=Wc(i),I!==null){for(o.flags|=128,Ql(y,!1),h=I.updateQueue,h!==null&&(o.updateQueue=h,o.flags|=4),o.subtreeFlags=0,h=u,u=o.child;u!==null;)y=u,i=h,y.flags&=14680066,I=y.alternate,I===null?(y.childLanes=0,y.lanes=i,y.child=null,y.subtreeFlags=0,y.memoizedProps=null,y.memoizedState=null,y.updateQueue=null,y.dependencies=null,y.stateNode=null):(y.childLanes=I.childLanes,y.lanes=I.lanes,y.child=I.child,y.subtreeFlags=0,y.deletions=null,y.memoizedProps=I.memoizedProps,y.memoizedState=I.memoizedState,y.updateQueue=I.updateQueue,y.type=I.type,i=I.dependencies,y.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),u=u.sibling;return Je(lt,lt.current&1|2),o.child}i=i.sibling}y.tail!==null&&Xe()>ha&&(o.flags|=128,h=!0,Ql(y,!1),o.lanes=4194304)}else{if(!h)if(i=Wc(I),i!==null){if(o.flags|=128,h=!0,u=i.updateQueue,u!==null&&(o.updateQueue=u,o.flags|=4),Ql(y,!0),y.tail===null&&y.tailMode==="hidden"&&!I.alternate&&!it)return qt(o),null}else 2*Xe()-y.renderingStartTime>ha&&u!==1073741824&&(o.flags|=128,h=!0,Ql(y,!1),o.lanes=4194304);y.isBackwards?(I.sibling=o.child,o.child=I):(u=y.last,u!==null?u.sibling=I:o.child=I,y.last=I)}return y.tail!==null?(o=y.tail,y.rendering=o,y.tail=o.sibling,y.renderingStartTime=Xe(),o.sibling=null,u=lt.current,Je(lt,h?u&1|2:u&1),o):(qt(o),null);case 22:case 23:return Sp(),h=o.memoizedState!==null,i!==null&&i.memoizedState!==null!==h&&(o.flags|=8192),h&&(o.mode&1)!==0?(En&1073741824)!==0&&(qt(o),o.subtreeFlags&6&&(o.flags|=8192)):qt(o),null;case 24:return null;case 25:return null}throw Error(t(156,o.tag))}function US(i,o){switch(Vf(o),o.tag){case 1:return ln(o.type)&&Oc(),i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 3:return la(),tt(an),tt(zt),Gf(),i=o.flags,(i&65536)!==0&&(i&128)===0?(o.flags=i&-65537|128,o):null;case 5:return Hf(o),null;case 13:if(tt(lt),i=o.memoizedState,i!==null&&i.dehydrated!==null){if(o.alternate===null)throw Error(t(340));ia()}return i=o.flags,i&65536?(o.flags=i&-65537|128,o):null;case 19:return tt(lt),null;case 4:return la(),null;case 10:return Uf(o.type._context),null;case 22:case 23:return Sp(),null;case 24:return null;default:return null}}var td=!1,Ht=!1,BS=typeof WeakSet=="function"?WeakSet:Set,fe=null;function ca(i,o){var u=i.ref;if(u!==null)if(typeof u=="function")try{u(null)}catch(h){dt(i,o,h)}else u.current=null}function fp(i,o,u){try{u()}catch(h){dt(i,o,h)}}var Xv=!1;function zS(i,o){if(Sf=Ai,i=Ry(),yf(i)){if("selectionStart"in i)var u={start:i.selectionStart,end:i.selectionEnd};else e:{u=(u=i.ownerDocument)&&u.defaultView||window;var h=u.getSelection&&u.getSelection();if(h&&h.rangeCount!==0){u=h.anchorNode;var m=h.anchorOffset,y=h.focusNode;h=h.focusOffset;try{u.nodeType,y.nodeType}catch{u=null;break e}var I=0,b=-1,V=-1,W=0,Z=0,te=i,J=null;t:for(;;){for(var de;te!==u||m!==0&&te.nodeType!==3||(b=I+m),te!==y||h!==0&&te.nodeType!==3||(V=I+h),te.nodeType===3&&(I+=te.nodeValue.length),(de=te.firstChild)!==null;)J=te,te=de;for(;;){if(te===i)break t;if(J===u&&++W===m&&(b=I),J===y&&++Z===h&&(V=I),(de=te.nextSibling)!==null)break;te=J,J=te.parentNode}te=de}u=b===-1||V===-1?null:{start:b,end:V}}else u=null}u=u||{start:0,end:0}}else u=null;for(kf={focusedElem:i,selectionRange:u},Ai=!1,fe=o;fe!==null;)if(o=fe,i=o.child,(o.subtreeFlags&1028)!==0&&i!==null)i.return=o,fe=i;else for(;fe!==null;){o=fe;try{var pe=o.alternate;if((o.flags&1024)!==0)switch(o.tag){case 0:case 11:case 15:break;case 1:if(pe!==null){var ge=pe.memoizedProps,mt=pe.memoizedState,$=o.stateNode,M=$.getSnapshotBeforeUpdate(o.elementType===o.type?ge:nr(o.type,ge),mt);$.__reactInternalSnapshotBeforeUpdate=M}break;case 3:var q=o.stateNode.containerInfo;q.nodeType===1?q.textContent="":q.nodeType===9&&q.documentElement&&q.removeChild(q.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(ie){dt(o,o.return,ie)}if(i=o.sibling,i!==null){i.return=o.return,fe=i;break}fe=o.return}return pe=Xv,Xv=!1,pe}function Yl(i,o,u){var h=o.updateQueue;if(h=h!==null?h.lastEffect:null,h!==null){var m=h=h.next;do{if((m.tag&i)===i){var y=m.destroy;m.destroy=void 0,y!==void 0&&fp(o,u,y)}m=m.next}while(m!==h)}}function nd(i,o){if(o=o.updateQueue,o=o!==null?o.lastEffect:null,o!==null){var u=o=o.next;do{if((u.tag&i)===i){var h=u.create;u.destroy=h()}u=u.next}while(u!==o)}}function pp(i){var o=i.ref;if(o!==null){var u=i.stateNode;switch(i.tag){case 5:i=u;break;default:i=u}typeof o=="function"?o(i):o.current=i}}function Jv(i){var o=i.alternate;o!==null&&(i.alternate=null,Jv(o)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(o=i.stateNode,o!==null&&(delete o[Ir],delete o[Fl],delete o[Cf],delete o[TS],delete o[SS])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function Zv(i){return i.tag===5||i.tag===3||i.tag===4}function e_(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||Zv(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function mp(i,o,u){var h=i.tag;if(h===5||h===6)i=i.stateNode,o?u.nodeType===8?u.parentNode.insertBefore(i,o):u.insertBefore(i,o):(u.nodeType===8?(o=u.parentNode,o.insertBefore(i,u)):(o=u,o.appendChild(i)),u=u._reactRootContainer,u!=null||o.onclick!==null||(o.onclick=Dc));else if(h!==4&&(i=i.child,i!==null))for(mp(i,o,u),i=i.sibling;i!==null;)mp(i,o,u),i=i.sibling}function gp(i,o,u){var h=i.tag;if(h===5||h===6)i=i.stateNode,o?u.insertBefore(i,o):u.appendChild(i);else if(h!==4&&(i=i.child,i!==null))for(gp(i,o,u),i=i.sibling;i!==null;)gp(i,o,u),i=i.sibling}var jt=null,rr=!1;function Mi(i,o,u){for(u=u.child;u!==null;)t_(i,o,u),u=u.sibling}function t_(i,o,u){if(mn&&typeof mn.onCommitFiberUnmount=="function")try{mn.onCommitFiberUnmount(xs,u)}catch{}switch(u.tag){case 5:Ht||ca(u,o);case 6:var h=jt,m=rr;jt=null,Mi(i,o,u),jt=h,rr=m,jt!==null&&(rr?(i=jt,u=u.stateNode,i.nodeType===8?i.parentNode.removeChild(u):i.removeChild(u)):jt.removeChild(u.stateNode));break;case 18:jt!==null&&(rr?(i=jt,u=u.stateNode,i.nodeType===8?Rf(i.parentNode,u):i.nodeType===1&&Rf(i,u),Jn(i)):Rf(jt,u.stateNode));break;case 4:h=jt,m=rr,jt=u.stateNode.containerInfo,rr=!0,Mi(i,o,u),jt=h,rr=m;break;case 0:case 11:case 14:case 15:if(!Ht&&(h=u.updateQueue,h!==null&&(h=h.lastEffect,h!==null))){m=h=h.next;do{var y=m,I=y.destroy;y=y.tag,I!==void 0&&((y&2)!==0||(y&4)!==0)&&fp(u,o,I),m=m.next}while(m!==h)}Mi(i,o,u);break;case 1:if(!Ht&&(ca(u,o),h=u.stateNode,typeof h.componentWillUnmount=="function"))try{h.props=u.memoizedProps,h.state=u.memoizedState,h.componentWillUnmount()}catch(b){dt(u,o,b)}Mi(i,o,u);break;case 21:Mi(i,o,u);break;case 22:u.mode&1?(Ht=(h=Ht)||u.memoizedState!==null,Mi(i,o,u),Ht=h):Mi(i,o,u);break;default:Mi(i,o,u)}}function n_(i){var o=i.updateQueue;if(o!==null){i.updateQueue=null;var u=i.stateNode;u===null&&(u=i.stateNode=new BS),o.forEach(function(h){var m=XS.bind(null,i,h);u.has(h)||(u.add(h),h.then(m,m))})}}function ir(i,o){var u=o.deletions;if(u!==null)for(var h=0;h<u.length;h++){var m=u[h];try{var y=i,I=o,b=I;e:for(;b!==null;){switch(b.tag){case 5:jt=b.stateNode,rr=!1;break e;case 3:jt=b.stateNode.containerInfo,rr=!0;break e;case 4:jt=b.stateNode.containerInfo,rr=!0;break e}b=b.return}if(jt===null)throw Error(t(160));t_(y,I,m),jt=null,rr=!1;var V=m.alternate;V!==null&&(V.return=null),m.return=null}catch(W){dt(m,o,W)}}if(o.subtreeFlags&12854)for(o=o.child;o!==null;)r_(o,i),o=o.sibling}function r_(i,o){var u=i.alternate,h=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(ir(o,i),Sr(i),h&4){try{Yl(3,i,i.return),nd(3,i)}catch(ge){dt(i,i.return,ge)}try{Yl(5,i,i.return)}catch(ge){dt(i,i.return,ge)}}break;case 1:ir(o,i),Sr(i),h&512&&u!==null&&ca(u,u.return);break;case 5:if(ir(o,i),Sr(i),h&512&&u!==null&&ca(u,u.return),i.flags&32){var m=i.stateNode;try{wi(m,"")}catch(ge){dt(i,i.return,ge)}}if(h&4&&(m=i.stateNode,m!=null)){var y=i.memoizedProps,I=u!==null?u.memoizedProps:y,b=i.type,V=i.updateQueue;if(i.updateQueue=null,V!==null)try{b==="input"&&y.type==="radio"&&y.name!=null&&al(m,y),gl(b,I);var W=gl(b,y);for(I=0;I<V.length;I+=2){var Z=V[I],te=V[I+1];Z==="style"?fl(m,te):Z==="dangerouslySetInnerHTML"?dl(m,te):Z==="children"?wi(m,te):H(m,Z,te,W)}switch(b){case"input":ll(m,y);break;case"textarea":ko(m,y);break;case"select":var J=m._wrapperState.wasMultiple;m._wrapperState.wasMultiple=!!y.multiple;var de=y.value;de!=null?$r(m,!!y.multiple,de,!1):J!==!!y.multiple&&(y.defaultValue!=null?$r(m,!!y.multiple,y.defaultValue,!0):$r(m,!!y.multiple,y.multiple?[]:"",!1))}m[Fl]=y}catch(ge){dt(i,i.return,ge)}}break;case 6:if(ir(o,i),Sr(i),h&4){if(i.stateNode===null)throw Error(t(162));m=i.stateNode,y=i.memoizedProps;try{m.nodeValue=y}catch(ge){dt(i,i.return,ge)}}break;case 3:if(ir(o,i),Sr(i),h&4&&u!==null&&u.memoizedState.isDehydrated)try{Jn(o.containerInfo)}catch(ge){dt(i,i.return,ge)}break;case 4:ir(o,i),Sr(i);break;case 13:ir(o,i),Sr(i),m=i.child,m.flags&8192&&(y=m.memoizedState!==null,m.stateNode.isHidden=y,!y||m.alternate!==null&&m.alternate.memoizedState!==null||(_p=Xe())),h&4&&n_(i);break;case 22:if(Z=u!==null&&u.memoizedState!==null,i.mode&1?(Ht=(W=Ht)||Z,ir(o,i),Ht=W):ir(o,i),Sr(i),h&8192){if(W=i.memoizedState!==null,(i.stateNode.isHidden=W)&&!Z&&(i.mode&1)!==0)for(fe=i,Z=i.child;Z!==null;){for(te=fe=Z;fe!==null;){switch(J=fe,de=J.child,J.tag){case 0:case 11:case 14:case 15:Yl(4,J,J.return);break;case 1:ca(J,J.return);var pe=J.stateNode;if(typeof pe.componentWillUnmount=="function"){h=J,u=J.return;try{o=h,pe.props=o.memoizedProps,pe.state=o.memoizedState,pe.componentWillUnmount()}catch(ge){dt(h,u,ge)}}break;case 5:ca(J,J.return);break;case 22:if(J.memoizedState!==null){o_(te);continue}}de!==null?(de.return=J,fe=de):o_(te)}Z=Z.sibling}e:for(Z=null,te=i;;){if(te.tag===5){if(Z===null){Z=te;try{m=te.stateNode,W?(y=m.style,typeof y.setProperty=="function"?y.setProperty("display","none","important"):y.display="none"):(b=te.stateNode,V=te.memoizedProps.style,I=V!=null&&V.hasOwnProperty("display")?V.display:null,b.style.display=hl("display",I))}catch(ge){dt(i,i.return,ge)}}}else if(te.tag===6){if(Z===null)try{te.stateNode.nodeValue=W?"":te.memoizedProps}catch(ge){dt(i,i.return,ge)}}else if((te.tag!==22&&te.tag!==23||te.memoizedState===null||te===i)&&te.child!==null){te.child.return=te,te=te.child;continue}if(te===i)break e;for(;te.sibling===null;){if(te.return===null||te.return===i)break e;Z===te&&(Z=null),te=te.return}Z===te&&(Z=null),te.sibling.return=te.return,te=te.sibling}}break;case 19:ir(o,i),Sr(i),h&4&&n_(i);break;case 21:break;default:ir(o,i),Sr(i)}}function Sr(i){var o=i.flags;if(o&2){try{e:{for(var u=i.return;u!==null;){if(Zv(u)){var h=u;break e}u=u.return}throw Error(t(160))}switch(h.tag){case 5:var m=h.stateNode;h.flags&32&&(wi(m,""),h.flags&=-33);var y=e_(i);gp(i,y,m);break;case 3:case 4:var I=h.stateNode.containerInfo,b=e_(i);mp(i,b,I);break;default:throw Error(t(161))}}catch(V){dt(i,i.return,V)}i.flags&=-3}o&4096&&(i.flags&=-4097)}function $S(i,o,u){fe=i,i_(i)}function i_(i,o,u){for(var h=(i.mode&1)!==0;fe!==null;){var m=fe,y=m.child;if(m.tag===22&&h){var I=m.memoizedState!==null||td;if(!I){var b=m.alternate,V=b!==null&&b.memoizedState!==null||Ht;b=td;var W=Ht;if(td=I,(Ht=V)&&!W)for(fe=m;fe!==null;)I=fe,V=I.child,I.tag===22&&I.memoizedState!==null?a_(m):V!==null?(V.return=I,fe=V):a_(m);for(;y!==null;)fe=y,i_(y),y=y.sibling;fe=m,td=b,Ht=W}s_(i)}else(m.subtreeFlags&8772)!==0&&y!==null?(y.return=m,fe=y):s_(i)}}function s_(i){for(;fe!==null;){var o=fe;if((o.flags&8772)!==0){var u=o.alternate;try{if((o.flags&8772)!==0)switch(o.tag){case 0:case 11:case 15:Ht||nd(5,o);break;case 1:var h=o.stateNode;if(o.flags&4&&!Ht)if(u===null)h.componentDidMount();else{var m=o.elementType===o.type?u.memoizedProps:nr(o.type,u.memoizedProps);h.componentDidUpdate(m,u.memoizedState,h.__reactInternalSnapshotBeforeUpdate)}var y=o.updateQueue;y!==null&&ov(o,y,h);break;case 3:var I=o.updateQueue;if(I!==null){if(u=null,o.child!==null)switch(o.child.tag){case 5:u=o.child.stateNode;break;case 1:u=o.child.stateNode}ov(o,I,u)}break;case 5:var b=o.stateNode;if(u===null&&o.flags&4){u=b;var V=o.memoizedProps;switch(o.type){case"button":case"input":case"select":case"textarea":V.autoFocus&&u.focus();break;case"img":V.src&&(u.src=V.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(o.memoizedState===null){var W=o.alternate;if(W!==null){var Z=W.memoizedState;if(Z!==null){var te=Z.dehydrated;te!==null&&Jn(te)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Ht||o.flags&512&&pp(o)}catch(J){dt(o,o.return,J)}}if(o===i){fe=null;break}if(u=o.sibling,u!==null){u.return=o.return,fe=u;break}fe=o.return}}function o_(i){for(;fe!==null;){var o=fe;if(o===i){fe=null;break}var u=o.sibling;if(u!==null){u.return=o.return,fe=u;break}fe=o.return}}function a_(i){for(;fe!==null;){var o=fe;try{switch(o.tag){case 0:case 11:case 15:var u=o.return;try{nd(4,o)}catch(V){dt(o,u,V)}break;case 1:var h=o.stateNode;if(typeof h.componentDidMount=="function"){var m=o.return;try{h.componentDidMount()}catch(V){dt(o,m,V)}}var y=o.return;try{pp(o)}catch(V){dt(o,y,V)}break;case 5:var I=o.return;try{pp(o)}catch(V){dt(o,I,V)}}}catch(V){dt(o,o.return,V)}if(o===i){fe=null;break}var b=o.sibling;if(b!==null){b.return=o.return,fe=b;break}fe=o.return}}var qS=Math.ceil,rd=se.ReactCurrentDispatcher,yp=se.ReactCurrentOwner,On=se.ReactCurrentBatchConfig,je=0,Dt=null,yt=null,Ft=0,En=0,da=Ni(0),bt=0,Xl=null,Ms=0,id=0,vp=0,Jl=null,cn=null,_p=0,ha=1/0,ii=null,sd=!1,wp=null,ji=null,od=!1,Fi=null,ad=0,Zl=0,Ep=null,ld=-1,ud=0;function en(){return(je&6)!==0?Xe():ld!==-1?ld:ld=Xe()}function Ui(i){return(i.mode&1)===0?1:(je&2)!==0&&Ft!==0?Ft&-Ft:bS.transition!==null?(ud===0&&(ud=Ss()),ud):(i=Ve,i!==0||(i=window.event,i=i===void 0?16:bl(i.type)),i)}function sr(i,o,u,h){if(50<Zl)throw Zl=0,Ep=null,Error(t(185));Ti(i,u,h),((je&2)===0||i!==Dt)&&(i===Dt&&((je&2)===0&&(id|=u),bt===4&&Bi(i,Ft)),dn(i,h),u===1&&je===0&&(o.mode&1)===0&&(ha=Xe()+500,Mc&&Vi()))}function dn(i,o){var u=i.callbackNode;Wr(i,o);var h=Ts(i,i===Dt?Ft:0);if(h===0)u!==null&&Il(u),i.callbackNode=null,i.callbackPriority=0;else if(o=h&-h,i.callbackPriority!==o){if(u!=null&&Il(u),o===1)i.tag===0?kS(u_.bind(null,i)):Ky(u_.bind(null,i)),IS(function(){(je&6)===0&&Vi()}),u=null;else{switch(ki(h)){case 1:u=Is;break;case 4:u=Ei;break;case 16:u=An;break;case 536870912:u=uc;break;default:u=An}u=y_(u,l_.bind(null,i))}i.callbackPriority=o,i.callbackNode=u}}function l_(i,o){if(ld=-1,ud=0,(je&6)!==0)throw Error(t(327));var u=i.callbackNode;if(fa()&&i.callbackNode!==u)return null;var h=Ts(i,i===Dt?Ft:0);if(h===0)return null;if((h&30)!==0||(h&i.expiredLanes)!==0||o)o=cd(i,h);else{o=h;var m=je;je|=2;var y=d_();(Dt!==i||Ft!==o)&&(ii=null,ha=Xe()+500,Fs(i,o));do try{GS();break}catch(b){c_(i,b)}while(!0);Ff(),rd.current=y,je=m,yt!==null?o=0:(Dt=null,Ft=0,o=bt)}if(o!==0){if(o===2&&(m=gn(i),m!==0&&(h=m,o=Ip(i,m))),o===1)throw u=Xl,Fs(i,0),Bi(i,h),dn(i,Xe()),u;if(o===6)Bi(i,h);else{if(m=i.current.alternate,(h&30)===0&&!HS(m)&&(o=cd(i,h),o===2&&(y=gn(i),y!==0&&(h=y,o=Ip(i,y))),o===1))throw u=Xl,Fs(i,0),Bi(i,h),dn(i,Xe()),u;switch(i.finishedWork=m,i.finishedLanes=h,o){case 0:case 1:throw Error(t(345));case 2:Us(i,cn,ii);break;case 3:if(Bi(i,h),(h&130023424)===h&&(o=_p+500-Xe(),10<o)){if(Ts(i,0)!==0)break;if(m=i.suspendedLanes,(m&h)!==h){en(),i.pingedLanes|=i.suspendedLanes&m;break}i.timeoutHandle=Af(Us.bind(null,i,cn,ii),o);break}Us(i,cn,ii);break;case 4:if(Bi(i,h),(h&4194240)===h)break;for(o=i.eventTimes,m=-1;0<h;){var I=31-Xt(h);y=1<<I,I=o[I],I>m&&(m=I),h&=~y}if(h=m,h=Xe()-h,h=(120>h?120:480>h?480:1080>h?1080:1920>h?1920:3e3>h?3e3:4320>h?4320:1960*qS(h/1960))-h,10<h){i.timeoutHandle=Af(Us.bind(null,i,cn,ii),h);break}Us(i,cn,ii);break;case 5:Us(i,cn,ii);break;default:throw Error(t(329))}}}return dn(i,Xe()),i.callbackNode===u?l_.bind(null,i):null}function Ip(i,o){var u=Jl;return i.current.memoizedState.isDehydrated&&(Fs(i,o).flags|=256),i=cd(i,o),i!==2&&(o=cn,cn=u,o!==null&&xp(o)),i}function xp(i){cn===null?cn=i:cn.push.apply(cn,i)}function HS(i){for(var o=i;;){if(o.flags&16384){var u=o.updateQueue;if(u!==null&&(u=u.stores,u!==null))for(var h=0;h<u.length;h++){var m=u[h],y=m.getSnapshot;m=m.value;try{if(!er(y(),m))return!1}catch{return!1}}}if(u=o.child,o.subtreeFlags&16384&&u!==null)u.return=o,o=u;else{if(o===i)break;for(;o.sibling===null;){if(o.return===null||o.return===i)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Bi(i,o){for(o&=~vp,o&=~id,i.suspendedLanes|=o,i.pingedLanes&=~o,i=i.expirationTimes;0<o;){var u=31-Xt(o),h=1<<u;i[u]=-1,o&=~h}}function u_(i){if((je&6)!==0)throw Error(t(327));fa();var o=Ts(i,0);if((o&1)===0)return dn(i,Xe()),null;var u=cd(i,o);if(i.tag!==0&&u===2){var h=gn(i);h!==0&&(o=h,u=Ip(i,h))}if(u===1)throw u=Xl,Fs(i,0),Bi(i,o),dn(i,Xe()),u;if(u===6)throw Error(t(345));return i.finishedWork=i.current.alternate,i.finishedLanes=o,Us(i,cn,ii),dn(i,Xe()),null}function Tp(i,o){var u=je;je|=1;try{return i(o)}finally{je=u,je===0&&(ha=Xe()+500,Mc&&Vi())}}function js(i){Fi!==null&&Fi.tag===0&&(je&6)===0&&fa();var o=je;je|=1;var u=On.transition,h=Ve;try{if(On.transition=null,Ve=1,i)return i()}finally{Ve=h,On.transition=u,je=o,(je&6)===0&&Vi()}}function Sp(){En=da.current,tt(da)}function Fs(i,o){i.finishedWork=null,i.finishedLanes=0;var u=i.timeoutHandle;if(u!==-1&&(i.timeoutHandle=-1,ES(u)),yt!==null)for(u=yt.return;u!==null;){var h=u;switch(Vf(h),h.tag){case 1:h=h.type.childContextTypes,h!=null&&Oc();break;case 3:la(),tt(an),tt(zt),Gf();break;case 5:Hf(h);break;case 4:la();break;case 13:tt(lt);break;case 19:tt(lt);break;case 10:Uf(h.type._context);break;case 22:case 23:Sp()}u=u.return}if(Dt=i,yt=i=zi(i.current,null),Ft=En=o,bt=0,Xl=null,vp=id=Ms=0,cn=Jl=null,Vs!==null){for(o=0;o<Vs.length;o++)if(u=Vs[o],h=u.interleaved,h!==null){u.interleaved=null;var m=h.next,y=u.pending;if(y!==null){var I=y.next;y.next=m,h.next=I}u.pending=h}Vs=null}return i}function c_(i,o){do{var u=yt;try{if(Ff(),Gc.current=Xc,Kc){for(var h=ut.memoizedState;h!==null;){var m=h.queue;m!==null&&(m.pending=null),h=h.next}Kc=!1}if(Ls=0,Nt=kt=ut=null,Hl=!1,Wl=0,yp.current=null,u===null||u.return===null){bt=1,Xl=o,yt=null;break}e:{var y=i,I=u.return,b=u,V=o;if(o=Ft,b.flags|=32768,V!==null&&typeof V=="object"&&typeof V.then=="function"){var W=V,Z=b,te=Z.tag;if((Z.mode&1)===0&&(te===0||te===11||te===15)){var J=Z.alternate;J?(Z.updateQueue=J.updateQueue,Z.memoizedState=J.memoizedState,Z.lanes=J.lanes):(Z.updateQueue=null,Z.memoizedState=null)}var de=Ov(I);if(de!==null){de.flags&=-257,Lv(de,I,b,y,o),de.mode&1&&Vv(y,W,o),o=de,V=W;var pe=o.updateQueue;if(pe===null){var ge=new Set;ge.add(V),o.updateQueue=ge}else pe.add(V);break e}else{if((o&1)===0){Vv(y,W,o),kp();break e}V=Error(t(426))}}else if(it&&b.mode&1){var mt=Ov(I);if(mt!==null){(mt.flags&65536)===0&&(mt.flags|=256),Lv(mt,I,b,y,o),Mf(ua(V,b));break e}}y=V=ua(V,b),bt!==4&&(bt=2),Jl===null?Jl=[y]:Jl.push(y),y=I;do{switch(y.tag){case 3:y.flags|=65536,o&=-o,y.lanes|=o;var $=Nv(y,V,o);sv(y,$);break e;case 1:b=V;var M=y.type,q=y.stateNode;if((y.flags&128)===0&&(typeof M.getDerivedStateFromError=="function"||q!==null&&typeof q.componentDidCatch=="function"&&(ji===null||!ji.has(q)))){y.flags|=65536,o&=-o,y.lanes|=o;var ie=Dv(y,b,o);sv(y,ie);break e}}y=y.return}while(y!==null)}f_(u)}catch(ye){o=ye,yt===u&&u!==null&&(yt=u=u.return);continue}break}while(!0)}function d_(){var i=rd.current;return rd.current=Xc,i===null?Xc:i}function kp(){(bt===0||bt===3||bt===2)&&(bt=4),Dt===null||(Ms&268435455)===0&&(id&268435455)===0||Bi(Dt,Ft)}function cd(i,o){var u=je;je|=2;var h=d_();(Dt!==i||Ft!==o)&&(ii=null,Fs(i,o));do try{WS();break}catch(m){c_(i,m)}while(!0);if(Ff(),je=u,rd.current=h,yt!==null)throw Error(t(261));return Dt=null,Ft=0,bt}function WS(){for(;yt!==null;)h_(yt)}function GS(){for(;yt!==null&&!ac();)h_(yt)}function h_(i){var o=g_(i.alternate,i,En);i.memoizedProps=i.pendingProps,o===null?f_(i):yt=o,yp.current=null}function f_(i){var o=i;do{var u=o.alternate;if(i=o.return,(o.flags&32768)===0){if(u=FS(u,o,En),u!==null){yt=u;return}}else{if(u=US(u,o),u!==null){u.flags&=32767,yt=u;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{bt=6,yt=null;return}}if(o=o.sibling,o!==null){yt=o;return}yt=o=i}while(o!==null);bt===0&&(bt=5)}function Us(i,o,u){var h=Ve,m=On.transition;try{On.transition=null,Ve=1,KS(i,o,u,h)}finally{On.transition=m,Ve=h}return null}function KS(i,o,u,h){do fa();while(Fi!==null);if((je&6)!==0)throw Error(t(327));u=i.finishedWork;var m=i.finishedLanes;if(u===null)return null;if(i.finishedWork=null,i.finishedLanes=0,u===i.current)throw Error(t(177));i.callbackNode=null,i.callbackPriority=0;var y=u.lanes|u.childLanes;if(Qe(i,y),i===Dt&&(yt=Dt=null,Ft=0),(u.subtreeFlags&2064)===0&&(u.flags&2064)===0||od||(od=!0,y_(An,function(){return fa(),null})),y=(u.flags&15990)!==0,(u.subtreeFlags&15990)!==0||y){y=On.transition,On.transition=null;var I=Ve;Ve=1;var b=je;je|=4,yp.current=null,zS(i,u),r_(u,i),pS(kf),Ai=!!Sf,kf=Sf=null,i.current=u,$S(u),uf(),je=b,Ve=I,On.transition=y}else i.current=u;if(od&&(od=!1,Fi=i,ad=m),y=i.pendingLanes,y===0&&(ji=null),cc(u.stateNode),dn(i,Xe()),o!==null)for(h=i.onRecoverableError,u=0;u<o.length;u++)m=o[u],h(m.value,{componentStack:m.stack,digest:m.digest});if(sd)throw sd=!1,i=wp,wp=null,i;return(ad&1)!==0&&i.tag!==0&&fa(),y=i.pendingLanes,(y&1)!==0?i===Ep?Zl++:(Zl=0,Ep=i):Zl=0,Vi(),null}function fa(){if(Fi!==null){var i=ki(ad),o=On.transition,u=Ve;try{if(On.transition=null,Ve=16>i?16:i,Fi===null)var h=!1;else{if(i=Fi,Fi=null,ad=0,(je&6)!==0)throw Error(t(331));var m=je;for(je|=4,fe=i.current;fe!==null;){var y=fe,I=y.child;if((fe.flags&16)!==0){var b=y.deletions;if(b!==null){for(var V=0;V<b.length;V++){var W=b[V];for(fe=W;fe!==null;){var Z=fe;switch(Z.tag){case 0:case 11:case 15:Yl(8,Z,y)}var te=Z.child;if(te!==null)te.return=Z,fe=te;else for(;fe!==null;){Z=fe;var J=Z.sibling,de=Z.return;if(Jv(Z),Z===W){fe=null;break}if(J!==null){J.return=de,fe=J;break}fe=de}}}var pe=y.alternate;if(pe!==null){var ge=pe.child;if(ge!==null){pe.child=null;do{var mt=ge.sibling;ge.sibling=null,ge=mt}while(ge!==null)}}fe=y}}if((y.subtreeFlags&2064)!==0&&I!==null)I.return=y,fe=I;else e:for(;fe!==null;){if(y=fe,(y.flags&2048)!==0)switch(y.tag){case 0:case 11:case 15:Yl(9,y,y.return)}var $=y.sibling;if($!==null){$.return=y.return,fe=$;break e}fe=y.return}}var M=i.current;for(fe=M;fe!==null;){I=fe;var q=I.child;if((I.subtreeFlags&2064)!==0&&q!==null)q.return=I,fe=q;else e:for(I=M;fe!==null;){if(b=fe,(b.flags&2048)!==0)try{switch(b.tag){case 0:case 11:case 15:nd(9,b)}}catch(ye){dt(b,b.return,ye)}if(b===I){fe=null;break e}var ie=b.sibling;if(ie!==null){ie.return=b.return,fe=ie;break e}fe=b.return}}if(je=m,Vi(),mn&&typeof mn.onPostCommitFiberRoot=="function")try{mn.onPostCommitFiberRoot(xs,i)}catch{}h=!0}return h}finally{Ve=u,On.transition=o}}return!1}function p_(i,o,u){o=ua(u,o),o=Nv(i,o,1),i=Li(i,o,1),o=en(),i!==null&&(Ti(i,1,o),dn(i,o))}function dt(i,o,u){if(i.tag===3)p_(i,i,u);else for(;o!==null;){if(o.tag===3){p_(o,i,u);break}else if(o.tag===1){var h=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(ji===null||!ji.has(h))){i=ua(u,i),i=Dv(o,i,1),o=Li(o,i,1),i=en(),o!==null&&(Ti(o,1,i),dn(o,i));break}}o=o.return}}function QS(i,o,u){var h=i.pingCache;h!==null&&h.delete(o),o=en(),i.pingedLanes|=i.suspendedLanes&u,Dt===i&&(Ft&u)===u&&(bt===4||bt===3&&(Ft&130023424)===Ft&&500>Xe()-_p?Fs(i,0):vp|=u),dn(i,o)}function m_(i,o){o===0&&((i.mode&1)===0?o=1:(o=Lo,Lo<<=1,(Lo&130023424)===0&&(Lo=4194304)));var u=en();i=ti(i,o),i!==null&&(Ti(i,o,u),dn(i,u))}function YS(i){var o=i.memoizedState,u=0;o!==null&&(u=o.retryLane),m_(i,u)}function XS(i,o){var u=0;switch(i.tag){case 13:var h=i.stateNode,m=i.memoizedState;m!==null&&(u=m.retryLane);break;case 19:h=i.stateNode;break;default:throw Error(t(314))}h!==null&&h.delete(o),m_(i,u)}var g_;g_=function(i,o,u){if(i!==null)if(i.memoizedProps!==o.pendingProps||an.current)un=!0;else{if((i.lanes&u)===0&&(o.flags&128)===0)return un=!1,jS(i,o,u);un=(i.flags&131072)!==0}else un=!1,it&&(o.flags&1048576)!==0&&Qy(o,Fc,o.index);switch(o.lanes=0,o.tag){case 2:var h=o.type;ed(i,o),i=o.pendingProps;var m=ta(o,zt.current);aa(o,u),m=Yf(null,o,h,i,m,u);var y=Xf();return o.flags|=1,typeof m=="object"&&m!==null&&typeof m.render=="function"&&m.$$typeof===void 0?(o.tag=1,o.memoizedState=null,o.updateQueue=null,ln(h)?(y=!0,Lc(o)):y=!1,o.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,$f(o),m.updater=Jc,o.stateNode=m,m._reactInternals=o,rp(o,h,i,u),o=ap(null,o,h,!0,y,u)):(o.tag=0,it&&y&&Df(o),Zt(null,o,m,u),o=o.child),o;case 16:h=o.elementType;e:{switch(ed(i,o),i=o.pendingProps,m=h._init,h=m(h._payload),o.type=h,m=o.tag=ZS(h),i=nr(h,i),m){case 0:o=op(null,o,h,i,u);break e;case 1:o=zv(null,o,h,i,u);break e;case 11:o=Mv(null,o,h,i,u);break e;case 14:o=jv(null,o,h,nr(h.type,i),u);break e}throw Error(t(306,h,""))}return o;case 0:return h=o.type,m=o.pendingProps,m=o.elementType===h?m:nr(h,m),op(i,o,h,m,u);case 1:return h=o.type,m=o.pendingProps,m=o.elementType===h?m:nr(h,m),zv(i,o,h,m,u);case 3:e:{if($v(o),i===null)throw Error(t(387));h=o.pendingProps,y=o.memoizedState,m=y.element,iv(i,o),Hc(o,h,null,u);var I=o.memoizedState;if(h=I.element,y.isDehydrated)if(y={element:h,isDehydrated:!1,cache:I.cache,pendingSuspenseBoundaries:I.pendingSuspenseBoundaries,transitions:I.transitions},o.updateQueue.baseState=y,o.memoizedState=y,o.flags&256){m=ua(Error(t(423)),o),o=qv(i,o,h,u,m);break e}else if(h!==m){m=ua(Error(t(424)),o),o=qv(i,o,h,u,m);break e}else for(wn=Pi(o.stateNode.containerInfo.firstChild),_n=o,it=!0,tr=null,u=nv(o,null,h,u),o.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling;else{if(ia(),h===m){o=ri(i,o,u);break e}Zt(i,o,h,u)}o=o.child}return o;case 5:return av(o),i===null&&Lf(o),h=o.type,m=o.pendingProps,y=i!==null?i.memoizedProps:null,I=m.children,bf(h,m)?I=null:y!==null&&bf(h,y)&&(o.flags|=32),Bv(i,o),Zt(i,o,I,u),o.child;case 6:return i===null&&Lf(o),null;case 13:return Hv(i,o,u);case 4:return qf(o,o.stateNode.containerInfo),h=o.pendingProps,i===null?o.child=sa(o,null,h,u):Zt(i,o,h,u),o.child;case 11:return h=o.type,m=o.pendingProps,m=o.elementType===h?m:nr(h,m),Mv(i,o,h,m,u);case 7:return Zt(i,o,o.pendingProps,u),o.child;case 8:return Zt(i,o,o.pendingProps.children,u),o.child;case 12:return Zt(i,o,o.pendingProps.children,u),o.child;case 10:e:{if(h=o.type._context,m=o.pendingProps,y=o.memoizedProps,I=m.value,Je(zc,h._currentValue),h._currentValue=I,y!==null)if(er(y.value,I)){if(y.children===m.children&&!an.current){o=ri(i,o,u);break e}}else for(y=o.child,y!==null&&(y.return=o);y!==null;){var b=y.dependencies;if(b!==null){I=y.child;for(var V=b.firstContext;V!==null;){if(V.context===h){if(y.tag===1){V=ni(-1,u&-u),V.tag=2;var W=y.updateQueue;if(W!==null){W=W.shared;var Z=W.pending;Z===null?V.next=V:(V.next=Z.next,Z.next=V),W.pending=V}}y.lanes|=u,V=y.alternate,V!==null&&(V.lanes|=u),Bf(y.return,u,o),b.lanes|=u;break}V=V.next}}else if(y.tag===10)I=y.type===o.type?null:y.child;else if(y.tag===18){if(I=y.return,I===null)throw Error(t(341));I.lanes|=u,b=I.alternate,b!==null&&(b.lanes|=u),Bf(I,u,o),I=y.sibling}else I=y.child;if(I!==null)I.return=y;else for(I=y;I!==null;){if(I===o){I=null;break}if(y=I.sibling,y!==null){y.return=I.return,I=y;break}I=I.return}y=I}Zt(i,o,m.children,u),o=o.child}return o;case 9:return m=o.type,h=o.pendingProps.children,aa(o,u),m=Dn(m),h=h(m),o.flags|=1,Zt(i,o,h,u),o.child;case 14:return h=o.type,m=nr(h,o.pendingProps),m=nr(h.type,m),jv(i,o,h,m,u);case 15:return Fv(i,o,o.type,o.pendingProps,u);case 17:return h=o.type,m=o.pendingProps,m=o.elementType===h?m:nr(h,m),ed(i,o),o.tag=1,ln(h)?(i=!0,Lc(o)):i=!1,aa(o,u),Cv(o,h,m),rp(o,h,m,u),ap(null,o,h,!0,i,u);case 19:return Gv(i,o,u);case 22:return Uv(i,o,u)}throw Error(t(156,o.tag))};function y_(i,o){return Vo(i,o)}function JS(i,o,u,h){this.tag=i,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ln(i,o,u,h){return new JS(i,o,u,h)}function bp(i){return i=i.prototype,!(!i||!i.isReactComponent)}function ZS(i){if(typeof i=="function")return bp(i)?1:0;if(i!=null){if(i=i.$$typeof,i===j)return 11;if(i===Ze)return 14}return 2}function zi(i,o){var u=i.alternate;return u===null?(u=Ln(i.tag,o,i.key,i.mode),u.elementType=i.elementType,u.type=i.type,u.stateNode=i.stateNode,u.alternate=i,i.alternate=u):(u.pendingProps=o,u.type=i.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=i.flags&14680064,u.childLanes=i.childLanes,u.lanes=i.lanes,u.child=i.child,u.memoizedProps=i.memoizedProps,u.memoizedState=i.memoizedState,u.updateQueue=i.updateQueue,o=i.dependencies,u.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},u.sibling=i.sibling,u.index=i.index,u.ref=i.ref,u}function dd(i,o,u,h,m,y){var I=2;if(h=i,typeof i=="function")bp(i)&&(I=1);else if(typeof i=="string")I=5;else e:switch(i){case C:return Bs(u.children,m,y,o);case k:I=8,m|=8;break;case A:return i=Ln(12,u,o,m|2),i.elementType=A,i.lanes=y,i;case R:return i=Ln(13,u,o,m),i.elementType=R,i.lanes=y,i;case Ke:return i=Ln(19,u,o,m),i.elementType=Ke,i.lanes=y,i;case Fe:return hd(u,m,y,o);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case D:I=10;break e;case L:I=9;break e;case j:I=11;break e;case Ze:I=14;break e;case ee:I=16,h=null;break e}throw Error(t(130,i==null?i:typeof i,""))}return o=Ln(I,u,o,m),o.elementType=i,o.type=h,o.lanes=y,o}function Bs(i,o,u,h){return i=Ln(7,i,h,o),i.lanes=u,i}function hd(i,o,u,h){return i=Ln(22,i,h,o),i.elementType=Fe,i.lanes=u,i.stateNode={isHidden:!1},i}function Ap(i,o,u){return i=Ln(6,i,null,o),i.lanes=u,i}function Rp(i,o,u){return o=Ln(4,i.children!==null?i.children:[],i.key,o),o.lanes=u,o.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},o}function ek(i,o,u,h,m){this.tag=o,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=xi(0),this.expirationTimes=xi(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=xi(0),this.identifierPrefix=h,this.onRecoverableError=m,this.mutableSourceEagerHydrationData=null}function Cp(i,o,u,h,m,y,I,b,V){return i=new ek(i,o,u,b,V),o===1?(o=1,y===!0&&(o|=8)):o=0,y=Ln(3,null,null,o),i.current=y,y.stateNode=i,y.memoizedState={element:h,isDehydrated:u,cache:null,transitions:null,pendingSuspenseBoundaries:null},$f(y),i}function tk(i,o,u){var h=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:re,key:h==null?null:""+h,children:i,containerInfo:o,implementation:u}}function v_(i){if(!i)return Di;i=i._reactInternals;e:{if(Gn(i)!==i||i.tag!==1)throw Error(t(170));var o=i;do{switch(o.tag){case 3:o=o.stateNode.context;break e;case 1:if(ln(o.type)){o=o.stateNode.__reactInternalMemoizedMergedChildContext;break e}}o=o.return}while(o!==null);throw Error(t(171))}if(i.tag===1){var u=i.type;if(ln(u))return Wy(i,u,o)}return o}function __(i,o,u,h,m,y,I,b,V){return i=Cp(u,h,!0,i,m,y,I,b,V),i.context=v_(null),u=i.current,h=en(),m=Ui(u),y=ni(h,m),y.callback=o??null,Li(u,y,m),i.current.lanes=m,Ti(i,m,h),dn(i,h),i}function fd(i,o,u,h){var m=o.current,y=en(),I=Ui(m);return u=v_(u),o.context===null?o.context=u:o.pendingContext=u,o=ni(y,I),o.payload={element:i},h=h===void 0?null:h,h!==null&&(o.callback=h),i=Li(m,o,I),i!==null&&(sr(i,m,I,y),qc(i,m,I)),I}function pd(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function w_(i,o){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var u=i.retryLane;i.retryLane=u!==0&&u<o?u:o}}function Pp(i,o){w_(i,o),(i=i.alternate)&&w_(i,o)}function nk(){return null}var E_=typeof reportError=="function"?reportError:function(i){console.error(i)};function Np(i){this._internalRoot=i}md.prototype.render=Np.prototype.render=function(i){var o=this._internalRoot;if(o===null)throw Error(t(409));fd(i,o,null,null)},md.prototype.unmount=Np.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var o=i.containerInfo;js(function(){fd(null,i,null,null)}),o[Xr]=null}};function md(i){this._internalRoot=i}md.prototype.unstable_scheduleHydration=function(i){if(i){var o=mc();i={blockedOn:null,target:i,priority:o};for(var u=0;u<vr.length&&o!==0&&o<vr[u].priority;u++);vr.splice(u,0,i),u===0&&vc(i)}};function Dp(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function gd(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function I_(){}function rk(i,o,u,h,m){if(m){if(typeof h=="function"){var y=h;h=function(){var W=pd(I);y.call(W)}}var I=__(o,h,i,0,null,!1,!1,"",I_);return i._reactRootContainer=I,i[Xr]=I.current,Ml(i.nodeType===8?i.parentNode:i),js(),I}for(;m=i.lastChild;)i.removeChild(m);if(typeof h=="function"){var b=h;h=function(){var W=pd(V);b.call(W)}}var V=Cp(i,0,!1,null,null,!1,!1,"",I_);return i._reactRootContainer=V,i[Xr]=V.current,Ml(i.nodeType===8?i.parentNode:i),js(function(){fd(o,V,u,h)}),V}function yd(i,o,u,h,m){var y=u._reactRootContainer;if(y){var I=y;if(typeof m=="function"){var b=m;m=function(){var V=pd(I);b.call(V)}}fd(o,I,i,m)}else I=rk(u,o,i,m,h);return pd(I)}fc=function(i){switch(i.tag){case 3:var o=i.stateNode;if(o.current.memoizedState.isDehydrated){var u=Ii(o.pendingLanes);u!==0&&(Si(o,u|1),dn(o,Xe()),(je&6)===0&&(ha=Xe()+500,Vi()))}break;case 13:js(function(){var h=ti(i,1);if(h!==null){var m=en();sr(h,i,1,m)}}),Pp(i,1)}},Mo=function(i){if(i.tag===13){var o=ti(i,134217728);if(o!==null){var u=en();sr(o,i,134217728,u)}Pp(i,134217728)}},pc=function(i){if(i.tag===13){var o=Ui(i),u=ti(i,o);if(u!==null){var h=en();sr(u,i,o,h)}Pp(i,o)}},mc=function(){return Ve},gc=function(i,o){var u=Ve;try{return Ve=i,o()}finally{Ve=u}},Ao=function(i,o,u){switch(o){case"input":if(ll(i,u),o=u.name,u.type==="radio"&&o!=null){for(u=i;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll("input[name="+JSON.stringify(""+o)+'][type="radio"]'),o=0;o<u.length;o++){var h=u[o];if(h!==i&&h.form===i.form){var m=Vc(h);if(!m)throw Error(t(90));Io(h),ll(h,m)}}}break;case"textarea":ko(i,u);break;case"select":o=u.value,o!=null&&$r(i,!!u.multiple,o,!1)}},vs=Tp,vl=js;var ik={usingClientEntryPoint:!1,Events:[Ul,Zo,Vc,gr,yl,Tp]},eu={findFiberByHostInstance:Cs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},sk={bundleType:eu.bundleType,version:eu.version,rendererPackageName:eu.rendererPackageName,rendererConfig:eu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:se.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=El(i),i===null?null:i.stateNode},findFiberByHostInstance:eu.findFiberByHostInstance||nk,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vd.isDisabled&&vd.supportsFiber)try{xs=vd.inject(sk),mn=vd}catch{}}return hn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ik,hn.createPortal=function(i,o){var u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Dp(o))throw Error(t(200));return tk(i,o,null,u)},hn.createRoot=function(i,o){if(!Dp(i))throw Error(t(299));var u=!1,h="",m=E_;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(h=o.identifierPrefix),o.onRecoverableError!==void 0&&(m=o.onRecoverableError)),o=Cp(i,1,!1,null,null,u,!1,h,m),i[Xr]=o.current,Ml(i.nodeType===8?i.parentNode:i),new Np(o)},hn.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var o=i._reactInternals;if(o===void 0)throw typeof i.render=="function"?Error(t(188)):(i=Object.keys(i).join(","),Error(t(268,i)));return i=El(o),i=i===null?null:i.stateNode,i},hn.flushSync=function(i){return js(i)},hn.hydrate=function(i,o,u){if(!gd(o))throw Error(t(200));return yd(null,i,o,!0,u)},hn.hydrateRoot=function(i,o,u){if(!Dp(i))throw Error(t(405));var h=u!=null&&u.hydratedSources||null,m=!1,y="",I=E_;if(u!=null&&(u.unstable_strictMode===!0&&(m=!0),u.identifierPrefix!==void 0&&(y=u.identifierPrefix),u.onRecoverableError!==void 0&&(I=u.onRecoverableError)),o=__(o,null,i,1,u??null,m,!1,y,I),i[Xr]=o.current,Ml(i),h)for(i=0;i<h.length;i++)u=h[i],m=u._getVersion,m=m(u._source),o.mutableSourceEagerHydrationData==null?o.mutableSourceEagerHydrationData=[u,m]:o.mutableSourceEagerHydrationData.push(u,m);return new md(o)},hn.render=function(i,o,u){if(!gd(o))throw Error(t(200));return yd(null,i,o,!1,u)},hn.unmountComponentAtNode=function(i){if(!gd(i))throw Error(t(40));return i._reactRootContainer?(js(function(){yd(null,null,i,!1,function(){i._reactRootContainer=null,i[Xr]=null})}),!0):!1},hn.unstable_batchedUpdates=Tp,hn.unstable_renderSubtreeIntoContainer=function(i,o,u,h){if(!gd(u))throw Error(t(200));if(i==null||i._reactInternals===void 0)throw Error(t(38));return yd(i,o,u,!1,h)},hn.version="18.3.1-next-f1338f8080-20240426",hn}var C_;function fk(){if(C_)return Lp.exports;C_=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Lp.exports=hk(),Lp.exports}var P_;function pk(){if(P_)return _d;P_=1;var n=fk();return _d.createRoot=n.createRoot,_d.hydrateRoot=n.hydrateRoot,_d}var mk=pk();const gk=X0(mk);/**
 * react-router v7.10.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var N_="popstate";function yk(n={}){function e(r,s){let{pathname:a,search:l,hash:d}=r.location;return rm("",{pathname:a,search:l,hash:d},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function t(r,s){return typeof s=="string"?s:Tu(s)}return _k(e,t,null,n)}function ot(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Bn(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function vk(){return Math.random().toString(36).substring(2,10)}function D_(n,e){return{usr:n.state,key:n.key,idx:e}}function rm(n,e,t=null,r){return{pathname:typeof n=="string"?n:n.pathname,search:"",hash:"",...typeof e=="string"?Ga(e):e,state:t,key:e&&e.key||r||vk()}}function Tu({pathname:n="/",search:e="",hash:t=""}){return e&&e!=="?"&&(n+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(n+=t.charAt(0)==="#"?t:"#"+t),n}function Ga(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substring(t),n=n.substring(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substring(r),n=n.substring(0,r)),n&&(e.pathname=n)}return e}function _k(n,e,t,r={}){let{window:s=document.defaultView,v5Compat:a=!1}=r,l=s.history,d="POP",f=null,p=v();p==null&&(p=0,l.replaceState({...l.state,idx:p},""));function v(){return(l.state||{idx:null}).idx}function _(){d="POP";let O=v(),K=O==null?null:O-p;p=O,f&&f({action:d,location:P.location,delta:K})}function x(O,K){d="PUSH";let Q=rm(P.location,O,K);p=v()+1;let H=D_(Q,p),se=P.createHref(Q);try{l.pushState(H,"",se)}catch(ce){if(ce instanceof DOMException&&ce.name==="DataCloneError")throw ce;s.location.assign(se)}a&&f&&f({action:d,location:P.location,delta:1})}function S(O,K){d="REPLACE";let Q=rm(P.location,O,K);p=v();let H=D_(Q,p),se=P.createHref(Q);l.replaceState(H,"",se),a&&f&&f({action:d,location:P.location,delta:0})}function N(O){return wk(O)}let P={get action(){return d},get location(){return n(s,l)},listen(O){if(f)throw new Error("A history only accepts one active listener");return s.addEventListener(N_,_),f=O,()=>{s.removeEventListener(N_,_),f=null}},createHref(O){return e(s,O)},createURL:N,encodeLocation(O){let K=N(O);return{pathname:K.pathname,search:K.search,hash:K.hash}},push:x,replace:S,go(O){return l.go(O)}};return P}function wk(n,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),ot(t,"No window.location.(origin|href) available to create URL");let r=typeof n=="string"?n:Tu(n);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=t+r),new URL(r,t)}function J0(n,e,t="/"){return Ek(n,e,t,!1)}function Ek(n,e,t,r){let s=typeof e=="string"?Ga(e):e,a=ci(s.pathname||"/",t);if(a==null)return null;let l=Z0(n);Ik(l);let d=null;for(let f=0;d==null&&f<l.length;++f){let p=Dk(a);d=Pk(l[f],p,r)}return d}function Z0(n,e=[],t=[],r="",s=!1){let a=(l,d,f=s,p)=>{let v={relativePath:p===void 0?l.path||"":p,caseSensitive:l.caseSensitive===!0,childrenIndex:d,route:l};if(v.relativePath.startsWith("/")){if(!v.relativePath.startsWith(r)&&f)return;ot(v.relativePath.startsWith(r),`Absolute route path "${v.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),v.relativePath=v.relativePath.slice(r.length)}let _=li([r,v.relativePath]),x=t.concat(v);l.children&&l.children.length>0&&(ot(l.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${_}".`),Z0(l.children,e,x,_,f)),!(l.path==null&&!l.index)&&e.push({path:_,score:Rk(_,l.index),routesMeta:x})};return n.forEach((l,d)=>{var f;if(l.path===""||!((f=l.path)!=null&&f.includes("?")))a(l,d);else for(let p of eE(l.path))a(l,d,!0,p)}),e}function eE(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,s=t.endsWith("?"),a=t.replace(/\?$/,"");if(r.length===0)return s?[a,""]:[a];let l=eE(r.join("/")),d=[];return d.push(...l.map(f=>f===""?a:[a,f].join("/"))),s&&d.push(...l),d.map(f=>n.startsWith("/")&&f===""?"/":f)}function Ik(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:Ck(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}var xk=/^:[\w-]+$/,Tk=3,Sk=2,kk=1,bk=10,Ak=-2,V_=n=>n==="*";function Rk(n,e){let t=n.split("/"),r=t.length;return t.some(V_)&&(r+=Ak),e&&(r+=Sk),t.filter(s=>!V_(s)).reduce((s,a)=>s+(xk.test(a)?Tk:a===""?kk:bk),r)}function Ck(n,e){return n.length===e.length&&n.slice(0,-1).every((r,s)=>r===e[s])?n[n.length-1]-e[e.length-1]:0}function Pk(n,e,t=!1){let{routesMeta:r}=n,s={},a="/",l=[];for(let d=0;d<r.length;++d){let f=r[d],p=d===r.length-1,v=a==="/"?e:e.slice(a.length)||"/",_=Kd({path:f.relativePath,caseSensitive:f.caseSensitive,end:p},v),x=f.route;if(!_&&p&&t&&!r[r.length-1].route.index&&(_=Kd({path:f.relativePath,caseSensitive:f.caseSensitive,end:!1},v)),!_)return null;Object.assign(s,_.params),l.push({params:s,pathname:li([a,_.pathname]),pathnameBase:jk(li([a,_.pathnameBase])),route:x}),_.pathnameBase!=="/"&&(a=li([a,_.pathnameBase]))}return l}function Kd(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=Nk(n.path,n.caseSensitive,n.end),s=e.match(t);if(!s)return null;let a=s[0],l=a.replace(/(.)\/+$/,"$1"),d=s.slice(1);return{params:r.reduce((p,{paramName:v,isOptional:_},x)=>{if(v==="*"){let N=d[x]||"";l=a.slice(0,a.length-N.length).replace(/(.)\/+$/,"$1")}const S=d[x];return _&&!S?p[v]=void 0:p[v]=(S||"").replace(/%2F/g,"/"),p},{}),pathname:a,pathnameBase:l,pattern:n}}function Nk(n,e=!1,t=!0){Bn(n==="*"||!n.endsWith("*")||n.endsWith("/*"),`Route path "${n}" will be treated as if it were "${n.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${n.replace(/\*$/,"/*")}".`);let r=[],s="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,d,f)=>(r.push({paramName:d,isOptional:f!=null}),f?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return n.endsWith("*")?(r.push({paramName:"*"}),s+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?s+="\\/*$":n!==""&&n!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function Dk(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Bn(!1,`The URL path "${n}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),n}}function ci(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}var Vk=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ok=n=>Vk.test(n);function Lk(n,e="/"){let{pathname:t,search:r="",hash:s=""}=typeof n=="string"?Ga(n):n,a;if(t)if(Ok(t))a=t;else{if(t.includes("//")){let l=t;t=t.replace(/\/\/+/g,"/"),Bn(!1,`Pathnames cannot have embedded double slashes - normalizing ${l} -> ${t}`)}t.startsWith("/")?a=O_(t.substring(1),"/"):a=O_(t,e)}else a=e;return{pathname:a,search:Fk(r),hash:Uk(s)}}function O_(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(s=>{s===".."?t.length>1&&t.pop():s!=="."&&t.push(s)}),t.length>1?t.join("/"):"/"}function Fp(n,e,t,r){return`Cannot include a '${n}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Mk(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function $m(n){let e=Mk(n);return e.map((t,r)=>r===e.length-1?t.pathname:t.pathnameBase)}function qm(n,e,t,r=!1){let s;typeof n=="string"?s=Ga(n):(s={...n},ot(!s.pathname||!s.pathname.includes("?"),Fp("?","pathname","search",s)),ot(!s.pathname||!s.pathname.includes("#"),Fp("#","pathname","hash",s)),ot(!s.search||!s.search.includes("#"),Fp("#","search","hash",s)));let a=n===""||s.pathname==="",l=a?"/":s.pathname,d;if(l==null)d=t;else{let _=e.length-1;if(!r&&l.startsWith("..")){let x=l.split("/");for(;x[0]==="..";)x.shift(),_-=1;s.pathname=x.join("/")}d=_>=0?e[_]:"/"}let f=Lk(s,d),p=l&&l!=="/"&&l.endsWith("/"),v=(a||l===".")&&t.endsWith("/");return!f.pathname.endsWith("/")&&(p||v)&&(f.pathname+="/"),f}var li=n=>n.join("/").replace(/\/\/+/g,"/"),jk=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),Fk=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,Uk=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function Bk(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}function zk(n){return n.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var tE=["POST","PUT","PATCH","DELETE"];new Set(tE);var $k=["GET",...tE];new Set($k);var Ka=U.createContext(null);Ka.displayName="DataRouter";var xh=U.createContext(null);xh.displayName="DataRouterState";U.createContext(!1);var nE=U.createContext({isTransitioning:!1});nE.displayName="ViewTransition";var qk=U.createContext(new Map);qk.displayName="Fetchers";var Hk=U.createContext(null);Hk.displayName="Await";var $n=U.createContext(null);$n.displayName="Navigation";var Bu=U.createContext(null);Bu.displayName="Location";var hr=U.createContext({outlet:null,matches:[],isDataRoute:!1});hr.displayName="Route";var Hm=U.createContext(null);Hm.displayName="RouteError";function Wk(n,{relative:e}={}){ot(Qa(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:r}=U.useContext($n),{hash:s,pathname:a,search:l}=zu(n,{relative:e}),d=a;return t!=="/"&&(d=a==="/"?t:li([t,a])),r.createHref({pathname:d,search:l,hash:s})}function Qa(){return U.useContext(Bu)!=null}function ds(){return ot(Qa(),"useLocation() may be used only in the context of a <Router> component."),U.useContext(Bu).location}var rE="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function iE(n){U.useContext($n).static||U.useLayoutEffect(n)}function qn(){let{isDataRoute:n}=U.useContext(hr);return n?s1():Gk()}function Gk(){ot(Qa(),"useNavigate() may be used only in the context of a <Router> component.");let n=U.useContext(Ka),{basename:e,navigator:t}=U.useContext($n),{matches:r}=U.useContext(hr),{pathname:s}=ds(),a=JSON.stringify($m(r)),l=U.useRef(!1);return iE(()=>{l.current=!0}),U.useCallback((f,p={})=>{if(Bn(l.current,rE),!l.current)return;if(typeof f=="number"){t.go(f);return}let v=qm(f,JSON.parse(a),s,p.relative==="path");n==null&&e!=="/"&&(v.pathname=v.pathname==="/"?e:li([e,v.pathname])),(p.replace?t.replace:t.push)(v,p.state,p)},[e,t,a,s,n])}U.createContext(null);function Wm(){let{matches:n}=U.useContext(hr),e=n[n.length-1];return e?e.params:{}}function zu(n,{relative:e}={}){let{matches:t}=U.useContext(hr),{pathname:r}=ds(),s=JSON.stringify($m(t));return U.useMemo(()=>qm(n,JSON.parse(s),r,e==="path"),[n,s,r,e])}function Kk(n,e){return sE(n,e)}function sE(n,e,t,r,s){var Q;ot(Qa(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=U.useContext($n),{matches:l}=U.useContext(hr),d=l[l.length-1],f=d?d.params:{},p=d?d.pathname:"/",v=d?d.pathnameBase:"/",_=d&&d.route;{let H=_&&_.path||"";oE(p,!_||H.endsWith("*")||H.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${p}" (under <Route path="${H}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${H}"> to <Route path="${H==="/"?"*":`${H}/*`}">.`)}let x=ds(),S;if(e){let H=typeof e=="string"?Ga(e):e;ot(v==="/"||((Q=H.pathname)==null?void 0:Q.startsWith(v)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${v}" but pathname "${H.pathname}" was given in the \`location\` prop.`),S=H}else S=x;let N=S.pathname||"/",P=N;if(v!=="/"){let H=v.replace(/^\//,"").split("/");P="/"+N.replace(/^\//,"").split("/").slice(H.length).join("/")}let O=J0(n,{pathname:P});Bn(_||O!=null,`No routes matched location "${S.pathname}${S.search}${S.hash}" `),Bn(O==null||O[O.length-1].route.element!==void 0||O[O.length-1].route.Component!==void 0||O[O.length-1].route.lazy!==void 0,`Matched leaf route at location "${S.pathname}${S.search}${S.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let K=Zk(O&&O.map(H=>Object.assign({},H,{params:Object.assign({},f,H.params),pathname:li([v,a.encodeLocation?a.encodeLocation(H.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:H.pathname]),pathnameBase:H.pathnameBase==="/"?v:li([v,a.encodeLocation?a.encodeLocation(H.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:H.pathnameBase])})),l,t,r,s);return e&&K?U.createElement(Bu.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...S},navigationType:"POP"}},K):K}function Qk(){let n=i1(),e=Bk(n)?`${n.status} ${n.statusText}`:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,r="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:r},a={padding:"2px 4px",backgroundColor:r},l=null;return console.error("Error handled by React Router default ErrorBoundary:",n),l=U.createElement(U.Fragment,null,U.createElement("p",null," Hey developer "),U.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",U.createElement("code",{style:a},"ErrorBoundary")," or"," ",U.createElement("code",{style:a},"errorElement")," prop on your route.")),U.createElement(U.Fragment,null,U.createElement("h2",null,"Unexpected Application Error!"),U.createElement("h3",{style:{fontStyle:"italic"}},e),t?U.createElement("pre",{style:s},t):null,l)}var Yk=U.createElement(Qk,null),Xk=class extends U.Component{constructor(n){super(n),this.state={location:n.location,revalidation:n.revalidation,error:n.error}}static getDerivedStateFromError(n){return{error:n}}static getDerivedStateFromProps(n,e){return e.location!==n.location||e.revalidation!=="idle"&&n.revalidation==="idle"?{error:n.error,location:n.location,revalidation:n.revalidation}:{error:n.error!==void 0?n.error:e.error,location:e.location,revalidation:n.revalidation||e.revalidation}}componentDidCatch(n,e){this.props.onError?this.props.onError(n,e):console.error("React Router caught the following error during render",n)}render(){return this.state.error!==void 0?U.createElement(hr.Provider,{value:this.props.routeContext},U.createElement(Hm.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Jk({routeContext:n,match:e,children:t}){let r=U.useContext(Ka);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),U.createElement(hr.Provider,{value:n},t)}function Zk(n,e=[],t=null,r=null,s=null){if(n==null){if(!t)return null;if(t.errors)n=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let a=n,l=t==null?void 0:t.errors;if(l!=null){let v=a.findIndex(_=>_.route.id&&(l==null?void 0:l[_.route.id])!==void 0);ot(v>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(l).join(",")}`),a=a.slice(0,Math.min(a.length,v+1))}let d=!1,f=-1;if(t)for(let v=0;v<a.length;v++){let _=a[v];if((_.route.HydrateFallback||_.route.hydrateFallbackElement)&&(f=v),_.route.id){let{loaderData:x,errors:S}=t,N=_.route.loader&&!x.hasOwnProperty(_.route.id)&&(!S||S[_.route.id]===void 0);if(_.route.lazy||N){d=!0,f>=0?a=a.slice(0,f+1):a=[a[0]];break}}}let p=t&&r?(v,_)=>{var x,S;r(v,{location:t.location,params:((S=(x=t.matches)==null?void 0:x[0])==null?void 0:S.params)??{},unstable_pattern:zk(t.matches),errorInfo:_})}:void 0;return a.reduceRight((v,_,x)=>{let S,N=!1,P=null,O=null;t&&(S=l&&_.route.id?l[_.route.id]:void 0,P=_.route.errorElement||Yk,d&&(f<0&&x===0?(oE("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),N=!0,O=null):f===x&&(N=!0,O=_.route.hydrateFallbackElement||null)));let K=e.concat(a.slice(0,x+1)),Q=()=>{let H;return S?H=P:N?H=O:_.route.Component?H=U.createElement(_.route.Component,null):_.route.element?H=_.route.element:H=v,U.createElement(Jk,{match:_,routeContext:{outlet:v,matches:K,isDataRoute:t!=null},children:H})};return t&&(_.route.ErrorBoundary||_.route.errorElement||x===0)?U.createElement(Xk,{location:t.location,revalidation:t.revalidation,component:P,error:S,children:Q(),routeContext:{outlet:null,matches:K,isDataRoute:!0},onError:p}):Q()},null)}function Gm(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function e1(n){let e=U.useContext(Ka);return ot(e,Gm(n)),e}function t1(n){let e=U.useContext(xh);return ot(e,Gm(n)),e}function n1(n){let e=U.useContext(hr);return ot(e,Gm(n)),e}function Km(n){let e=n1(n),t=e.matches[e.matches.length-1];return ot(t.route.id,`${n} can only be used on routes that contain a unique "id"`),t.route.id}function r1(){return Km("useRouteId")}function i1(){var r;let n=U.useContext(Hm),e=t1("useRouteError"),t=Km("useRouteError");return n!==void 0?n:(r=e.errors)==null?void 0:r[t]}function s1(){let{router:n}=e1("useNavigate"),e=Km("useNavigate"),t=U.useRef(!1);return iE(()=>{t.current=!0}),U.useCallback(async(s,a={})=>{Bn(t.current,rE),t.current&&(typeof s=="number"?await n.navigate(s):await n.navigate(s,{fromRouteId:e,...a}))},[n,e])}var L_={};function oE(n,e,t){!e&&!L_[n]&&(L_[n]=!0,Bn(!1,t))}U.memo(o1);function o1({routes:n,future:e,state:t,unstable_onError:r}){return sE(n,void 0,t,r,e)}function a1({to:n,replace:e,state:t,relative:r}){ot(Qa(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=U.useContext($n);Bn(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:a}=U.useContext(hr),{pathname:l}=ds(),d=qn(),f=qm(n,$m(a),l,r==="path"),p=JSON.stringify(f);return U.useEffect(()=>{d(JSON.parse(p),{replace:e,state:t,relative:r})},[d,p,r,e,t]),null}function kr(n){ot(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function l1({basename:n="/",children:e=null,location:t,navigationType:r="POP",navigator:s,static:a=!1,unstable_useTransitions:l}){ot(!Qa(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let d=n.replace(/^\/*/,"/"),f=U.useMemo(()=>({basename:d,navigator:s,static:a,unstable_useTransitions:l,future:{}}),[d,s,a,l]);typeof t=="string"&&(t=Ga(t));let{pathname:p="/",search:v="",hash:_="",state:x=null,key:S="default"}=t,N=U.useMemo(()=>{let P=ci(p,d);return P==null?null:{location:{pathname:P,search:v,hash:_,state:x,key:S},navigationType:r}},[d,p,v,_,x,S,r]);return Bn(N!=null,`<Router basename="${d}"> is not able to match the URL "${p}${v}${_}" because it does not start with the basename, so the <Router> won't render anything.`),N==null?null:U.createElement($n.Provider,{value:f},U.createElement(Bu.Provider,{children:e,value:N}))}function u1({children:n,location:e}){return Kk(im(n),e)}function im(n,e=[]){let t=[];return U.Children.forEach(n,(r,s)=>{if(!U.isValidElement(r))return;let a=[...e,s];if(r.type===U.Fragment){t.push.apply(t,im(r.props.children,a));return}ot(r.type===kr,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),ot(!r.props.index||!r.props.children,"An index route cannot have child routes.");let l={id:r.props.id||a.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(l.children=im(r.props.children,a)),t.push(l)}),t}var Cd="get",Pd="application/x-www-form-urlencoded";function Th(n){return typeof HTMLElement<"u"&&n instanceof HTMLElement}function c1(n){return Th(n)&&n.tagName.toLowerCase()==="button"}function d1(n){return Th(n)&&n.tagName.toLowerCase()==="form"}function h1(n){return Th(n)&&n.tagName.toLowerCase()==="input"}function f1(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function p1(n,e){return n.button===0&&(!e||e==="_self")&&!f1(n)}var wd=null;function m1(){if(wd===null)try{new FormData(document.createElement("form"),0),wd=!1}catch{wd=!0}return wd}var g1=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Up(n){return n!=null&&!g1.has(n)?(Bn(!1,`"${n}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Pd}"`),null):n}function y1(n,e){let t,r,s,a,l;if(d1(n)){let d=n.getAttribute("action");r=d?ci(d,e):null,t=n.getAttribute("method")||Cd,s=Up(n.getAttribute("enctype"))||Pd,a=new FormData(n)}else if(c1(n)||h1(n)&&(n.type==="submit"||n.type==="image")){let d=n.form;if(d==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let f=n.getAttribute("formaction")||d.getAttribute("action");if(r=f?ci(f,e):null,t=n.getAttribute("formmethod")||d.getAttribute("method")||Cd,s=Up(n.getAttribute("formenctype"))||Up(d.getAttribute("enctype"))||Pd,a=new FormData(d,n),!m1()){let{name:p,type:v,value:_}=n;if(v==="image"){let x=p?`${p}.`:"";a.append(`${x}x`,"0"),a.append(`${x}y`,"0")}else p&&a.append(p,_)}}else{if(Th(n))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=Cd,r=null,s=Pd,l=n}return a&&s==="text/plain"&&(l=a,a=void 0),{action:r,method:t.toLowerCase(),encType:s,formData:a,body:l}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Qm(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function v1(n,e,t){let r=typeof n=="string"?new URL(n,typeof window>"u"?"server://singlefetch/":window.location.origin):n;return r.pathname==="/"?r.pathname=`_root.${t}`:e&&ci(r.pathname,e)==="/"?r.pathname=`${e.replace(/\/$/,"")}/_root.${t}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${t}`,r}async function _1(n,e){if(n.id in e)return e[n.id];try{let t=await import(n.module);return e[n.id]=t,t}catch(t){return console.error(`Error loading route module \`${n.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function w1(n){return n==null?!1:n.href==null?n.rel==="preload"&&typeof n.imageSrcSet=="string"&&typeof n.imageSizes=="string":typeof n.rel=="string"&&typeof n.href=="string"}async function E1(n,e,t){let r=await Promise.all(n.map(async s=>{let a=e.routes[s.route.id];if(a){let l=await _1(a,t);return l.links?l.links():[]}return[]}));return S1(r.flat(1).filter(w1).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function M_(n,e,t,r,s,a){let l=(f,p)=>t[p]?f.route.id!==t[p].route.id:!0,d=(f,p)=>{var v;return t[p].pathname!==f.pathname||((v=t[p].route.path)==null?void 0:v.endsWith("*"))&&t[p].params["*"]!==f.params["*"]};return a==="assets"?e.filter((f,p)=>l(f,p)||d(f,p)):a==="data"?e.filter((f,p)=>{var _;let v=r.routes[f.route.id];if(!v||!v.hasLoader)return!1;if(l(f,p)||d(f,p))return!0;if(f.route.shouldRevalidate){let x=f.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:((_=t[0])==null?void 0:_.params)||{},nextUrl:new URL(n,window.origin),nextParams:f.params,defaultShouldRevalidate:!0});if(typeof x=="boolean")return x}return!0}):[]}function I1(n,e,{includeHydrateFallback:t}={}){return x1(n.map(r=>{let s=e.routes[r.route.id];if(!s)return[];let a=[s.module];return s.clientActionModule&&(a=a.concat(s.clientActionModule)),s.clientLoaderModule&&(a=a.concat(s.clientLoaderModule)),t&&s.hydrateFallbackModule&&(a=a.concat(s.hydrateFallbackModule)),s.imports&&(a=a.concat(s.imports)),a}).flat(1))}function x1(n){return[...new Set(n)]}function T1(n){let e={},t=Object.keys(n).sort();for(let r of t)e[r]=n[r];return e}function S1(n,e){let t=new Set;return new Set(e),n.reduce((r,s)=>{let a=JSON.stringify(T1(s));return t.has(a)||(t.add(a),r.push({key:a,link:s})),r},[])}function aE(){let n=U.useContext(Ka);return Qm(n,"You must render this element inside a <DataRouterContext.Provider> element"),n}function k1(){let n=U.useContext(xh);return Qm(n,"You must render this element inside a <DataRouterStateContext.Provider> element"),n}var Ym=U.createContext(void 0);Ym.displayName="FrameworkContext";function lE(){let n=U.useContext(Ym);return Qm(n,"You must render this element inside a <HydratedRouter> element"),n}function b1(n,e){let t=U.useContext(Ym),[r,s]=U.useState(!1),[a,l]=U.useState(!1),{onFocus:d,onBlur:f,onMouseEnter:p,onMouseLeave:v,onTouchStart:_}=e,x=U.useRef(null);U.useEffect(()=>{if(n==="render"&&l(!0),n==="viewport"){let P=K=>{K.forEach(Q=>{l(Q.isIntersecting)})},O=new IntersectionObserver(P,{threshold:.5});return x.current&&O.observe(x.current),()=>{O.disconnect()}}},[n]),U.useEffect(()=>{if(r){let P=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(P)}}},[r]);let S=()=>{s(!0)},N=()=>{s(!1),l(!1)};return t?n!=="intent"?[a,x,{}]:[a,x,{onFocus:nu(d,S),onBlur:nu(f,N),onMouseEnter:nu(p,S),onMouseLeave:nu(v,N),onTouchStart:nu(_,S)}]:[!1,x,{}]}function nu(n,e){return t=>{n&&n(t),t.defaultPrevented||e(t)}}function A1({page:n,...e}){let{router:t}=aE(),r=U.useMemo(()=>J0(t.routes,n,t.basename),[t.routes,n,t.basename]);return r?U.createElement(C1,{page:n,matches:r,...e}):null}function R1(n){let{manifest:e,routeModules:t}=lE(),[r,s]=U.useState([]);return U.useEffect(()=>{let a=!1;return E1(n,e,t).then(l=>{a||s(l)}),()=>{a=!0}},[n,e,t]),r}function C1({page:n,matches:e,...t}){let r=ds(),{manifest:s,routeModules:a}=lE(),{basename:l}=aE(),{loaderData:d,matches:f}=k1(),p=U.useMemo(()=>M_(n,e,f,s,r,"data"),[n,e,f,s,r]),v=U.useMemo(()=>M_(n,e,f,s,r,"assets"),[n,e,f,s,r]),_=U.useMemo(()=>{if(n===r.pathname+r.search+r.hash)return[];let N=new Set,P=!1;if(e.forEach(K=>{var H;let Q=s.routes[K.route.id];!Q||!Q.hasLoader||(!p.some(se=>se.route.id===K.route.id)&&K.route.id in d&&((H=a[K.route.id])!=null&&H.shouldRevalidate)||Q.hasClientLoader?P=!0:N.add(K.route.id))}),N.size===0)return[];let O=v1(n,l,"data");return P&&N.size>0&&O.searchParams.set("_routes",e.filter(K=>N.has(K.route.id)).map(K=>K.route.id).join(",")),[O.pathname+O.search]},[l,d,r,s,p,e,n,a]),x=U.useMemo(()=>I1(v,s),[v,s]),S=R1(v);return U.createElement(U.Fragment,null,_.map(N=>U.createElement("link",{key:N,rel:"prefetch",as:"fetch",href:N,...t})),x.map(N=>U.createElement("link",{key:N,rel:"modulepreload",href:N,...t})),S.map(({key:N,link:P})=>U.createElement("link",{key:N,nonce:t.nonce,...P})))}function P1(...n){return e=>{n.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var uE=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{uE&&(window.__reactRouterVersion="7.10.1")}catch{}function N1({basename:n,children:e,unstable_useTransitions:t,window:r}){let s=U.useRef();s.current==null&&(s.current=yk({window:r,v5Compat:!0}));let a=s.current,[l,d]=U.useState({action:a.action,location:a.location}),f=U.useCallback(p=>{t===!1?d(p):U.startTransition(()=>d(p))},[t]);return U.useLayoutEffect(()=>a.listen(f),[a,f]),U.createElement(l1,{basename:n,children:e,location:l.location,navigationType:l.action,navigator:a,unstable_useTransitions:t===!0})}var cE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,dE=U.forwardRef(function({onClick:e,discover:t="render",prefetch:r="none",relative:s,reloadDocument:a,replace:l,state:d,target:f,to:p,preventScrollReset:v,viewTransition:_,...x},S){let{basename:N,unstable_useTransitions:P}=U.useContext($n),O=typeof p=="string"&&cE.test(p),K,Q=!1;if(typeof p=="string"&&O&&(K=p,uE))try{let D=new URL(window.location.href),L=p.startsWith("//")?new URL(D.protocol+p):new URL(p),j=ci(L.pathname,N);L.origin===D.origin&&j!=null?p=j+L.search+L.hash:Q=!0}catch{Bn(!1,`<Link to="${p}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let H=Wk(p,{relative:s}),[se,ce,re]=b1(r,x),C=O1(p,{replace:l,state:d,target:f,preventScrollReset:v,relative:s,viewTransition:_,unstable_useTransitions:P});function k(D){e&&e(D),D.defaultPrevented||C(D)}let A=U.createElement("a",{...x,...re,href:K||H,onClick:Q||a?e:k,ref:P1(S,ce),target:f,"data-discover":!O&&t==="render"?"true":void 0});return se&&!O?U.createElement(U.Fragment,null,A,U.createElement(A1,{page:H})):A});dE.displayName="Link";var hE=U.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:r="",end:s=!1,style:a,to:l,viewTransition:d,children:f,...p},v){let _=zu(l,{relative:p.relative}),x=ds(),S=U.useContext(xh),{navigator:N,basename:P}=U.useContext($n),O=S!=null&&U1(_)&&d===!0,K=N.encodeLocation?N.encodeLocation(_).pathname:_.pathname,Q=x.pathname,H=S&&S.navigation&&S.navigation.location?S.navigation.location.pathname:null;t||(Q=Q.toLowerCase(),H=H?H.toLowerCase():null,K=K.toLowerCase()),H&&P&&(H=ci(H,P)||H);const se=K!=="/"&&K.endsWith("/")?K.length-1:K.length;let ce=Q===K||!s&&Q.startsWith(K)&&Q.charAt(se)==="/",re=H!=null&&(H===K||!s&&H.startsWith(K)&&H.charAt(K.length)==="/"),C={isActive:ce,isPending:re,isTransitioning:O},k=ce?e:void 0,A;typeof r=="function"?A=r(C):A=[r,ce?"active":null,re?"pending":null,O?"transitioning":null].filter(Boolean).join(" ");let D=typeof a=="function"?a(C):a;return U.createElement(dE,{...p,"aria-current":k,className:A,ref:v,style:D,to:l,viewTransition:d},typeof f=="function"?f(C):f)});hE.displayName="NavLink";var D1=U.forwardRef(({discover:n="render",fetcherKey:e,navigate:t,reloadDocument:r,replace:s,state:a,method:l=Cd,action:d,onSubmit:f,relative:p,preventScrollReset:v,viewTransition:_,...x},S)=>{let{unstable_useTransitions:N}=U.useContext($n),P=j1(),O=F1(d,{relative:p}),K=l.toLowerCase()==="get"?"get":"post",Q=typeof d=="string"&&cE.test(d),H=se=>{if(f&&f(se),se.defaultPrevented)return;se.preventDefault();let ce=se.nativeEvent.submitter,re=(ce==null?void 0:ce.getAttribute("formmethod"))||l,C=()=>P(ce||se.currentTarget,{fetcherKey:e,method:re,navigate:t,replace:s,state:a,relative:p,preventScrollReset:v,viewTransition:_});N&&t!==!1?U.startTransition(()=>C()):C()};return U.createElement("form",{ref:S,method:K,action:O,onSubmit:r?f:H,...x,"data-discover":!Q&&n==="render"?"true":void 0})});D1.displayName="Form";function V1(n){return`${n} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function fE(n){let e=U.useContext(Ka);return ot(e,V1(n)),e}function O1(n,{target:e,replace:t,state:r,preventScrollReset:s,relative:a,viewTransition:l,unstable_useTransitions:d}={}){let f=qn(),p=ds(),v=zu(n,{relative:a});return U.useCallback(_=>{if(p1(_,e)){_.preventDefault();let x=t!==void 0?t:Tu(p)===Tu(v),S=()=>f(n,{replace:x,state:r,preventScrollReset:s,relative:a,viewTransition:l});d?U.startTransition(()=>S()):S()}},[p,f,v,t,r,e,n,s,a,l,d])}var L1=0,M1=()=>`__${String(++L1)}__`;function j1(){let{router:n}=fE("useSubmit"),{basename:e}=U.useContext($n),t=r1(),r=n.fetch,s=n.navigate;return U.useCallback(async(a,l={})=>{let{action:d,method:f,encType:p,formData:v,body:_}=y1(a,e);if(l.navigate===!1){let x=l.fetcherKey||M1();await r(x,t,l.action||d,{preventScrollReset:l.preventScrollReset,formData:v,body:_,formMethod:l.method||f,formEncType:l.encType||p,flushSync:l.flushSync})}else await s(l.action||d,{preventScrollReset:l.preventScrollReset,formData:v,body:_,formMethod:l.method||f,formEncType:l.encType||p,replace:l.replace,state:l.state,fromRouteId:t,flushSync:l.flushSync,viewTransition:l.viewTransition})},[r,s,e,t])}function F1(n,{relative:e}={}){let{basename:t}=U.useContext($n),r=U.useContext(hr);ot(r,"useFormAction must be used inside a RouteContext");let[s]=r.matches.slice(-1),a={...zu(n||".",{relative:e})},l=ds();if(n==null){a.search=l.search;let d=new URLSearchParams(a.search),f=d.getAll("index");if(f.some(v=>v==="")){d.delete("index"),f.filter(_=>_).forEach(_=>d.append("index",_));let v=d.toString();a.search=v?`?${v}`:""}}return(!n||n===".")&&s.route.index&&(a.search=a.search?a.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(a.pathname=a.pathname==="/"?t:li([t,a.pathname])),Tu(a)}function U1(n,{relative:e}={}){let t=U.useContext(nE);ot(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=fE("useViewTransitionState"),s=zu(n,{relative:e});if(!t.isTransitioning)return!1;let a=ci(t.currentLocation.pathname,r)||t.currentLocation.pathname,l=ci(t.nextLocation.pathname,r)||t.nextLocation.pathname;return Kd(s.pathname,l)!=null||Kd(s.pathname,a)!=null}const j_=n=>{let e;const t=new Set,r=(p,v)=>{const _=typeof p=="function"?p(e):p;if(!Object.is(_,e)){const x=e;e=v??(typeof _!="object"||_===null)?_:Object.assign({},e,_),t.forEach(S=>S(e,x))}},s=()=>e,d={setState:r,getState:s,getInitialState:()=>f,subscribe:p=>(t.add(p),()=>t.delete(p))},f=e=n(r,s,d);return d},B1=(n=>n?j_(n):j_),z1=n=>n;function $1(n,e=z1){const t=Sa.useSyncExternalStore(n.subscribe,Sa.useCallback(()=>e(n.getState()),[n,e]),Sa.useCallback(()=>e(n.getInitialState()),[n,e]));return Sa.useDebugValue(t),t}const F_=n=>{const e=B1(n),t=r=>$1(e,r);return Object.assign(t,e),t},Xm=(n=>n?F_(n):F_),go=Xm(n=>({user:null,isLoading:!0,isAuthenticated:!1,setUser:e=>n({user:e,isAuthenticated:!!e}),setLoading:e=>n({isLoading:e}),clearUser:()=>n({user:null,isAuthenticated:!1})})),q1=()=>{};var U_={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pE=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let s=n.charCodeAt(r);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},H1=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const s=n[t++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const a=n[t++];e[r++]=String.fromCharCode((s&31)<<6|a&63)}else if(s>239&&s<365){const a=n[t++],l=n[t++],d=n[t++],f=((s&7)<<18|(a&63)<<12|(l&63)<<6|d&63)-65536;e[r++]=String.fromCharCode(55296+(f>>10)),e[r++]=String.fromCharCode(56320+(f&1023))}else{const a=n[t++],l=n[t++];e[r++]=String.fromCharCode((s&15)<<12|(a&63)<<6|l&63)}}return e.join("")},mE={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<n.length;s+=3){const a=n[s],l=s+1<n.length,d=l?n[s+1]:0,f=s+2<n.length,p=f?n[s+2]:0,v=a>>2,_=(a&3)<<4|d>>4;let x=(d&15)<<2|p>>6,S=p&63;f||(S=64,l||(x=64)),r.push(t[v],t[_],t[x],t[S])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(pE(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):H1(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<n.length;){const a=t[n.charAt(s++)],d=s<n.length?t[n.charAt(s)]:0;++s;const p=s<n.length?t[n.charAt(s)]:64;++s;const _=s<n.length?t[n.charAt(s)]:64;if(++s,a==null||d==null||p==null||_==null)throw new W1;const x=a<<2|d>>4;if(r.push(x),p!==64){const S=d<<4&240|p>>2;if(r.push(S),_!==64){const N=p<<6&192|_;r.push(N)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class W1 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const G1=function(n){const e=pE(n);return mE.encodeByteArray(e,!0)},Qd=function(n){return G1(n).replace(/\./g,"")},gE=function(n){try{return mE.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yE(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K1=()=>yE().__FIREBASE_DEFAULTS__,Q1=()=>{if(typeof process>"u"||typeof U_>"u")return;const n=U_.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},Y1=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&gE(n[1]);return e&&JSON.parse(e)},Sh=()=>{try{return q1()||K1()||Q1()||Y1()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},vE=n=>{var e,t;return(t=(e=Sh())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},X1=n=>{const e=vE(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},_E=()=>{var n;return(n=Sh())===null||n===void 0?void 0:n.config},wE=n=>{var e;return(e=Sh())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J1{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ya(n){try{return(n.startsWith("http://")||n.startsWith("https://")?new URL(n).hostname:n).endsWith(".cloudworkstations.dev")}catch{return!1}}async function EE(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z1(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",s=n.iat||0,a=n.sub||n.user_id;if(!a)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:a,user_id:a,firebase:{sign_in_provider:"custom",identities:{}}},n);return[Qd(JSON.stringify(t)),Qd(JSON.stringify(l)),""].join(".")}const fu={};function eb(){const n={prod:[],emulator:[]};for(const e of Object.keys(fu))fu[e]?n.emulator.push(e):n.prod.push(e);return n}function tb(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let B_=!1;function IE(n,e){if(typeof window>"u"||typeof document>"u"||!Ya(window.location.host)||fu[n]===e||fu[n]||B_)return;fu[n]=e;function t(x){return`__firebase__banner__${x}`}const r="__firebase__banner",a=eb().prod.length>0;function l(){const x=document.getElementById(r);x&&x.remove()}function d(x){x.style.display="flex",x.style.background="#7faaf0",x.style.position="fixed",x.style.bottom="5px",x.style.left="5px",x.style.padding=".5em",x.style.borderRadius="5px",x.style.alignItems="center"}function f(x,S){x.setAttribute("width","24"),x.setAttribute("id",S),x.setAttribute("height","24"),x.setAttribute("viewBox","0 0 24 24"),x.setAttribute("fill","none"),x.style.marginLeft="-6px"}function p(){const x=document.createElement("span");return x.style.cursor="pointer",x.style.marginLeft="16px",x.style.fontSize="24px",x.innerHTML=" &times;",x.onclick=()=>{B_=!0,l()},x}function v(x,S){x.setAttribute("id",S),x.innerText="Learn more",x.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",x.setAttribute("target","__blank"),x.style.paddingLeft="5px",x.style.textDecoration="underline"}function _(){const x=tb(r),S=t("text"),N=document.getElementById(S)||document.createElement("span"),P=t("learnmore"),O=document.getElementById(P)||document.createElement("a"),K=t("preprendIcon"),Q=document.getElementById(K)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(x.created){const H=x.element;d(H),v(O,P);const se=p();f(Q,K),H.append(Q,N,O,se),document.body.appendChild(H)}a?(N.innerText="Preview backend disconnected.",Q.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(Q.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,N.innerText="Preview backend running in this workspace."),N.setAttribute("id",S)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",_):_()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function At(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function nb(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(At())}function xE(){var n;const e=(n=Sh())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function rb(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Jm(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function ib(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function sb(){const n=At();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function TE(){return!xE()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function SE(){return!xE()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function kh(){try{return typeof indexedDB=="object"}catch{return!1}}function Zm(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{var a;e(((a=s.error)===null||a===void 0?void 0:a.message)||"")}}catch(t){e(t)}})}function kE(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ob="FirebaseError";class fr extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=ob,Object.setPrototypeOf(this,fr.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,yo.prototype.create)}}class yo{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},s=`${this.service}/${e}`,a=this.errors[e],l=a?ab(a,r):"Error",d=`${this.serviceName}: ${l} (${s}).`;return new fr(s,d,r)}}function ab(n,e){return n.replace(lb,(t,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const lb=/\{\$([^}]+)}/g;function ub(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function ss(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const s of t){if(!r.includes(s))return!1;const a=n[s],l=e[s];if(z_(a)&&z_(l)){if(!ss(a,l))return!1}else if(a!==l)return!1}for(const s of r)if(!t.includes(s))return!1;return!0}function z_(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $u(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function cb(n,e){const t=new db(n,e);return t.subscribe.bind(t)}class db{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let s;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");hb(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:r},s.next===void 0&&(s.next=Bp),s.error===void 0&&(s.error=Bp),s.complete===void 0&&(s.complete=Bp);const a=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),a}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function hb(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function Bp(){}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fb=1e3,pb=2,mb=14400*1e3,gb=.5;function $_(n,e=fb,t=pb){const r=e*Math.pow(t,n),s=Math.round(gb*r*(Math.random()-.5)*2);return Math.min(mb,r+s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Et(n){return n&&n._delegate?n._delegate:n}class dr{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $s="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yb{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new J1;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(a){if(s)return null;throw a}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(_b(e))try{this.getOrInitializeService({instanceIdentifier:$s})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const a=this.getOrInitializeService({instanceIdentifier:s});r.resolve(a)}catch{}}}}clearInstance(e=$s){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=$s){return this.instances.has(e)}getOptions(e=$s){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[a,l]of this.instancesDeferred.entries()){const d=this.normalizeInstanceIdentifier(a);r===d&&l.resolve(s)}return s}onInit(e,t){var r;const s=this.normalizeInstanceIdentifier(t),a=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;a.add(e),this.onInitCallbacks.set(s,a);const l=this.instances.get(s);return l&&e(l,s),()=>{a.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const s of r)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:vb(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=$s){return this.component?this.component.multipleInstances?e:$s:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function vb(n){return n===$s?void 0:n}function _b(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wb{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new yb(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ne;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Ne||(Ne={}));const Eb={debug:Ne.DEBUG,verbose:Ne.VERBOSE,info:Ne.INFO,warn:Ne.WARN,error:Ne.ERROR,silent:Ne.SILENT},Ib=Ne.INFO,xb={[Ne.DEBUG]:"log",[Ne.VERBOSE]:"log",[Ne.INFO]:"info",[Ne.WARN]:"warn",[Ne.ERROR]:"error"},Tb=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),s=xb[e];if(s)console[s](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class bh{constructor(e){this.name=e,this._logLevel=Ib,this._logHandler=Tb,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ne))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Eb[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ne.DEBUG,...e),this._logHandler(this,Ne.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ne.VERBOSE,...e),this._logHandler(this,Ne.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ne.INFO,...e),this._logHandler(this,Ne.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ne.WARN,...e),this._logHandler(this,Ne.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ne.ERROR,...e),this._logHandler(this,Ne.ERROR,...e)}}const Sb=(n,e)=>e.some(t=>n instanceof t);let q_,H_;function kb(){return q_||(q_=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function bb(){return H_||(H_=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const bE=new WeakMap,sm=new WeakMap,AE=new WeakMap,zp=new WeakMap,eg=new WeakMap;function Ab(n){const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("success",a),n.removeEventListener("error",l)},a=()=>{t(es(n.result)),s()},l=()=>{r(n.error),s()};n.addEventListener("success",a),n.addEventListener("error",l)});return e.then(t=>{t instanceof IDBCursor&&bE.set(t,n)}).catch(()=>{}),eg.set(e,n),e}function Rb(n){if(sm.has(n))return;const e=new Promise((t,r)=>{const s=()=>{n.removeEventListener("complete",a),n.removeEventListener("error",l),n.removeEventListener("abort",l)},a=()=>{t(),s()},l=()=>{r(n.error||new DOMException("AbortError","AbortError")),s()};n.addEventListener("complete",a),n.addEventListener("error",l),n.addEventListener("abort",l)});sm.set(n,e)}let om={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return sm.get(n);if(e==="objectStoreNames")return n.objectStoreNames||AE.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return es(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function Cb(n){om=n(om)}function Pb(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call($p(this),e,...t);return AE.set(r,e.sort?e.sort():[e]),es(r)}:bb().includes(n)?function(...e){return n.apply($p(this),e),es(bE.get(this))}:function(...e){return es(n.apply($p(this),e))}}function Nb(n){return typeof n=="function"?Pb(n):(n instanceof IDBTransaction&&Rb(n),Sb(n,kb())?new Proxy(n,om):n)}function es(n){if(n instanceof IDBRequest)return Ab(n);if(zp.has(n))return zp.get(n);const e=Nb(n);return e!==n&&(zp.set(n,e),eg.set(e,n)),e}const $p=n=>eg.get(n);function RE(n,e,{blocked:t,upgrade:r,blocking:s,terminated:a}={}){const l=indexedDB.open(n,e),d=es(l);return r&&l.addEventListener("upgradeneeded",f=>{r(es(l.result),f.oldVersion,f.newVersion,es(l.transaction),f)}),t&&l.addEventListener("blocked",f=>t(f.oldVersion,f.newVersion,f)),d.then(f=>{a&&f.addEventListener("close",()=>a()),s&&f.addEventListener("versionchange",p=>s(p.oldVersion,p.newVersion,p))}).catch(()=>{}),d}const Db=["get","getKey","getAll","getAllKeys","count"],Vb=["put","add","delete","clear"],qp=new Map;function W_(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(qp.get(e))return qp.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,s=Vb.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(s||Db.includes(t)))return;const a=async function(l,...d){const f=this.transaction(l,s?"readwrite":"readonly");let p=f.store;return r&&(p=p.index(d.shift())),(await Promise.all([p[t](...d),s&&f.done]))[0]};return qp.set(e,a),a}Cb(n=>({...n,get:(e,t,r)=>W_(e,t)||n.get(e,t,r),has:(e,t)=>!!W_(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ob{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Lb(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function Lb(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const am="@firebase/app",G_="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const di=new bh("@firebase/app"),Mb="@firebase/app-compat",jb="@firebase/analytics-compat",Fb="@firebase/analytics",Ub="@firebase/app-check-compat",Bb="@firebase/app-check",zb="@firebase/auth",$b="@firebase/auth-compat",qb="@firebase/database",Hb="@firebase/data-connect",Wb="@firebase/database-compat",Gb="@firebase/functions",Kb="@firebase/functions-compat",Qb="@firebase/installations",Yb="@firebase/installations-compat",Xb="@firebase/messaging",Jb="@firebase/messaging-compat",Zb="@firebase/performance",eA="@firebase/performance-compat",tA="@firebase/remote-config",nA="@firebase/remote-config-compat",rA="@firebase/storage",iA="@firebase/storage-compat",sA="@firebase/firestore",oA="@firebase/ai",aA="@firebase/firestore-compat",lA="firebase",uA="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lm="[DEFAULT]",cA={[am]:"fire-core",[Mb]:"fire-core-compat",[Fb]:"fire-analytics",[jb]:"fire-analytics-compat",[Bb]:"fire-app-check",[Ub]:"fire-app-check-compat",[zb]:"fire-auth",[$b]:"fire-auth-compat",[qb]:"fire-rtdb",[Hb]:"fire-data-connect",[Wb]:"fire-rtdb-compat",[Gb]:"fire-fn",[Kb]:"fire-fn-compat",[Qb]:"fire-iid",[Yb]:"fire-iid-compat",[Xb]:"fire-fcm",[Jb]:"fire-fcm-compat",[Zb]:"fire-perf",[eA]:"fire-perf-compat",[tA]:"fire-rc",[nA]:"fire-rc-compat",[rA]:"fire-gcs",[iA]:"fire-gcs-compat",[sA]:"fire-fst",[aA]:"fire-fst-compat",[oA]:"fire-vertex","fire-js":"fire-js",[lA]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yd=new Map,dA=new Map,um=new Map;function K_(n,e){try{n.container.addComponent(e)}catch(t){di.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Lr(n){const e=n.name;if(um.has(e))return di.debug(`There were multiple attempts to register component ${e}.`),!1;um.set(e,n);for(const t of Yd.values())K_(t,n);for(const t of dA.values())K_(t,n);return!0}function vo(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function ar(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hA={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ts=new yo("app","Firebase",hA);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fA{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new dr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ts.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xa=uA;function CE(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:lm,automaticDataCollectionEnabled:!0},e),s=r.name;if(typeof s!="string"||!s)throw ts.create("bad-app-name",{appName:String(s)});if(t||(t=_E()),!t)throw ts.create("no-options");const a=Yd.get(s);if(a){if(ss(t,a.options)&&ss(r,a.config))return a;throw ts.create("duplicate-app",{appName:s})}const l=new wb(s);for(const f of um.values())l.addComponent(f);const d=new fA(t,r,l);return Yd.set(s,d),d}function tg(n=lm){const e=Yd.get(n);if(!e&&n===lm&&_E())return CE();if(!e)throw ts.create("no-app",{appName:n});return e}function Fn(n,e,t){var r;let s=(r=cA[n])!==null&&r!==void 0?r:n;t&&(s+=`-${t}`);const a=s.match(/\s|\//),l=e.match(/\s|\//);if(a||l){const d=[`Unable to register library "${s}" with version "${e}":`];a&&d.push(`library name "${s}" contains illegal characters (whitespace or "/")`),a&&l&&d.push("and"),l&&d.push(`version name "${e}" contains illegal characters (whitespace or "/")`),di.warn(d.join(" "));return}Lr(new dr(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pA="firebase-heartbeat-database",mA=1,Su="firebase-heartbeat-store";let Hp=null;function PE(){return Hp||(Hp=RE(pA,mA,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(Su)}catch(t){console.warn(t)}}}}).catch(n=>{throw ts.create("idb-open",{originalErrorMessage:n.message})})),Hp}async function gA(n){try{const t=(await PE()).transaction(Su),r=await t.objectStore(Su).get(NE(n));return await t.done,r}catch(e){if(e instanceof fr)di.warn(e.message);else{const t=ts.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});di.warn(t.message)}}}async function Q_(n,e){try{const r=(await PE()).transaction(Su,"readwrite");await r.objectStore(Su).put(e,NE(n)),await r.done}catch(t){if(t instanceof fr)di.warn(t.message);else{const r=ts.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});di.warn(r.message)}}}function NE(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yA=1024,vA=30;class _A{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new EA(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),a=Y_();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===a||this._heartbeatsCache.heartbeats.some(l=>l.date===a))return;if(this._heartbeatsCache.heartbeats.push({date:a,agent:s}),this._heartbeatsCache.heartbeats.length>vA){const l=IA(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(l,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){di.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=Y_(),{heartbeatsToSend:r,unsentEntries:s}=wA(this._heartbeatsCache.heartbeats),a=Qd(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),a}catch(t){return di.warn(t),""}}}function Y_(){return new Date().toISOString().substring(0,10)}function wA(n,e=yA){const t=[];let r=n.slice();for(const s of n){const a=t.find(l=>l.agent===s.agent);if(a){if(a.dates.push(s.date),X_(t)>e){a.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),X_(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class EA{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return kh()?Zm().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await gA(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return Q_(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const s=await this.read();return Q_(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function X_(n){return Qd(JSON.stringify({version:2,heartbeats:n})).length}function IA(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xA(n){Lr(new dr("platform-logger",e=>new Ob(e),"PRIVATE")),Lr(new dr("heartbeat",e=>new _A(e),"PRIVATE")),Fn(am,G_,n),Fn(am,G_,"esm2017"),Fn("fire-js","")}xA("");var J_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ns,DE;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(C,k){function A(){}A.prototype=k.prototype,C.D=k.prototype,C.prototype=new A,C.prototype.constructor=C,C.C=function(D,L,j){for(var R=Array(arguments.length-2),Ke=2;Ke<arguments.length;Ke++)R[Ke-2]=arguments[Ke];return k.prototype[L].apply(D,R)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(C,k,A){A||(A=0);var D=Array(16);if(typeof k=="string")for(var L=0;16>L;++L)D[L]=k.charCodeAt(A++)|k.charCodeAt(A++)<<8|k.charCodeAt(A++)<<16|k.charCodeAt(A++)<<24;else for(L=0;16>L;++L)D[L]=k[A++]|k[A++]<<8|k[A++]<<16|k[A++]<<24;k=C.g[0],A=C.g[1],L=C.g[2];var j=C.g[3],R=k+(j^A&(L^j))+D[0]+3614090360&4294967295;k=A+(R<<7&4294967295|R>>>25),R=j+(L^k&(A^L))+D[1]+3905402710&4294967295,j=k+(R<<12&4294967295|R>>>20),R=L+(A^j&(k^A))+D[2]+606105819&4294967295,L=j+(R<<17&4294967295|R>>>15),R=A+(k^L&(j^k))+D[3]+3250441966&4294967295,A=L+(R<<22&4294967295|R>>>10),R=k+(j^A&(L^j))+D[4]+4118548399&4294967295,k=A+(R<<7&4294967295|R>>>25),R=j+(L^k&(A^L))+D[5]+1200080426&4294967295,j=k+(R<<12&4294967295|R>>>20),R=L+(A^j&(k^A))+D[6]+2821735955&4294967295,L=j+(R<<17&4294967295|R>>>15),R=A+(k^L&(j^k))+D[7]+4249261313&4294967295,A=L+(R<<22&4294967295|R>>>10),R=k+(j^A&(L^j))+D[8]+1770035416&4294967295,k=A+(R<<7&4294967295|R>>>25),R=j+(L^k&(A^L))+D[9]+2336552879&4294967295,j=k+(R<<12&4294967295|R>>>20),R=L+(A^j&(k^A))+D[10]+4294925233&4294967295,L=j+(R<<17&4294967295|R>>>15),R=A+(k^L&(j^k))+D[11]+2304563134&4294967295,A=L+(R<<22&4294967295|R>>>10),R=k+(j^A&(L^j))+D[12]+1804603682&4294967295,k=A+(R<<7&4294967295|R>>>25),R=j+(L^k&(A^L))+D[13]+4254626195&4294967295,j=k+(R<<12&4294967295|R>>>20),R=L+(A^j&(k^A))+D[14]+2792965006&4294967295,L=j+(R<<17&4294967295|R>>>15),R=A+(k^L&(j^k))+D[15]+1236535329&4294967295,A=L+(R<<22&4294967295|R>>>10),R=k+(L^j&(A^L))+D[1]+4129170786&4294967295,k=A+(R<<5&4294967295|R>>>27),R=j+(A^L&(k^A))+D[6]+3225465664&4294967295,j=k+(R<<9&4294967295|R>>>23),R=L+(k^A&(j^k))+D[11]+643717713&4294967295,L=j+(R<<14&4294967295|R>>>18),R=A+(j^k&(L^j))+D[0]+3921069994&4294967295,A=L+(R<<20&4294967295|R>>>12),R=k+(L^j&(A^L))+D[5]+3593408605&4294967295,k=A+(R<<5&4294967295|R>>>27),R=j+(A^L&(k^A))+D[10]+38016083&4294967295,j=k+(R<<9&4294967295|R>>>23),R=L+(k^A&(j^k))+D[15]+3634488961&4294967295,L=j+(R<<14&4294967295|R>>>18),R=A+(j^k&(L^j))+D[4]+3889429448&4294967295,A=L+(R<<20&4294967295|R>>>12),R=k+(L^j&(A^L))+D[9]+568446438&4294967295,k=A+(R<<5&4294967295|R>>>27),R=j+(A^L&(k^A))+D[14]+3275163606&4294967295,j=k+(R<<9&4294967295|R>>>23),R=L+(k^A&(j^k))+D[3]+4107603335&4294967295,L=j+(R<<14&4294967295|R>>>18),R=A+(j^k&(L^j))+D[8]+1163531501&4294967295,A=L+(R<<20&4294967295|R>>>12),R=k+(L^j&(A^L))+D[13]+2850285829&4294967295,k=A+(R<<5&4294967295|R>>>27),R=j+(A^L&(k^A))+D[2]+4243563512&4294967295,j=k+(R<<9&4294967295|R>>>23),R=L+(k^A&(j^k))+D[7]+1735328473&4294967295,L=j+(R<<14&4294967295|R>>>18),R=A+(j^k&(L^j))+D[12]+2368359562&4294967295,A=L+(R<<20&4294967295|R>>>12),R=k+(A^L^j)+D[5]+4294588738&4294967295,k=A+(R<<4&4294967295|R>>>28),R=j+(k^A^L)+D[8]+2272392833&4294967295,j=k+(R<<11&4294967295|R>>>21),R=L+(j^k^A)+D[11]+1839030562&4294967295,L=j+(R<<16&4294967295|R>>>16),R=A+(L^j^k)+D[14]+4259657740&4294967295,A=L+(R<<23&4294967295|R>>>9),R=k+(A^L^j)+D[1]+2763975236&4294967295,k=A+(R<<4&4294967295|R>>>28),R=j+(k^A^L)+D[4]+1272893353&4294967295,j=k+(R<<11&4294967295|R>>>21),R=L+(j^k^A)+D[7]+4139469664&4294967295,L=j+(R<<16&4294967295|R>>>16),R=A+(L^j^k)+D[10]+3200236656&4294967295,A=L+(R<<23&4294967295|R>>>9),R=k+(A^L^j)+D[13]+681279174&4294967295,k=A+(R<<4&4294967295|R>>>28),R=j+(k^A^L)+D[0]+3936430074&4294967295,j=k+(R<<11&4294967295|R>>>21),R=L+(j^k^A)+D[3]+3572445317&4294967295,L=j+(R<<16&4294967295|R>>>16),R=A+(L^j^k)+D[6]+76029189&4294967295,A=L+(R<<23&4294967295|R>>>9),R=k+(A^L^j)+D[9]+3654602809&4294967295,k=A+(R<<4&4294967295|R>>>28),R=j+(k^A^L)+D[12]+3873151461&4294967295,j=k+(R<<11&4294967295|R>>>21),R=L+(j^k^A)+D[15]+530742520&4294967295,L=j+(R<<16&4294967295|R>>>16),R=A+(L^j^k)+D[2]+3299628645&4294967295,A=L+(R<<23&4294967295|R>>>9),R=k+(L^(A|~j))+D[0]+4096336452&4294967295,k=A+(R<<6&4294967295|R>>>26),R=j+(A^(k|~L))+D[7]+1126891415&4294967295,j=k+(R<<10&4294967295|R>>>22),R=L+(k^(j|~A))+D[14]+2878612391&4294967295,L=j+(R<<15&4294967295|R>>>17),R=A+(j^(L|~k))+D[5]+4237533241&4294967295,A=L+(R<<21&4294967295|R>>>11),R=k+(L^(A|~j))+D[12]+1700485571&4294967295,k=A+(R<<6&4294967295|R>>>26),R=j+(A^(k|~L))+D[3]+2399980690&4294967295,j=k+(R<<10&4294967295|R>>>22),R=L+(k^(j|~A))+D[10]+4293915773&4294967295,L=j+(R<<15&4294967295|R>>>17),R=A+(j^(L|~k))+D[1]+2240044497&4294967295,A=L+(R<<21&4294967295|R>>>11),R=k+(L^(A|~j))+D[8]+1873313359&4294967295,k=A+(R<<6&4294967295|R>>>26),R=j+(A^(k|~L))+D[15]+4264355552&4294967295,j=k+(R<<10&4294967295|R>>>22),R=L+(k^(j|~A))+D[6]+2734768916&4294967295,L=j+(R<<15&4294967295|R>>>17),R=A+(j^(L|~k))+D[13]+1309151649&4294967295,A=L+(R<<21&4294967295|R>>>11),R=k+(L^(A|~j))+D[4]+4149444226&4294967295,k=A+(R<<6&4294967295|R>>>26),R=j+(A^(k|~L))+D[11]+3174756917&4294967295,j=k+(R<<10&4294967295|R>>>22),R=L+(k^(j|~A))+D[2]+718787259&4294967295,L=j+(R<<15&4294967295|R>>>17),R=A+(j^(L|~k))+D[9]+3951481745&4294967295,C.g[0]=C.g[0]+k&4294967295,C.g[1]=C.g[1]+(L+(R<<21&4294967295|R>>>11))&4294967295,C.g[2]=C.g[2]+L&4294967295,C.g[3]=C.g[3]+j&4294967295}r.prototype.u=function(C,k){k===void 0&&(k=C.length);for(var A=k-this.blockSize,D=this.B,L=this.h,j=0;j<k;){if(L==0)for(;j<=A;)s(this,C,j),j+=this.blockSize;if(typeof C=="string"){for(;j<k;)if(D[L++]=C.charCodeAt(j++),L==this.blockSize){s(this,D),L=0;break}}else for(;j<k;)if(D[L++]=C[j++],L==this.blockSize){s(this,D),L=0;break}}this.h=L,this.o+=k},r.prototype.v=function(){var C=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);C[0]=128;for(var k=1;k<C.length-8;++k)C[k]=0;var A=8*this.o;for(k=C.length-8;k<C.length;++k)C[k]=A&255,A/=256;for(this.u(C),C=Array(16),k=A=0;4>k;++k)for(var D=0;32>D;D+=8)C[A++]=this.g[k]>>>D&255;return C};function a(C,k){var A=d;return Object.prototype.hasOwnProperty.call(A,C)?A[C]:A[C]=k(C)}function l(C,k){this.h=k;for(var A=[],D=!0,L=C.length-1;0<=L;L--){var j=C[L]|0;D&&j==k||(A[L]=j,D=!1)}this.g=A}var d={};function f(C){return-128<=C&&128>C?a(C,function(k){return new l([k|0],0>k?-1:0)}):new l([C|0],0>C?-1:0)}function p(C){if(isNaN(C)||!isFinite(C))return _;if(0>C)return O(p(-C));for(var k=[],A=1,D=0;C>=A;D++)k[D]=C/A|0,A*=4294967296;return new l(k,0)}function v(C,k){if(C.length==0)throw Error("number format error: empty string");if(k=k||10,2>k||36<k)throw Error("radix out of range: "+k);if(C.charAt(0)=="-")return O(v(C.substring(1),k));if(0<=C.indexOf("-"))throw Error('number format error: interior "-" character');for(var A=p(Math.pow(k,8)),D=_,L=0;L<C.length;L+=8){var j=Math.min(8,C.length-L),R=parseInt(C.substring(L,L+j),k);8>j?(j=p(Math.pow(k,j)),D=D.j(j).add(p(R))):(D=D.j(A),D=D.add(p(R)))}return D}var _=f(0),x=f(1),S=f(16777216);n=l.prototype,n.m=function(){if(P(this))return-O(this).m();for(var C=0,k=1,A=0;A<this.g.length;A++){var D=this.i(A);C+=(0<=D?D:4294967296+D)*k,k*=4294967296}return C},n.toString=function(C){if(C=C||10,2>C||36<C)throw Error("radix out of range: "+C);if(N(this))return"0";if(P(this))return"-"+O(this).toString(C);for(var k=p(Math.pow(C,6)),A=this,D="";;){var L=se(A,k).g;A=K(A,L.j(k));var j=((0<A.g.length?A.g[0]:A.h)>>>0).toString(C);if(A=L,N(A))return j+D;for(;6>j.length;)j="0"+j;D=j+D}},n.i=function(C){return 0>C?0:C<this.g.length?this.g[C]:this.h};function N(C){if(C.h!=0)return!1;for(var k=0;k<C.g.length;k++)if(C.g[k]!=0)return!1;return!0}function P(C){return C.h==-1}n.l=function(C){return C=K(this,C),P(C)?-1:N(C)?0:1};function O(C){for(var k=C.g.length,A=[],D=0;D<k;D++)A[D]=~C.g[D];return new l(A,~C.h).add(x)}n.abs=function(){return P(this)?O(this):this},n.add=function(C){for(var k=Math.max(this.g.length,C.g.length),A=[],D=0,L=0;L<=k;L++){var j=D+(this.i(L)&65535)+(C.i(L)&65535),R=(j>>>16)+(this.i(L)>>>16)+(C.i(L)>>>16);D=R>>>16,j&=65535,R&=65535,A[L]=R<<16|j}return new l(A,A[A.length-1]&-2147483648?-1:0)};function K(C,k){return C.add(O(k))}n.j=function(C){if(N(this)||N(C))return _;if(P(this))return P(C)?O(this).j(O(C)):O(O(this).j(C));if(P(C))return O(this.j(O(C)));if(0>this.l(S)&&0>C.l(S))return p(this.m()*C.m());for(var k=this.g.length+C.g.length,A=[],D=0;D<2*k;D++)A[D]=0;for(D=0;D<this.g.length;D++)for(var L=0;L<C.g.length;L++){var j=this.i(D)>>>16,R=this.i(D)&65535,Ke=C.i(L)>>>16,Ze=C.i(L)&65535;A[2*D+2*L]+=R*Ze,Q(A,2*D+2*L),A[2*D+2*L+1]+=j*Ze,Q(A,2*D+2*L+1),A[2*D+2*L+1]+=R*Ke,Q(A,2*D+2*L+1),A[2*D+2*L+2]+=j*Ke,Q(A,2*D+2*L+2)}for(D=0;D<k;D++)A[D]=A[2*D+1]<<16|A[2*D];for(D=k;D<2*k;D++)A[D]=0;return new l(A,0)};function Q(C,k){for(;(C[k]&65535)!=C[k];)C[k+1]+=C[k]>>>16,C[k]&=65535,k++}function H(C,k){this.g=C,this.h=k}function se(C,k){if(N(k))throw Error("division by zero");if(N(C))return new H(_,_);if(P(C))return k=se(O(C),k),new H(O(k.g),O(k.h));if(P(k))return k=se(C,O(k)),new H(O(k.g),k.h);if(30<C.g.length){if(P(C)||P(k))throw Error("slowDivide_ only works with positive integers.");for(var A=x,D=k;0>=D.l(C);)A=ce(A),D=ce(D);var L=re(A,1),j=re(D,1);for(D=re(D,2),A=re(A,2);!N(D);){var R=j.add(D);0>=R.l(C)&&(L=L.add(A),j=R),D=re(D,1),A=re(A,1)}return k=K(C,L.j(k)),new H(L,k)}for(L=_;0<=C.l(k);){for(A=Math.max(1,Math.floor(C.m()/k.m())),D=Math.ceil(Math.log(A)/Math.LN2),D=48>=D?1:Math.pow(2,D-48),j=p(A),R=j.j(k);P(R)||0<R.l(C);)A-=D,j=p(A),R=j.j(k);N(j)&&(j=x),L=L.add(j),C=K(C,R)}return new H(L,C)}n.A=function(C){return se(this,C).h},n.and=function(C){for(var k=Math.max(this.g.length,C.g.length),A=[],D=0;D<k;D++)A[D]=this.i(D)&C.i(D);return new l(A,this.h&C.h)},n.or=function(C){for(var k=Math.max(this.g.length,C.g.length),A=[],D=0;D<k;D++)A[D]=this.i(D)|C.i(D);return new l(A,this.h|C.h)},n.xor=function(C){for(var k=Math.max(this.g.length,C.g.length),A=[],D=0;D<k;D++)A[D]=this.i(D)^C.i(D);return new l(A,this.h^C.h)};function ce(C){for(var k=C.g.length+1,A=[],D=0;D<k;D++)A[D]=C.i(D)<<1|C.i(D-1)>>>31;return new l(A,C.h)}function re(C,k){var A=k>>5;k%=32;for(var D=C.g.length-A,L=[],j=0;j<D;j++)L[j]=0<k?C.i(j+A)>>>k|C.i(j+A+1)<<32-k:C.i(j+A);return new l(L,C.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,DE=r,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.A,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=p,l.fromString=v,ns=l}).apply(typeof J_<"u"?J_:typeof self<"u"?self:typeof window<"u"?window:{});var Ed=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var VE,lu,OE,Nd,cm,LE,ME,jE;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(c,g,E){return c==Array.prototype||c==Object.prototype||(c[g]=E.value),c};function t(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ed=="object"&&Ed];for(var g=0;g<c.length;++g){var E=c[g];if(E&&E.Math==Math)return E}throw Error("Cannot find global object")}var r=t(this);function s(c,g){if(g)e:{var E=r;c=c.split(".");for(var T=0;T<c.length-1;T++){var B=c[T];if(!(B in E))break e;E=E[B]}c=c[c.length-1],T=E[c],g=g(T),g!=T&&g!=null&&e(E,c,{configurable:!0,writable:!0,value:g})}}function a(c,g){c instanceof String&&(c+="");var E=0,T=!1,B={next:function(){if(!T&&E<c.length){var G=E++;return{value:g(G,c[G]),done:!1}}return T=!0,{done:!0,value:void 0}}};return B[Symbol.iterator]=function(){return B},B}s("Array.prototype.values",function(c){return c||function(){return a(this,function(g,E){return E})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var l=l||{},d=this||self;function f(c){var g=typeof c;return g=g!="object"?g:c?Array.isArray(c)?"array":g:"null",g=="array"||g=="object"&&typeof c.length=="number"}function p(c){var g=typeof c;return g=="object"&&c!=null||g=="function"}function v(c,g,E){return c.call.apply(c.bind,arguments)}function _(c,g,E){if(!c)throw Error();if(2<arguments.length){var T=Array.prototype.slice.call(arguments,2);return function(){var B=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(B,T),c.apply(g,B)}}return function(){return c.apply(g,arguments)}}function x(c,g,E){return x=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?v:_,x.apply(null,arguments)}function S(c,g){var E=Array.prototype.slice.call(arguments,1);return function(){var T=E.slice();return T.push.apply(T,arguments),c.apply(this,T)}}function N(c,g){function E(){}E.prototype=g.prototype,c.aa=g.prototype,c.prototype=new E,c.prototype.constructor=c,c.Qb=function(T,B,G){for(var ae=Array(arguments.length-2),qe=2;qe<arguments.length;qe++)ae[qe-2]=arguments[qe];return g.prototype[B].apply(T,ae)}}function P(c){const g=c.length;if(0<g){const E=Array(g);for(let T=0;T<g;T++)E[T]=c[T];return E}return[]}function O(c,g){for(let E=1;E<arguments.length;E++){const T=arguments[E];if(f(T)){const B=c.length||0,G=T.length||0;c.length=B+G;for(let ae=0;ae<G;ae++)c[B+ae]=T[ae]}else c.push(T)}}class K{constructor(g,E){this.i=g,this.j=E,this.h=0,this.g=null}get(){let g;return 0<this.h?(this.h--,g=this.g,this.g=g.next,g.next=null):g=this.i(),g}}function Q(c){return/^[\s\xa0]*$/.test(c)}function H(){var c=d.navigator;return c&&(c=c.userAgent)?c:""}function se(c){return se[" "](c),c}se[" "]=function(){};var ce=H().indexOf("Gecko")!=-1&&!(H().toLowerCase().indexOf("webkit")!=-1&&H().indexOf("Edge")==-1)&&!(H().indexOf("Trident")!=-1||H().indexOf("MSIE")!=-1)&&H().indexOf("Edge")==-1;function re(c,g,E){for(const T in c)g.call(E,c[T],T,c)}function C(c,g){for(const E in c)g.call(void 0,c[E],E,c)}function k(c){const g={};for(const E in c)g[E]=c[E];return g}const A="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function D(c,g){let E,T;for(let B=1;B<arguments.length;B++){T=arguments[B];for(E in T)c[E]=T[E];for(let G=0;G<A.length;G++)E=A[G],Object.prototype.hasOwnProperty.call(T,E)&&(c[E]=T[E])}}function L(c){var g=1;c=c.split(":");const E=[];for(;0<g&&c.length;)E.push(c.shift()),g--;return c.length&&E.push(c.join(":")),E}function j(c){d.setTimeout(()=>{throw c},0)}function R(){var c=Ee;let g=null;return c.g&&(g=c.g,c.g=c.g.next,c.g||(c.h=null),g.next=null),g}class Ke{constructor(){this.h=this.g=null}add(g,E){const T=Ze.get();T.set(g,E),this.h?this.h.next=T:this.g=T,this.h=T}}var Ze=new K(()=>new ee,c=>c.reset());class ee{constructor(){this.next=this.g=this.h=null}set(g,E){this.h=g,this.g=E,this.next=null}reset(){this.next=this.g=this.h=null}}let Fe,le=!1,Ee=new Ke,he=()=>{const c=d.Promise.resolve(void 0);Fe=()=>{c.then(F)}};var F=()=>{for(var c;c=R();){try{c.h.call(c.g)}catch(E){j(E)}var g=Ze;g.j(c),100>g.h&&(g.h++,c.next=g.g,g.g=c)}le=!1};function X(){this.s=this.s,this.C=this.C}X.prototype.s=!1,X.prototype.ma=function(){this.s||(this.s=!0,this.N())},X.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function _e(c,g){this.type=c,this.g=this.target=g,this.defaultPrevented=!1}_e.prototype.h=function(){this.defaultPrevented=!0};var Ae=(function(){if(!d.addEventListener||!Object.defineProperty)return!1;var c=!1,g=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const E=()=>{};d.addEventListener("test",E,g),d.removeEventListener("test",E,g)}catch{}return c})();function Ce(c,g){if(_e.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c){var E=this.type=c.type,T=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;if(this.target=c.target||c.srcElement,this.g=g,g=c.relatedTarget){if(ce){e:{try{se(g.nodeName);var B=!0;break e}catch{}B=!1}B||(g=null)}}else E=="mouseover"?g=c.fromElement:E=="mouseout"&&(g=c.toElement);this.relatedTarget=g,T?(this.clientX=T.clientX!==void 0?T.clientX:T.pageX,this.clientY=T.clientY!==void 0?T.clientY:T.pageY,this.screenX=T.screenX||0,this.screenY=T.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=typeof c.pointerType=="string"?c.pointerType:Oe[c.pointerType]||"",this.state=c.state,this.i=c,c.defaultPrevented&&Ce.aa.h.call(this)}}N(Ce,_e);var Oe={2:"touch",3:"pen",4:"mouse"};Ce.prototype.h=function(){Ce.aa.h.call(this);var c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var Be="closure_listenable_"+(1e6*Math.random()|0),ze=0;function Ye(c,g,E,T,B){this.listener=c,this.proxy=null,this.src=g,this.type=E,this.capture=!!T,this.ha=B,this.key=++ze,this.da=this.fa=!1}function Ct(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function Br(c){this.src=c,this.g={},this.h=0}Br.prototype.add=function(c,g,E,T,B){var G=c.toString();c=this.g[G],c||(c=this.g[G]=[],this.h++);var ae=_i(c,g,T,B);return-1<ae?(g=c[ae],E||(g.fa=!1)):(g=new Ye(g,this.src,G,!!T,B),g.fa=E,c.push(g)),g};function Io(c,g){var E=g.type;if(E in c.g){var T=c.g[E],B=Array.prototype.indexOf.call(T,g,void 0),G;(G=0<=B)&&Array.prototype.splice.call(T,B,1),G&&(Ct(g),c.g[E].length==0&&(delete c.g[E],c.h--))}}function _i(c,g,E,T){for(var B=0;B<c.length;++B){var G=c[B];if(!G.da&&G.listener==g&&G.capture==!!E&&G.ha==T)return B}return-1}var ps="closure_lm_"+(1e6*Math.random()|0),xo={};function al(c,g,E,T,B){if(Array.isArray(g)){for(var G=0;G<g.length;G++)al(c,g[G],E,T,B);return null}return E=cl(E),c&&c[Be]?c.K(g,E,p(T)?!!T.capture:!1,B):ll(c,g,E,!1,T,B)}function ll(c,g,E,T,B,G){if(!g)throw Error("Invalid event type");var ae=p(B)?!!B.capture:!!B,qe=So(c);if(qe||(c[ps]=qe=new Br(c)),E=qe.add(g,E,T,ae,G),E.proxy)return E;if(T=ic(),E.proxy=T,T.src=c,T.listener=E,c.addEventListener)Ae||(B=ae),B===void 0&&(B=!1),c.addEventListener(g.toString(),T,B);else if(c.attachEvent)c.attachEvent($r(g.toString()),T);else if(c.addListener&&c.removeListener)c.addListener(T);else throw Error("addEventListener and attachEvent are unavailable.");return E}function ic(){function c(E){return g.call(c.src,c.listener,E)}const g=ul;return c}function To(c,g,E,T,B){if(Array.isArray(g))for(var G=0;G<g.length;G++)To(c,g[G],E,T,B);else T=p(T)?!!T.capture:!!T,E=cl(E),c&&c[Be]?(c=c.i,g=String(g).toString(),g in c.g&&(G=c.g[g],E=_i(G,E,T,B),-1<E&&(Ct(G[E]),Array.prototype.splice.call(G,E,1),G.length==0&&(delete c.g[g],c.h--)))):c&&(c=So(c))&&(g=c.g[g.toString()],c=-1,g&&(c=_i(g,E,T,B)),(E=-1<c?g[c]:null)&&zr(E))}function zr(c){if(typeof c!="number"&&c&&!c.da){var g=c.src;if(g&&g[Be])Io(g.i,c);else{var E=c.type,T=c.proxy;g.removeEventListener?g.removeEventListener(E,T,c.capture):g.detachEvent?g.detachEvent($r(E),T):g.addListener&&g.removeListener&&g.removeListener(T),(E=So(g))?(Io(E,c),E.h==0&&(E.src=null,g[ps]=null)):Ct(c)}}}function $r(c){return c in xo?xo[c]:xo[c]="on"+c}function ul(c,g){if(c.da)c=!0;else{g=new Ce(g,this);var E=c.listener,T=c.ha||c.src;c.fa&&zr(c),c=E.call(T,g)}return c}function So(c){return c=c[ps],c instanceof Br?c:null}var ko="__closure_events_fn_"+(1e9*Math.random()>>>0);function cl(c){return typeof c=="function"?c:(c[ko]||(c[ko]=function(g){return c.handleEvent(g)}),c[ko])}function xt(){X.call(this),this.i=new Br(this),this.M=this,this.F=null}N(xt,X),xt.prototype[Be]=!0,xt.prototype.removeEventListener=function(c,g,E,T){To(this,c,g,E,T)};function Tt(c,g){var E,T=c.F;if(T)for(E=[];T;T=T.F)E.push(T);if(c=c.M,T=g.type||g,typeof g=="string")g=new _e(g,c);else if(g instanceof _e)g.target=g.target||c;else{var B=g;g=new _e(T,c),D(g,B)}if(B=!0,E)for(var G=E.length-1;0<=G;G--){var ae=g.g=E[G];B=qr(ae,T,!0,g)&&B}if(ae=g.g=c,B=qr(ae,T,!0,g)&&B,B=qr(ae,T,!1,g)&&B,E)for(G=0;G<E.length;G++)ae=g.g=E[G],B=qr(ae,T,!1,g)&&B}xt.prototype.N=function(){if(xt.aa.N.call(this),this.i){var c=this.i,g;for(g in c.g){for(var E=c.g[g],T=0;T<E.length;T++)Ct(E[T]);delete c.g[g],c.h--}}this.F=null},xt.prototype.K=function(c,g,E,T){return this.i.add(String(c),g,!1,E,T)},xt.prototype.L=function(c,g,E,T){return this.i.add(String(c),g,!0,E,T)};function qr(c,g,E,T){if(g=c.i.g[String(g)],!g)return!0;g=g.concat();for(var B=!0,G=0;G<g.length;++G){var ae=g[G];if(ae&&!ae.da&&ae.capture==E){var qe=ae.listener,St=ae.ha||ae.src;ae.fa&&Io(c.i,ae),B=qe.call(St,T)!==!1&&B}}return B&&!T.defaultPrevented}function dl(c,g,E){if(typeof c=="function")E&&(c=x(c,E));else if(c&&typeof c.handleEvent=="function")c=x(c.handleEvent,c);else throw Error("Invalid listener argument");return 2147483647<Number(g)?-1:d.setTimeout(c,g||0)}function wi(c){c.g=dl(()=>{c.g=null,c.i&&(c.i=!1,wi(c))},c.l);const g=c.h;c.h=null,c.m.apply(null,g)}class ms extends X{constructor(g,E){super(),this.m=g,this.l=E,this.h=null,this.i=!1,this.g=null}j(g){this.h=arguments,this.g?this.i=!0:wi(this)}N(){super.N(),this.g&&(d.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function gs(c){X.call(this),this.h=c,this.g={}}N(gs,X);var hl=[];function fl(c){re(c.g,function(g,E){this.g.hasOwnProperty(E)&&zr(g)},c),c.g={}}gs.prototype.N=function(){gs.aa.N.call(this),fl(this)},gs.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var pl=d.JSON.stringify,ml=d.JSON.parse,gl=class{stringify(c){return d.JSON.stringify(c,void 0)}parse(c){return d.JSON.parse(c,void 0)}};function ys(){}ys.prototype.h=null;function bo(c){return c.h||(c.h=c.i())}function Ao(){}var bn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function mr(){_e.call(this,"d")}N(mr,_e);function Ro(){_e.call(this,"c")}N(Ro,_e);var gr={},yl=null;function vs(){return yl=yl||new xt}gr.La="serverreachability";function vl(c){_e.call(this,gr.La,c)}N(vl,_e);function Hr(c){const g=vs();Tt(g,new vl(g))}gr.STAT_EVENT="statevent";function _l(c,g){_e.call(this,gr.STAT_EVENT,c),this.stat=g}N(_l,_e);function pt(c){const g=vs();Tt(g,new _l(g,c))}gr.Ma="timingevent";function Co(c,g){_e.call(this,gr.Ma,c),this.size=g}N(Co,_e);function Hn(c,g){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return d.setTimeout(function(){c()},g)}function _s(){this.g=!0}_s.prototype.xa=function(){this.g=!1};function ws(c,g,E,T,B,G){c.info(function(){if(c.g)if(G)for(var ae="",qe=G.split("&"),St=0;St<qe.length;St++){var Le=qe[St].split("=");if(1<Le.length){var Pt=Le[0];Le=Le[1];var gt=Pt.split("_");ae=2<=gt.length&&gt[1]=="type"?ae+(Pt+"="+Le+"&"):ae+(Pt+"=redacted&")}}else ae=null;else ae=G;return"XMLHTTP REQ ("+T+") [attempt "+B+"]: "+g+`
`+E+`
`+ae})}function Po(c,g,E,T,B,G,ae){c.info(function(){return"XMLHTTP RESP ("+T+") [ attempt "+B+"]: "+g+`
`+E+`
`+G+" "+ae})}function Wn(c,g,E,T){c.info(function(){return"XMLHTTP TEXT ("+g+"): "+lf(c,E)+(T?" "+T:"")})}function wl(c,g){c.info(function(){return"TIMEOUT: "+g})}_s.prototype.info=function(){};function lf(c,g){if(!c.g)return g;if(!g)return null;try{var E=JSON.parse(g);if(E){for(c=0;c<E.length;c++)if(Array.isArray(E[c])){var T=E[c];if(!(2>T.length)){var B=T[1];if(Array.isArray(B)&&!(1>B.length)){var G=B[0];if(G!="noop"&&G!="stop"&&G!="close")for(var ae=1;ae<B.length;ae++)B[ae]=""}}}}return pl(E)}catch{return g}}var No={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},sc={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Gn;function Es(){}N(Es,ys),Es.prototype.g=function(){return new XMLHttpRequest},Es.prototype.i=function(){return{}},Gn=new Es;function Kn(c,g,E,T){this.j=c,this.i=g,this.l=E,this.R=T||1,this.U=new gs(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new oc}function oc(){this.i=null,this.g="",this.h=!1}var El={},Do={};function Vo(c,g,E){c.L=1,c.v=Si(gn(g)),c.m=E,c.P=!0,Il(c,null)}function Il(c,g){c.F=Date.now(),Xe(c),c.A=gn(c.v);var E=c.A,T=c.R;Array.isArray(T)||(T=[String(T)]),bi(E.i,"t",T),c.C=0,E=c.j.J,c.h=new oc,c.g=Tc(c.j,E?g:null,!c.m),0<c.O&&(c.M=new ms(x(c.Y,c,c.g),c.O)),g=c.U,E=c.g,T=c.ca;var B="readystatechange";Array.isArray(B)||(B&&(hl[0]=B.toString()),B=hl);for(var G=0;G<B.length;G++){var ae=al(E,B[G],T||g.handleEvent,!1,g.h||g);if(!ae)break;g.g[ae.key]=ae}g=c.H?k(c.H):{},c.m?(c.u||(c.u="POST"),g["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.A,c.u,c.m,g)):(c.u="GET",c.g.ea(c.A,c.u,null,g)),Hr(),ws(c.i,c.u,c.A,c.l,c.R,c.m)}Kn.prototype.ca=function(c){c=c.target;const g=this.M;g&&on(c)==3?g.j():this.Y(c)},Kn.prototype.Y=function(c){try{if(c==this.g)e:{const gt=on(this.g);var g=this.g.Ba();const Cn=this.g.Z();if(!(3>gt)&&(gt!=3||this.g&&(this.h.h||this.g.oa()||Al(this.g)))){this.J||gt!=4||g==7||(g==8||0>=Cn?Hr(3):Hr(2)),Is(this);var E=this.g.Z();this.X=E;t:if(ac(this)){var T=Al(this.g);c="";var B=T.length,G=on(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){An(this),Ei(this);var ae="";break t}this.h.i=new d.TextDecoder}for(g=0;g<B;g++)this.h.h=!0,c+=this.h.i.decode(T[g],{stream:!(G&&g==B-1)});T.length=0,this.h.g+=c,this.C=0,ae=this.h.g}else ae=this.g.oa();if(this.o=E==200,Po(this.i,this.u,this.A,this.l,this.R,gt,E),this.o){if(this.T&&!this.K){t:{if(this.g){var qe,St=this.g;if((qe=St.g?St.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!Q(qe)){var Le=qe;break t}}Le=null}if(E=Le)Wn(this.i,this.l,E,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,xl(this,E);else{this.o=!1,this.s=3,pt(12),An(this),Ei(this);break e}}if(this.P){E=!0;let vn;for(;!this.J&&this.C<ae.length;)if(vn=uf(this,ae),vn==Do){gt==4&&(this.s=4,pt(14),E=!1),Wn(this.i,this.l,null,"[Incomplete Response]");break}else if(vn==El){this.s=4,pt(15),Wn(this.i,this.l,ae,"[Invalid Chunk]"),E=!1;break}else Wn(this.i,this.l,vn,null),xl(this,vn);if(ac(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),gt!=4||ae.length!=0||this.h.h||(this.s=1,pt(16),E=!1),this.o=this.o&&E,!E)Wn(this.i,this.l,ae,"[Invalid Chunked Response]"),An(this),Ei(this);else if(0<ae.length&&!this.W){this.W=!0;var Pt=this.j;Pt.g==this&&Pt.ba&&!Pt.M&&(Pt.j.info("Great, no buffering proxy detected. Bytes received: "+ae.length),Cl(Pt),Pt.M=!0,pt(11))}}else Wn(this.i,this.l,ae,null),xl(this,ae);gt==4&&An(this),this.o&&!this.J&&(gt==4?Ho(this.j,this):(this.o=!1,Xe(this)))}else Uo(this.g),E==400&&0<ae.indexOf("Unknown SID")?(this.s=3,pt(12)):(this.s=0,pt(13)),An(this),Ei(this)}}}catch{}finally{}};function ac(c){return c.g?c.u=="GET"&&c.L!=2&&c.j.Ca:!1}function uf(c,g){var E=c.C,T=g.indexOf(`
`,E);return T==-1?Do:(E=Number(g.substring(E,T)),isNaN(E)?El:(T+=1,T+E>g.length?Do:(g=g.slice(T,T+E),c.C=T+E,g)))}Kn.prototype.cancel=function(){this.J=!0,An(this)};function Xe(c){c.S=Date.now()+c.I,lc(c,c.I)}function lc(c,g){if(c.B!=null)throw Error("WatchDog timer not null");c.B=Hn(x(c.ba,c),g)}function Is(c){c.B&&(d.clearTimeout(c.B),c.B=null)}Kn.prototype.ba=function(){this.B=null;const c=Date.now();0<=c-this.S?(wl(this.i,this.A),this.L!=2&&(Hr(),pt(17)),An(this),this.s=2,Ei(this)):lc(this,this.S-c)};function Ei(c){c.j.G==0||c.J||Ho(c.j,c)}function An(c){Is(c);var g=c.M;g&&typeof g.ma=="function"&&g.ma(),c.M=null,fl(c.U),c.g&&(g=c.g,c.g=null,g.abort(),g.ma())}function xl(c,g){try{var E=c.j;if(E.G!=0&&(E.g==c||Xt(E.h,c))){if(!c.K&&Xt(E.h,c)&&E.G==3){try{var T=E.Da.g.parse(g)}catch{T=null}if(Array.isArray(T)&&T.length==3){var B=T;if(B[0]==0){e:if(!E.u){if(E.g)if(E.g.F+3e3<c.F)qo(E),Zn(E);else break e;$o(E),pt(18)}}else E.za=B[1],0<E.za-E.T&&37500>B[2]&&E.F&&E.v==0&&!E.C&&(E.C=Hn(x(E.Za,E),6e3));if(1>=cc(E.h)&&E.ca){try{E.ca()}catch{}E.ca=void 0}}else Yr(E,11)}else if((c.K||E.g==c)&&qo(E),!Q(g))for(B=E.Da.g.parse(g),g=0;g<B.length;g++){let Le=B[g];if(E.T=Le[0],Le=Le[1],E.G==2)if(Le[0]=="c"){E.K=Le[1],E.ia=Le[2];const Pt=Le[3];Pt!=null&&(E.la=Pt,E.j.info("VER="+E.la));const gt=Le[4];gt!=null&&(E.Aa=gt,E.j.info("SVER="+E.Aa));const Cn=Le[5];Cn!=null&&typeof Cn=="number"&&0<Cn&&(T=1.5*Cn,E.L=T,E.j.info("backChannelRequestTimeoutMs_="+T)),T=E;const vn=c.g;if(vn){const Rs=vn.g?vn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Rs){var G=T.h;G.g||Rs.indexOf("spdy")==-1&&Rs.indexOf("quic")==-1&&Rs.indexOf("h2")==-1||(G.j=G.l,G.g=new Set,G.h&&(Tl(G,G.h),G.h=null))}if(T.D){const Go=vn.g?vn.g.getResponseHeader("X-HTTP-Session-Id"):null;Go&&(T.ya=Go,Qe(T.I,T.D,Go))}}E.G=3,E.l&&E.l.ua(),E.ba&&(E.R=Date.now()-c.F,E.j.info("Handshake RTT: "+E.R+"ms")),T=E;var ae=c;if(T.qa=xc(T,T.J?T.ia:null,T.W),ae.K){dc(T.h,ae);var qe=ae,St=T.L;St&&(qe.I=St),qe.B&&(Is(qe),Xe(qe)),T.g=ae}else As(T);0<E.i.length&&wr(E)}else Le[0]!="stop"&&Le[0]!="close"||Yr(E,7);else E.G==3&&(Le[0]=="stop"||Le[0]=="close"?Le[0]=="stop"?Yr(E,7):Mt(E):Le[0]!="noop"&&E.l&&E.l.ta(Le),E.v=0)}}Hr(4)}catch{}}var uc=class{constructor(c,g){this.g=c,this.map=g}};function xs(c){this.l=c||10,d.PerformanceNavigationTiming?(c=d.performance.getEntriesByType("navigation"),c=0<c.length&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(d.chrome&&d.chrome.loadTimes&&d.chrome.loadTimes()&&d.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function mn(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function cc(c){return c.h?1:c.g?c.g.size:0}function Xt(c,g){return c.h?c.h==g:c.g?c.g.has(g):!1}function Tl(c,g){c.g?c.g.add(g):c.h=g}function dc(c,g){c.h&&c.h==g?c.h=null:c.g&&c.g.has(g)&&c.g.delete(g)}xs.prototype.cancel=function(){if(this.i=hc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function hc(c){if(c.h!=null)return c.i.concat(c.h.D);if(c.g!=null&&c.g.size!==0){let g=c.i;for(const E of c.g.values())g=g.concat(E.D);return g}return P(c.i)}function Oo(c){if(c.V&&typeof c.V=="function")return c.V();if(typeof Map<"u"&&c instanceof Map||typeof Set<"u"&&c instanceof Set)return Array.from(c.values());if(typeof c=="string")return c.split("");if(f(c)){for(var g=[],E=c.length,T=0;T<E;T++)g.push(c[T]);return g}g=[],E=0;for(T in c)g[E++]=c[T];return g}function Lo(c){if(c.na&&typeof c.na=="function")return c.na();if(!c.V||typeof c.V!="function"){if(typeof Map<"u"&&c instanceof Map)return Array.from(c.keys());if(!(typeof Set<"u"&&c instanceof Set)){if(f(c)||typeof c=="string"){var g=[];c=c.length;for(var E=0;E<c;E++)g.push(E);return g}g=[],E=0;for(const T in c)g[E++]=T;return g}}}function Ii(c,g){if(c.forEach&&typeof c.forEach=="function")c.forEach(g,void 0);else if(f(c)||typeof c=="string")Array.prototype.forEach.call(c,g,void 0);else for(var E=Lo(c),T=Oo(c),B=T.length,G=0;G<B;G++)g.call(void 0,T[G],E&&E[G],c)}var Ts=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function cf(c,g){if(c){c=c.split("&");for(var E=0;E<c.length;E++){var T=c[E].indexOf("="),B=null;if(0<=T){var G=c[E].substring(0,T);B=c[E].substring(T+1)}else G=c[E];g(G,B?decodeURIComponent(B.replace(/\+/g," ")):"")}}}function Wr(c){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,c instanceof Wr){this.h=c.h,Ss(this,c.j),this.o=c.o,this.g=c.g,xi(this,c.s),this.l=c.l;var g=c.i,E=new yr;E.i=g.i,g.g&&(E.g=new Map(g.g),E.h=g.h),Ti(this,E),this.m=c.m}else c&&(g=String(c).match(Ts))?(this.h=!1,Ss(this,g[1]||"",!0),this.o=Ve(g[2]||""),this.g=Ve(g[3]||"",!0),xi(this,g[4]),this.l=Ve(g[5]||"",!0),Ti(this,g[6]||"",!0),this.m=Ve(g[7]||"")):(this.h=!1,this.i=new yr(null,this.h))}Wr.prototype.toString=function(){var c=[],g=this.j;g&&c.push(ki(g,Mo,!0),":");var E=this.g;return(E||g=="file")&&(c.push("//"),(g=this.o)&&c.push(ki(g,Mo,!0),"@"),c.push(encodeURIComponent(String(E)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),E=this.s,E!=null&&c.push(":",String(E))),(E=this.l)&&(this.g&&E.charAt(0)!="/"&&c.push("/"),c.push(ki(E,E.charAt(0)=="/"?mc:pc,!0))),(E=this.i.toString())&&c.push("?",E),(E=this.m)&&c.push("#",ki(E,Sl)),c.join("")};function gn(c){return new Wr(c)}function Ss(c,g,E){c.j=E?Ve(g,!0):g,c.j&&(c.j=c.j.replace(/:$/,""))}function xi(c,g){if(g){if(g=Number(g),isNaN(g)||0>g)throw Error("Bad port number "+g);c.s=g}else c.s=null}function Ti(c,g,E){g instanceof yr?(c.i=g,vr(c.i,c.h)):(E||(g=ki(g,gc)),c.i=new yr(g,c.h))}function Qe(c,g,E){c.i.set(g,E)}function Si(c){return Qe(c,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),c}function Ve(c,g){return c?g?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function ki(c,g,E){return typeof c=="string"?(c=encodeURI(c).replace(g,fc),E&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function fc(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var Mo=/[#\/\?@]/g,pc=/[#\?:]/g,mc=/[#\?]/g,gc=/[#\?@]/g,Sl=/#/g;function yr(c,g){this.h=this.g=null,this.i=c||null,this.j=!!g}function Lt(c){c.g||(c.g=new Map,c.h=0,c.i&&cf(c.i,function(g,E){c.add(decodeURIComponent(g.replace(/\+/g," ")),E)}))}n=yr.prototype,n.add=function(c,g){Lt(this),this.i=null,c=Rn(this,c);var E=this.g.get(c);return E||this.g.set(c,E=[]),E.push(g),this.h+=1,this};function Qn(c,g){Lt(c),g=Rn(c,g),c.g.has(g)&&(c.i=null,c.h-=c.g.get(g).length,c.g.delete(g))}function Yn(c,g){return Lt(c),g=Rn(c,g),c.g.has(g)}n.forEach=function(c,g){Lt(this),this.g.forEach(function(E,T){E.forEach(function(B){c.call(g,B,T,this)},this)},this)},n.na=function(){Lt(this);const c=Array.from(this.g.values()),g=Array.from(this.g.keys()),E=[];for(let T=0;T<g.length;T++){const B=c[T];for(let G=0;G<B.length;G++)E.push(g[T])}return E},n.V=function(c){Lt(this);let g=[];if(typeof c=="string")Yn(this,c)&&(g=g.concat(this.g.get(Rn(this,c))));else{c=Array.from(this.g.values());for(let E=0;E<c.length;E++)g=g.concat(c[E])}return g},n.set=function(c,g){return Lt(this),this.i=null,c=Rn(this,c),Yn(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[g]),this.h+=1,this},n.get=function(c,g){return c?(c=this.V(c),0<c.length?String(c[0]):g):g};function bi(c,g,E){Qn(c,g),0<E.length&&(c.i=null,c.g.set(Rn(c,g),P(E)),c.h+=E.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],g=Array.from(this.g.keys());for(var E=0;E<g.length;E++){var T=g[E];const G=encodeURIComponent(String(T)),ae=this.V(T);for(T=0;T<ae.length;T++){var B=G;ae[T]!==""&&(B+="="+encodeURIComponent(String(ae[T]))),c.push(B)}}return this.i=c.join("&")};function Rn(c,g){return g=String(g),c.j&&(g=g.toLowerCase()),g}function vr(c,g){g&&!c.j&&(Lt(c),c.i=null,c.g.forEach(function(E,T){var B=T.toLowerCase();T!=B&&(Qn(this,T),bi(this,B,E))},c)),c.j=g}function df(c,g){const E=new _s;if(d.Image){const T=new Image;T.onload=S(sn,E,"TestLoadImage: loaded",!0,g,T),T.onerror=S(sn,E,"TestLoadImage: error",!1,g,T),T.onabort=S(sn,E,"TestLoadImage: abort",!1,g,T),T.ontimeout=S(sn,E,"TestLoadImage: timeout",!1,g,T),d.setTimeout(function(){T.ontimeout&&T.ontimeout()},1e4),T.src=c}else g(!1)}function yc(c,g){const E=new _s,T=new AbortController,B=setTimeout(()=>{T.abort(),sn(E,"TestPingServer: timeout",!1,g)},1e4);fetch(c,{signal:T.signal}).then(G=>{clearTimeout(B),G.ok?sn(E,"TestPingServer: ok",!0,g):sn(E,"TestPingServer: server error",!1,g)}).catch(()=>{clearTimeout(B),sn(E,"TestPingServer: error",!1,g)})}function sn(c,g,E,T,B){try{B&&(B.onload=null,B.onerror=null,B.onabort=null,B.ontimeout=null),T(E)}catch{}}function hf(){this.g=new gl}function vc(c,g,E){const T=E||"";try{Ii(c,function(B,G){let ae=B;p(B)&&(ae=pl(B)),g.push(T+G+"="+encodeURIComponent(ae))})}catch(B){throw g.push(T+"type="+encodeURIComponent("_badmap")),B}}function Gr(c){this.l=c.Ub||null,this.j=c.eb||!1}N(Gr,ys),Gr.prototype.g=function(){return new ks(this.l,this.j)},Gr.prototype.i=(function(c){return function(){return c}})({});function ks(c,g){xt.call(this),this.D=c,this.o=g,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}N(ks,xt),n=ks.prototype,n.open=function(c,g){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=c,this.A=g,this.readyState=1,Jn(this)},n.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const g={headers:this.u,method:this.B,credentials:this.m,cache:void 0};c&&(g.body=c),(this.D||d).fetch(new Request(this.A,g)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Xn(this)),this.readyState=0},n.Sa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,Jn(this)),this.g&&(this.readyState=3,Jn(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof d.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;_c(this)}else c.text().then(this.Ra.bind(this),this.ga.bind(this))};function _c(c){c.j.read().then(c.Pa.bind(c)).catch(c.ga.bind(c))}n.Pa=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var g=c.value?c.value:new Uint8Array(0);(g=this.v.decode(g,{stream:!c.done}))&&(this.response=this.responseText+=g)}c.done?Xn(this):Jn(this),this.readyState==3&&_c(this)}},n.Ra=function(c){this.g&&(this.response=this.responseText=c,Xn(this))},n.Qa=function(c){this.g&&(this.response=c,Xn(this))},n.ga=function(){this.g&&Xn(this)};function Xn(c){c.readyState=4,c.l=null,c.j=null,c.v=null,Jn(c)}n.setRequestHeader=function(c,g){this.u.append(c,g)},n.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],g=this.h.entries();for(var E=g.next();!E.done;)E=E.value,c.push(E[0]+": "+E[1]),E=g.next();return c.join(`\r
`)};function Jn(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(ks.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function Kr(c){let g="";return re(c,function(E,T){g+=T,g+=":",g+=E,g+=`\r
`}),g}function Ai(c,g,E){e:{for(T in E){var T=!1;break e}T=!0}T||(E=Kr(E),typeof c=="string"?E!=null&&encodeURIComponent(String(E)):Qe(c,g,E))}function rt(c){xt.call(this),this.headers=new Map,this.o=c||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}N(rt,xt);var ff=/^https?$/i,kl=["POST","PUT"];n=rt.prototype,n.Ha=function(c){this.J=c},n.ea=function(c,g,E,T){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);g=g?g.toUpperCase():"GET",this.D=c,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Gn.g(),this.v=this.o?bo(this.o):bo(Gn),this.g.onreadystatechange=x(this.Ea,this);try{this.B=!0,this.g.open(g,String(c),!0),this.B=!1}catch(G){bs(this,G);return}if(c=E||"",E=new Map(this.headers),T)if(Object.getPrototypeOf(T)===Object.prototype)for(var B in T)E.set(B,T[B]);else if(typeof T.keys=="function"&&typeof T.get=="function")for(const G of T.keys())E.set(G,T.get(G));else throw Error("Unknown input type for opt_headers: "+String(T));T=Array.from(E.keys()).find(G=>G.toLowerCase()=="content-type"),B=d.FormData&&c instanceof d.FormData,!(0<=Array.prototype.indexOf.call(kl,g,void 0))||T||B||E.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[G,ae]of E)this.g.setRequestHeader(G,ae);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Fo(this),this.u=!0,this.g.send(c),this.u=!1}catch(G){bs(this,G)}};function bs(c,g){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=g,c.m=5,jo(c),yn(c)}function jo(c){c.A||(c.A=!0,Tt(c,"complete"),Tt(c,"error"))}n.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=c||7,Tt(this,"complete"),Tt(this,"abort"),yn(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),yn(this,!0)),rt.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?bl(this):this.bb())},n.bb=function(){bl(this)};function bl(c){if(c.h&&typeof l<"u"&&(!c.v[1]||on(c)!=4||c.Z()!=2)){if(c.u&&on(c)==4)dl(c.Ea,0,c);else if(Tt(c,"readystatechange"),on(c)==4){c.h=!1;try{const ae=c.Z();e:switch(ae){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var g=!0;break e;default:g=!1}var E;if(!(E=g)){var T;if(T=ae===0){var B=String(c.D).match(Ts)[1]||null;!B&&d.self&&d.self.location&&(B=d.self.location.protocol.slice(0,-1)),T=!ff.test(B?B.toLowerCase():"")}E=T}if(E)Tt(c,"complete"),Tt(c,"success");else{c.m=6;try{var G=2<on(c)?c.g.statusText:""}catch{G=""}c.l=G+" ["+c.Z()+"]",jo(c)}}finally{yn(c)}}}}function yn(c,g){if(c.g){Fo(c);const E=c.g,T=c.v[0]?()=>{}:null;c.g=null,c.v=null,g||Tt(c,"ready");try{E.onreadystatechange=T}catch{}}}function Fo(c){c.I&&(d.clearTimeout(c.I),c.I=null)}n.isActive=function(){return!!this.g};function on(c){return c.g?c.g.readyState:0}n.Z=function(){try{return 2<on(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(c){if(this.g){var g=this.g.responseText;return c&&g.indexOf(c)==0&&(g=g.substring(c.length)),ml(g)}};function Al(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.H){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function Uo(c){const g={};c=(c.g&&2<=on(c)&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let T=0;T<c.length;T++){if(Q(c[T]))continue;var E=L(c[T]);const B=E[0];if(E=E[1],typeof E!="string")continue;E=E.trim();const G=g[B]||[];g[B]=G,G.push(E)}C(g,function(T){return T.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function _r(c,g,E){return E&&E.internalChannelParams&&E.internalChannelParams[c]||g}function Rl(c){this.Aa=0,this.i=[],this.j=new _s,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=_r("failFast",!1,c),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=_r("baseRetryDelayMs",5e3,c),this.cb=_r("retryDelaySeedMs",1e4,c),this.Wa=_r("forwardChannelMaxRetries",2,c),this.wa=_r("forwardChannelRequestTimeoutMs",2e4,c),this.pa=c&&c.xmlHttpFactory||void 0,this.Xa=c&&c.Tb||void 0,this.Ca=c&&c.useFetchStreams||!1,this.L=void 0,this.J=c&&c.supportsCrossDomainXhr||!1,this.K="",this.h=new xs(c&&c.concurrentRequestLimit),this.Da=new hf,this.P=c&&c.fastHandshake||!1,this.O=c&&c.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=c&&c.Rb||!1,c&&c.xa&&this.j.xa(),c&&c.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&c&&c.detectBufferingProxy||!1,this.ja=void 0,c&&c.longPollingTimeout&&0<c.longPollingTimeout&&(this.ja=c.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=Rl.prototype,n.la=8,n.G=1,n.connect=function(c,g,E,T){pt(0),this.W=c,this.H=g||{},E&&T!==void 0&&(this.H.OSID=E,this.H.OAID=T),this.F=this.X,this.I=xc(this,null,this.W),wr(this)};function Mt(c){if(Bo(c),c.G==3){var g=c.U++,E=gn(c.I);if(Qe(E,"SID",c.K),Qe(E,"RID",g),Qe(E,"TYPE","terminate"),Qr(c,E),g=new Kn(c,c.j,g),g.L=2,g.v=Si(gn(E)),E=!1,d.navigator&&d.navigator.sendBeacon)try{E=d.navigator.sendBeacon(g.v.toString(),"")}catch{}!E&&d.Image&&(new Image().src=g.v,E=!0),E||(g.g=Tc(g.j,null),g.g.ea(g.v)),g.F=Date.now(),Xe(g)}Ic(c)}function Zn(c){c.g&&(Cl(c),c.g.cancel(),c.g=null)}function Bo(c){Zn(c),c.u&&(d.clearTimeout(c.u),c.u=null),qo(c),c.h.cancel(),c.s&&(typeof c.s=="number"&&d.clearTimeout(c.s),c.s=null)}function wr(c){if(!mn(c.h)&&!c.s){c.s=!0;var g=c.Ga;Fe||he(),le||(Fe(),le=!0),Ee.add(g,c),c.B=0}}function pf(c,g){return cc(c.h)>=c.h.j-(c.s?1:0)?!1:c.s?(c.i=g.D.concat(c.i),!0):c.G==1||c.G==2||c.B>=(c.Va?0:c.Wa)?!1:(c.s=Hn(x(c.Ga,c,g),Ec(c,c.B)),c.B++,!0)}n.Ga=function(c){if(this.s)if(this.s=null,this.G==1){if(!c){this.U=Math.floor(1e5*Math.random()),c=this.U++;const B=new Kn(this,this.j,c);let G=this.o;if(this.S&&(G?(G=k(G),D(G,this.S)):G=this.S),this.m!==null||this.O||(B.H=G,G=null),this.P)e:{for(var g=0,E=0;E<this.i.length;E++){t:{var T=this.i[E];if("__data__"in T.map&&(T=T.map.__data__,typeof T=="string")){T=T.length;break t}T=void 0}if(T===void 0)break;if(g+=T,4096<g){g=E;break e}if(g===4096||E===this.i.length-1){g=E+1;break e}}g=1e3}else g=1e3;g=Ri(this,B,g),E=gn(this.I),Qe(E,"RID",c),Qe(E,"CVER",22),this.D&&Qe(E,"X-HTTP-Session-Id",this.D),Qr(this,E),G&&(this.O?g="headers="+encodeURIComponent(String(Kr(G)))+"&"+g:this.m&&Ai(E,this.m,G)),Tl(this.h,B),this.Ua&&Qe(E,"TYPE","init"),this.P?(Qe(E,"$req",g),Qe(E,"SID","null"),B.T=!0,Vo(B,E,null)):Vo(B,E,g),this.G=2}}else this.G==3&&(c?zo(this,c):this.i.length==0||mn(this.h)||zo(this))};function zo(c,g){var E;g?E=g.l:E=c.U++;const T=gn(c.I);Qe(T,"SID",c.K),Qe(T,"RID",E),Qe(T,"AID",c.T),Qr(c,T),c.m&&c.o&&Ai(T,c.m,c.o),E=new Kn(c,c.j,E,c.B+1),c.m===null&&(E.H=c.o),g&&(c.i=g.D.concat(c.i)),g=Ri(c,E,1e3),E.I=Math.round(.5*c.wa)+Math.round(.5*c.wa*Math.random()),Tl(c.h,E),Vo(E,T,g)}function Qr(c,g){c.H&&re(c.H,function(E,T){Qe(g,T,E)}),c.l&&Ii({},function(E,T){Qe(g,T,E)})}function Ri(c,g,E){E=Math.min(c.i.length,E);var T=c.l?x(c.l.Na,c.l,c):null;e:{var B=c.i;let G=-1;for(;;){const ae=["count="+E];G==-1?0<E?(G=B[0].g,ae.push("ofs="+G)):G=0:ae.push("ofs="+G);let qe=!0;for(let St=0;St<E;St++){let Le=B[St].g;const Pt=B[St].map;if(Le-=G,0>Le)G=Math.max(0,B[St].g-100),qe=!1;else try{vc(Pt,ae,"req"+Le+"_")}catch{T&&T(Pt)}}if(qe){T=ae.join("&");break e}}}return c=c.i.splice(0,E),g.D=c,T}function As(c){if(!c.g&&!c.u){c.Y=1;var g=c.Fa;Fe||he(),le||(Fe(),le=!0),Ee.add(g,c),c.v=0}}function $o(c){return c.g||c.u||3<=c.v?!1:(c.Y++,c.u=Hn(x(c.Fa,c),Ec(c,c.v)),c.v++,!0)}n.Fa=function(){if(this.u=null,wc(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var c=2*this.R;this.j.info("BP detection timer enabled: "+c),this.A=Hn(x(this.ab,this),c)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,pt(10),Zn(this),wc(this))};function Cl(c){c.A!=null&&(d.clearTimeout(c.A),c.A=null)}function wc(c){c.g=new Kn(c,c.j,"rpc",c.Y),c.m===null&&(c.g.H=c.o),c.g.O=0;var g=gn(c.qa);Qe(g,"RID","rpc"),Qe(g,"SID",c.K),Qe(g,"AID",c.T),Qe(g,"CI",c.F?"0":"1"),!c.F&&c.ja&&Qe(g,"TO",c.ja),Qe(g,"TYPE","xmlhttp"),Qr(c,g),c.m&&c.o&&Ai(g,c.m,c.o),c.L&&(c.g.I=c.L);var E=c.g;c=c.ia,E.L=1,E.v=Si(gn(g)),E.m=null,E.P=!0,Il(E,c)}n.Za=function(){this.C!=null&&(this.C=null,Zn(this),$o(this),pt(19))};function qo(c){c.C!=null&&(d.clearTimeout(c.C),c.C=null)}function Ho(c,g){var E=null;if(c.g==g){qo(c),Cl(c),c.g=null;var T=2}else if(Xt(c.h,g))E=g.D,dc(c.h,g),T=1;else return;if(c.G!=0){if(g.o)if(T==1){E=g.m?g.m.length:0,g=Date.now()-g.F;var B=c.B;T=vs(),Tt(T,new Co(T,E)),wr(c)}else As(c);else if(B=g.s,B==3||B==0&&0<g.X||!(T==1&&pf(c,g)||T==2&&$o(c)))switch(E&&0<E.length&&(g=c.h,g.i=g.i.concat(E)),B){case 1:Yr(c,5);break;case 4:Yr(c,10);break;case 3:Yr(c,6);break;default:Yr(c,2)}}}function Ec(c,g){let E=c.Ta+Math.floor(Math.random()*c.cb);return c.isActive()||(E*=2),E*g}function Yr(c,g){if(c.j.info("Error code "+g),g==2){var E=x(c.fb,c),T=c.Xa;const B=!T;T=new Wr(T||"//www.google.com/images/cleardot.gif"),d.location&&d.location.protocol=="http"||Ss(T,"https"),Si(T),B?df(T.toString(),E):yc(T.toString(),E)}else pt(2);c.G=0,c.l&&c.l.sa(g),Ic(c),Bo(c)}n.fb=function(c){c?(this.j.info("Successfully pinged google.com"),pt(2)):(this.j.info("Failed to ping google.com"),pt(1))};function Ic(c){if(c.G=0,c.ka=[],c.l){const g=hc(c.h);(g.length!=0||c.i.length!=0)&&(O(c.ka,g),O(c.ka,c.i),c.h.i.length=0,P(c.i),c.i.length=0),c.l.ra()}}function xc(c,g,E){var T=E instanceof Wr?gn(E):new Wr(E);if(T.g!="")g&&(T.g=g+"."+T.g),xi(T,T.s);else{var B=d.location;T=B.protocol,g=g?g+"."+B.hostname:B.hostname,B=+B.port;var G=new Wr(null);T&&Ss(G,T),g&&(G.g=g),B&&xi(G,B),E&&(G.l=E),T=G}return E=c.D,g=c.ya,E&&g&&Qe(T,E,g),Qe(T,"VER",c.la),Qr(c,T),T}function Tc(c,g,E){if(g&&!c.J)throw Error("Can't create secondary domain capable XhrIo object.");return g=c.Ca&&!c.pa?new rt(new Gr({eb:E})):new rt(c.pa),g.Ha(c.J),g}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Pl(){}n=Pl.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Wo(){}Wo.prototype.g=function(c,g){return new Jt(c,g)};function Jt(c,g){xt.call(this),this.g=new Rl(g),this.l=c,this.h=g&&g.messageUrlParams||null,c=g&&g.messageHeaders||null,g&&g.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=g&&g.initMessageHeaders||null,g&&g.messageContentType&&(c?c["X-WebChannel-Content-Type"]=g.messageContentType:c={"X-WebChannel-Content-Type":g.messageContentType}),g&&g.va&&(c?c["X-WebChannel-Client-Profile"]=g.va:c={"X-WebChannel-Client-Profile":g.va}),this.g.S=c,(c=g&&g.Sb)&&!Q(c)&&(this.g.m=c),this.v=g&&g.supportsCrossDomainXhr||!1,this.u=g&&g.sendRawJson||!1,(g=g&&g.httpSessionIdParam)&&!Q(g)&&(this.g.D=g,c=this.h,c!==null&&g in c&&(c=this.h,g in c&&delete c[g])),this.j=new Er(this)}N(Jt,xt),Jt.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Jt.prototype.close=function(){Mt(this.g)},Jt.prototype.o=function(c){var g=this.g;if(typeof c=="string"){var E={};E.__data__=c,c=E}else this.u&&(E={},E.__data__=pl(c),c=E);g.i.push(new uc(g.Ya++,c)),g.G==3&&wr(g)},Jt.prototype.N=function(){this.g.l=null,delete this.j,Mt(this.g),delete this.g,Jt.aa.N.call(this)};function Sc(c){mr.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var g=c.__sm__;if(g){e:{for(const E in g){c=E;break e}c=void 0}(this.i=c)&&(c=this.i,g=g!==null&&c in g?g[c]:void 0),this.data=g}else this.data=c}N(Sc,mr);function kc(){Ro.call(this),this.status=1}N(kc,Ro);function Er(c){this.g=c}N(Er,Pl),Er.prototype.ua=function(){Tt(this.g,"a")},Er.prototype.ta=function(c){Tt(this.g,new Sc(c))},Er.prototype.sa=function(c){Tt(this.g,new kc)},Er.prototype.ra=function(){Tt(this.g,"b")},Wo.prototype.createWebChannel=Wo.prototype.g,Jt.prototype.send=Jt.prototype.o,Jt.prototype.open=Jt.prototype.m,Jt.prototype.close=Jt.prototype.close,jE=function(){return new Wo},ME=function(){return vs()},LE=gr,cm={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},No.NO_ERROR=0,No.TIMEOUT=8,No.HTTP_ERROR=6,Nd=No,sc.COMPLETE="complete",OE=sc,Ao.EventType=bn,bn.OPEN="a",bn.CLOSE="b",bn.ERROR="c",bn.MESSAGE="d",xt.prototype.listen=xt.prototype.K,lu=Ao,rt.prototype.listenOnce=rt.prototype.L,rt.prototype.getLastError=rt.prototype.Ka,rt.prototype.getLastErrorCode=rt.prototype.Ba,rt.prototype.getStatus=rt.prototype.Z,rt.prototype.getResponseJson=rt.prototype.Oa,rt.prototype.getResponseText=rt.prototype.oa,rt.prototype.send=rt.prototype.ea,rt.prototype.setWithCredentials=rt.prototype.Ha,VE=rt}).apply(typeof Ed<"u"?Ed:typeof self<"u"?self:typeof window<"u"?window:{});const Z_="@firebase/firestore",ew="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ut{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Ut.UNAUTHENTICATED=new Ut(null),Ut.GOOGLE_CREDENTIALS=new Ut("google-credentials-uid"),Ut.FIRST_PARTY=new Ut("first-party-uid"),Ut.MOCK_USER=new Ut("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ja="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const so=new bh("@firebase/firestore");function wa(){return so.logLevel}function ne(n,...e){if(so.logLevel<=Ne.DEBUG){const t=e.map(ng);so.debug(`Firestore (${Ja}): ${n}`,...t)}}function tn(n,...e){if(so.logLevel<=Ne.ERROR){const t=e.map(ng);so.error(`Firestore (${Ja}): ${n}`,...t)}}function Mr(n,...e){if(so.logLevel<=Ne.WARN){const t=e.map(ng);so.warn(`Firestore (${Ja}): ${n}`,...t)}}function ng(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return(function(t){return JSON.stringify(t)})(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function me(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,FE(n,r,t)}function FE(n,e,t){let r=`FIRESTORE (${Ja}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw tn(r),new Error(r)}function ve(n,e,t,r){let s="Unexpected state";typeof t=="string"?s=t:r=t,n||FE(e,s,r)}function be(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class oe extends fr{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nr{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UE{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class TA{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Ut.UNAUTHENTICATED)))}shutdown(){}}class SA{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class kA{constructor(e){this.t=e,this.currentUser=Ut.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){ve(this.o===void 0,42304);let r=this.i;const s=f=>this.i!==r?(r=this.i,t(f)):Promise.resolve();let a=new Nr;this.o=()=>{this.i++,this.currentUser=this.u(),a.resolve(),a=new Nr,e.enqueueRetryable((()=>s(this.currentUser)))};const l=()=>{const f=a;e.enqueueRetryable((async()=>{await f.promise,await s(this.currentUser)}))},d=f=>{ne("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=f,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit((f=>d(f))),setTimeout((()=>{if(!this.auth){const f=this.t.getImmediate({optional:!0});f?d(f):(ne("FirebaseAuthCredentialsProvider","Auth not yet detected"),a.resolve(),a=new Nr)}}),0),l()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((r=>this.i!==e?(ne("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(ve(typeof r.accessToken=="string",31837,{l:r}),new UE(r.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ve(e===null||typeof e=="string",2055,{h:e}),new Ut(e)}}class bA{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Ut.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class AA{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new bA(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(Ut.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class tw{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class RA{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,ar(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){ve(this.o===void 0,3512);const r=a=>{a.error!=null&&ne("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${a.error.message}`);const l=a.token!==this.m;return this.m=a.token,ne("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?t(a.token):Promise.resolve()};this.o=a=>{e.enqueueRetryable((()=>r(a)))};const s=a=>{ne("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((a=>s(a))),setTimeout((()=>{if(!this.appCheck){const a=this.V.getImmediate({optional:!0});a?s(a):ne("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new tw(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((t=>t?(ve(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new tw(t.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CA(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BE(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rg{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=CA(40);for(let a=0;a<s.length;++a)r.length<20&&s[a]<t&&(r+=e.charAt(s[a]%62))}return r}}function Te(n,e){return n<e?-1:n>e?1:0}function dm(n,e){let t=0;for(;t<n.length&&t<e.length;){const r=n.codePointAt(t),s=e.codePointAt(t);if(r!==s){if(r<128&&s<128)return Te(r,s);{const a=BE(),l=PA(a.encode(nw(n,t)),a.encode(nw(e,t)));return l!==0?l:Te(r,s)}}t+=r>65535?2:1}return Te(n.length,e.length)}function nw(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function PA(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return Te(n[t],e[t]);return Te(n.length,e.length)}function Ca(n,e,t){return n.length===e.length&&n.every(((r,s)=>t(r,e[s])))}function zE(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rw="__name__";class Ar{constructor(e,t,r){t===void 0?t=0:t>e.length&&me(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&me(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Ar.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ar?e.forEach((r=>{t.push(r)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let s=0;s<r;s++){const a=Ar.compareSegments(e.get(s),t.get(s));if(a!==0)return a}return Te(e.length,t.length)}static compareSegments(e,t){const r=Ar.isNumericId(e),s=Ar.isNumericId(t);return r&&!s?-1:!r&&s?1:r&&s?Ar.extractNumericId(e).compare(Ar.extractNumericId(t)):dm(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ns.fromString(e.substring(4,e.length-2))}}class $e extends Ar{construct(e,t,r){return new $e(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new oe(Y.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter((s=>s.length>0)))}return new $e(t)}static emptyPath(){return new $e([])}}const NA=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ct extends Ar{construct(e,t,r){return new ct(e,t,r)}static isValidIdentifier(e){return NA.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ct.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===rw}static keyField(){return new ct([rw])}static fromServerFormat(e){const t=[];let r="",s=0;const a=()=>{if(r.length===0)throw new oe(Y.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let l=!1;for(;s<e.length;){const d=e[s];if(d==="\\"){if(s+1===e.length)throw new oe(Y.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const f=e[s+1];if(f!=="\\"&&f!=="."&&f!=="`")throw new oe(Y.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=f,s+=2}else d==="`"?(l=!l,s++):d!=="."||l?(r+=d,s++):(a(),s++)}if(a(),l)throw new oe(Y.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ct(t)}static emptyPath(){return new ct([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ue{constructor(e){this.path=e}static fromPath(e){return new ue($e.fromString(e))}static fromName(e){return new ue($e.fromString(e).popFirst(5))}static empty(){return new ue($e.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&$e.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return $e.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ue(new $e(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $E(n,e,t){if(!t)throw new oe(Y.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function DA(n,e,t,r){if(e===!0&&r===!0)throw new oe(Y.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function iw(n){if(!ue.isDocumentKey(n))throw new oe(Y.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function sw(n){if(ue.isDocumentKey(n))throw new oe(Y.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function qE(n){return typeof n=="object"&&n!==null&&(Object.getPrototypeOf(n)===Object.prototype||Object.getPrototypeOf(n)===null)}function Ah(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=(function(r){return r.constructor?r.constructor.name:null})(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":me(12329,{type:typeof n})}function nn(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new oe(Y.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Ah(n);throw new oe(Y.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function VA(n,e){if(e<=0)throw new oe(Y.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _t(n,e){const t={typeString:n};return e&&(t.value=e),t}function qu(n,e){if(!qE(n))throw new oe(Y.INVALID_ARGUMENT,"JSON must be an object");let t;for(const r in e)if(e[r]){const s=e[r].typeString,a="value"in e[r]?{value:e[r].value}:void 0;if(!(r in n)){t=`JSON missing required field: '${r}'`;break}const l=n[r];if(s&&typeof l!==s){t=`JSON field '${r}' must be a ${s}.`;break}if(a!==void 0&&l!==a.value){t=`Expected '${r}' field to equal '${a.value}'`;break}}if(t)throw new oe(Y.INVALID_ARGUMENT,t);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ow=-62135596800,aw=1e6;class He{static now(){return He.fromMillis(Date.now())}static fromDate(e){return He.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*aw);return new He(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new oe(Y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new oe(Y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<ow)throw new oe(Y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new oe(Y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/aw}_compareTo(e){return this.seconds===e.seconds?Te(this.nanoseconds,e.nanoseconds):Te(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:He._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(qu(e,He._jsonSchema))return new He(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-ow;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}He._jsonSchemaVersion="firestore/timestamp/1.0",He._jsonSchema={type:_t("string",He._jsonSchemaVersion),seconds:_t("number"),nanoseconds:_t("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class we{static fromTimestamp(e){return new we(e)}static min(){return new we(new He(0,0))}static max(){return new we(new He(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ku=-1;class Xd{constructor(e,t,r,s){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=s}}function hm(n){return n.fields.find((e=>e.kind===2))}function qs(n){return n.fields.filter((e=>e.kind!==2))}Xd.UNKNOWN_ID=-1;class Dd{constructor(e,t){this.fieldPath=e,this.kind=t}}class bu{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new bu(0,Sn.min())}}function OA(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,s=we.fromTimestamp(r===1e9?new He(t+1,0):new He(t,r));return new Sn(s,ue.empty(),e)}function HE(n){return new Sn(n.readTime,n.key,ku)}class Sn{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new Sn(we.min(),ue.empty(),ku)}static max(){return new Sn(we.max(),ue.empty(),ku)}}function ig(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=ue.comparator(n.documentKey,e.documentKey),t!==0?t:Te(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WE="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class GE{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _o(n){if(n.code!==Y.FAILED_PRECONDITION||n.message!==WE)throw n;ne("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)}),(t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&me(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new z(((r,s)=>{this.nextCallback=a=>{this.wrapSuccess(e,a).next(r,s)},this.catchCallback=a=>{this.wrapFailure(t,a).next(r,s)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof z?t:z.resolve(t)}catch(t){return z.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):z.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):z.reject(t)}static resolve(e){return new z(((t,r)=>{t(e)}))}static reject(e){return new z(((t,r)=>{r(e)}))}static waitFor(e){return new z(((t,r)=>{let s=0,a=0,l=!1;e.forEach((d=>{++s,d.next((()=>{++a,l&&a===s&&t()}),(f=>r(f)))})),l=!0,a===s&&t()}))}static or(e){let t=z.resolve(!1);for(const r of e)t=t.next((s=>s?z.resolve(s):r()));return t}static forEach(e,t){const r=[];return e.forEach(((s,a)=>{r.push(t.call(this,s,a))})),this.waitFor(r)}static mapArray(e,t){return new z(((r,s)=>{const a=e.length,l=new Array(a);let d=0;for(let f=0;f<a;f++){const p=f;t(e[p]).next((v=>{l[p]=v,++d,d===a&&r(l)}),(v=>s(v)))}}))}static doWhile(e,t){return new z(((r,s)=>{const a=()=>{e()===!0?t().next((()=>{a()}),s):r()};a()}))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const In="SimpleDb";class Rh{static open(e,t,r,s){try{return new Rh(t,e.transaction(s,r))}catch(a){throw new pu(t,a)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new Nr,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new pu(e,t.error)):this.S.resolve()},this.transaction.onerror=r=>{const s=sg(r.target.error);this.S.reject(new pu(e,s))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(ne(In,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}v(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new MA(t)}}class rs{static delete(e){return ne(In,"Removing database:",e),Ws(yE().indexedDB.deleteDatabase(e)).toPromise()}static C(){if(!kh())return!1;if(rs.F())return!0;const e=At(),t=rs.M(e),r=0<t&&t<10,s=KE(e),a=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||a)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.O)==="YES"}static N(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.B=r,this.L=null,rs.M(At())===12.2&&tn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async k(e){return this.db||(ne(In,"Opening database:",this.name),this.db=await new Promise(((t,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=a=>{const l=a.target.result;t(l)},s.onblocked=()=>{r(new pu(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=a=>{const l=a.target.error;l.name==="VersionError"?r(new oe(Y.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):l.name==="InvalidStateError"?r(new oe(Y.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+l)):r(new pu(e,l))},s.onupgradeneeded=a=>{ne(In,'Database "'+this.name+'" requires upgrade from version:',a.oldVersion);const l=a.target.result;if(this.L!==null&&this.L!==a.oldVersion)throw new Error(`refusing to open IndexedDB database due to potential corruption of the IndexedDB database data; this corruption could be caused by clicking the "clear site data" button in a web browser; try reloading the web page to re-initialize the IndexedDB database: lastClosedDbVersion=${this.L}, event.oldVersion=${a.oldVersion}, event.newVersion=${a.newVersion}, db.version=${l.version}`);this.B.q(l,s.transaction,a.oldVersion,this.version).next((()=>{ne(In,"Database upgrade to version "+this.version+" complete")}))}})),this.db.addEventListener("close",(t=>{const r=t.target;this.L=r.version}),{passive:!0})),this.db.addEventListener("versionchange",(t=>{var r;t.newVersion===null&&(Mr('Received "versionchange" event with newVersion===null; notifying the registered DatabaseDeletedListener, if any'),(r=this.databaseDeletedListener)===null||r===void 0||r.call(this))}),{passive:!0}),this.db}setDatabaseDeletedListener(e){if(this.databaseDeletedListener)throw new Error("setDatabaseDeletedListener() may only be called once, and it has already been called");this.databaseDeletedListener=e}async runTransaction(e,t,r,s){const a=t==="readonly";let l=0;for(;;){++l;try{this.db=await this.k(e);const d=Rh.open(this.db,e,a?"readonly":"readwrite",r),f=s(d).next((p=>(d.v(),p))).catch((p=>(d.abort(p),z.reject(p)))).toPromise();return f.catch((()=>{})),await d.D,f}catch(d){const f=d,p=f.name!=="FirebaseError"&&l<3;if(ne(In,"Transaction failed with error:",f.message,"Retrying:",p),this.close(),!p)return Promise.reject(f)}}}close(){this.db&&this.db.close(),this.db=void 0}}function KE(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class LA{constructor(e){this.$=e,this.U=!1,this.K=null}get isDone(){return this.U}get W(){return this.K}set cursor(e){this.$=e}done(){this.U=!0}G(e){this.K=e}delete(){return Ws(this.$.delete())}}class pu extends oe{constructor(e,t){super(Y.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function hs(n){return n.name==="IndexedDbTransactionError"}class MA{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(ne(In,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(ne(In,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Ws(r)}add(e){return ne(In,"ADD",this.store.name,e,e),Ws(this.store.add(e))}get(e){return Ws(this.store.get(e)).next((t=>(t===void 0&&(t=null),ne(In,"GET",this.store.name,e,t),t)))}delete(e){return ne(In,"DELETE",this.store.name,e),Ws(this.store.delete(e))}count(){return ne(In,"COUNT",this.store.name),Ws(this.store.count())}j(e,t){const r=this.options(e,t),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const a=s.getAll(r.range);return new z(((l,d)=>{a.onerror=f=>{d(f.target.error)},a.onsuccess=f=>{l(f.target.result)}}))}{const a=this.cursor(r),l=[];return this.J(a,((d,f)=>{l.push(f)})).next((()=>l))}}H(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new z(((s,a)=>{r.onerror=l=>{a(l.target.error)},r.onsuccess=l=>{s(l.target.result)}}))}Y(e,t){ne(In,"DELETE ALL",this.store.name);const r=this.options(e,t);r.Z=!1;const s=this.cursor(r);return this.J(s,((a,l,d)=>d.delete()))}X(e,t){let r;t?r=e:(r={},t=e);const s=this.cursor(r);return this.J(s,t)}ee(e){const t=this.cursor({});return new z(((r,s)=>{t.onerror=a=>{const l=sg(a.target.error);s(l)},t.onsuccess=a=>{const l=a.target.result;l?e(l.primaryKey,l.value).next((d=>{d?l.continue():r()})):r()}}))}J(e,t){const r=[];return new z(((s,a)=>{e.onerror=l=>{a(l.target.error)},e.onsuccess=l=>{const d=l.target.result;if(!d)return void s();const f=new LA(d),p=t(d.primaryKey,d.value,f);if(p instanceof z){const v=p.catch((_=>(f.done(),z.reject(_))));r.push(v)}f.isDone?s():f.W===null?d.continue():d.continue(f.W)}})).next((()=>z.waitFor(r)))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.Z?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Ws(n){return new z(((e,t)=>{n.onsuccess=r=>{const s=r.target.result;e(s)},n.onerror=r=>{const s=sg(r.target.error);t(s)}}))}let lw=!1;function sg(n){const e=rs.M(At());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new oe("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return lw||(lw=!0,setTimeout((()=>{throw r}),0)),r}}return n}const mu="IndexBackfiller";class jA{constructor(e,t){this.asyncQueue=e,this.te=t,this.task=null}start(){this.ne(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}ne(e){ne(mu,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{const t=await this.te.re();ne(mu,`Documents written: ${t}`)}catch(t){hs(t)?ne(mu,"Ignoring IndexedDB error during index backfill: ",t):await _o(t)}await this.ne(6e4)}))}}class FA{constructor(e,t){this.localStore=e,this.persistence=t}async re(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.ie(t,e)))}ie(e,t){const r=new Set;let s=t,a=!0;return z.doWhile((()=>a===!0&&s>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((l=>{if(l!==null&&!r.has(l))return ne(mu,`Processing collection: ${l}`),this.se(e,l,s).next((d=>{s-=d,r.add(l)}));a=!1})))).next((()=>t-s))}se(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((s=>this.localStore.localDocuments.getNextDocuments(e,t,s,r).next((a=>{const l=a.changes;return this.localStore.indexManager.updateIndexEntries(e,l).next((()=>this.oe(s,a))).next((d=>(ne(mu,`Updating offset: ${d}`),this.localStore.indexManager.updateCollectionGroup(e,t,d)))).next((()=>l.size))}))))}oe(e,t){let r=e;return t.changes.forEach(((s,a)=>{const l=HE(a);ig(l,r)>0&&(r=l)})),new Sn(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jn{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this._e(r),this.ae=r=>t.writeSequenceNumber(r))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}jn.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zs=-1;function Ch(n){return n==null}function Au(n){return n===0&&1/n==-1/0}function UA(n){return typeof n=="number"&&Number.isInteger(n)&&!Au(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jd="";function Yt(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=uw(e)),e=BA(n.get(t),e);return uw(e)}function BA(n,e){let t=e;const r=n.length;for(let s=0;s<r;s++){const a=n.charAt(s);switch(a){case"\0":t+="";break;case Jd:t+="";break;default:t+=a}}return t}function uw(n){return n+Jd+""}function Cr(n){const e=n.length;if(ve(e>=2,64408,{path:n}),e===2)return ve(n.charAt(0)===Jd&&n.charAt(1)==="",56145,{path:n}),$e.emptyPath();const t=e-2,r=[];let s="";for(let a=0;a<e;){const l=n.indexOf(Jd,a);switch((l<0||l>t)&&me(50515,{path:n}),n.charAt(l+1)){case"":const d=n.substring(a,l);let f;s.length===0?f=d:(s+=d,f=s,s=""),r.push(f);break;case"":s+=n.substring(a,l),s+="\0";break;case"":s+=n.substring(a,l+1);break;default:me(61167,{path:n})}a=l+2}return new $e(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hs="remoteDocuments",Hu="owner",pa="owner",Ru="mutationQueues",zA="userId",or="mutations",cw="batchId",Ys="userMutationsIndex",dw=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vd(n,e){return[n,Yt(e)]}function QE(n,e,t){return[n,Yt(e),t]}const $A={},Pa="documentMutations",Zd="remoteDocumentsV14",qA=["prefixPath","collectionGroup","readTime","documentId"],Od="documentKeyIndex",HA=["prefixPath","collectionGroup","documentId"],YE="collectionGroupIndex",WA=["collectionGroup","readTime","prefixPath","documentId"],Cu="remoteDocumentGlobal",fm="remoteDocumentGlobalKey",Na="targets",XE="queryTargetsIndex",GA=["canonicalId","targetId"],Da="targetDocuments",KA=["targetId","path"],og="documentTargetsIndex",QA=["path","targetId"],eh="targetGlobalKey",eo="targetGlobal",Pu="collectionParents",YA=["collectionId","parent"],Va="clientMetadata",XA="clientId",Ph="bundles",JA="bundleId",Nh="namedQueries",ZA="name",ag="indexConfiguration",eR="indexId",pm="collectionGroupIndex",tR="collectionGroup",gu="indexState",nR=["indexId","uid"],JE="sequenceNumberIndex",rR=["uid","sequenceNumber"],yu="indexEntries",iR=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],ZE="documentKeyIndex",sR=["indexId","uid","orderedDocumentKey"],Dh="documentOverlays",oR=["userId","collectionPath","documentId"],mm="collectionPathOverlayIndex",aR=["userId","collectionPath","largestBatchId"],eI="collectionGroupOverlayIndex",lR=["userId","collectionGroup","largestBatchId"],lg="globals",uR="name",tI=[Ru,or,Pa,Hs,Na,Hu,eo,Da,Va,Cu,Pu,Ph,Nh],cR=[...tI,Dh],nI=[Ru,or,Pa,Zd,Na,Hu,eo,Da,Va,Cu,Pu,Ph,Nh,Dh],rI=nI,ug=[...rI,ag,gu,yu],dR=ug,iI=[...ug,lg],hR=iI;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gm extends GE{constructor(e,t){super(),this.ce=e,this.currentSequenceNumber=t}}function Rt(n,e){const t=be(n);return rs.N(t.ce,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hw(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function fs(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function sI(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class at{constructor(e,t){this.comparator=e,this.root=t||Bt.EMPTY}insert(e,t){return new at(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Bt.BLACK,null,null))}remove(e){return new at(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Bt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return t+r.left.size;s<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,r)=>(e(t,r),!1)))}toString(){const e=[];return this.inorderTraversal(((t,r)=>(e.push(`${t}:${r}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Id(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Id(this.root,e,this.comparator,!1)}getReverseIterator(){return new Id(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Id(this.root,e,this.comparator,!0)}}class Id{constructor(e,t,r,s){this.isReverse=s,this.nodeStack=[];let a=1;for(;!e.isEmpty();)if(a=t?r(e.key,t):1,t&&s&&(a*=-1),a<0)e=this.isReverse?e.left:e.right;else{if(a===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Bt{constructor(e,t,r,s,a){this.key=e,this.value=t,this.color=r??Bt.RED,this.left=s??Bt.EMPTY,this.right=a??Bt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,s,a){return new Bt(e??this.key,t??this.value,r??this.color,s??this.left,a??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let s=this;const a=r(e,s.key);return s=a<0?s.copy(null,null,null,s.left.insert(e,t,r),null):a===0?s.copy(null,t,null,null,null):s.copy(null,null,null,null,s.right.insert(e,t,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Bt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,s=this;if(t(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,t),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),t(e,s.key)===0){if(s.right.isEmpty())return Bt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,t))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Bt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Bt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw me(43730,{key:this.key,value:this.value});if(this.right.isRed())throw me(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw me(27949);return e+(this.isRed()?0:1)}}Bt.EMPTY=null,Bt.RED=!0,Bt.BLACK=!1;Bt.EMPTY=new class{constructor(){this.size=0}get key(){throw me(57766)}get value(){throw me(16141)}get color(){throw me(16727)}get left(){throw me(29726)}get right(){throw me(36894)}copy(e,t,r,s,a){return this}insert(e,t,r){return new Bt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ge{constructor(e){this.comparator=e,this.data=new at(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,r)=>(e(t),!1)))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;t(s.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new fw(this.data.getIterator())}getIteratorFrom(e){return new fw(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((r=>{t=t.add(r)})),t}isEqual(e){if(!(e instanceof Ge)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const s=t.getNext().key,a=r.getNext().key;if(this.comparator(s,a)!==0)return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Ge(this.comparator);return t.data=e,t}}class fw{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function ma(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fn{constructor(e){this.fields=e,e.sort(ct.comparator)}static empty(){return new fn([])}unionWith(e){let t=new Ge(ct.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new fn(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Ca(this.fields,e.fields,((t,r)=>t.isEqual(r)))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oI extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class It{constructor(e){this.binaryString=e}static fromBase64String(e){const t=(function(s){try{return atob(s)}catch(a){throw typeof DOMException<"u"&&a instanceof DOMException?new oI("Invalid base64 string: "+a):a}})(e);return new It(t)}static fromUint8Array(e){const t=(function(s){let a="";for(let l=0;l<s.length;++l)a+=String.fromCharCode(s[l]);return a})(e);return new It(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return(function(t){return btoa(t)})(this.binaryString)}toUint8Array(){return(function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Te(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}It.EMPTY_BYTE_STRING=new It("");const fR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function hi(n){if(ve(!!n,39018),typeof n=="string"){let e=0;const t=fR.exec(n);if(ve(!!t,46558,{timestamp:n}),t[1]){let s=t[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:st(n.seconds),nanos:st(n.nanos)}}function st(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function fi(n){return typeof n=="string"?It.fromBase64String(n):It.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aI="server_timestamp",lI="__type__",uI="__previous_value__",cI="__local_write_time__";function cg(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[lI])===null||t===void 0?void 0:t.stringValue)===aI}function Vh(n){const e=n.mapValue.fields[uI];return cg(e)?Vh(e):e}function Nu(n){const e=hi(n.mapValue.fields[cI].timestampValue);return new He(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pR{constructor(e,t,r,s,a,l,d,f,p,v){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=s,this.ssl=a,this.forceLongPolling=l,this.autoDetectLongPolling=d,this.longPollingOptions=f,this.useFetchStreams=p,this.isUsingEmulator=v}}const th="(default)";class oo{constructor(e,t){this.projectId=e,this.database=t||th}static empty(){return new oo("","")}get isDefaultDatabase(){return this.database===th}isEqual(e){return e instanceof oo&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dg="__type__",dI="__max__",Zi={mapValue:{fields:{__type__:{stringValue:dI}}}},hg="__vector__",Oa="value",Ld={nullValue:"NULL_VALUE"};function os(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?cg(n)?4:hI(n)?9007199254740991:Oh(n)?10:11:me(28295,{value:n})}function jr(n,e){if(n===e)return!0;const t=os(n);if(t!==os(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Nu(n).isEqual(Nu(e));case 3:return(function(s,a){if(typeof s.timestampValue=="string"&&typeof a.timestampValue=="string"&&s.timestampValue.length===a.timestampValue.length)return s.timestampValue===a.timestampValue;const l=hi(s.timestampValue),d=hi(a.timestampValue);return l.seconds===d.seconds&&l.nanos===d.nanos})(n,e);case 5:return n.stringValue===e.stringValue;case 6:return(function(s,a){return fi(s.bytesValue).isEqual(fi(a.bytesValue))})(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return(function(s,a){return st(s.geoPointValue.latitude)===st(a.geoPointValue.latitude)&&st(s.geoPointValue.longitude)===st(a.geoPointValue.longitude)})(n,e);case 2:return(function(s,a){if("integerValue"in s&&"integerValue"in a)return st(s.integerValue)===st(a.integerValue);if("doubleValue"in s&&"doubleValue"in a){const l=st(s.doubleValue),d=st(a.doubleValue);return l===d?Au(l)===Au(d):isNaN(l)&&isNaN(d)}return!1})(n,e);case 9:return Ca(n.arrayValue.values||[],e.arrayValue.values||[],jr);case 10:case 11:return(function(s,a){const l=s.mapValue.fields||{},d=a.mapValue.fields||{};if(hw(l)!==hw(d))return!1;for(const f in l)if(l.hasOwnProperty(f)&&(d[f]===void 0||!jr(l[f],d[f])))return!1;return!0})(n,e);default:return me(52216,{left:n})}}function Du(n,e){return(n.values||[]).find((t=>jr(t,e)))!==void 0}function as(n,e){if(n===e)return 0;const t=os(n),r=os(e);if(t!==r)return Te(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return Te(n.booleanValue,e.booleanValue);case 2:return(function(a,l){const d=st(a.integerValue||a.doubleValue),f=st(l.integerValue||l.doubleValue);return d<f?-1:d>f?1:d===f?0:isNaN(d)?isNaN(f)?0:-1:1})(n,e);case 3:return pw(n.timestampValue,e.timestampValue);case 4:return pw(Nu(n),Nu(e));case 5:return dm(n.stringValue,e.stringValue);case 6:return(function(a,l){const d=fi(a),f=fi(l);return d.compareTo(f)})(n.bytesValue,e.bytesValue);case 7:return(function(a,l){const d=a.split("/"),f=l.split("/");for(let p=0;p<d.length&&p<f.length;p++){const v=Te(d[p],f[p]);if(v!==0)return v}return Te(d.length,f.length)})(n.referenceValue,e.referenceValue);case 8:return(function(a,l){const d=Te(st(a.latitude),st(l.latitude));return d!==0?d:Te(st(a.longitude),st(l.longitude))})(n.geoPointValue,e.geoPointValue);case 9:return mw(n.arrayValue,e.arrayValue);case 10:return(function(a,l){var d,f,p,v;const _=a.fields||{},x=l.fields||{},S=(d=_[Oa])===null||d===void 0?void 0:d.arrayValue,N=(f=x[Oa])===null||f===void 0?void 0:f.arrayValue,P=Te(((p=S==null?void 0:S.values)===null||p===void 0?void 0:p.length)||0,((v=N==null?void 0:N.values)===null||v===void 0?void 0:v.length)||0);return P!==0?P:mw(S,N)})(n.mapValue,e.mapValue);case 11:return(function(a,l){if(a===Zi.mapValue&&l===Zi.mapValue)return 0;if(a===Zi.mapValue)return 1;if(l===Zi.mapValue)return-1;const d=a.fields||{},f=Object.keys(d),p=l.fields||{},v=Object.keys(p);f.sort(),v.sort();for(let _=0;_<f.length&&_<v.length;++_){const x=dm(f[_],v[_]);if(x!==0)return x;const S=as(d[f[_]],p[v[_]]);if(S!==0)return S}return Te(f.length,v.length)})(n.mapValue,e.mapValue);default:throw me(23264,{le:t})}}function pw(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return Te(n,e);const t=hi(n),r=hi(e),s=Te(t.seconds,r.seconds);return s!==0?s:Te(t.nanos,r.nanos)}function mw(n,e){const t=n.values||[],r=e.values||[];for(let s=0;s<t.length&&s<r.length;++s){const a=as(t[s],r[s]);if(a)return a}return Te(t.length,r.length)}function La(n){return ym(n)}function ym(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?(function(t){const r=hi(t);return`time(${r.seconds},${r.nanos})`})(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?(function(t){return fi(t).toBase64()})(n.bytesValue):"referenceValue"in n?(function(t){return ue.fromName(t).toString()})(n.referenceValue):"geoPointValue"in n?(function(t){return`geo(${t.latitude},${t.longitude})`})(n.geoPointValue):"arrayValue"in n?(function(t){let r="[",s=!0;for(const a of t.values||[])s?s=!1:r+=",",r+=ym(a);return r+"]"})(n.arrayValue):"mapValue"in n?(function(t){const r=Object.keys(t.fields||{}).sort();let s="{",a=!0;for(const l of r)a?a=!1:s+=",",s+=`${l}:${ym(t.fields[l])}`;return s+"}"})(n.mapValue):me(61005,{value:n})}function Md(n){switch(os(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Vh(n);return e?16+Md(e):16;case 5:return 2*n.stringValue.length;case 6:return fi(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return(function(r){return(r.values||[]).reduce(((s,a)=>s+Md(a)),0)})(n.arrayValue);case 10:case 11:return(function(r){let s=0;return fs(r.fields,((a,l)=>{s+=a.length+Md(l)})),s})(n.mapValue);default:throw me(13486,{value:n})}}function Vu(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function vm(n){return!!n&&"integerValue"in n}function Ou(n){return!!n&&"arrayValue"in n}function gw(n){return!!n&&"nullValue"in n}function yw(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function jd(n){return!!n&&"mapValue"in n}function Oh(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[dg])===null||t===void 0?void 0:t.stringValue)===hg}function vu(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return fs(n.mapValue.fields,((t,r)=>e.mapValue.fields[t]=vu(r))),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=vu(n.arrayValue.values[t]);return e}return Object.assign({},n)}function hI(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===dI}const fI={mapValue:{fields:{[dg]:{stringValue:hg},[Oa]:{arrayValue:{}}}}};function mR(n){return"nullValue"in n?Ld:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Vu(oo.empty(),ue.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Oh(n)?fI:{mapValue:{}}:me(35942,{value:n})}function gR(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Vu(oo.empty(),ue.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?fI:"mapValue"in n?Oh(n)?{mapValue:{}}:Zi:me(61959,{value:n})}function vw(n,e){const t=as(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function _w(n,e){const t=as(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kt{constructor(e){this.value=e}static empty(){return new Kt({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!jd(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=vu(t)}setAll(e){let t=ct.emptyPath(),r={},s=[];e.forEach(((l,d)=>{if(!t.isImmediateParentOf(d)){const f=this.getFieldsMap(t);this.applyChanges(f,r,s),r={},s=[],t=d.popLast()}l?r[d.lastSegment()]=vu(l):s.push(d.lastSegment())}));const a=this.getFieldsMap(t);this.applyChanges(a,r,s)}delete(e){const t=this.field(e.popLast());jd(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return jr(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=t.mapValue.fields[e.get(r)];jd(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=s),t=s}return t.mapValue.fields}applyChanges(e,t,r){fs(t,((s,a)=>e[s]=a));for(const s of r)delete e[s]}clone(){return new Kt(vu(this.value))}}function pI(n){const e=[];return fs(n.fields,((t,r)=>{const s=new ct([t]);if(jd(r)){const a=pI(r.mapValue).fields;if(a.length===0)e.push(s);else for(const l of a)e.push(s.child(l))}else e.push(s)})),new fn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ht{constructor(e,t,r,s,a,l,d){this.key=e,this.documentType=t,this.version=r,this.readTime=s,this.createTime=a,this.data=l,this.documentState=d}static newInvalidDocument(e){return new ht(e,0,we.min(),we.min(),we.min(),Kt.empty(),0)}static newFoundDocument(e,t,r,s){return new ht(e,1,t,we.min(),r,s,0)}static newNoDocument(e,t){return new ht(e,2,t,we.min(),we.min(),Kt.empty(),0)}static newUnknownDocument(e,t){return new ht(e,3,t,we.min(),we.min(),Kt.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(we.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Kt.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Kt.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=we.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ht&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ht(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ma{constructor(e,t){this.position=e,this.inclusive=t}}function ww(n,e,t){let r=0;for(let s=0;s<n.position.length;s++){const a=e[s],l=n.position[s];if(a.field.isKeyField()?r=ue.comparator(ue.fromName(l.referenceValue),t.key):r=as(l,t.data.field(a.field)),a.dir==="desc"&&(r*=-1),r!==0)break}return r}function Ew(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!jr(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lu{constructor(e,t="asc"){this.field=e,this.dir=t}}function yR(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mI{}class De extends mI{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new vR(e,t,r):t==="array-contains"?new ER(e,r):t==="in"?new EI(e,r):t==="not-in"?new IR(e,r):t==="array-contains-any"?new xR(e,r):new De(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new _R(e,r):new wR(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(as(t,this.value)):t!==null&&os(this.value)===os(t)&&this.matchesComparison(as(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return me(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class We extends mI{constructor(e,t){super(),this.filters=e,this.op=t,this.he=null}static create(e,t){return new We(e,t)}matches(e){return ja(this)?this.filters.find((t=>!t.matches(e)))===void 0:this.filters.find((t=>t.matches(e)))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function ja(n){return n.op==="and"}function _m(n){return n.op==="or"}function fg(n){return gI(n)&&ja(n)}function gI(n){for(const e of n.filters)if(e instanceof We)return!1;return!0}function wm(n){if(n instanceof De)return n.field.canonicalString()+n.op.toString()+La(n.value);if(fg(n))return n.filters.map((e=>wm(e))).join(",");{const e=n.filters.map((t=>wm(t))).join(",");return`${n.op}(${e})`}}function yI(n,e){return n instanceof De?(function(r,s){return s instanceof De&&r.op===s.op&&r.field.isEqual(s.field)&&jr(r.value,s.value)})(n,e):n instanceof We?(function(r,s){return s instanceof We&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce(((a,l,d)=>a&&yI(l,s.filters[d])),!0):!1})(n,e):void me(19439)}function vI(n,e){const t=n.filters.concat(e);return We.create(t,n.op)}function _I(n){return n instanceof De?(function(t){return`${t.field.canonicalString()} ${t.op} ${La(t.value)}`})(n):n instanceof We?(function(t){return t.op.toString()+" {"+t.getFilters().map(_I).join(" ,")+"}"})(n):"Filter"}class vR extends De{constructor(e,t,r){super(e,t,r),this.key=ue.fromName(r.referenceValue)}matches(e){const t=ue.comparator(e.key,this.key);return this.matchesComparison(t)}}class _R extends De{constructor(e,t){super(e,"in",t),this.keys=wI("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class wR extends De{constructor(e,t){super(e,"not-in",t),this.keys=wI("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function wI(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map((r=>ue.fromName(r.referenceValue)))}class ER extends De{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Ou(t)&&Du(t.arrayValue,this.value)}}class EI extends De{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Du(this.value.arrayValue,t)}}class IR extends De{constructor(e,t){super(e,"not-in",t)}matches(e){if(Du(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Du(this.value.arrayValue,t)}}class xR extends De{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Ou(t)||!t.arrayValue.values)&&t.arrayValue.values.some((r=>Du(this.value.arrayValue,r)))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TR{constructor(e,t=null,r=[],s=[],a=null,l=null,d=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=s,this.limit=a,this.startAt=l,this.endAt=d,this.Pe=null}}function Em(n,e=null,t=[],r=[],s=null,a=null,l=null){return new TR(n,e,t,r,s,a,l)}function ao(n){const e=be(n);if(e.Pe===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map((r=>wm(r))).join(","),t+="|ob:",t+=e.orderBy.map((r=>(function(a){return a.field.canonicalString()+a.dir})(r))).join(","),Ch(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((r=>La(r))).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((r=>La(r))).join(",")),e.Pe=t}return e.Pe}function Wu(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!yR(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!yI(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!Ew(n.startAt,e.startAt)&&Ew(n.endAt,e.endAt)}function nh(n){return ue.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function rh(n,e){return n.filters.filter((t=>t instanceof De&&t.field.isEqual(e)))}function Iw(n,e,t){let r=Ld,s=!0;for(const a of rh(n,e)){let l=Ld,d=!0;switch(a.op){case"<":case"<=":l=mR(a.value);break;case"==":case"in":case">=":l=a.value;break;case">":l=a.value,d=!1;break;case"!=":case"not-in":l=Ld}vw({value:r,inclusive:s},{value:l,inclusive:d})<0&&(r=l,s=d)}if(t!==null){for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const l=t.position[a];vw({value:r,inclusive:s},{value:l,inclusive:t.inclusive})<0&&(r=l,s=t.inclusive);break}}return{value:r,inclusive:s}}function xw(n,e,t){let r=Zi,s=!0;for(const a of rh(n,e)){let l=Zi,d=!0;switch(a.op){case">=":case">":l=gR(a.value),d=!1;break;case"==":case"in":case"<=":l=a.value;break;case"<":l=a.value,d=!1;break;case"!=":case"not-in":l=Zi}_w({value:r,inclusive:s},{value:l,inclusive:d})>0&&(r=l,s=d)}if(t!==null){for(let a=0;a<n.orderBy.length;++a)if(n.orderBy[a].field.isEqual(e)){const l=t.position[a];_w({value:r,inclusive:s},{value:l,inclusive:t.inclusive})>0&&(r=l,s=t.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Za{constructor(e,t=null,r=[],s=[],a=null,l="F",d=null,f=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=s,this.limit=a,this.limitType=l,this.startAt=d,this.endAt=f,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function SR(n,e,t,r,s,a,l,d){return new Za(n,e,t,r,s,a,l,d)}function Gu(n){return new Za(n)}function Tw(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function II(n){return n.collectionGroup!==null}function _u(n){const e=be(n);if(e.Te===null){e.Te=[];const t=new Set;for(const a of e.explicitOrderBy)e.Te.push(a),t.add(a.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(l){let d=new Ge(ct.comparator);return l.filters.forEach((f=>{f.getFlattenedFilters().forEach((p=>{p.isInequality()&&(d=d.add(p.field))}))})),d})(e).forEach((a=>{t.has(a.canonicalString())||a.isKeyField()||e.Te.push(new Lu(a,r))})),t.has(ct.keyField().canonicalString())||e.Te.push(new Lu(ct.keyField(),r))}return e.Te}function Un(n){const e=be(n);return e.Ie||(e.Ie=kR(e,_u(n))),e.Ie}function kR(n,e){if(n.limitType==="F")return Em(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map((s=>{const a=s.dir==="desc"?"asc":"desc";return new Lu(s.field,a)}));const t=n.endAt?new Ma(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new Ma(n.startAt.position,n.startAt.inclusive):null;return Em(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function Im(n,e){const t=n.filters.concat([e]);return new Za(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function ih(n,e,t){return new Za(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function Lh(n,e){return Wu(Un(n),Un(e))&&n.limitType===e.limitType}function xI(n){return`${ao(Un(n))}|lt:${n.limitType}`}function Ea(n){return`Query(target=${(function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map((s=>_I(s))).join(", ")}]`),Ch(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map((s=>(function(l){return`${l.field.canonicalString()} (${l.dir})`})(s))).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map((s=>La(s))).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map((s=>La(s))).join(",")),`Target(${r})`})(Un(n))}; limitType=${n.limitType})`}function Ku(n,e){return e.isFoundDocument()&&(function(r,s){const a=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(a):ue.isDocumentKey(r.path)?r.path.isEqual(a):r.path.isImmediateParentOf(a)})(n,e)&&(function(r,s){for(const a of _u(r))if(!a.field.isKeyField()&&s.data.field(a.field)===null)return!1;return!0})(n,e)&&(function(r,s){for(const a of r.filters)if(!a.matches(s))return!1;return!0})(n,e)&&(function(r,s){return!(r.startAt&&!(function(l,d,f){const p=ww(l,d,f);return l.inclusive?p<=0:p<0})(r.startAt,_u(r),s)||r.endAt&&!(function(l,d,f){const p=ww(l,d,f);return l.inclusive?p>=0:p>0})(r.endAt,_u(r),s))})(n,e)}function bR(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function TI(n){return(e,t)=>{let r=!1;for(const s of _u(n)){const a=AR(s,e,t);if(a!==0)return a;r=r||s.field.isKeyField()}return 0}}function AR(n,e,t){const r=n.field.isKeyField()?ue.comparator(e.key,t.key):(function(a,l,d){const f=l.data.field(a),p=d.data.field(a);return f!==null&&p!==null?as(f,p):me(42886)})(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return me(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[s,a]of r)if(this.equalsFn(s,e))return a}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let a=0;a<s.length;a++)if(this.equalsFn(s[a][0],e))return void(s[a]=[e,t]);s.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[t]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){fs(this.inner,((t,r)=>{for(const[s,a]of r)e(s,a)}))}isEmpty(){return sI(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RR=new at(ue.comparator);function xn(){return RR}const SI=new at(ue.comparator);function uu(...n){let e=SI;for(const t of n)e=e.insert(t.key,t);return e}function kI(n){let e=SI;return n.forEach(((t,r)=>e=e.insert(t,r.overlayedDocument))),e}function Pr(){return wu()}function bI(){return wu()}function wu(){return new mi((n=>n.toString()),((n,e)=>n.isEqual(e)))}const CR=new at(ue.comparator),PR=new Ge(ue.comparator);function Re(...n){let e=PR;for(const t of n)e=e.add(t);return e}const NR=new Ge(Te);function DR(){return NR}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pg(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Au(e)?"-0":e}}function AI(n){return{integerValue:""+n}}function VR(n,e){return UA(e)?AI(e):pg(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mh{constructor(){this._=void 0}}function OR(n,e,t){return n instanceof Fa?(function(s,a){const l={fields:{[lI]:{stringValue:aI},[cI]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return a&&cg(a)&&(a=Vh(a)),a&&(l.fields[uI]=a),{mapValue:l}})(t,e):n instanceof Ua?CI(n,e):n instanceof Ba?PI(n,e):(function(s,a){const l=RI(s,a),d=Sw(l)+Sw(s.Ee);return vm(l)&&vm(s.Ee)?AI(d):pg(s.serializer,d)})(n,e)}function LR(n,e,t){return n instanceof Ua?CI(n,e):n instanceof Ba?PI(n,e):t}function RI(n,e){return n instanceof Mu?(function(r){return vm(r)||(function(a){return!!a&&"doubleValue"in a})(r)})(e)?e:{integerValue:0}:null}class Fa extends Mh{}class Ua extends Mh{constructor(e){super(),this.elements=e}}function CI(n,e){const t=NI(e);for(const r of n.elements)t.some((s=>jr(s,r)))||t.push(r);return{arrayValue:{values:t}}}class Ba extends Mh{constructor(e){super(),this.elements=e}}function PI(n,e){let t=NI(e);for(const r of n.elements)t=t.filter((s=>!jr(s,r)));return{arrayValue:{values:t}}}class Mu extends Mh{constructor(e,t){super(),this.serializer=e,this.Ee=t}}function Sw(n){return st(n.integerValue||n.doubleValue)}function NI(n){return Ou(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DI{constructor(e,t){this.field=e,this.transform=t}}function MR(n,e){return n.field.isEqual(e.field)&&(function(r,s){return r instanceof Ua&&s instanceof Ua||r instanceof Ba&&s instanceof Ba?Ca(r.elements,s.elements,jr):r instanceof Mu&&s instanceof Mu?jr(r.Ee,s.Ee):r instanceof Fa&&s instanceof Fa})(n.transform,e.transform)}class jR{constructor(e,t){this.version=e,this.transformResults=t}}class Qt{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Qt}static exists(e){return new Qt(void 0,e)}static updateTime(e){return new Qt(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Fd(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class jh{}function VI(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new Fh(n.key,Qt.none()):new el(n.key,n.data,Qt.none());{const t=n.data,r=Kt.empty();let s=new Ge(ct.comparator);for(let a of e.fields)if(!s.has(a)){let l=t.field(a);l===null&&a.length>1&&(a=a.popLast(),l=t.field(a)),l===null?r.delete(a):r.set(a,l),s=s.add(a)}return new gi(n.key,r,new fn(s.toArray()),Qt.none())}}function FR(n,e,t){n instanceof el?(function(s,a,l){const d=s.value.clone(),f=bw(s.fieldTransforms,a,l.transformResults);d.setAll(f),a.convertToFoundDocument(l.version,d).setHasCommittedMutations()})(n,e,t):n instanceof gi?(function(s,a,l){if(!Fd(s.precondition,a))return void a.convertToUnknownDocument(l.version);const d=bw(s.fieldTransforms,a,l.transformResults),f=a.data;f.setAll(OI(s)),f.setAll(d),a.convertToFoundDocument(l.version,f).setHasCommittedMutations()})(n,e,t):(function(s,a,l){a.convertToNoDocument(l.version).setHasCommittedMutations()})(0,e,t)}function Eu(n,e,t,r){return n instanceof el?(function(a,l,d,f){if(!Fd(a.precondition,l))return d;const p=a.value.clone(),v=Aw(a.fieldTransforms,f,l);return p.setAll(v),l.convertToFoundDocument(l.version,p).setHasLocalMutations(),null})(n,e,t,r):n instanceof gi?(function(a,l,d,f){if(!Fd(a.precondition,l))return d;const p=Aw(a.fieldTransforms,f,l),v=l.data;return v.setAll(OI(a)),v.setAll(p),l.convertToFoundDocument(l.version,v).setHasLocalMutations(),d===null?null:d.unionWith(a.fieldMask.fields).unionWith(a.fieldTransforms.map((_=>_.field)))})(n,e,t,r):(function(a,l,d){return Fd(a.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):d})(n,e,t)}function UR(n,e){let t=null;for(const r of n.fieldTransforms){const s=e.data.field(r.field),a=RI(r.transform,s||null);a!=null&&(t===null&&(t=Kt.empty()),t.set(r.field,a))}return t||null}function kw(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!(function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Ca(r,s,((a,l)=>MR(a,l)))})(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class el extends jh{constructor(e,t,r,s=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class gi extends jh{constructor(e,t,r,s,a=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=s,this.fieldTransforms=a,this.type=1}getFieldMask(){return this.fieldMask}}function OI(n){const e=new Map;return n.fieldMask.fields.forEach((t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}})),e}function bw(n,e,t){const r=new Map;ve(n.length===t.length,32656,{Ae:t.length,Re:n.length});for(let s=0;s<t.length;s++){const a=n[s],l=a.transform,d=e.data.field(a.field);r.set(a.field,LR(l,d,t[s]))}return r}function Aw(n,e,t){const r=new Map;for(const s of n){const a=s.transform,l=t.data.field(s.field);r.set(s.field,OR(a,l,e))}return r}class Fh extends jh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class LI extends jh{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mg{constructor(e,t,r,s){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let s=0;s<this.mutations.length;s++){const a=this.mutations[s];a.key.isEqual(e.key)&&FR(a,e,r[s])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=Eu(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=Eu(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=bI();return this.mutations.forEach((s=>{const a=e.get(s.key),l=a.overlayedDocument;let d=this.applyToLocalView(l,a.mutatedFields);d=t.has(s.key)?null:d;const f=VI(l,d);f!==null&&r.set(s.key,f),l.isValidDocument()||l.convertToNoDocument(we.min())})),r}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Re())}isEqual(e){return this.batchId===e.batchId&&Ca(this.mutations,e.mutations,((t,r)=>kw(t,r)))&&Ca(this.baseMutations,e.baseMutations,((t,r)=>kw(t,r)))}}class gg{constructor(e,t,r,s){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=s}static from(e,t,r){ve(e.mutations.length===r.length,58842,{Ve:e.mutations.length,me:r.length});let s=(function(){return CR})();const a=e.mutations;for(let l=0;l<a.length;l++)s=s.insert(a[l].key,r[l].version);return new gg(e,t,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yg{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BR{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var vt,Me;function zR(n){switch(n){case Y.OK:return me(64938);case Y.CANCELLED:case Y.UNKNOWN:case Y.DEADLINE_EXCEEDED:case Y.RESOURCE_EXHAUSTED:case Y.INTERNAL:case Y.UNAVAILABLE:case Y.UNAUTHENTICATED:return!1;case Y.INVALID_ARGUMENT:case Y.NOT_FOUND:case Y.ALREADY_EXISTS:case Y.PERMISSION_DENIED:case Y.FAILED_PRECONDITION:case Y.ABORTED:case Y.OUT_OF_RANGE:case Y.UNIMPLEMENTED:case Y.DATA_LOSS:return!0;default:return me(15467,{code:n})}}function MI(n){if(n===void 0)return tn("GRPC error has no .code"),Y.UNKNOWN;switch(n){case vt.OK:return Y.OK;case vt.CANCELLED:return Y.CANCELLED;case vt.UNKNOWN:return Y.UNKNOWN;case vt.DEADLINE_EXCEEDED:return Y.DEADLINE_EXCEEDED;case vt.RESOURCE_EXHAUSTED:return Y.RESOURCE_EXHAUSTED;case vt.INTERNAL:return Y.INTERNAL;case vt.UNAVAILABLE:return Y.UNAVAILABLE;case vt.UNAUTHENTICATED:return Y.UNAUTHENTICATED;case vt.INVALID_ARGUMENT:return Y.INVALID_ARGUMENT;case vt.NOT_FOUND:return Y.NOT_FOUND;case vt.ALREADY_EXISTS:return Y.ALREADY_EXISTS;case vt.PERMISSION_DENIED:return Y.PERMISSION_DENIED;case vt.FAILED_PRECONDITION:return Y.FAILED_PRECONDITION;case vt.ABORTED:return Y.ABORTED;case vt.OUT_OF_RANGE:return Y.OUT_OF_RANGE;case vt.UNIMPLEMENTED:return Y.UNIMPLEMENTED;case vt.DATA_LOSS:return Y.DATA_LOSS;default:return me(39323,{code:n})}}(Me=vt||(vt={}))[Me.OK=0]="OK",Me[Me.CANCELLED=1]="CANCELLED",Me[Me.UNKNOWN=2]="UNKNOWN",Me[Me.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Me[Me.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Me[Me.NOT_FOUND=5]="NOT_FOUND",Me[Me.ALREADY_EXISTS=6]="ALREADY_EXISTS",Me[Me.PERMISSION_DENIED=7]="PERMISSION_DENIED",Me[Me.UNAUTHENTICATED=16]="UNAUTHENTICATED",Me[Me.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Me[Me.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Me[Me.ABORTED=10]="ABORTED",Me[Me.OUT_OF_RANGE=11]="OUT_OF_RANGE",Me[Me.UNIMPLEMENTED=12]="UNIMPLEMENTED",Me[Me.INTERNAL=13]="INTERNAL",Me[Me.UNAVAILABLE=14]="UNAVAILABLE",Me[Me.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $R=new ns([4294967295,4294967295],0);function Rw(n){const e=BE().encode(n),t=new DE;return t.update(e),new Uint8Array(t.digest())}function Cw(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),a=e.getUint32(12,!0);return[new ns([t,r],0),new ns([s,a],0)]}class vg{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new cu(`Invalid padding: ${t}`);if(r<0)throw new cu(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new cu(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new cu(`Invalid padding when bitmap length is 0: ${t}`);this.fe=8*e.length-t,this.ge=ns.fromNumber(this.fe)}pe(e,t,r){let s=e.add(t.multiply(ns.fromNumber(r)));return s.compare($R)===1&&(s=new ns([s.getBits(0),s.getBits(1)],0)),s.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;const t=Rw(e),[r,s]=Cw(t);for(let a=0;a<this.hashCount;a++){const l=this.pe(r,s,a);if(!this.ye(l))return!1}return!0}static create(e,t,r){const s=e%8==0?0:8-e%8,a=new Uint8Array(Math.ceil(e/8)),l=new vg(a,s,t);return r.forEach((d=>l.insert(d))),l}insert(e){if(this.fe===0)return;const t=Rw(e),[r,s]=Cw(t);for(let a=0;a<this.hashCount;a++){const l=this.pe(r,s,a);this.we(l)}}we(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class cu extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uh{constructor(e,t,r,s,a){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=a}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const s=new Map;return s.set(e,Qu.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Uh(we.min(),s,new at(Te),xn(),Re())}}class Qu{constructor(e,t,r,s,a){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=a}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new Qu(r,t,Re(),Re(),Re())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ud{constructor(e,t,r,s){this.Se=e,this.removedTargetIds=t,this.key=r,this.be=s}}class jI{constructor(e,t){this.targetId=e,this.De=t}}class FI{constructor(e,t,r=It.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=s}}class Pw{constructor(){this.ve=0,this.Ce=Nw(),this.Fe=It.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=Re(),t=Re(),r=Re();return this.Ce.forEach(((s,a)=>{switch(a){case 0:e=e.add(s);break;case 2:t=t.add(s);break;case 1:r=r.add(s);break;default:me(38017,{changeType:a})}})),new Qu(this.Fe,this.Me,e,t,r)}ke(){this.xe=!1,this.Ce=Nw()}qe(e,t){this.xe=!0,this.Ce=this.Ce.insert(e,t)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,ve(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class qR{constructor(e){this.We=e,this.Ge=new Map,this.ze=xn(),this.je=xd(),this.Je=xd(),this.He=new at(Te)}Ye(e){for(const t of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(t,e.be):this.Xe(t,e.key,e.be);for(const t of e.removedTargetIds)this.Xe(t,e.key,e.be)}et(e){this.forEachTarget(e,(t=>{const r=this.tt(t);switch(e.state){case 0:this.nt(t)&&r.Be(e.resumeToken);break;case 1:r.Ue(),r.Oe||r.ke(),r.Be(e.resumeToken);break;case 2:r.Ue(),r.Oe||this.removeTarget(t);break;case 3:this.nt(t)&&(r.Ke(),r.Be(e.resumeToken));break;case 4:this.nt(t)&&(this.rt(t),r.Be(e.resumeToken));break;default:me(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Ge.forEach(((r,s)=>{this.nt(s)&&t(s)}))}it(e){const t=e.targetId,r=e.De.count,s=this.st(t);if(s){const a=s.target;if(nh(a))if(r===0){const l=new ue(a.path);this.Xe(t,l,ht.newNoDocument(l,we.min()))}else ve(r===1,20013,{expectedCount:r});else{const l=this.ot(t);if(l!==r){const d=this._t(e),f=d?this.ut(d,e,l):1;if(f!==0){this.rt(t);const p=f===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(t,p)}}}}}_t(e){const t=e.De.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:a=0}=t;let l,d;try{l=fi(r).toUint8Array()}catch(f){if(f instanceof oI)return Mr("Decoding the base64 bloom filter in existence filter failed ("+f.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw f}try{d=new vg(l,s,a)}catch(f){return Mr(f instanceof cu?"BloomFilter error: ":"Applying bloom filter failed: ",f),null}return d.fe===0?null:d}ut(e,t,r){return t.De.count===r-this.ht(e,t.targetId)?0:2}ht(e,t){const r=this.We.getRemoteKeysForTarget(t);let s=0;return r.forEach((a=>{const l=this.We.lt(),d=`projects/${l.projectId}/databases/${l.database}/documents/${a.path.canonicalString()}`;e.mightContain(d)||(this.Xe(t,a,null),s++)})),s}Pt(e){const t=new Map;this.Ge.forEach(((a,l)=>{const d=this.st(l);if(d){if(a.current&&nh(d.target)){const f=new ue(d.target.path);this.Tt(f).has(l)||this.It(l,f)||this.Xe(l,f,ht.newNoDocument(f,e))}a.Ne&&(t.set(l,a.Le()),a.ke())}}));let r=Re();this.Je.forEach(((a,l)=>{let d=!0;l.forEachWhile((f=>{const p=this.st(f);return!p||p.purpose==="TargetPurposeLimboResolution"||(d=!1,!1)})),d&&(r=r.add(a))})),this.ze.forEach(((a,l)=>l.setReadTime(e)));const s=new Uh(e,t,this.He,this.ze,r);return this.ze=xn(),this.je=xd(),this.Je=xd(),this.He=new at(Te),s}Ze(e,t){if(!this.nt(e))return;const r=this.It(e,t.key)?2:0;this.tt(e).qe(t.key,r),this.ze=this.ze.insert(t.key,t),this.je=this.je.insert(t.key,this.Tt(t.key).add(e)),this.Je=this.Je.insert(t.key,this.dt(t.key).add(e))}Xe(e,t,r){if(!this.nt(e))return;const s=this.tt(e);this.It(e,t)?s.qe(t,1):s.Qe(t),this.Je=this.Je.insert(t,this.dt(t).delete(e)),this.Je=this.Je.insert(t,this.dt(t).add(e)),r&&(this.ze=this.ze.insert(t,r))}removeTarget(e){this.Ge.delete(e)}ot(e){const t=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let t=this.Ge.get(e);return t||(t=new Pw,this.Ge.set(e,t)),t}dt(e){let t=this.Je.get(e);return t||(t=new Ge(Te),this.Je=this.Je.insert(e,t)),t}Tt(e){let t=this.je.get(e);return t||(t=new Ge(Te),this.je=this.je.insert(e,t)),t}nt(e){const t=this.st(e)!==null;return t||ne("WatchChangeAggregator","Detected inactive target",e),t}st(e){const t=this.Ge.get(e);return t&&t.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new Pw),this.We.getRemoteKeysForTarget(e).forEach((t=>{this.Xe(e,t,null)}))}It(e,t){return this.We.getRemoteKeysForTarget(e).has(t)}}function xd(){return new at(ue.comparator)}function Nw(){return new at(ue.comparator)}const HR={asc:"ASCENDING",desc:"DESCENDING"},WR={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},GR={and:"AND",or:"OR"};class KR{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function xm(n,e){return n.useProto3Json||Ch(e)?e:{value:e}}function za(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function UI(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function QR(n,e){return za(n,e.toTimestamp())}function rn(n){return ve(!!n,49232),we.fromTimestamp((function(t){const r=hi(t);return new He(r.seconds,r.nanos)})(n))}function _g(n,e){return Tm(n,e).canonicalString()}function Tm(n,e){const t=(function(s){return new $e(["projects",s.projectId,"databases",s.database])})(n).child("documents");return e===void 0?t:t.child(e)}function BI(n){const e=$e.fromString(n);return ve(YI(e),10190,{key:e.toString()}),e}function sh(n,e){return _g(n.databaseId,e.path)}function to(n,e){const t=BI(e);if(t.get(1)!==n.databaseId.projectId)throw new oe(Y.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new oe(Y.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new ue(qI(t))}function zI(n,e){return _g(n.databaseId,e)}function $I(n){const e=BI(n);return e.length===4?$e.emptyPath():qI(e)}function Sm(n){return new $e(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function qI(n){return ve(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function Dw(n,e,t){return{name:sh(n,e),fields:t.value.mapValue.fields}}function YR(n,e,t){const r=to(n,e.name),s=rn(e.updateTime),a=e.createTime?rn(e.createTime):we.min(),l=new Kt({mapValue:{fields:e.fields}}),d=ht.newFoundDocument(r,s,a,l);return t&&d.setHasCommittedMutations(),t?d.setHasCommittedMutations():d}function XR(n,e){let t;if("targetChange"in e){e.targetChange;const r=(function(p){return p==="NO_CHANGE"?0:p==="ADD"?1:p==="REMOVE"?2:p==="CURRENT"?3:p==="RESET"?4:me(39313,{state:p})})(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],a=(function(p,v){return p.useProto3Json?(ve(v===void 0||typeof v=="string",58123),It.fromBase64String(v||"")):(ve(v===void 0||v instanceof Buffer||v instanceof Uint8Array,16193),It.fromUint8Array(v||new Uint8Array))})(n,e.targetChange.resumeToken),l=e.targetChange.cause,d=l&&(function(p){const v=p.code===void 0?Y.UNKNOWN:MI(p.code);return new oe(v,p.message||"")})(l);t=new FI(r,s,a,d||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=to(n,r.document.name),a=rn(r.document.updateTime),l=r.document.createTime?rn(r.document.createTime):we.min(),d=new Kt({mapValue:{fields:r.document.fields}}),f=ht.newFoundDocument(s,a,l,d),p=r.targetIds||[],v=r.removedTargetIds||[];t=new Ud(p,v,f.key,f)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=to(n,r.document),a=r.readTime?rn(r.readTime):we.min(),l=ht.newNoDocument(s,a),d=r.removedTargetIds||[];t=new Ud([],d,l.key,l)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=to(n,r.document),a=r.removedTargetIds||[];t=new Ud([],a,s,null)}else{if(!("filter"in e))return me(11601,{At:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:a}=r,l=new BR(s,a),d=r.targetId;t=new jI(d,l)}}return t}function oh(n,e){let t;if(e instanceof el)t={update:Dw(n,e.key,e.value)};else if(e instanceof Fh)t={delete:sh(n,e.key)};else if(e instanceof gi)t={update:Dw(n,e.key,e.data),updateMask:rC(e.fieldMask)};else{if(!(e instanceof LI))return me(16599,{Rt:e.type});t={verify:sh(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map((r=>(function(a,l){const d=l.transform;if(d instanceof Fa)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(d instanceof Ua)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:d.elements}};if(d instanceof Ba)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:d.elements}};if(d instanceof Mu)return{fieldPath:l.field.canonicalString(),increment:d.Ee};throw me(20930,{transform:l.transform})})(0,r)))),e.precondition.isNone||(t.currentDocument=(function(s,a){return a.updateTime!==void 0?{updateTime:QR(s,a.updateTime)}:a.exists!==void 0?{exists:a.exists}:me(27497)})(n,e.precondition)),t}function km(n,e){const t=e.currentDocument?(function(a){return a.updateTime!==void 0?Qt.updateTime(rn(a.updateTime)):a.exists!==void 0?Qt.exists(a.exists):Qt.none()})(e.currentDocument):Qt.none(),r=e.updateTransforms?e.updateTransforms.map((s=>(function(l,d){let f=null;if("setToServerValue"in d)ve(d.setToServerValue==="REQUEST_TIME",16630,{proto:d}),f=new Fa;else if("appendMissingElements"in d){const v=d.appendMissingElements.values||[];f=new Ua(v)}else if("removeAllFromArray"in d){const v=d.removeAllFromArray.values||[];f=new Ba(v)}else"increment"in d?f=new Mu(l,d.increment):me(16584,{proto:d});const p=ct.fromServerFormat(d.fieldPath);return new DI(p,f)})(n,s))):[];if(e.update){e.update.name;const s=to(n,e.update.name),a=new Kt({mapValue:{fields:e.update.fields}});if(e.updateMask){const l=(function(f){const p=f.fieldPaths||[];return new fn(p.map((v=>ct.fromServerFormat(v))))})(e.updateMask);return new gi(s,a,l,t,r)}return new el(s,a,t,r)}if(e.delete){const s=to(n,e.delete);return new Fh(s,t)}if(e.verify){const s=to(n,e.verify);return new LI(s,t)}return me(1463,{proto:e})}function JR(n,e){return n&&n.length>0?(ve(e!==void 0,14353),n.map((t=>(function(s,a){let l=s.updateTime?rn(s.updateTime):rn(a);return l.isEqual(we.min())&&(l=rn(a)),new jR(l,s.transformResults||[])})(t,e)))):[]}function HI(n,e){return{documents:[zI(n,e.path)]}}function WI(n,e){const t={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=zI(n,s);const a=(function(p){if(p.length!==0)return QI(We.create(p,"and"))})(e.filters);a&&(t.structuredQuery.where=a);const l=(function(p){if(p.length!==0)return p.map((v=>(function(x){return{field:Ia(x.field),direction:eC(x.dir)}})(v)))})(e.orderBy);l&&(t.structuredQuery.orderBy=l);const d=xm(n,e.limit);return d!==null&&(t.structuredQuery.limit=d),e.startAt&&(t.structuredQuery.startAt=(function(p){return{before:p.inclusive,values:p.position}})(e.startAt)),e.endAt&&(t.structuredQuery.endAt=(function(p){return{before:!p.inclusive,values:p.position}})(e.endAt)),{Vt:t,parent:s}}function GI(n){let e=$I(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let s=null;if(r>0){ve(r===1,65062);const v=t.from[0];v.allDescendants?s=v.collectionId:e=e.child(v.collectionId)}let a=[];t.where&&(a=(function(_){const x=KI(_);return x instanceof We&&fg(x)?x.getFilters():[x]})(t.where));let l=[];t.orderBy&&(l=(function(_){return _.map((x=>(function(N){return new Lu(xa(N.field),(function(O){switch(O){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}})(N.direction))})(x)))})(t.orderBy));let d=null;t.limit&&(d=(function(_){let x;return x=typeof _=="object"?_.value:_,Ch(x)?null:x})(t.limit));let f=null;t.startAt&&(f=(function(_){const x=!!_.before,S=_.values||[];return new Ma(S,x)})(t.startAt));let p=null;return t.endAt&&(p=(function(_){const x=!_.before,S=_.values||[];return new Ma(S,x)})(t.endAt)),SR(e,s,l,a,d,"F",f,p)}function ZR(n,e){const t=(function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return me(28987,{purpose:s})}})(e.purpose);return t==null?null:{"goog-listen-tags":t}}function KI(n){return n.unaryFilter!==void 0?(function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=xa(t.unaryFilter.field);return De.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=xa(t.unaryFilter.field);return De.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const a=xa(t.unaryFilter.field);return De.create(a,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=xa(t.unaryFilter.field);return De.create(l,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return me(61313);default:return me(60726)}})(n):n.fieldFilter!==void 0?(function(t){return De.create(xa(t.fieldFilter.field),(function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return me(58110);default:return me(50506)}})(t.fieldFilter.op),t.fieldFilter.value)})(n):n.compositeFilter!==void 0?(function(t){return We.create(t.compositeFilter.filters.map((r=>KI(r))),(function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return me(1026)}})(t.compositeFilter.op))})(n):me(30097,{filter:n})}function eC(n){return HR[n]}function tC(n){return WR[n]}function nC(n){return GR[n]}function Ia(n){return{fieldPath:n.canonicalString()}}function xa(n){return ct.fromServerFormat(n.fieldPath)}function QI(n){return n instanceof De?(function(t){if(t.op==="=="){if(yw(t.value))return{unaryFilter:{field:Ia(t.field),op:"IS_NAN"}};if(gw(t.value))return{unaryFilter:{field:Ia(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(yw(t.value))return{unaryFilter:{field:Ia(t.field),op:"IS_NOT_NAN"}};if(gw(t.value))return{unaryFilter:{field:Ia(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ia(t.field),op:tC(t.op),value:t.value}}})(n):n instanceof We?(function(t){const r=t.getFilters().map((s=>QI(s)));return r.length===1?r[0]:{compositeFilter:{op:nC(t.op),filters:r}}})(n):me(54877,{filter:n})}function rC(n){const e=[];return n.fields.forEach((t=>e.push(t.canonicalString()))),{fieldPaths:e}}function YI(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class si{constructor(e,t,r,s,a=we.min(),l=we.min(),d=It.EMPTY_BYTE_STRING,f=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=a,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=d,this.expectedCount=f}withSequenceNumber(e){return new si(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new si(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new si(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new si(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XI{constructor(e){this.gt=e}}function iC(n,e){let t;if(e.document)t=YR(n.gt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=ue.fromSegments(e.noDocument.path),s=uo(e.noDocument.readTime);t=ht.newNoDocument(r,s),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return me(56709);{const r=ue.fromSegments(e.unknownDocument.path),s=uo(e.unknownDocument.version);t=ht.newUnknownDocument(r,s)}}return e.readTime&&t.setReadTime((function(s){const a=new He(s[0],s[1]);return we.fromTimestamp(a)})(e.readTime)),t}function Vw(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:ah(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=(function(a,l){return{name:sh(a,l.key),fields:l.data.value.mapValue.fields,updateTime:za(a,l.version.toTimestamp()),createTime:za(a,l.createTime.toTimestamp())}})(n.gt,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:lo(e.version)};else{if(!e.isUnknownDocument())return me(57904,{document:e});r.unknownDocument={path:t.path.toArray(),version:lo(e.version)}}return r}function ah(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function lo(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function uo(n){const e=new He(n.seconds,n.nanoseconds);return we.fromTimestamp(e)}function Gs(n,e){const t=(e.baseMutations||[]).map((a=>km(n.gt,a)));for(let a=0;a<e.mutations.length-1;++a){const l=e.mutations[a];if(a+1<e.mutations.length&&e.mutations[a+1].transform!==void 0){const d=e.mutations[a+1];l.updateTransforms=d.transform.fieldTransforms,e.mutations.splice(a+1,1),++a}}const r=e.mutations.map((a=>km(n.gt,a))),s=He.fromMillis(e.localWriteTimeMs);return new mg(e.batchId,s,t,r)}function du(n){const e=uo(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?uo(n.lastLimboFreeSnapshotVersion):we.min();let r;return r=(function(a){return a.documents!==void 0})(n.query)?(function(a){const l=a.documents.length;return ve(l===1,1966,{count:l}),Un(Gu($I(a.documents[0])))})(n.query):(function(a){return Un(GI(a))})(n.query),new si(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,It.fromBase64String(n.resumeToken))}function JI(n,e){const t=lo(e.snapshotVersion),r=lo(e.lastLimboFreeSnapshotVersion);let s;s=nh(e.target)?HI(n.gt,e.target):WI(n.gt,e.target).Vt;const a=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:ao(e.target),readTime:t,resumeToken:a,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function ZI(n){const e=GI({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?ih(e,e.limit,"L"):e}function Wp(n,e){return new yg(e.largestBatchId,km(n.gt,e.overlayMutation))}function Ow(n,e){const t=e.path.lastSegment();return[n,Yt(e.path.popLast()),t]}function Lw(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:lo(r.readTime),documentKey:Yt(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sC{getBundleMetadata(e,t){return Mw(e).get(t).next((r=>{if(r)return(function(a){return{id:a.bundleId,createTime:uo(a.createTime),version:a.version}})(r)}))}saveBundleMetadata(e,t){return Mw(e).put((function(s){return{bundleId:s.id,createTime:lo(rn(s.createTime)),version:s.version}})(t))}getNamedQuery(e,t){return jw(e).get(t).next((r=>{if(r)return(function(a){return{name:a.name,query:ZI(a.bundledQuery),readTime:uo(a.readTime)}})(r)}))}saveNamedQuery(e,t){return jw(e).put((function(s){return{name:s.name,readTime:lo(rn(s.readTime)),bundledQuery:s.bundledQuery}})(t))}}function Mw(n){return Rt(n,Ph)}function jw(n){return Rt(n,Nh)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bh{constructor(e,t){this.serializer=e,this.userId=t}static yt(e,t){const r=t.uid||"";return new Bh(e,r)}getOverlay(e,t){return ru(e).get(Ow(this.userId,t)).next((r=>r?Wp(this.serializer,r):null))}getOverlays(e,t){const r=Pr();return z.forEach(t,(s=>this.getOverlay(e,s).next((a=>{a!==null&&r.set(s,a)})))).next((()=>r))}saveOverlays(e,t,r){const s=[];return r.forEach(((a,l)=>{const d=new yg(t,l);s.push(this.wt(e,d))})),z.waitFor(s)}removeOverlaysForBatchId(e,t,r){const s=new Set;t.forEach((l=>s.add(Yt(l.getCollectionPath()))));const a=[];return s.forEach((l=>{const d=IDBKeyRange.bound([this.userId,l,r],[this.userId,l,r+1],!1,!0);a.push(ru(e).Y(mm,d))})),z.waitFor(a)}getOverlaysForCollection(e,t,r){const s=Pr(),a=Yt(t),l=IDBKeyRange.bound([this.userId,a,r],[this.userId,a,Number.POSITIVE_INFINITY],!0);return ru(e).j(mm,l).next((d=>{for(const f of d){const p=Wp(this.serializer,f);s.set(p.getKey(),p)}return s}))}getOverlaysForCollectionGroup(e,t,r,s){const a=Pr();let l;const d=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return ru(e).X({index:eI,range:d},((f,p,v)=>{const _=Wp(this.serializer,p);a.size()<s||_.largestBatchId===l?(a.set(_.getKey(),_),l=_.largestBatchId):v.done()})).next((()=>a))}wt(e,t){return ru(e).put((function(s,a,l){const[d,f,p]=Ow(a,l.mutation.key);return{userId:a,collectionPath:f,documentId:p,collectionGroup:l.mutation.key.getCollectionGroup(),largestBatchId:l.largestBatchId,overlayMutation:oh(s.gt,l.mutation)}})(this.serializer,this.userId,t))}}function ru(n){return Rt(n,Dh)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oC{St(e){return Rt(e,lg)}getSessionToken(e){return this.St(e).get("sessionToken").next((t=>{const r=t==null?void 0:t.value;return r?It.fromUint8Array(r):It.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.St(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ks{constructor(){}bt(e,t){this.Dt(e,t),t.vt()}Dt(e,t){if("nullValue"in e)this.Ct(t,5);else if("booleanValue"in e)this.Ct(t,10),t.Ft(e.booleanValue?1:0);else if("integerValue"in e)this.Ct(t,15),t.Ft(st(e.integerValue));else if("doubleValue"in e){const r=st(e.doubleValue);isNaN(r)?this.Ct(t,13):(this.Ct(t,15),Au(r)?t.Ft(0):t.Ft(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Ct(t,20),typeof r=="string"&&(r=hi(r)),t.Mt(`${r.seconds||""}`),t.Ft(r.nanos||0)}else if("stringValue"in e)this.xt(e.stringValue,t),this.Ot(t);else if("bytesValue"in e)this.Ct(t,30),t.Nt(fi(e.bytesValue)),this.Ot(t);else if("referenceValue"in e)this.Bt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Ct(t,45),t.Ft(r.latitude||0),t.Ft(r.longitude||0)}else"mapValue"in e?hI(e)?this.Ct(t,Number.MAX_SAFE_INTEGER):Oh(e)?this.Lt(e.mapValue,t):(this.kt(e.mapValue,t),this.Ot(t)):"arrayValue"in e?(this.qt(e.arrayValue,t),this.Ot(t)):me(19022,{Qt:e})}xt(e,t){this.Ct(t,25),this.$t(e,t)}$t(e,t){t.Mt(e)}kt(e,t){const r=e.fields||{};this.Ct(t,55);for(const s of Object.keys(r))this.xt(s,t),this.Dt(r[s],t)}Lt(e,t){var r,s;const a=e.fields||{};this.Ct(t,53);const l=Oa,d=((s=(r=a[l].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.length)||0;this.Ct(t,15),t.Ft(st(d)),this.xt(l,t),this.Dt(a[l],t)}qt(e,t){const r=e.values||[];this.Ct(t,50);for(const s of r)this.Dt(s,t)}Bt(e,t){this.Ct(t,37),ue.fromName(e).path.forEach((r=>{this.Ct(t,60),this.$t(r,t)}))}Ct(e,t){e.Ft(t)}Ot(e){e.Ft(2)}}Ks.Ut=new Ks;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ga=255;function aC(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function Fw(n){const e=64-(function(r){let s=0;for(let a=0;a<8;++a){const l=aC(255&r[a]);if(s+=l,l!==8)break}return s})(n);return Math.ceil(e/8)}class lC{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Kt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Wt(r.value),r=t.next();this.Gt()}zt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.jt(r.value),r=t.next();this.Jt()}Ht(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Wt(r);else if(r<2048)this.Wt(960|r>>>6),this.Wt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Wt(480|r>>>12),this.Wt(128|63&r>>>6),this.Wt(128|63&r);else{const s=t.codePointAt(0);this.Wt(240|s>>>18),this.Wt(128|63&s>>>12),this.Wt(128|63&s>>>6),this.Wt(128|63&s)}}this.Gt()}Yt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.jt(r);else if(r<2048)this.jt(960|r>>>6),this.jt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.jt(480|r>>>12),this.jt(128|63&r>>>6),this.jt(128|63&r);else{const s=t.codePointAt(0);this.jt(240|s>>>18),this.jt(128|63&s>>>12),this.jt(128|63&s>>>6),this.jt(128|63&s)}}this.Jt()}Zt(e){const t=this.Xt(e),r=Fw(t);this.en(1+r),this.buffer[this.position++]=255&r;for(let s=t.length-r;s<t.length;++s)this.buffer[this.position++]=255&t[s]}tn(e){const t=this.Xt(e),r=Fw(t);this.en(1+r),this.buffer[this.position++]=~(255&r);for(let s=t.length-r;s<t.length;++s)this.buffer[this.position++]=~(255&t[s])}nn(){this.rn(ga),this.rn(255)}sn(){this._n(ga),this._n(255)}reset(){this.position=0}seed(e){this.en(e.length),this.buffer.set(e,this.position),this.position+=e.length}an(){return this.buffer.slice(0,this.position)}Xt(e){const t=(function(a){const l=new DataView(new ArrayBuffer(8));return l.setFloat64(0,a,!1),new Uint8Array(l.buffer)})(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let s=1;s<t.length;++s)t[s]^=r?255:0;return t}Wt(e){const t=255&e;t===0?(this.rn(0),this.rn(255)):t===ga?(this.rn(ga),this.rn(0)):this.rn(t)}jt(e){const t=255&e;t===0?(this._n(0),this._n(255)):t===ga?(this._n(ga),this._n(0)):this._n(e)}Gt(){this.rn(0),this.rn(1)}Jt(){this._n(0),this._n(1)}rn(e){this.en(1),this.buffer[this.position++]=e}_n(e){this.en(1),this.buffer[this.position++]=~e}en(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class uC{constructor(e){this.un=e}Nt(e){this.un.Kt(e)}Mt(e){this.un.Ht(e)}Ft(e){this.un.Zt(e)}vt(){this.un.nn()}}class cC{constructor(e){this.un=e}Nt(e){this.un.zt(e)}Mt(e){this.un.Yt(e)}Ft(e){this.un.tn(e)}vt(){this.un.sn()}}class iu{constructor(){this.un=new lC,this.cn=new uC(this.un),this.ln=new cC(this.un)}seed(e){this.un.seed(e)}hn(e){return e===0?this.cn:this.ln}an(){return this.un.an()}reset(){this.un.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qs{constructor(e,t,r,s){this.Pn=e,this.Tn=t,this.In=r,this.dn=s}En(){const e=this.dn.length,t=e===0||this.dn[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.dn,0),t!==e?r.set([0],this.dn.length):++r[r.length-1],new Qs(this.Pn,this.Tn,this.In,r)}An(e,t,r){return{indexId:this.Pn,uid:e,arrayValue:Bd(this.In),directionalValue:Bd(this.dn),orderedDocumentKey:Bd(t),documentKey:r.path.toArray()}}Rn(e,t,r){const s=this.An(e,t,r);return[s.indexId,s.uid,s.arrayValue,s.directionalValue,s.orderedDocumentKey,s.documentKey]}}function qi(n,e){let t=n.Pn-e.Pn;return t!==0?t:(t=Uw(n.In,e.In),t!==0?t:(t=Uw(n.dn,e.dn),t!==0?t:ue.comparator(n.Tn,e.Tn)))}function Uw(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}function Bd(n){return SE()?(function(t){let r="";for(let s=0;s<t.length;s++)r+=String.fromCharCode(t[s]);return r})(n):n}function Bw(n){return typeof n!="string"?n:(function(t){const r=new Uint8Array(t.length);for(let s=0;s<t.length;s++)r[s]=t.charCodeAt(s);return r})(n)}class zw{constructor(e){this.Vn=new Ge(((t,r)=>ct.comparator(t.field,r.field))),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.mn=e.orderBy,this.fn=[];for(const t of e.filters){const r=t;r.isInequality()?this.Vn=this.Vn.add(r):this.fn.push(r)}}get gn(){return this.Vn.size>1}pn(e){if(ve(e.collectionGroup===this.collectionId,49279),this.gn)return!1;const t=hm(e);if(t!==void 0&&!this.yn(t))return!1;const r=qs(e);let s=new Set,a=0,l=0;for(;a<r.length&&this.yn(r[a]);++a)s=s.add(r[a].fieldPath.canonicalString());if(a===r.length)return!0;if(this.Vn.size>0){const d=this.Vn.getIterator().getNext();if(!s.has(d.field.canonicalString())){const f=r[a];if(!this.wn(d,f)||!this.Sn(this.mn[l++],f))return!1}++a}for(;a<r.length;++a){const d=r[a];if(l>=this.mn.length||!this.Sn(this.mn[l++],d))return!1}return!0}bn(){if(this.gn)return null;let e=new Ge(ct.comparator);const t=[];for(const r of this.fn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new Dd(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new Dd(r.field,0))}for(const r of this.mn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new Dd(r.field,r.dir==="asc"?0:1)));return new Xd(Xd.UNKNOWN_ID,this.collectionId,t,bu.empty())}yn(e){for(const t of this.fn)if(this.wn(t,e))return!0;return!1}wn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}Sn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ex(n){var e,t;if(ve(n instanceof De||n instanceof We,20012),n instanceof De){if(n instanceof EI){const s=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map((a=>De.create(n.field,"==",a))))||[];return We.create(s,"or")}return n}const r=n.filters.map((s=>ex(s)));return We.create(r,n.op)}function dC(n){if(n.getFilters().length===0)return[];const e=Rm(ex(n));return ve(tx(e),7391),bm(e)||Am(e)?[e]:e.getFilters()}function bm(n){return n instanceof De}function Am(n){return n instanceof We&&fg(n)}function tx(n){return bm(n)||Am(n)||(function(t){if(t instanceof We&&_m(t)){for(const r of t.getFilters())if(!bm(r)&&!Am(r))return!1;return!0}return!1})(n)}function Rm(n){if(ve(n instanceof De||n instanceof We,34018),n instanceof De)return n;if(n.filters.length===1)return Rm(n.filters[0]);const e=n.filters.map((r=>Rm(r)));let t=We.create(e,n.op);return t=lh(t),tx(t)?t:(ve(t instanceof We,64498),ve(ja(t),40251),ve(t.filters.length>1,57927),t.filters.reduce(((r,s)=>wg(r,s))))}function wg(n,e){let t;return ve(n instanceof De||n instanceof We,38388),ve(e instanceof De||e instanceof We,25473),t=n instanceof De?e instanceof De?(function(s,a){return We.create([s,a],"and")})(n,e):$w(n,e):e instanceof De?$w(e,n):(function(s,a){if(ve(s.filters.length>0&&a.filters.length>0,48005),ja(s)&&ja(a))return vI(s,a.getFilters());const l=_m(s)?s:a,d=_m(s)?a:s,f=l.filters.map((p=>wg(p,d)));return We.create(f,"or")})(n,e),lh(t)}function $w(n,e){if(ja(e))return vI(e,n.getFilters());{const t=e.filters.map((r=>wg(n,r)));return We.create(t,"or")}}function lh(n){if(ve(n instanceof De||n instanceof We,11850),n instanceof De)return n;const e=n.getFilters();if(e.length===1)return lh(e[0]);if(gI(n))return n;const t=e.map((s=>lh(s))),r=[];return t.forEach((s=>{s instanceof De?r.push(s):s instanceof We&&(s.op===n.op?r.push(...s.filters):r.push(s))})),r.length===1?r[0]:We.create(r,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hC{constructor(){this.Dn=new Eg}addToCollectionParentIndex(e,t){return this.Dn.add(t),z.resolve()}getCollectionParents(e,t){return z.resolve(this.Dn.getEntries(t))}addFieldIndex(e,t){return z.resolve()}deleteFieldIndex(e,t){return z.resolve()}deleteAllFieldIndexes(e){return z.resolve()}createTargetIndexes(e,t){return z.resolve()}getDocumentsMatchingTarget(e,t){return z.resolve(null)}getIndexType(e,t){return z.resolve(0)}getFieldIndexes(e,t){return z.resolve([])}getNextCollectionGroupToUpdate(e){return z.resolve(null)}getMinOffset(e,t){return z.resolve(Sn.min())}getMinOffsetFromCollectionGroup(e,t){return z.resolve(Sn.min())}updateCollectionGroup(e,t,r){return z.resolve()}updateIndexEntries(e,t){return z.resolve()}}class Eg{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t]||new Ge($e.comparator),a=!s.has(r);return this.index[t]=s.add(r),a}has(e){const t=e.lastSegment(),r=e.popLast(),s=this.index[t];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Ge($e.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qw="IndexedDbIndexManager",Td=new Uint8Array(0);class fC{constructor(e,t){this.databaseId=t,this.vn=new Eg,this.Cn=new mi((r=>ao(r)),((r,s)=>Wu(r,s))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.vn.has(t)){const r=t.lastSegment(),s=t.popLast();e.addOnCommittedListener((()=>{this.vn.add(t)}));const a={collectionId:r,parent:Yt(s)};return Hw(e).put(a)}return z.resolve()}getCollectionParents(e,t){const r=[],s=IDBKeyRange.bound([t,""],[zE(t),""],!1,!0);return Hw(e).j(s).next((a=>{for(const l of a){if(l.collectionId!==t)break;r.push(Cr(l.parent))}return r}))}addFieldIndex(e,t){const r=su(e),s=(function(d){return{indexId:d.indexId,collectionGroup:d.collectionGroup,fields:d.fields.map((f=>[f.fieldPath.canonicalString(),f.kind]))}})(t);delete s.indexId;const a=r.add(s);if(t.indexState){const l=va(e);return a.next((d=>{l.put(Lw(d,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return a.next()}deleteFieldIndex(e,t){const r=su(e),s=va(e),a=ya(e);return r.delete(t.indexId).next((()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>a.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=su(e),r=ya(e),s=va(e);return t.Y().next((()=>r.Y())).next((()=>s.Y()))}createTargetIndexes(e,t){return z.forEach(this.Fn(t),(r=>this.getIndexType(e,r).next((s=>{if(s===0||s===1){const a=new zw(r).bn();if(a!=null)return this.addFieldIndex(e,a)}}))))}getDocumentsMatchingTarget(e,t){const r=ya(e);let s=!0;const a=new Map;return z.forEach(this.Fn(t),(l=>this.Mn(e,l).next((d=>{s&&(s=!!d),a.set(l,d)})))).next((()=>{if(s){let l=Re();const d=[];return z.forEach(a,((f,p)=>{ne(qw,`Using index ${(function(H){return`id=${H.indexId}|cg=${H.collectionGroup}|f=${H.fields.map((se=>`${se.fieldPath}:${se.kind}`)).join(",")}`})(f)} to execute ${ao(t)}`);const v=(function(H,se){const ce=hm(se);if(ce===void 0)return null;for(const re of rh(H,ce.fieldPath))switch(re.op){case"array-contains-any":return re.value.arrayValue.values||[];case"array-contains":return[re.value]}return null})(p,f),_=(function(H,se){const ce=new Map;for(const re of qs(se))for(const C of rh(H,re.fieldPath))switch(C.op){case"==":case"in":ce.set(re.fieldPath.canonicalString(),C.value);break;case"not-in":case"!=":return ce.set(re.fieldPath.canonicalString(),C.value),Array.from(ce.values())}return null})(p,f),x=(function(H,se){const ce=[];let re=!0;for(const C of qs(se)){const k=C.kind===0?Iw(H,C.fieldPath,H.startAt):xw(H,C.fieldPath,H.startAt);ce.push(k.value),re&&(re=k.inclusive)}return new Ma(ce,re)})(p,f),S=(function(H,se){const ce=[];let re=!0;for(const C of qs(se)){const k=C.kind===0?xw(H,C.fieldPath,H.endAt):Iw(H,C.fieldPath,H.endAt);ce.push(k.value),re&&(re=k.inclusive)}return new Ma(ce,re)})(p,f),N=this.xn(f,p,x),P=this.xn(f,p,S),O=this.On(f,p,_),K=this.Nn(f.indexId,v,N,x.inclusive,P,S.inclusive,O);return z.forEach(K,(Q=>r.H(Q,t.limit).next((H=>{H.forEach((se=>{const ce=ue.fromSegments(se.documentKey);l.has(ce)||(l=l.add(ce),d.push(ce))}))}))))})).next((()=>d))}return z.resolve(null)}))}Fn(e){let t=this.Cn.get(e);return t||(e.filters.length===0?t=[e]:t=dC(We.create(e.filters,"and")).map((r=>Em(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt))),this.Cn.set(e,t),t)}Nn(e,t,r,s,a,l,d){const f=(t!=null?t.length:1)*Math.max(r.length,a.length),p=f/(t!=null?t.length:1),v=[];for(let _=0;_<f;++_){const x=t?this.Bn(t[_/p]):Td,S=this.Ln(e,x,r[_%p],s),N=this.kn(e,x,a[_%p],l),P=d.map((O=>this.Ln(e,x,O,!0)));v.push(...this.createRange(S,N,P))}return v}Ln(e,t,r,s){const a=new Qs(e,ue.empty(),t,r);return s?a:a.En()}kn(e,t,r,s){const a=new Qs(e,ue.empty(),t,r);return s?a.En():a}Mn(e,t){const r=new zw(t),s=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,s).next((a=>{let l=null;for(const d of a)r.pn(d)&&(!l||d.fields.length>l.fields.length)&&(l=d);return l}))}getIndexType(e,t){let r=2;const s=this.Fn(t);return z.forEach(s,(a=>this.Mn(e,a).next((l=>{l?r!==0&&l.fields.length<(function(f){let p=new Ge(ct.comparator),v=!1;for(const _ of f.filters)for(const x of _.getFlattenedFilters())x.field.isKeyField()||(x.op==="array-contains"||x.op==="array-contains-any"?v=!0:p=p.add(x.field));for(const _ of f.orderBy)_.field.isKeyField()||(p=p.add(_.field));return p.size+(v?1:0)})(a)&&(r=1):r=0})))).next((()=>(function(l){return l.limit!==null})(t)&&s.length>1&&r===2?1:r))}qn(e,t){const r=new iu;for(const s of qs(e)){const a=t.data.field(s.fieldPath);if(a==null)return null;const l=r.hn(s.kind);Ks.Ut.bt(a,l)}return r.an()}Bn(e){const t=new iu;return Ks.Ut.bt(e,t.hn(0)),t.an()}Qn(e,t){const r=new iu;return Ks.Ut.bt(Vu(this.databaseId,t),r.hn((function(a){const l=qs(a);return l.length===0?0:l[l.length-1].kind})(e))),r.an()}On(e,t,r){if(r===null)return[];let s=[];s.push(new iu);let a=0;for(const l of qs(e)){const d=r[a++];for(const f of s)if(this.$n(t,l.fieldPath)&&Ou(d))s=this.Un(s,l,d);else{const p=f.hn(l.kind);Ks.Ut.bt(d,p)}}return this.Kn(s)}xn(e,t,r){return this.On(e,t,r.position)}Kn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].an();return t}Un(e,t,r){const s=[...e],a=[];for(const l of r.arrayValue.values||[])for(const d of s){const f=new iu;f.seed(d.an()),Ks.Ut.bt(l,f.hn(t.kind)),a.push(f)}return a}$n(e,t){return!!e.filters.find((r=>r instanceof De&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in")))}getFieldIndexes(e,t){const r=su(e),s=va(e);return(t?r.j(pm,IDBKeyRange.bound(t,t)):r.j()).next((a=>{const l=[];return z.forEach(a,(d=>s.get([d.indexId,this.uid]).next((f=>{l.push((function(v,_){const x=_?new bu(_.sequenceNumber,new Sn(uo(_.readTime),new ue(Cr(_.documentKey)),_.largestBatchId)):bu.empty(),S=v.fields.map((([N,P])=>new Dd(ct.fromServerFormat(N),P)));return new Xd(v.indexId,v.collectionGroup,S,x)})(d,f))})))).next((()=>l))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((t=>t.length===0?null:(t.sort(((r,s)=>{const a=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return a!==0?a:Te(r.collectionGroup,s.collectionGroup)})),t[0].collectionGroup)))}updateCollectionGroup(e,t,r){const s=su(e),a=va(e);return this.Wn(e).next((l=>s.j(pm,IDBKeyRange.bound(t,t)).next((d=>z.forEach(d,(f=>a.put(Lw(f.indexId,this.uid,l,r))))))))}updateIndexEntries(e,t){const r=new Map;return z.forEach(t,((s,a)=>{const l=r.get(s.collectionGroup);return(l?z.resolve(l):this.getFieldIndexes(e,s.collectionGroup)).next((d=>(r.set(s.collectionGroup,d),z.forEach(d,(f=>this.Gn(e,s,f).next((p=>{const v=this.zn(a,f);return p.isEqual(v)?z.resolve():this.jn(e,a,f,p,v)})))))))}))}Jn(e,t,r,s){return ya(e).put(s.An(this.uid,this.Qn(r,t.key),t.key))}Hn(e,t,r,s){return ya(e).delete(s.Rn(this.uid,this.Qn(r,t.key),t.key))}Gn(e,t,r){const s=ya(e);let a=new Ge(qi);return s.X({index:ZE,range:IDBKeyRange.only([r.indexId,this.uid,Bd(this.Qn(r,t))])},((l,d)=>{a=a.add(new Qs(r.indexId,t,Bw(d.arrayValue),Bw(d.directionalValue)))})).next((()=>a))}zn(e,t){let r=new Ge(qi);const s=this.qn(t,e);if(s==null)return r;const a=hm(t);if(a!=null){const l=e.data.field(a.fieldPath);if(Ou(l))for(const d of l.arrayValue.values||[])r=r.add(new Qs(t.indexId,e.key,this.Bn(d),s))}else r=r.add(new Qs(t.indexId,e.key,Td,s));return r}jn(e,t,r,s,a){ne(qw,"Updating index entries for document '%s'",t.key);const l=[];return(function(f,p,v,_,x){const S=f.getIterator(),N=p.getIterator();let P=ma(S),O=ma(N);for(;P||O;){let K=!1,Q=!1;if(P&&O){const H=v(P,O);H<0?Q=!0:H>0&&(K=!0)}else P!=null?Q=!0:K=!0;K?(_(O),O=ma(N)):Q?(x(P),P=ma(S)):(P=ma(S),O=ma(N))}})(s,a,qi,(d=>{l.push(this.Jn(e,t,r,d))}),(d=>{l.push(this.Hn(e,t,r,d))})),z.waitFor(l)}Wn(e){let t=1;return va(e).X({index:JE,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((r,s,a)=>{a.done(),t=s.sequenceNumber+1})).next((()=>t))}createRange(e,t,r){r=r.sort(((l,d)=>qi(l,d))).filter(((l,d,f)=>!d||qi(l,f[d-1])!==0));const s=[];s.push(e);for(const l of r){const d=qi(l,e),f=qi(l,t);if(d===0)s[0]=e.En();else if(d>0&&f<0)s.push(l),s.push(l.En());else if(f>0)break}s.push(t);const a=[];for(let l=0;l<s.length;l+=2){if(this.Yn(s[l],s[l+1]))return[];const d=s[l].Rn(this.uid,Td,ue.empty()),f=s[l+1].Rn(this.uid,Td,ue.empty());a.push(IDBKeyRange.bound(d,f))}return a}Yn(e,t){return qi(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(Ww)}getMinOffset(e,t){return z.mapArray(this.Fn(t),(r=>this.Mn(e,r).next((s=>s||me(44426))))).next(Ww)}}function Hw(n){return Rt(n,Pu)}function ya(n){return Rt(n,yu)}function su(n){return Rt(n,ag)}function va(n){return Rt(n,gu)}function Ww(n){ve(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const s=n[r].indexState.offset;ig(s,e)<0&&(e=s),t<s.largestBatchId&&(t=s.largestBatchId)}return new Sn(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gw={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},nx=41943040;class Gt{static withCacheSize(e){return new Gt(e,Gt.DEFAULT_COLLECTION_PERCENTILE,Gt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rx(n,e,t){const r=n.store(or),s=n.store(Pa),a=[],l=IDBKeyRange.only(t.batchId);let d=0;const f=r.X({range:l},((v,_,x)=>(d++,x.delete())));a.push(f.next((()=>{ve(d===1,47070,{batchId:t.batchId})})));const p=[];for(const v of t.mutations){const _=QE(e,v.key.path,t.batchId);a.push(s.delete(_)),p.push(v.key)}return z.waitFor(a).next((()=>p))}function uh(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw me(14731);e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Gt.DEFAULT_COLLECTION_PERCENTILE=10,Gt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Gt.DEFAULT=new Gt(nx,Gt.DEFAULT_COLLECTION_PERCENTILE,Gt.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Gt.DISABLED=new Gt(-1,0,0);class zh{constructor(e,t,r,s){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=s,this.Zn={}}static yt(e,t,r,s){ve(e.uid!=="",64387);const a=e.isAuthenticated()?e.uid:"";return new zh(a,t,r,s)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Hi(e).X({index:Ys,range:r},((s,a,l)=>{t=!1,l.done()})).next((()=>t))}addMutationBatch(e,t,r,s){const a=Ta(e),l=Hi(e);return l.add({}).next((d=>{ve(typeof d=="number",49019);const f=new mg(d,t,r,s),p=(function(S,N,P){const O=P.baseMutations.map((Q=>oh(S.gt,Q))),K=P.mutations.map((Q=>oh(S.gt,Q)));return{userId:N,batchId:P.batchId,localWriteTimeMs:P.localWriteTime.toMillis(),baseMutations:O,mutations:K}})(this.serializer,this.userId,f),v=[];let _=new Ge(((x,S)=>Te(x.canonicalString(),S.canonicalString())));for(const x of s){const S=QE(this.userId,x.key.path,d);_=_.add(x.key.path.popLast()),v.push(l.put(p)),v.push(a.put(S,$A))}return _.forEach((x=>{v.push(this.indexManager.addToCollectionParentIndex(e,x))})),e.addOnCommittedListener((()=>{this.Zn[d]=f.keys()})),z.waitFor(v).next((()=>f))}))}lookupMutationBatch(e,t){return Hi(e).get(t).next((r=>r?(ve(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:t}),Gs(this.serializer,r)):null))}Xn(e,t){return this.Zn[t]?z.resolve(this.Zn[t]):this.lookupMutationBatch(e,t).next((r=>{if(r){const s=r.keys();return this.Zn[t]=s,s}return null}))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=IDBKeyRange.lowerBound([this.userId,r]);let a=null;return Hi(e).X({index:Ys,range:s},((l,d,f)=>{d.userId===this.userId&&(ve(d.batchId>=r,47524,{er:r}),a=Gs(this.serializer,d)),f.done()})).next((()=>a))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=Zs;return Hi(e).X({index:Ys,range:t,reverse:!0},((s,a,l)=>{r=a.batchId,l.done()})).next((()=>r))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Zs],[this.userId,Number.POSITIVE_INFINITY]);return Hi(e).j(Ys,t).next((r=>r.map((s=>Gs(this.serializer,s)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=Vd(this.userId,t.path),s=IDBKeyRange.lowerBound(r),a=[];return Ta(e).X({range:s},((l,d,f)=>{const[p,v,_]=l,x=Cr(v);if(p===this.userId&&t.path.isEqual(x))return Hi(e).get(_).next((S=>{if(!S)throw me(61480,{tr:l,batchId:_});ve(S.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:S.userId,batchId:_}),a.push(Gs(this.serializer,S))}));f.done()})).next((()=>a))}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ge(Te);const s=[];return t.forEach((a=>{const l=Vd(this.userId,a.path),d=IDBKeyRange.lowerBound(l),f=Ta(e).X({range:d},((p,v,_)=>{const[x,S,N]=p,P=Cr(S);x===this.userId&&a.path.isEqual(P)?r=r.add(N):_.done()}));s.push(f)})),z.waitFor(s).next((()=>this.nr(e,r)))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1,a=Vd(this.userId,r),l=IDBKeyRange.lowerBound(a);let d=new Ge(Te);return Ta(e).X({range:l},((f,p,v)=>{const[_,x,S]=f,N=Cr(x);_===this.userId&&r.isPrefixOf(N)?N.length===s&&(d=d.add(S)):v.done()})).next((()=>this.nr(e,d)))}nr(e,t){const r=[],s=[];return t.forEach((a=>{s.push(Hi(e).get(a).next((l=>{if(l===null)throw me(35274,{batchId:a});ve(l.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:l.userId,batchId:a}),r.push(Gs(this.serializer,l))})))})),z.waitFor(s).next((()=>r))}removeMutationBatch(e,t){return rx(e.ce,this.userId,t).next((r=>(e.addOnCommittedListener((()=>{this.rr(t.batchId)})),z.forEach(r,(s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))))}rr(e){delete this.Zn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return z.resolve();const r=IDBKeyRange.lowerBound((function(l){return[l]})(this.userId)),s=[];return Ta(e).X({range:r},((a,l,d)=>{if(a[0]===this.userId){const f=Cr(a[1]);s.push(f)}else d.done()})).next((()=>{ve(s.length===0,56720,{ir:s.map((a=>a.canonicalString()))})}))}))}containsKey(e,t){return ix(e,this.userId,t)}sr(e){return sx(e).get(this.userId).next((t=>t||{userId:this.userId,lastAcknowledgedBatchId:Zs,lastStreamToken:""}))}}function ix(n,e,t){const r=Vd(e,t.path),s=r[1],a=IDBKeyRange.lowerBound(r);let l=!1;return Ta(n).X({range:a,Z:!0},((d,f,p)=>{const[v,_,x]=d;v===e&&_===s&&(l=!0),p.done()})).next((()=>l))}function Hi(n){return Rt(n,or)}function Ta(n){return Rt(n,Pa)}function sx(n){return Rt(n,Ru)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class co{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new co(0)}static ur(){return new co(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pC{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.cr(e).next((t=>{const r=new co(t.highestTargetId);return t.highestTargetId=r.next(),this.lr(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.cr(e).next((t=>we.fromTimestamp(new He(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.cr(e).next((t=>t.highestListenSequenceNumber))}setTargetsMetadata(e,t,r){return this.cr(e).next((s=>(s.highestListenSequenceNumber=t,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),t>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=t),this.lr(e,s))))}addTargetData(e,t){return this.hr(e,t).next((()=>this.cr(e).next((r=>(r.targetCount+=1,this.Pr(t,r),this.lr(e,r))))))}updateTargetData(e,t){return this.hr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>_a(e).delete(t.targetId))).next((()=>this.cr(e))).next((r=>(ve(r.targetCount>0,8065),r.targetCount-=1,this.lr(e,r))))}removeTargets(e,t,r){let s=0;const a=[];return _a(e).X(((l,d)=>{const f=du(d);f.sequenceNumber<=t&&r.get(f.targetId)===null&&(s++,a.push(this.removeTargetData(e,f)))})).next((()=>z.waitFor(a))).next((()=>s))}forEachTarget(e,t){return _a(e).X(((r,s)=>{const a=du(s);t(a)}))}cr(e){return Kw(e).get(eh).next((t=>(ve(t!==null,2888),t)))}lr(e,t){return Kw(e).put(eh,t)}hr(e,t){return _a(e).put(JI(this.serializer,t))}Pr(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.cr(e).next((t=>t.targetCount))}getTargetData(e,t){const r=ao(t),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let a=null;return _a(e).X({range:s,index:XE},((l,d,f)=>{const p=du(d);Wu(t,p.target)&&(a=p,f.done())})).next((()=>a))}addMatchingKeys(e,t,r){const s=[],a=Qi(e);return t.forEach((l=>{const d=Yt(l.path);s.push(a.put({targetId:r,path:d})),s.push(this.referenceDelegate.addReference(e,r,l))})),z.waitFor(s)}removeMatchingKeys(e,t,r){const s=Qi(e);return z.forEach(t,(a=>{const l=Yt(a.path);return z.waitFor([s.delete([r,l]),this.referenceDelegate.removeReference(e,r,a)])}))}removeMatchingKeysForTargetId(e,t){const r=Qi(e),s=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),s=Qi(e);let a=Re();return s.X({range:r,Z:!0},((l,d,f)=>{const p=Cr(l[1]),v=new ue(p);a=a.add(v)})).next((()=>a))}containsKey(e,t){const r=Yt(t.path),s=IDBKeyRange.bound([r],[zE(r)],!1,!0);let a=0;return Qi(e).X({index:og,Z:!0,range:s},(([l,d],f,p)=>{l!==0&&(a++,p.done())})).next((()=>a>0))}Et(e,t){return _a(e).get(t).next((r=>r?du(r):null))}}function _a(n){return Rt(n,Na)}function Kw(n){return Rt(n,eo)}function Qi(n){return Rt(n,Da)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qw="LruGarbageCollector",mC=1048576;function Yw([n,e],[t,r]){const s=Te(n,t);return s===0?Te(e,r):s}class gC{constructor(e){this.Tr=e,this.buffer=new Ge(Yw),this.Ir=0}dr(){return++this.Ir}Er(e){const t=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();Yw(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class ox{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){ne(Qw,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){hs(t)?ne(Qw,"Ignoring IndexedDB error during garbage collection: ",t):await _o(t)}await this.Rr(3e5)}))}}class yC{constructor(e,t){this.Vr=e,this.params=t}calculateTargetCount(e,t){return this.Vr.mr(e).next((r=>Math.floor(t/100*r)))}nthSequenceNumber(e,t){if(t===0)return z.resolve(jn.ue);const r=new gC(t);return this.Vr.forEachTarget(e,(s=>r.Er(s.sequenceNumber))).next((()=>this.Vr.gr(e,(s=>r.Er(s))))).next((()=>r.maxValue))}removeTargets(e,t,r){return this.Vr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.Vr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(ne("LruGarbageCollector","Garbage collection skipped; disabled"),z.resolve(Gw)):this.getCacheSize(e).next((r=>r<this.params.cacheSizeCollectionThreshold?(ne("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Gw):this.pr(e,t)))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,t){let r,s,a,l,d,f,p;const v=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((_=>(_>this.params.maximumSequenceNumbersToCollect?(ne("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${_}`),s=this.params.maximumSequenceNumbersToCollect):s=_,l=Date.now(),this.nthSequenceNumber(e,s)))).next((_=>(r=_,d=Date.now(),this.removeTargets(e,r,t)))).next((_=>(a=_,f=Date.now(),this.removeOrphanedDocuments(e,r)))).next((_=>(p=Date.now(),wa()<=Ne.DEBUG&&ne("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${l-v}ms
	Determined least recently used ${s} in `+(d-l)+`ms
	Removed ${a} targets in `+(f-d)+`ms
	Removed ${_} documents in `+(p-f)+`ms
Total Duration: ${p-v}ms`),z.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:a,documentsRemoved:_}))))}}function ax(n,e){return new yC(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vC{constructor(e,t){this.db=e,this.garbageCollector=ax(this,t)}mr(e){const t=this.yr(e);return this.db.getTargetCache().getTargetCount(e).next((r=>t.next((s=>r+s))))}yr(e){let t=0;return this.gr(e,(r=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}gr(e,t){return this.wr(e,((r,s)=>t(s)))}addReference(e,t,r){return Sd(e,r)}removeReference(e,t,r){return Sd(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Sd(e,t)}Sr(e,t){return(function(s,a){let l=!1;return sx(s).ee((d=>ix(s,d,a).next((f=>(f&&(l=!0),z.resolve(!f)))))).next((()=>l))})(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let a=0;return this.wr(e,((l,d)=>{if(d<=t){const f=this.Sr(e,l).next((p=>{if(!p)return a++,r.getEntry(e,l).next((()=>(r.removeEntry(l,we.min()),Qi(e).delete((function(_){return[0,Yt(_.path)]})(l)))))}));s.push(f)}})).next((()=>z.waitFor(s))).next((()=>r.apply(e))).next((()=>a))}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Sd(e,t)}wr(e,t){const r=Qi(e);let s,a=jn.ue;return r.X({index:og},(([l,d],{path:f,sequenceNumber:p})=>{l===0?(a!==jn.ue&&t(new ue(Cr(s)),a),a=p,s=f):a=jn.ue})).next((()=>{a!==jn.ue&&t(new ue(Cr(s)),a)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Sd(n,e){return Qi(n).put((function(r,s){return{targetId:0,path:Yt(r.path),sequenceNumber:s}})(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lx{constructor(){this.changes=new mi((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,ht.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?z.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _C{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return zs(e).put(r)}removeEntry(e,t,r){return zs(e).delete((function(a,l){const d=a.path.toArray();return[d.slice(0,d.length-2),d[d.length-2],ah(l),d[d.length-1]]})(t,r))}updateMetadata(e,t){return this.getMetadata(e).next((r=>(r.byteSize+=t,this.br(e,r))))}getEntry(e,t){let r=ht.newInvalidDocument(t);return zs(e).X({index:Od,range:IDBKeyRange.only(ou(t))},((s,a)=>{r=this.Dr(t,a)})).next((()=>r))}vr(e,t){let r={size:0,document:ht.newInvalidDocument(t)};return zs(e).X({index:Od,range:IDBKeyRange.only(ou(t))},((s,a)=>{r={document:this.Dr(t,a),size:uh(a)}})).next((()=>r))}getEntries(e,t){let r=xn();return this.Cr(e,t,((s,a)=>{const l=this.Dr(s,a);r=r.insert(s,l)})).next((()=>r))}Fr(e,t){let r=xn(),s=new at(ue.comparator);return this.Cr(e,t,((a,l)=>{const d=this.Dr(a,l);r=r.insert(a,d),s=s.insert(a,uh(l))})).next((()=>({documents:r,Mr:s})))}Cr(e,t,r){if(t.isEmpty())return z.resolve();let s=new Ge(Zw);t.forEach((f=>s=s.add(f)));const a=IDBKeyRange.bound(ou(s.first()),ou(s.last())),l=s.getIterator();let d=l.getNext();return zs(e).X({index:Od,range:a},((f,p,v)=>{const _=ue.fromSegments([...p.prefixPath,p.collectionGroup,p.documentId]);for(;d&&Zw(d,_)<0;)r(d,null),d=l.getNext();d&&d.isEqual(_)&&(r(d,p),d=l.hasNext()?l.getNext():null),d?v.G(ou(d)):v.done()})).next((()=>{for(;d;)r(d,null),d=l.hasNext()?l.getNext():null}))}getDocumentsMatchingQuery(e,t,r,s,a){const l=t.path,d=[l.popLast().toArray(),l.lastSegment(),ah(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],f=[l.popLast().toArray(),l.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return zs(e).j(IDBKeyRange.bound(d,f,!0)).next((p=>{a==null||a.incrementDocumentReadCount(p.length);let v=xn();for(const _ of p){const x=this.Dr(ue.fromSegments(_.prefixPath.concat(_.collectionGroup,_.documentId)),_);x.isFoundDocument()&&(Ku(t,x)||s.has(x.key))&&(v=v.insert(x.key,x))}return v}))}getAllFromCollectionGroup(e,t,r,s){let a=xn();const l=Jw(t,r),d=Jw(t,Sn.max());return zs(e).X({index:YE,range:IDBKeyRange.bound(l,d,!0)},((f,p,v)=>{const _=this.Dr(ue.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);a=a.insert(_.key,_),a.size===s&&v.done()})).next((()=>a))}newChangeBuffer(e){return new wC(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((t=>t.byteSize))}getMetadata(e){return Xw(e).get(fm).next((t=>(ve(!!t,20021),t)))}br(e,t){return Xw(e).put(fm,t)}Dr(e,t){if(t){const r=iC(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(we.min())))return r}return ht.newInvalidDocument(e)}}function ux(n){return new _C(n)}class wC extends lx{constructor(e,t){super(),this.Or=e,this.trackRemovals=t,this.Nr=new mi((r=>r.toString()),((r,s)=>r.isEqual(s)))}applyChanges(e){const t=[];let r=0,s=new Ge(((a,l)=>Te(a.canonicalString(),l.canonicalString())));return this.changes.forEach(((a,l)=>{const d=this.Nr.get(a);if(t.push(this.Or.removeEntry(e,a,d.readTime)),l.isValidDocument()){const f=Vw(this.Or.serializer,l);s=s.add(a.path.popLast());const p=uh(f);r+=p-d.size,t.push(this.Or.addEntry(e,a,f))}else if(r-=d.size,this.trackRemovals){const f=Vw(this.Or.serializer,l.convertToNoDocument(we.min()));t.push(this.Or.addEntry(e,a,f))}})),s.forEach((a=>{t.push(this.Or.indexManager.addToCollectionParentIndex(e,a))})),t.push(this.Or.updateMetadata(e,r)),z.waitFor(t)}getFromCache(e,t){return this.Or.vr(e,t).next((r=>(this.Nr.set(t,{size:r.size,readTime:r.document.readTime}),r.document)))}getAllFromCache(e,t){return this.Or.Fr(e,t).next((({documents:r,Mr:s})=>(s.forEach(((a,l)=>{this.Nr.set(a,{size:l,readTime:r.get(a).readTime})})),r)))}}function Xw(n){return Rt(n,Cu)}function zs(n){return Rt(n,Zd)}function ou(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function Jw(n,e){const t=e.documentKey.path.toArray();return[n,ah(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function Zw(n,e){const t=n.path.toArray(),r=e.path.toArray();let s=0;for(let a=0;a<t.length-2&&a<r.length-2;++a)if(s=Te(t[a],r[a]),s)return s;return s=Te(t.length,r.length),s||(s=Te(t[t.length-2],r[r.length-2]),s||Te(t[t.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EC{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cx{constructor(e,t,r,s){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next((s=>(r=s,this.remoteDocumentCache.getEntry(e,t)))).next((s=>(r!==null&&Eu(r.mutation,s,fn.empty(),He.now()),s)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.getLocalViewOfDocuments(e,r,Re()).next((()=>r))))}getLocalViewOfDocuments(e,t,r=Re()){const s=Pr();return this.populateOverlays(e,s,t).next((()=>this.computeViews(e,t,s,r).next((a=>{let l=uu();return a.forEach(((d,f)=>{l=l.insert(d,f.overlayedDocument)})),l}))))}getOverlayedDocuments(e,t){const r=Pr();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,Re())))}populateOverlays(e,t,r){const s=[];return r.forEach((a=>{t.has(a)||s.push(a)})),this.documentOverlayCache.getOverlays(e,s).next((a=>{a.forEach(((l,d)=>{t.set(l,d)}))}))}computeViews(e,t,r,s){let a=xn();const l=wu(),d=(function(){return wu()})();return t.forEach(((f,p)=>{const v=r.get(p.key);s.has(p.key)&&(v===void 0||v.mutation instanceof gi)?a=a.insert(p.key,p):v!==void 0?(l.set(p.key,v.mutation.getFieldMask()),Eu(v.mutation,p,v.mutation.getFieldMask(),He.now())):l.set(p.key,fn.empty())})),this.recalculateAndSaveOverlays(e,a).next((f=>(f.forEach(((p,v)=>l.set(p,v))),t.forEach(((p,v)=>{var _;return d.set(p,new EC(v,(_=l.get(p))!==null&&_!==void 0?_:null))})),d)))}recalculateAndSaveOverlays(e,t){const r=wu();let s=new at(((l,d)=>l-d)),a=Re();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((l=>{for(const d of l)d.keys().forEach((f=>{const p=t.get(f);if(p===null)return;let v=r.get(f)||fn.empty();v=d.applyToLocalView(p,v),r.set(f,v);const _=(s.get(d.batchId)||Re()).add(f);s=s.insert(d.batchId,_)}))})).next((()=>{const l=[],d=s.getReverseIterator();for(;d.hasNext();){const f=d.getNext(),p=f.key,v=f.value,_=bI();v.forEach((x=>{if(!a.has(x)){const S=VI(t.get(x),r.get(x));S!==null&&_.set(x,S),a=a.add(x)}})),l.push(this.documentOverlayCache.saveOverlays(e,p,_))}return z.waitFor(l)})).next((()=>r))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((r=>this.recalculateAndSaveOverlays(e,r)))}getDocumentsMatchingQuery(e,t,r,s){return(function(l){return ue.isDocumentKey(l.path)&&l.collectionGroup===null&&l.filters.length===0})(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):II(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,s):this.getDocumentsMatchingCollectionQuery(e,t,r,s)}getNextDocuments(e,t,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,s).next((a=>{const l=s-a.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,s-a.size):z.resolve(Pr());let d=ku,f=a;return l.next((p=>z.forEach(p,((v,_)=>(d<_.largestBatchId&&(d=_.largestBatchId),a.get(v)?z.resolve():this.remoteDocumentCache.getEntry(e,v).next((x=>{f=f.insert(v,x)}))))).next((()=>this.populateOverlays(e,p,a))).next((()=>this.computeViews(e,f,p,Re()))).next((v=>({batchId:d,changes:kI(v)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ue(t)).next((r=>{let s=uu();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s}))}getDocumentsMatchingCollectionGroupQuery(e,t,r,s){const a=t.collectionGroup;let l=uu();return this.indexManager.getCollectionParents(e,a).next((d=>z.forEach(d,(f=>{const p=(function(_,x){return new Za(x,null,_.explicitOrderBy.slice(),_.filters.slice(),_.limit,_.limitType,_.startAt,_.endAt)})(t,f.child(a));return this.getDocumentsMatchingCollectionQuery(e,p,r,s).next((v=>{v.forEach(((_,x)=>{l=l.insert(_,x)}))}))})).next((()=>l))))}getDocumentsMatchingCollectionQuery(e,t,r,s){let a;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next((l=>(a=l,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,a,s)))).next((l=>{a.forEach(((f,p)=>{const v=p.getKey();l.get(v)===null&&(l=l.insert(v,ht.newInvalidDocument(v)))}));let d=uu();return l.forEach(((f,p)=>{const v=a.get(f);v!==void 0&&Eu(v.mutation,p,fn.empty(),He.now()),Ku(t,p)&&(d=d.insert(f,p))})),d}))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IC{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,t){return z.resolve(this.Br.get(t))}saveBundleMetadata(e,t){return this.Br.set(t.id,(function(s){return{id:s.id,version:s.version,createTime:rn(s.createTime)}})(t)),z.resolve()}getNamedQuery(e,t){return z.resolve(this.Lr.get(t))}saveNamedQuery(e,t){return this.Lr.set(t.name,(function(s){return{name:s.name,query:ZI(s.bundledQuery),readTime:rn(s.readTime)}})(t)),z.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xC{constructor(){this.overlays=new at(ue.comparator),this.kr=new Map}getOverlay(e,t){return z.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Pr();return z.forEach(t,(s=>this.getOverlay(e,s).next((a=>{a!==null&&r.set(s,a)})))).next((()=>r))}saveOverlays(e,t,r){return r.forEach(((s,a)=>{this.wt(e,t,a)})),z.resolve()}removeOverlaysForBatchId(e,t,r){const s=this.kr.get(r);return s!==void 0&&(s.forEach((a=>this.overlays=this.overlays.remove(a))),this.kr.delete(r)),z.resolve()}getOverlaysForCollection(e,t,r){const s=Pr(),a=t.length+1,l=new ue(t.child("")),d=this.overlays.getIteratorFrom(l);for(;d.hasNext();){const f=d.getNext().value,p=f.getKey();if(!t.isPrefixOf(p.path))break;p.path.length===a&&f.largestBatchId>r&&s.set(f.getKey(),f)}return z.resolve(s)}getOverlaysForCollectionGroup(e,t,r,s){let a=new at(((p,v)=>p-v));const l=this.overlays.getIterator();for(;l.hasNext();){const p=l.getNext().value;if(p.getKey().getCollectionGroup()===t&&p.largestBatchId>r){let v=a.get(p.largestBatchId);v===null&&(v=Pr(),a=a.insert(p.largestBatchId,v)),v.set(p.getKey(),p)}}const d=Pr(),f=a.getIterator();for(;f.hasNext()&&(f.getNext().value.forEach(((p,v)=>d.set(p,v))),!(d.size()>=s)););return z.resolve(d)}wt(e,t,r){const s=this.overlays.get(r.key);if(s!==null){const l=this.kr.get(s.largestBatchId).delete(r.key);this.kr.set(s.largestBatchId,l)}this.overlays=this.overlays.insert(r.key,new yg(t,r));let a=this.kr.get(t);a===void 0&&(a=Re(),this.kr.set(t,a)),this.kr.set(t,a.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TC{constructor(){this.sessionToken=It.EMPTY_BYTE_STRING}getSessionToken(e){return z.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,z.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ig{constructor(){this.qr=new Ge(Ot.Qr),this.$r=new Ge(Ot.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,t){const r=new Ot(e,t);this.qr=this.qr.add(r),this.$r=this.$r.add(r)}Kr(e,t){e.forEach((r=>this.addReference(r,t)))}removeReference(e,t){this.Wr(new Ot(e,t))}Gr(e,t){e.forEach((r=>this.removeReference(r,t)))}zr(e){const t=new ue(new $e([])),r=new Ot(t,e),s=new Ot(t,e+1),a=[];return this.$r.forEachInRange([r,s],(l=>{this.Wr(l),a.push(l.key)})),a}jr(){this.qr.forEach((e=>this.Wr(e)))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const t=new ue(new $e([])),r=new Ot(t,e),s=new Ot(t,e+1);let a=Re();return this.$r.forEachInRange([r,s],(l=>{a=a.add(l.key)})),a}containsKey(e){const t=new Ot(e,0),r=this.qr.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class Ot{constructor(e,t){this.key=e,this.Hr=t}static Qr(e,t){return ue.comparator(e.key,t.key)||Te(e.Hr,t.Hr)}static Ur(e,t){return Te(e.Hr,t.Hr)||ue.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SC{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.er=1,this.Yr=new Ge(Ot.Qr)}checkEmpty(e){return z.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,s){const a=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const l=new mg(a,t,r,s);this.mutationQueue.push(l);for(const d of s)this.Yr=this.Yr.add(new Ot(d.key,a)),this.indexManager.addToCollectionParentIndex(e,d.key.path.popLast());return z.resolve(l)}lookupMutationBatch(e,t){return z.resolve(this.Zr(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,s=this.Xr(r),a=s<0?0:s;return z.resolve(this.mutationQueue.length>a?this.mutationQueue[a]:null)}getHighestUnacknowledgedBatchId(){return z.resolve(this.mutationQueue.length===0?Zs:this.er-1)}getAllMutationBatches(e){return z.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new Ot(t,0),s=new Ot(t,Number.POSITIVE_INFINITY),a=[];return this.Yr.forEachInRange([r,s],(l=>{const d=this.Zr(l.Hr);a.push(d)})),z.resolve(a)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new Ge(Te);return t.forEach((s=>{const a=new Ot(s,0),l=new Ot(s,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([a,l],(d=>{r=r.add(d.Hr)}))})),z.resolve(this.ei(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,s=r.length+1;let a=r;ue.isDocumentKey(a)||(a=a.child(""));const l=new Ot(new ue(a),0);let d=new Ge(Te);return this.Yr.forEachWhile((f=>{const p=f.key.path;return!!r.isPrefixOf(p)&&(p.length===s&&(d=d.add(f.Hr)),!0)}),l),z.resolve(this.ei(d))}ei(e){const t=[];return e.forEach((r=>{const s=this.Zr(r);s!==null&&t.push(s)})),t}removeMutationBatch(e,t){ve(this.ti(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Yr;return z.forEach(t.mutations,(s=>{const a=new Ot(s.key,t.batchId);return r=r.delete(a),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)})).next((()=>{this.Yr=r}))}rr(e){}containsKey(e,t){const r=new Ot(t,0),s=this.Yr.firstAfterOrEqual(r);return z.resolve(t.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,z.resolve()}ti(e,t){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const t=this.Xr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kC{constructor(e){this.ni=e,this.docs=(function(){return new at(ue.comparator)})(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,s=this.docs.get(r),a=s?s.size:0,l=this.ni(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:l}),this.size+=l-a,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return z.resolve(r?r.document.mutableCopy():ht.newInvalidDocument(t))}getEntries(e,t){let r=xn();return t.forEach((s=>{const a=this.docs.get(s);r=r.insert(s,a?a.document.mutableCopy():ht.newInvalidDocument(s))})),z.resolve(r)}getDocumentsMatchingQuery(e,t,r,s){let a=xn();const l=t.path,d=new ue(l.child("__id-9223372036854775808__")),f=this.docs.getIteratorFrom(d);for(;f.hasNext();){const{key:p,value:{document:v}}=f.getNext();if(!l.isPrefixOf(p.path))break;p.path.length>l.length+1||ig(HE(v),r)<=0||(s.has(v.key)||Ku(t,v))&&(a=a.insert(v.key,v.mutableCopy()))}return z.resolve(a)}getAllFromCollectionGroup(e,t,r,s){me(9500)}ri(e,t){return z.forEach(this.docs,(r=>t(r)))}newChangeBuffer(e){return new bC(this)}getSize(e){return z.resolve(this.size)}}class bC extends lx{constructor(e){super(),this.Or=e}applyChanges(e){const t=[];return this.changes.forEach(((r,s)=>{s.isValidDocument()?t.push(this.Or.addEntry(e,s)):this.Or.removeEntry(r)})),z.waitFor(t)}getFromCache(e,t){return this.Or.getEntry(e,t)}getAllFromCache(e,t){return this.Or.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AC{constructor(e){this.persistence=e,this.ii=new mi((t=>ao(t)),Wu),this.lastRemoteSnapshotVersion=we.min(),this.highestTargetId=0,this.si=0,this.oi=new Ig,this.targetCount=0,this._i=co.ar()}forEachTarget(e,t){return this.ii.forEach(((r,s)=>t(s))),z.resolve()}getLastRemoteSnapshotVersion(e){return z.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return z.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),z.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.si&&(this.si=t),z.resolve()}hr(e){this.ii.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this._i=new co(t),this.highestTargetId=t),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,t){return this.hr(t),this.targetCount+=1,z.resolve()}updateTargetData(e,t){return this.hr(t),z.resolve()}removeTargetData(e,t){return this.ii.delete(t.target),this.oi.zr(t.targetId),this.targetCount-=1,z.resolve()}removeTargets(e,t,r){let s=0;const a=[];return this.ii.forEach(((l,d)=>{d.sequenceNumber<=t&&r.get(d.targetId)===null&&(this.ii.delete(l),a.push(this.removeMatchingKeysForTargetId(e,d.targetId)),s++)})),z.waitFor(a).next((()=>s))}getTargetCount(e){return z.resolve(this.targetCount)}getTargetData(e,t){const r=this.ii.get(t)||null;return z.resolve(r)}addMatchingKeys(e,t,r){return this.oi.Kr(t,r),z.resolve()}removeMatchingKeys(e,t,r){this.oi.Gr(t,r);const s=this.persistence.referenceDelegate,a=[];return s&&t.forEach((l=>{a.push(s.markPotentiallyOrphaned(e,l))})),z.waitFor(a)}removeMatchingKeysForTargetId(e,t){return this.oi.zr(t),z.resolve()}getMatchingKeysForTargetId(e,t){const r=this.oi.Jr(t);return z.resolve(r)}containsKey(e,t){return z.resolve(this.oi.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xg{constructor(e,t){this.ai={},this.overlays={},this.ui=new jn(0),this.ci=!1,this.ci=!0,this.li=new TC,this.referenceDelegate=e(this),this.hi=new AC(this),this.indexManager=new hC,this.remoteDocumentCache=(function(s){return new kC(s)})((r=>this.referenceDelegate.Pi(r))),this.serializer=new XI(t),this.Ti=new IC(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new xC,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ai[e.toKey()];return r||(r=new SC(t,this.referenceDelegate),this.ai[e.toKey()]=r),r}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,t,r){ne("MemoryPersistence","Starting transaction:",e);const s=new RC(this.ui.next());return this.referenceDelegate.Ii(),r(s).next((a=>this.referenceDelegate.di(s).next((()=>a)))).toPromise().then((a=>(s.raiseOnCommittedEvent(),a)))}Ei(e,t){return z.or(Object.values(this.ai).map((r=>()=>r.containsKey(e,t))))}}class RC extends GE{constructor(e){super(),this.currentSequenceNumber=e}}class $h{constructor(e){this.persistence=e,this.Ai=new Ig,this.Ri=null}static Vi(e){return new $h(e)}get mi(){if(this.Ri)return this.Ri;throw me(60996)}addReference(e,t,r){return this.Ai.addReference(r,t),this.mi.delete(r.toString()),z.resolve()}removeReference(e,t,r){return this.Ai.removeReference(r,t),this.mi.add(r.toString()),z.resolve()}markPotentiallyOrphaned(e,t){return this.mi.add(t.toString()),z.resolve()}removeTarget(e,t){this.Ai.zr(t.targetId).forEach((s=>this.mi.add(s.toString())));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next((s=>{s.forEach((a=>this.mi.add(a.toString())))})).next((()=>r.removeTargetData(e,t)))}Ii(){this.Ri=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return z.forEach(this.mi,(r=>{const s=ue.fromPath(r);return this.fi(e,s).next((a=>{a||t.removeEntry(s,we.min())}))})).next((()=>(this.Ri=null,t.apply(e))))}updateLimboDocument(e,t){return this.fi(e,t).next((r=>{r?this.mi.delete(t.toString()):this.mi.add(t.toString())}))}Pi(e){return 0}fi(e,t){return z.or([()=>z.resolve(this.Ai.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ei(e,t)])}}class ch{constructor(e,t){this.persistence=e,this.gi=new mi((r=>Yt(r.path)),((r,s)=>r.isEqual(s))),this.garbageCollector=ax(this,t)}static Vi(e,t){return new ch(e,t)}Ii(){}di(e){return z.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}mr(e){const t=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next((r=>t.next((s=>r+s))))}yr(e){let t=0;return this.gr(e,(r=>{t++})).next((()=>t))}gr(e,t){return z.forEach(this.gi,((r,s)=>this.Sr(e,r,s).next((a=>a?z.resolve():t(s)))))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const s=this.persistence.getRemoteDocumentCache(),a=s.newChangeBuffer();return s.ri(e,(l=>this.Sr(e,l,t).next((d=>{d||(r++,a.removeEntry(l,we.min()))})))).next((()=>a.apply(e))).next((()=>r))}markPotentiallyOrphaned(e,t){return this.gi.set(t,e.currentSequenceNumber),z.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.gi.set(r,e.currentSequenceNumber),z.resolve()}removeReference(e,t,r){return this.gi.set(r,e.currentSequenceNumber),z.resolve()}updateLimboDocument(e,t){return this.gi.set(t,e.currentSequenceNumber),z.resolve()}Pi(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Md(e.data.value)),t}Sr(e,t,r){return z.or([()=>this.persistence.Ei(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const s=this.gi.get(t);return z.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CC{constructor(e){this.serializer=e}q(e,t,r,s){const a=new Rh("createOrUpgrade",t);r<1&&s>=1&&((function(f){f.createObjectStore(Hu)})(e),(function(f){f.createObjectStore(Ru,{keyPath:zA}),f.createObjectStore(or,{keyPath:cw,autoIncrement:!0}).createIndex(Ys,dw,{unique:!0}),f.createObjectStore(Pa)})(e),e0(e),(function(f){f.createObjectStore(Hs)})(e));let l=z.resolve();return r<3&&s>=3&&(r!==0&&((function(f){f.deleteObjectStore(Da),f.deleteObjectStore(Na),f.deleteObjectStore(eo)})(e),e0(e)),l=l.next((()=>(function(f){const p=f.store(eo),v={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:we.min().toTimestamp(),targetCount:0};return p.put(eh,v)})(a)))),r<4&&s>=4&&(r!==0&&(l=l.next((()=>(function(f,p){return p.store(or).j().next((_=>{f.deleteObjectStore(or),f.createObjectStore(or,{keyPath:cw,autoIncrement:!0}).createIndex(Ys,dw,{unique:!0});const x=p.store(or),S=_.map((N=>x.put(N)));return z.waitFor(S)}))})(e,a)))),l=l.next((()=>{(function(f){f.createObjectStore(Va,{keyPath:XA})})(e)}))),r<5&&s>=5&&(l=l.next((()=>this.pi(a)))),r<6&&s>=6&&(l=l.next((()=>((function(f){f.createObjectStore(Cu)})(e),this.yi(a))))),r<7&&s>=7&&(l=l.next((()=>this.wi(a)))),r<8&&s>=8&&(l=l.next((()=>this.Si(e,a)))),r<9&&s>=9&&(l=l.next((()=>{(function(f){f.objectStoreNames.contains("remoteDocumentChanges")&&f.deleteObjectStore("remoteDocumentChanges")})(e)}))),r<10&&s>=10&&(l=l.next((()=>this.bi(a)))),r<11&&s>=11&&(l=l.next((()=>{(function(f){f.createObjectStore(Ph,{keyPath:JA})})(e),(function(f){f.createObjectStore(Nh,{keyPath:ZA})})(e)}))),r<12&&s>=12&&(l=l.next((()=>{(function(f){const p=f.createObjectStore(Dh,{keyPath:oR});p.createIndex(mm,aR,{unique:!1}),p.createIndex(eI,lR,{unique:!1})})(e)}))),r<13&&s>=13&&(l=l.next((()=>(function(f){const p=f.createObjectStore(Zd,{keyPath:qA});p.createIndex(Od,HA),p.createIndex(YE,WA)})(e))).next((()=>this.Di(e,a))).next((()=>e.deleteObjectStore(Hs)))),r<14&&s>=14&&(l=l.next((()=>this.Ci(e,a)))),r<15&&s>=15&&(l=l.next((()=>(function(f){f.createObjectStore(ag,{keyPath:eR,autoIncrement:!0}).createIndex(pm,tR,{unique:!1}),f.createObjectStore(gu,{keyPath:nR}).createIndex(JE,rR,{unique:!1}),f.createObjectStore(yu,{keyPath:iR}).createIndex(ZE,sR,{unique:!1})})(e)))),r<16&&s>=16&&(l=l.next((()=>{t.objectStore(gu).clear()})).next((()=>{t.objectStore(yu).clear()}))),r<17&&s>=17&&(l=l.next((()=>{(function(f){f.createObjectStore(lg,{keyPath:uR})})(e)}))),r<18&&s>=18&&SE()&&(l=l.next((()=>{t.objectStore(gu).clear()})).next((()=>{t.objectStore(yu).clear()}))),l}yi(e){let t=0;return e.store(Hs).X(((r,s)=>{t+=uh(s)})).next((()=>{const r={byteSize:t};return e.store(Cu).put(fm,r)}))}pi(e){const t=e.store(Ru),r=e.store(or);return t.j().next((s=>z.forEach(s,(a=>{const l=IDBKeyRange.bound([a.userId,Zs],[a.userId,a.lastAcknowledgedBatchId]);return r.j(Ys,l).next((d=>z.forEach(d,(f=>{ve(f.userId===a.userId,18650,"Cannot process batch from unexpected user",{batchId:f.batchId});const p=Gs(this.serializer,f);return rx(e,a.userId,p).next((()=>{}))}))))}))))}wi(e){const t=e.store(Da),r=e.store(Hs);return e.store(eo).get(eh).next((s=>{const a=[];return r.X(((l,d)=>{const f=new $e(l),p=(function(_){return[0,Yt(_)]})(f);a.push(t.get(p).next((v=>v?z.resolve():(_=>t.put({targetId:0,path:Yt(_),sequenceNumber:s.highestListenSequenceNumber}))(f))))})).next((()=>z.waitFor(a)))}))}Si(e,t){e.createObjectStore(Pu,{keyPath:YA});const r=t.store(Pu),s=new Eg,a=l=>{if(s.add(l)){const d=l.lastSegment(),f=l.popLast();return r.put({collectionId:d,parent:Yt(f)})}};return t.store(Hs).X({Z:!0},((l,d)=>{const f=new $e(l);return a(f.popLast())})).next((()=>t.store(Pa).X({Z:!0},(([l,d,f],p)=>{const v=Cr(d);return a(v.popLast())}))))}bi(e){const t=e.store(Na);return t.X(((r,s)=>{const a=du(s),l=JI(this.serializer,a);return t.put(l)}))}Di(e,t){const r=t.store(Hs),s=[];return r.X(((a,l)=>{const d=t.store(Zd),f=(function(_){return _.document?new ue($e.fromString(_.document.name).popFirst(5)):_.noDocument?ue.fromSegments(_.noDocument.path):_.unknownDocument?ue.fromSegments(_.unknownDocument.path):me(36783)})(l).path.toArray(),p={prefixPath:f.slice(0,f.length-2),collectionGroup:f[f.length-2],documentId:f[f.length-1],readTime:l.readTime||[0,0],unknownDocument:l.unknownDocument,noDocument:l.noDocument,document:l.document,hasCommittedMutations:!!l.hasCommittedMutations};s.push(d.put(p))})).next((()=>z.waitFor(s)))}Ci(e,t){const r=t.store(or),s=ux(this.serializer),a=new xg($h.Vi,this.serializer.gt);return r.j().next((l=>{const d=new Map;return l.forEach((f=>{var p;let v=(p=d.get(f.userId))!==null&&p!==void 0?p:Re();Gs(this.serializer,f).keys().forEach((_=>v=v.add(_))),d.set(f.userId,v)})),z.forEach(d,((f,p)=>{const v=new Ut(p),_=Bh.yt(this.serializer,v),x=a.getIndexManager(v),S=zh.yt(v,this.serializer,x,a.referenceDelegate);return new cx(s,S,_,x).recalculateAndSaveOverlaysForDocumentKeys(new gm(t,jn.ue),f).next()}))}))}}function e0(n){n.createObjectStore(Da,{keyPath:KA}).createIndex(og,QA,{unique:!0}),n.createObjectStore(Na,{keyPath:"targetId"}).createIndex(XE,GA,{unique:!0}),n.createObjectStore(eo)}const Wi="IndexedDbPersistence",Gp=18e5,Kp=5e3,Qp="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",PC="main";class Tg{constructor(e,t,r,s,a,l,d,f,p,v,_=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.Fi=a,this.window=l,this.document=d,this.Mi=p,this.xi=v,this.Oi=_,this.ui=null,this.ci=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Ni=null,this.inForeground=!1,this.Bi=null,this.Li=null,this.ki=Number.NEGATIVE_INFINITY,this.qi=x=>Promise.resolve(),!Tg.C())throw new oe(Y.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new vC(this,s),this.Qi=t+PC,this.serializer=new XI(f),this.$i=new rs(this.Qi,this.Oi,new CC(this.serializer)),this.li=new oC,this.hi=new pC(this.referenceDelegate,this.serializer),this.remoteDocumentCache=ux(this.serializer),this.Ti=new sC,this.window&&this.window.localStorage?this.Ui=this.window.localStorage:(this.Ui=null,v===!1&&tn(Wi,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Ki().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new oe(Y.FAILED_PRECONDITION,Qp);return this.Wi(),this.Gi(),this.zi(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.hi.getHighestSequenceNumber(e)))})).then((e=>{this.ui=new jn(e,this.Mi)})).then((()=>{this.ci=!0})).catch((e=>(this.$i&&this.$i.close(),Promise.reject(e))))}ji(e){return this.qi=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.$i.setDatabaseDeletedListener(e)}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.Fi.enqueueAndForget((async()=>{this.started&&await this.Ki()})))}Ki(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>kd(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.Ji(e).next((t=>{t||(this.isPrimary=!1,this.Fi.enqueueRetryable((()=>this.qi(!1))))}))})).next((()=>this.Hi(e))).next((t=>this.isPrimary&&!t?this.Yi(e).next((()=>!1)):!!t&&this.Zi(e).next((()=>!0)))))).catch((e=>{if(hs(e))return ne(Wi,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return ne(Wi,"Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.Fi.enqueueRetryable((()=>this.qi(e))),this.isPrimary=e}))}Ji(e){return au(e).get(pa).next((t=>z.resolve(this.Xi(t))))}es(e){return kd(e).delete(this.clientId)}async ts(){if(this.isPrimary&&!this.ns(this.ki,Gp)){this.ki=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(t=>{const r=Rt(t,Va);return r.j().next((s=>{const a=this.rs(s,Gp),l=s.filter((d=>a.indexOf(d)===-1));return z.forEach(l,(d=>r.delete(d.clientId))).next((()=>l))}))})).catch((()=>[]));if(this.Ui)for(const t of e)this.Ui.removeItem(this.ss(t.clientId))}}zi(){this.Li=this.Fi.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.Ki().then((()=>this.ts())).then((()=>this.zi()))))}Xi(e){return!!e&&e.ownerId===this.clientId}Hi(e){return this.xi?z.resolve(!0):au(e).get(pa).next((t=>{if(t!==null&&this.ns(t.leaseTimestampMs,Kp)&&!this._s(t.ownerId)){if(this.Xi(t)&&this.networkEnabled)return!0;if(!this.Xi(t)){if(!t.allowTabSynchronization)throw new oe(Y.FAILED_PRECONDITION,Qp);return!1}}return!(!this.networkEnabled||!this.inForeground)||kd(e).j().next((r=>this.rs(r,Kp).find((s=>{if(this.clientId!==s.clientId){const a=!this.networkEnabled&&s.networkEnabled,l=!this.inForeground&&s.inForeground,d=this.networkEnabled===s.networkEnabled;if(a||l&&d)return!0}return!1}))===void 0))})).next((t=>(this.isPrimary!==t&&ne(Wi,`Client ${t?"is":"is not"} eligible for a primary lease.`),t)))}async shutdown(){this.ci=!1,this.us(),this.Li&&(this.Li.cancel(),this.Li=null),this.cs(),this.ls(),await this.$i.runTransaction("shutdown","readwrite",[Hu,Va],(e=>{const t=new gm(e,jn.ue);return this.Yi(t).next((()=>this.es(t)))})),this.$i.close(),this.hs()}rs(e,t){return e.filter((r=>this.ns(r.updateTimeMs,t)&&!this._s(r.clientId)))}Ps(){return this.runTransaction("getActiveClients","readonly",(e=>kd(e).j().next((t=>this.rs(t,Gp).map((r=>r.clientId))))))}get started(){return this.ci}getGlobalsCache(){return this.li}getMutationQueue(e,t){return zh.yt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new fC(e,this.serializer.gt.databaseId)}getDocumentOverlayCache(e){return Bh.yt(this.serializer,e)}getBundleCache(){return this.Ti}runTransaction(e,t,r){ne(Wi,"Starting transaction:",e);const s=t==="readonly"?"readonly":"readwrite",a=(function(f){return f===18?hR:f===17?iI:f===16?dR:f===15?ug:f===14?rI:f===13?nI:f===12?cR:f===11?tI:void me(60245)})(this.Oi);let l;return this.$i.runTransaction(e,s,a,(d=>(l=new gm(d,this.ui?this.ui.next():jn.ue),t==="readwrite-primary"?this.Ji(l).next((f=>!!f||this.Hi(l))).next((f=>{if(!f)throw tn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.Fi.enqueueRetryable((()=>this.qi(!1))),new oe(Y.FAILED_PRECONDITION,WE);return r(l)})).next((f=>this.Zi(l).next((()=>f)))):this.Ts(l).next((()=>r(l)))))).then((d=>(l.raiseOnCommittedEvent(),d)))}Ts(e){return au(e).get(pa).next((t=>{if(t!==null&&this.ns(t.leaseTimestampMs,Kp)&&!this._s(t.ownerId)&&!this.Xi(t)&&!(this.xi||this.allowTabSynchronization&&t.allowTabSynchronization))throw new oe(Y.FAILED_PRECONDITION,Qp)}))}Zi(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return au(e).put(pa,t)}static C(){return rs.C()}Yi(e){const t=au(e);return t.get(pa).next((r=>this.Xi(r)?(ne(Wi,"Releasing primary lease."),t.delete(pa)):z.resolve()))}ns(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(tn(`Detected an update time that is in the future: ${e} > ${r}`),!1))}Wi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Bi=()=>{this.Fi.enqueueAndForget((()=>(this.inForeground=this.document.visibilityState==="visible",this.Ki())))},this.document.addEventListener("visibilitychange",this.Bi),this.inForeground=this.document.visibilityState==="visible")}cs(){this.Bi&&(this.document.removeEventListener("visibilitychange",this.Bi),this.Bi=null)}Gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Ni=()=>{this.us();const t=/(?:Version|Mobile)\/1[456]/;TE()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.Fi.enterRestrictedMode(!0),this.Fi.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Ni))}ls(){this.Ni&&(this.window.removeEventListener("pagehide",this.Ni),this.Ni=null)}_s(e){var t;try{const r=((t=this.Ui)===null||t===void 0?void 0:t.getItem(this.ss(e)))!==null;return ne(Wi,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return tn(Wi,"Failed to get zombied client id.",r),!1}}us(){if(this.Ui)try{this.Ui.setItem(this.ss(this.clientId),String(Date.now()))}catch(e){tn("Failed to set zombie client id.",e)}}hs(){if(this.Ui)try{this.Ui.removeItem(this.ss(this.clientId))}catch{}}ss(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function au(n){return Rt(n,Hu)}function kd(n){return Rt(n,Va)}function NC(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sg{constructor(e,t,r,s){this.targetId=e,this.fromCache=t,this.Is=r,this.ds=s}static Es(e,t){let r=Re(),s=Re();for(const a of t.docChanges)switch(a.type){case 0:r=r.add(a.doc.key);break;case 1:s=s.add(a.doc.key)}return new Sg(e,t.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DC{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dx{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=(function(){return TE()?8:KE(At())>0?6:4})()}initialize(e,t){this.gs=e,this.indexManager=t,this.As=!0}getDocumentsMatchingQuery(e,t,r,s){const a={result:null};return this.ps(e,t).next((l=>{a.result=l})).next((()=>{if(!a.result)return this.ys(e,t,s,r).next((l=>{a.result=l}))})).next((()=>{if(a.result)return;const l=new DC;return this.ws(e,t,l).next((d=>{if(a.result=d,this.Rs)return this.Ss(e,t,l,d.size)}))})).next((()=>a.result))}Ss(e,t,r,s){return r.documentReadCount<this.Vs?(wa()<=Ne.DEBUG&&ne("QueryEngine","SDK will not create cache indexes for query:",Ea(t),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),z.resolve()):(wa()<=Ne.DEBUG&&ne("QueryEngine","Query:",Ea(t),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.fs*s?(wa()<=Ne.DEBUG&&ne("QueryEngine","The SDK decides to create cache indexes for query:",Ea(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Un(t))):z.resolve())}ps(e,t){if(Tw(t))return z.resolve(null);let r=Un(t);return this.indexManager.getIndexType(e,r).next((s=>s===0?null:(t.limit!==null&&s===1&&(t=ih(t,null,"F"),r=Un(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next((a=>{const l=Re(...a);return this.gs.getDocuments(e,l).next((d=>this.indexManager.getMinOffset(e,r).next((f=>{const p=this.bs(t,d);return this.Ds(t,p,l,f.readTime)?this.ps(e,ih(t,null,"F")):this.vs(e,p,t,f)}))))})))))}ys(e,t,r,s){return Tw(t)||s.isEqual(we.min())?z.resolve(null):this.gs.getDocuments(e,r).next((a=>{const l=this.bs(t,a);return this.Ds(t,l,r,s)?z.resolve(null):(wa()<=Ne.DEBUG&&ne("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Ea(t)),this.vs(e,l,t,OA(s,ku)).next((d=>d)))}))}bs(e,t){let r=new Ge(TI(e));return t.forEach(((s,a)=>{Ku(e,a)&&(r=r.add(a))})),r}Ds(e,t,r,s){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const a=e.limitType==="F"?t.last():t.first();return!!a&&(a.hasPendingWrites||a.version.compareTo(s)>0)}ws(e,t,r){return wa()<=Ne.DEBUG&&ne("QueryEngine","Using full collection scan to execute query:",Ea(t)),this.gs.getDocumentsMatchingQuery(e,t,Sn.min(),r)}vs(e,t,r,s){return this.gs.getDocumentsMatchingQuery(e,r,s).next((a=>(t.forEach((l=>{a=a.insert(l.key,l)})),a)))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kg="LocalStore",VC=3e8;class OC{constructor(e,t,r,s){this.persistence=e,this.Cs=t,this.serializer=s,this.Fs=new at(Te),this.Ms=new mi((a=>ao(a)),Wu),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(r)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new cx(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Fs)))}}function hx(n,e,t,r){return new OC(n,e,t,r)}async function fx(n,e){const t=be(n);return await t.persistence.runTransaction("Handle user change","readonly",(r=>{let s;return t.mutationQueue.getAllMutationBatches(r).next((a=>(s=a,t.Ns(e),t.mutationQueue.getAllMutationBatches(r)))).next((a=>{const l=[],d=[];let f=Re();for(const p of s){l.push(p.batchId);for(const v of p.mutations)f=f.add(v.key)}for(const p of a){d.push(p.batchId);for(const v of p.mutations)f=f.add(v.key)}return t.localDocuments.getDocuments(r,f).next((p=>({Bs:p,removedBatchIds:l,addedBatchIds:d})))}))}))}function LC(n,e){const t=be(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",(r=>{const s=e.batch.keys(),a=t.Os.newChangeBuffer({trackRemovals:!0});return(function(d,f,p,v){const _=p.batch,x=_.keys();let S=z.resolve();return x.forEach((N=>{S=S.next((()=>v.getEntry(f,N))).next((P=>{const O=p.docVersions.get(N);ve(O!==null,48541),P.version.compareTo(O)<0&&(_.applyToRemoteDocument(P,p),P.isValidDocument()&&(P.setReadTime(p.commitVersion),v.addEntry(P)))}))})),S.next((()=>d.mutationQueue.removeMutationBatch(f,_)))})(t,r,e,a).next((()=>a.apply(r))).next((()=>t.mutationQueue.performConsistencyCheck(r))).next((()=>t.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId))).next((()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,(function(d){let f=Re();for(let p=0;p<d.mutationResults.length;++p)d.mutationResults[p].transformResults.length>0&&(f=f.add(d.batch.mutations[p].key));return f})(e)))).next((()=>t.localDocuments.getDocuments(r,s)))}))}function px(n){const e=be(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",(t=>e.hi.getLastRemoteSnapshotVersion(t)))}function MC(n,e){const t=be(n),r=e.snapshotVersion;let s=t.Fs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",(a=>{const l=t.Os.newChangeBuffer({trackRemovals:!0});s=t.Fs;const d=[];e.targetChanges.forEach(((v,_)=>{const x=s.get(_);if(!x)return;d.push(t.hi.removeMatchingKeys(a,v.removedDocuments,_).next((()=>t.hi.addMatchingKeys(a,v.addedDocuments,_))));let S=x.withSequenceNumber(a.currentSequenceNumber);e.targetMismatches.get(_)!==null?S=S.withResumeToken(It.EMPTY_BYTE_STRING,we.min()).withLastLimboFreeSnapshotVersion(we.min()):v.resumeToken.approximateByteSize()>0&&(S=S.withResumeToken(v.resumeToken,r)),s=s.insert(_,S),(function(P,O,K){return P.resumeToken.approximateByteSize()===0||O.snapshotVersion.toMicroseconds()-P.snapshotVersion.toMicroseconds()>=VC?!0:K.addedDocuments.size+K.modifiedDocuments.size+K.removedDocuments.size>0})(x,S,v)&&d.push(t.hi.updateTargetData(a,S))}));let f=xn(),p=Re();if(e.documentUpdates.forEach((v=>{e.resolvedLimboDocuments.has(v)&&d.push(t.persistence.referenceDelegate.updateLimboDocument(a,v))})),d.push(jC(a,l,e.documentUpdates).next((v=>{f=v.Ls,p=v.ks}))),!r.isEqual(we.min())){const v=t.hi.getLastRemoteSnapshotVersion(a).next((_=>t.hi.setTargetsMetadata(a,a.currentSequenceNumber,r)));d.push(v)}return z.waitFor(d).next((()=>l.apply(a))).next((()=>t.localDocuments.getLocalViewOfDocuments(a,f,p))).next((()=>f))})).then((a=>(t.Fs=s,a)))}function jC(n,e,t){let r=Re(),s=Re();return t.forEach((a=>r=r.add(a))),e.getEntries(n,r).next((a=>{let l=xn();return t.forEach(((d,f)=>{const p=a.get(d);f.isFoundDocument()!==p.isFoundDocument()&&(s=s.add(d)),f.isNoDocument()&&f.version.isEqual(we.min())?(e.removeEntry(d,f.readTime),l=l.insert(d,f)):!p.isValidDocument()||f.version.compareTo(p.version)>0||f.version.compareTo(p.version)===0&&p.hasPendingWrites?(e.addEntry(f),l=l.insert(d,f)):ne(kg,"Ignoring outdated watch update for ",d,". Current version:",p.version," Watch version:",f.version)})),{Ls:l,ks:s}}))}function FC(n,e){const t=be(n);return t.persistence.runTransaction("Get next mutation batch","readonly",(r=>(e===void 0&&(e=Zs),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e))))}function UC(n,e){const t=be(n);return t.persistence.runTransaction("Allocate target","readwrite",(r=>{let s;return t.hi.getTargetData(r,e).next((a=>a?(s=a,z.resolve(s)):t.hi.allocateTargetId(r).next((l=>(s=new si(e,l,"TargetPurposeListen",r.currentSequenceNumber),t.hi.addTargetData(r,s).next((()=>s)))))))})).then((r=>{const s=t.Fs.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(t.Fs=t.Fs.insert(r.targetId,r),t.Ms.set(e,r.targetId)),r}))}async function Cm(n,e,t){const r=be(n),s=r.Fs.get(e),a=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",a,(l=>r.persistence.referenceDelegate.removeTarget(l,s)))}catch(l){if(!hs(l))throw l;ne(kg,`Failed to update sequence numbers for target ${e}: ${l}`)}r.Fs=r.Fs.remove(e),r.Ms.delete(s.target)}function t0(n,e,t){const r=be(n);let s=we.min(),a=Re();return r.persistence.runTransaction("Execute query","readwrite",(l=>(function(f,p,v){const _=be(f),x=_.Ms.get(v);return x!==void 0?z.resolve(_.Fs.get(x)):_.hi.getTargetData(p,v)})(r,l,Un(e)).next((d=>{if(d)return s=d.lastLimboFreeSnapshotVersion,r.hi.getMatchingKeysForTargetId(l,d.targetId).next((f=>{a=f}))})).next((()=>r.Cs.getDocumentsMatchingQuery(l,e,t?s:we.min(),t?a:Re()))).next((d=>(BC(r,bR(e),d),{documents:d,qs:a})))))}function BC(n,e,t){let r=n.xs.get(e)||we.min();t.forEach(((s,a)=>{a.readTime.compareTo(r)>0&&(r=a.readTime)})),n.xs.set(e,r)}class n0{constructor(){this.activeTargetIds=DR()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class mx{constructor(){this.Fo=new n0,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,t,r){this.Mo[e]=t}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new n0,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zC{xo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r0="ConnectivityMonitor";class i0{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){ne(r0,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){ne(r0,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let bd=null;function Pm(){return bd===null?bd=(function(){return 268435456+Math.round(2147483648*Math.random())})():bd++,"0x"+bd.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yp="RestConnection",$C={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class qC{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.$o=t+"://"+e.host,this.Uo=`projects/${r}/databases/${s}`,this.Ko=this.databaseId.database===th?`project_id=${r}`:`project_id=${r}&database_id=${s}`}Wo(e,t,r,s,a){const l=Pm(),d=this.Go(e,t.toUriEncodedString());ne(Yp,`Sending RPC '${e}' ${l}:`,d,r);const f={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(f,s,a);const{host:p}=new URL(d),v=Ya(p);return this.jo(e,d,f,r,v).then((_=>(ne(Yp,`Received RPC '${e}' ${l}: `,_),_)),(_=>{throw Mr(Yp,`RPC '${e}' ${l} failed with error: `,_,"url: ",d,"request:",r),_}))}Jo(e,t,r,s,a,l){return this.Wo(e,t,r,s,a)}zo(e,t,r){e["X-Goog-Api-Client"]=(function(){return"gl-js/ fire/"+Ja})(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((s,a)=>e[a]=s)),r&&r.headers.forEach(((s,a)=>e[a]=s))}Go(e,t){const r=$C[e];return`${this.$o}/v1/${t}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HC{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wt="WebChannelConnection";class WC extends qC{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,t,r,s,a){const l=Pm();return new Promise(((d,f)=>{const p=new VE;p.setWithCredentials(!0),p.listenOnce(OE.COMPLETE,(()=>{try{switch(p.getLastErrorCode()){case Nd.NO_ERROR:const _=p.getResponseJson();ne(Wt,`XHR for RPC '${e}' ${l} received:`,JSON.stringify(_)),d(_);break;case Nd.TIMEOUT:ne(Wt,`RPC '${e}' ${l} timed out`),f(new oe(Y.DEADLINE_EXCEEDED,"Request time out"));break;case Nd.HTTP_ERROR:const x=p.getStatus();if(ne(Wt,`RPC '${e}' ${l} failed with status:`,x,"response text:",p.getResponseText()),x>0){let S=p.getResponseJson();Array.isArray(S)&&(S=S[0]);const N=S==null?void 0:S.error;if(N&&N.status&&N.message){const P=(function(K){const Q=K.toLowerCase().replace(/_/g,"-");return Object.values(Y).indexOf(Q)>=0?Q:Y.UNKNOWN})(N.status);f(new oe(P,N.message))}else f(new oe(Y.UNKNOWN,"Server responded with status "+p.getStatus()))}else f(new oe(Y.UNAVAILABLE,"Connection failed."));break;default:me(9055,{c_:e,streamId:l,l_:p.getLastErrorCode(),h_:p.getLastError()})}}finally{ne(Wt,`RPC '${e}' ${l} completed.`)}}));const v=JSON.stringify(s);ne(Wt,`RPC '${e}' ${l} sending request:`,s),p.send(t,"POST",v,r,15)}))}P_(e,t,r){const s=Pm(),a=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],l=jE(),d=ME(),f={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},p=this.longPollingOptions.timeoutSeconds;p!==void 0&&(f.longPollingTimeout=Math.round(1e3*p)),this.useFetchStreams&&(f.useFetchStreams=!0),this.zo(f.initMessageHeaders,t,r),f.encodeInitMessageHeaders=!0;const v=a.join("");ne(Wt,`Creating RPC '${e}' stream ${s}: ${v}`,f);const _=l.createWebChannel(v,f);this.T_(_);let x=!1,S=!1;const N=new HC({Ho:O=>{S?ne(Wt,`Not sending because RPC '${e}' stream ${s} is closed:`,O):(x||(ne(Wt,`Opening RPC '${e}' stream ${s} transport.`),_.open(),x=!0),ne(Wt,`RPC '${e}' stream ${s} sending:`,O),_.send(O))},Yo:()=>_.close()}),P=(O,K,Q)=>{O.listen(K,(H=>{try{Q(H)}catch(se){setTimeout((()=>{throw se}),0)}}))};return P(_,lu.EventType.OPEN,(()=>{S||(ne(Wt,`RPC '${e}' stream ${s} transport opened.`),N.s_())})),P(_,lu.EventType.CLOSE,(()=>{S||(S=!0,ne(Wt,`RPC '${e}' stream ${s} transport closed`),N.__(),this.I_(_))})),P(_,lu.EventType.ERROR,(O=>{S||(S=!0,Mr(Wt,`RPC '${e}' stream ${s} transport errored. Name:`,O.name,"Message:",O.message),N.__(new oe(Y.UNAVAILABLE,"The operation could not be completed")))})),P(_,lu.EventType.MESSAGE,(O=>{var K;if(!S){const Q=O.data[0];ve(!!Q,16349);const H=Q,se=(H==null?void 0:H.error)||((K=H[0])===null||K===void 0?void 0:K.error);if(se){ne(Wt,`RPC '${e}' stream ${s} received error:`,se);const ce=se.status;let re=(function(A){const D=vt[A];if(D!==void 0)return MI(D)})(ce),C=se.message;re===void 0&&(re=Y.INTERNAL,C="Unknown error status: "+ce+" with message "+se.message),S=!0,N.__(new oe(re,C)),_.close()}else ne(Wt,`RPC '${e}' stream ${s} received:`,Q),N.a_(Q)}})),P(d,LE.STAT_EVENT,(O=>{O.stat===cm.PROXY?ne(Wt,`RPC '${e}' stream ${s} detected buffering proxy`):O.stat===cm.NOPROXY&&ne(Wt,`RPC '${e}' stream ${s} detected no buffering proxy`)})),setTimeout((()=>{N.o_()}),0),N}terminate(){this.u_.forEach((e=>e.close())),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter((t=>t===e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GC(){return typeof window<"u"?window:null}function zd(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qh(n){return new KR(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gx{constructor(e,t,r=1e3,s=1.5,a=6e4){this.Fi=e,this.timerId=t,this.d_=r,this.E_=s,this.A_=a,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const t=Math.floor(this.R_+this.p_()),r=Math.max(0,Date.now()-this.m_),s=Math.max(0,t-r);s>0&&ne("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.R_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,s,(()=>(this.m_=Date.now(),e()))),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s0="PersistentStream";class yx{constructor(e,t,r,s,a,l,d,f){this.Fi=e,this.w_=r,this.S_=s,this.connection=a,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=d,this.listener=f,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new gx(e,t)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,(()=>this.L_())))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():t&&t.code===Y.RESOURCE_EXHAUSTED?(tn(t.toString()),tn("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):t&&t.code===Y.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(t)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),t=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([r,s])=>{this.b_===t&&this.W_(r,s)}),(r=>{e((()=>{const s=new oe(Y.UNKNOWN,"Fetching auth token failed: "+r.message);return this.G_(s)}))}))}W_(e,t){const r=this.K_(this.b_);this.stream=this.z_(e,t),this.stream.Zo((()=>{r((()=>this.listener.Zo()))})),this.stream.e_((()=>{r((()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,(()=>(this.x_()&&(this.state=3),Promise.resolve()))),this.listener.e_())))})),this.stream.n_((s=>{r((()=>this.G_(s)))})),this.stream.onMessage((s=>{r((()=>++this.C_==1?this.j_(s):this.onNext(s)))}))}O_(){this.state=5,this.F_.g_((async()=>{this.state=0,this.start()}))}G_(e){return ne(s0,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return t=>{this.Fi.enqueueAndForget((()=>this.b_===e?t():(ne(s0,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class KC extends yx{constructor(e,t,r,s,a,l){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,s,l),this.serializer=a}z_(e,t){return this.connection.P_("Listen",e,t)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const t=XR(this.serializer,e),r=(function(a){if(!("targetChange"in a))return we.min();const l=a.targetChange;return l.targetIds&&l.targetIds.length?we.min():l.readTime?rn(l.readTime):we.min()})(e);return this.listener.J_(t,r)}H_(e){const t={};t.database=Sm(this.serializer),t.addTarget=(function(a,l){let d;const f=l.target;if(d=nh(f)?{documents:HI(a,f)}:{query:WI(a,f).Vt},d.targetId=l.targetId,l.resumeToken.approximateByteSize()>0){d.resumeToken=UI(a,l.resumeToken);const p=xm(a,l.expectedCount);p!==null&&(d.expectedCount=p)}else if(l.snapshotVersion.compareTo(we.min())>0){d.readTime=za(a,l.snapshotVersion.toTimestamp());const p=xm(a,l.expectedCount);p!==null&&(d.expectedCount=p)}return d})(this.serializer,e);const r=ZR(this.serializer,e);r&&(t.labels=r),this.k_(t)}Y_(e){const t={};t.database=Sm(this.serializer),t.removeTarget=e,this.k_(t)}}class QC extends yx{constructor(e,t,r,s,a,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,s,l),this.serializer=a}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,t){return this.connection.P_("Write",e,t)}j_(e){return ve(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,ve(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){ve(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const t=JR(e.writeResults,e.commitTime),r=rn(e.commitTime);return this.listener.ta(r,t)}na(){const e={};e.database=Sm(this.serializer),this.k_(e)}X_(e){const t={streamToken:this.lastStreamToken,writes:e.map((r=>oh(this.serializer,r)))};this.k_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YC{}class XC extends YC{constructor(e,t,r,s){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=s,this.ra=!1}ia(){if(this.ra)throw new oe(Y.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,t,r,s){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([a,l])=>this.connection.Wo(e,Tm(t,r),s,a,l))).catch((a=>{throw a.name==="FirebaseError"?(a.code===Y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new oe(Y.UNKNOWN,a.toString())}))}Jo(e,t,r,s,a){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([l,d])=>this.connection.Jo(e,Tm(t,r),s,l,d,a))).catch((l=>{throw l.name==="FirebaseError"?(l.code===Y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new oe(Y.UNKNOWN,l.toString())}))}terminate(){this.ra=!0,this.connection.terminate()}}class JC{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve()))))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(tn(t),this._a=!1):ne("OnlineStateTracker",t)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ho="RemoteStore";class ZC{constructor(e,t,r,s,a){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=a,this.Ea.xo((l=>{r.enqueueAndForget((async()=>{wo(this)&&(ne(ho,"Restarting streams for network reachability change."),await(async function(f){const p=be(f);p.Ia.add(4),await Yu(p),p.Aa.set("Unknown"),p.Ia.delete(4),await Hh(p)})(this))}))})),this.Aa=new JC(r,s)}}async function Hh(n){if(wo(n))for(const e of n.da)await e(!0)}async function Yu(n){for(const e of n.da)await e(!1)}function vx(n,e){const t=be(n);t.Ta.has(e.targetId)||(t.Ta.set(e.targetId,e),Cg(t)?Rg(t):tl(t).x_()&&Ag(t,e))}function bg(n,e){const t=be(n),r=tl(t);t.Ta.delete(e),r.x_()&&_x(t,e),t.Ta.size===0&&(r.x_()?r.B_():wo(t)&&t.Aa.set("Unknown"))}function Ag(n,e){if(n.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(we.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}tl(n).H_(e)}function _x(n,e){n.Ra.$e(e),tl(n).Y_(e)}function Rg(n){n.Ra=new qR({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>n.Ta.get(e)||null,lt:()=>n.datastore.serializer.databaseId}),tl(n).start(),n.Aa.aa()}function Cg(n){return wo(n)&&!tl(n).M_()&&n.Ta.size>0}function wo(n){return be(n).Ia.size===0}function wx(n){n.Ra=void 0}async function eP(n){n.Aa.set("Online")}async function tP(n){n.Ta.forEach(((e,t)=>{Ag(n,e)}))}async function nP(n,e){wx(n),Cg(n)?(n.Aa.la(e),Rg(n)):n.Aa.set("Unknown")}async function rP(n,e,t){if(n.Aa.set("Online"),e instanceof FI&&e.state===2&&e.cause)try{await(async function(s,a){const l=a.cause;for(const d of a.targetIds)s.Ta.has(d)&&(await s.remoteSyncer.rejectListen(d,l),s.Ta.delete(d),s.Ra.removeTarget(d))})(n,e)}catch(r){ne(ho,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await dh(n,r)}else if(e instanceof Ud?n.Ra.Ye(e):e instanceof jI?n.Ra.it(e):n.Ra.et(e),!t.isEqual(we.min()))try{const r=await px(n.localStore);t.compareTo(r)>=0&&await(function(a,l){const d=a.Ra.Pt(l);return d.targetChanges.forEach(((f,p)=>{if(f.resumeToken.approximateByteSize()>0){const v=a.Ta.get(p);v&&a.Ta.set(p,v.withResumeToken(f.resumeToken,l))}})),d.targetMismatches.forEach(((f,p)=>{const v=a.Ta.get(f);if(!v)return;a.Ta.set(f,v.withResumeToken(It.EMPTY_BYTE_STRING,v.snapshotVersion)),_x(a,f);const _=new si(v.target,f,p,v.sequenceNumber);Ag(a,_)})),a.remoteSyncer.applyRemoteEvent(d)})(n,t)}catch(r){ne(ho,"Failed to raise snapshot:",r),await dh(n,r)}}async function dh(n,e,t){if(!hs(e))throw e;n.Ia.add(1),await Yu(n),n.Aa.set("Offline"),t||(t=()=>px(n.localStore)),n.asyncQueue.enqueueRetryable((async()=>{ne(ho,"Retrying IndexedDB access"),await t(),n.Ia.delete(1),await Hh(n)}))}function Ex(n,e){return e().catch((t=>dh(n,t,e)))}async function Xu(n){const e=be(n),t=ls(e);let r=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:Zs;for(;iP(e);)try{const s=await FC(e.localStore,r);if(s===null){e.Pa.length===0&&t.B_();break}r=s.batchId,sP(e,s)}catch(s){await dh(e,s)}Ix(e)&&xx(e)}function iP(n){return wo(n)&&n.Pa.length<10}function sP(n,e){n.Pa.push(e);const t=ls(n);t.x_()&&t.Z_&&t.X_(e.mutations)}function Ix(n){return wo(n)&&!ls(n).M_()&&n.Pa.length>0}function xx(n){ls(n).start()}async function oP(n){ls(n).na()}async function aP(n){const e=ls(n);for(const t of n.Pa)e.X_(t.mutations)}async function lP(n,e,t){const r=n.Pa.shift(),s=gg.from(r,e,t);await Ex(n,(()=>n.remoteSyncer.applySuccessfulWrite(s))),await Xu(n)}async function uP(n,e){e&&ls(n).Z_&&await(async function(r,s){if((function(l){return zR(l)&&l!==Y.ABORTED})(s.code)){const a=r.Pa.shift();ls(r).N_(),await Ex(r,(()=>r.remoteSyncer.rejectFailedWrite(a.batchId,s))),await Xu(r)}})(n,e),Ix(n)&&xx(n)}async function o0(n,e){const t=be(n);t.asyncQueue.verifyOperationInProgress(),ne(ho,"RemoteStore received new credentials");const r=wo(t);t.Ia.add(3),await Yu(t),r&&t.Aa.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.Ia.delete(3),await Hh(t)}async function cP(n,e){const t=be(n);e?(t.Ia.delete(2),await Hh(t)):e||(t.Ia.add(2),await Yu(t),t.Aa.set("Unknown"))}function tl(n){return n.Va||(n.Va=(function(t,r,s){const a=be(t);return a.ia(),new KC(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)})(n.datastore,n.asyncQueue,{Zo:eP.bind(null,n),e_:tP.bind(null,n),n_:nP.bind(null,n),J_:rP.bind(null,n)}),n.da.push((async e=>{e?(n.Va.N_(),Cg(n)?Rg(n):n.Aa.set("Unknown")):(await n.Va.stop(),wx(n))}))),n.Va}function ls(n){return n.ma||(n.ma=(function(t,r,s){const a=be(t);return a.ia(),new QC(r,a.connection,a.authCredentials,a.appCheckCredentials,a.serializer,s)})(n.datastore,n.asyncQueue,{Zo:()=>Promise.resolve(),e_:oP.bind(null,n),n_:uP.bind(null,n),ea:aP.bind(null,n),ta:lP.bind(null,n)}),n.da.push((async e=>{e?(n.ma.N_(),await Xu(n)):(await n.ma.stop(),n.Pa.length>0&&(ne(ho,`Stopping write stream with ${n.Pa.length} pending writes`),n.Pa=[]))}))),n.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pg{constructor(e,t,r,s,a){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=s,this.removalCallback=a,this.deferred=new Nr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((l=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,s,a){const l=Date.now()+r,d=new Pg(e,t,l,s,a);return d.start(r),d}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new oe(Y.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Ng(n,e){if(tn("AsyncQueue",`${e}: ${n}`),hs(n))return new oe(Y.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ka{static emptySet(e){return new ka(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||ue.comparator(t.key,r.key):(t,r)=>ue.comparator(t.key,r.key),this.keyedMap=uu(),this.sortedSet=new at(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,r)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof ka)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const s=t.getNext().key,a=r.getNext().key;if(!s.isEqual(a))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new ka;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a0{constructor(){this.fa=new at(ue.comparator)}track(e){const t=e.doc.key,r=this.fa.get(t);r?e.type!==0&&r.type===3?this.fa=this.fa.insert(t,e):e.type===3&&r.type!==1?this.fa=this.fa.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.fa=this.fa.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.fa=this.fa.remove(t):e.type===1&&r.type===2?this.fa=this.fa.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.fa=this.fa.insert(t,{type:2,doc:e.doc}):me(63341,{At:e,ga:r}):this.fa=this.fa.insert(t,e)}pa(){const e=[];return this.fa.inorderTraversal(((t,r)=>{e.push(r)})),e}}class $a{constructor(e,t,r,s,a,l,d,f,p){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=a,this.fromCache=l,this.syncStateChanged=d,this.excludesMetadataChanges=f,this.hasCachedResults=p}static fromInitialDocuments(e,t,r,s,a){const l=[];return t.forEach((d=>{l.push({type:0,doc:d})})),new $a(e,t,ka.emptySet(t),l,r,s,!0,!1,a)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Lh(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let s=0;s<t.length;s++)if(t[s].type!==r[s].type||!t[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dP{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some((e=>e.ba()))}}class hP{constructor(){this.queries=l0(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(t,r){const s=be(t),a=s.queries;s.queries=l0(),a.forEach(((l,d)=>{for(const f of d.wa)f.onError(r)}))})(this,new oe(Y.ABORTED,"Firestore shutting down"))}}function l0(){return new mi((n=>xI(n)),Lh)}async function Dg(n,e){const t=be(n);let r=3;const s=e.query;let a=t.queries.get(s);a?!a.Sa()&&e.ba()&&(r=2):(a=new dP,r=e.ba()?0:1);try{switch(r){case 0:a.ya=await t.onListen(s,!0);break;case 1:a.ya=await t.onListen(s,!1);break;case 2:await t.onFirstRemoteStoreListen(s)}}catch(l){const d=Ng(l,`Initialization of query '${Ea(e.query)}' failed`);return void e.onError(d)}t.queries.set(s,a),a.wa.push(e),e.va(t.onlineState),a.ya&&e.Ca(a.ya)&&Og(t)}async function Vg(n,e){const t=be(n),r=e.query;let s=3;const a=t.queries.get(r);if(a){const l=a.wa.indexOf(e);l>=0&&(a.wa.splice(l,1),a.wa.length===0?s=e.ba()?0:1:!a.Sa()&&e.ba()&&(s=2))}switch(s){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function fP(n,e){const t=be(n);let r=!1;for(const s of e){const a=s.query,l=t.queries.get(a);if(l){for(const d of l.wa)d.Ca(s)&&(r=!0);l.ya=s}}r&&Og(t)}function pP(n,e,t){const r=be(n),s=r.queries.get(e);if(s)for(const a of s.wa)a.onError(t);r.queries.delete(e)}function Og(n){n.Da.forEach((e=>{e.next()}))}var Nm,u0;(u0=Nm||(Nm={})).Fa="default",u0.Cache="cache";class Lg{constructor(e,t,r){this.query=e,this.Ma=t,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=r||{}}Ca(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new $a(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),t=!0):this.Ba(e,this.onlineState)&&(this.La(e),t=!0),this.Oa=e,t}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let t=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),t=!0),t}Ba(e,t){if(!e.fromCache||!this.ba())return!0;const r=t!=="Offline";return(!this.options.ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}Na(e){if(e.docChanges.length>0)return!0;const t=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}La(e){e=$a.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==Nm.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tx{constructor(e){this.key=e}}class Sx{constructor(e){this.key=e}}class mP{constructor(e,t){this.query=e,this.Ha=t,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=Re(),this.mutatedKeys=Re(),this.Xa=TI(e),this.eu=new ka(this.Xa)}get tu(){return this.Ha}nu(e,t){const r=t?t.ru:new a0,s=t?t.eu:this.eu;let a=t?t.mutatedKeys:this.mutatedKeys,l=s,d=!1;const f=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,p=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal(((v,_)=>{const x=s.get(v),S=Ku(this.query,_)?_:null,N=!!x&&this.mutatedKeys.has(x.key),P=!!S&&(S.hasLocalMutations||this.mutatedKeys.has(S.key)&&S.hasCommittedMutations);let O=!1;x&&S?x.data.isEqual(S.data)?N!==P&&(r.track({type:3,doc:S}),O=!0):this.iu(x,S)||(r.track({type:2,doc:S}),O=!0,(f&&this.Xa(S,f)>0||p&&this.Xa(S,p)<0)&&(d=!0)):!x&&S?(r.track({type:0,doc:S}),O=!0):x&&!S&&(r.track({type:1,doc:x}),O=!0,(f||p)&&(d=!0)),O&&(S?(l=l.add(S),a=P?a.add(v):a.delete(v)):(l=l.delete(v),a=a.delete(v)))})),this.query.limit!==null)for(;l.size>this.query.limit;){const v=this.query.limitType==="F"?l.last():l.first();l=l.delete(v.key),a=a.delete(v.key),r.track({type:1,doc:v})}return{eu:l,ru:r,Ds:d,mutatedKeys:a}}iu(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,s){const a=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const l=e.ru.pa();l.sort(((v,_)=>(function(S,N){const P=O=>{switch(O){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return me(20277,{At:O})}};return P(S)-P(N)})(v.type,_.type)||this.Xa(v.doc,_.doc))),this.su(r),s=s!=null&&s;const d=t&&!s?this.ou():[],f=this.Za.size===0&&this.current&&!s?1:0,p=f!==this.Ya;return this.Ya=f,l.length!==0||p?{snapshot:new $a(this.query,e.eu,a,l,e.mutatedKeys,f===0,p,!1,!!r&&r.resumeToken.approximateByteSize()>0),_u:d}:{_u:d}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new a0,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach((t=>this.Ha=this.Ha.add(t))),e.modifiedDocuments.forEach((t=>{})),e.removedDocuments.forEach((t=>this.Ha=this.Ha.delete(t))),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=Re(),this.eu.forEach((r=>{this.au(r.key)&&(this.Za=this.Za.add(r.key))}));const t=[];return e.forEach((r=>{this.Za.has(r)||t.push(new Sx(r))})),this.Za.forEach((r=>{e.has(r)||t.push(new Tx(r))})),t}uu(e){this.Ha=e.qs,this.Za=Re();const t=this.nu(e.documents);return this.applyChanges(t,!0)}cu(){return $a.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const Mg="SyncEngine";class gP{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class yP{constructor(e){this.key=e,this.lu=!1}}class vP{constructor(e,t,r,s,a,l){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=s,this.currentUser=a,this.maxConcurrentLimboResolutions=l,this.hu={},this.Pu=new mi((d=>xI(d)),Lh),this.Tu=new Map,this.Iu=new Set,this.du=new at(ue.comparator),this.Eu=new Map,this.Au=new Ig,this.Ru={},this.Vu=new Map,this.mu=co.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function _P(n,e,t=!0){const r=Px(n);let s;const a=r.Pu.get(e);return a?(r.sharedClientState.addLocalQueryTarget(a.targetId),s=a.view.cu()):s=await kx(r,e,t,!0),s}async function wP(n,e){const t=Px(n);await kx(t,e,!0,!1)}async function kx(n,e,t,r){const s=await UC(n.localStore,Un(e)),a=s.targetId,l=n.sharedClientState.addLocalQueryTarget(a,t);let d;return r&&(d=await EP(n,e,a,l==="current",s.resumeToken)),n.isPrimaryClient&&t&&vx(n.remoteStore,s),d}async function EP(n,e,t,r,s){n.gu=(_,x,S)=>(async function(P,O,K,Q){let H=O.view.nu(K);H.Ds&&(H=await t0(P.localStore,O.query,!1).then((({documents:C})=>O.view.nu(C,H))));const se=Q&&Q.targetChanges.get(O.targetId),ce=Q&&Q.targetMismatches.get(O.targetId)!=null,re=O.view.applyChanges(H,P.isPrimaryClient,se,ce);return d0(P,O.targetId,re._u),re.snapshot})(n,_,x,S);const a=await t0(n.localStore,e,!0),l=new mP(e,a.qs),d=l.nu(a.documents),f=Qu.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",s),p=l.applyChanges(d,n.isPrimaryClient,f);d0(n,t,p._u);const v=new gP(e,t,l);return n.Pu.set(e,v),n.Tu.has(t)?n.Tu.get(t).push(e):n.Tu.set(t,[e]),p.snapshot}async function IP(n,e,t){const r=be(n),s=r.Pu.get(e),a=r.Tu.get(s.targetId);if(a.length>1)return r.Tu.set(s.targetId,a.filter((l=>!Lh(l,e)))),void r.Pu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Cm(r.localStore,s.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(s.targetId),t&&bg(r.remoteStore,s.targetId),Dm(r,s.targetId)})).catch(_o)):(Dm(r,s.targetId),await Cm(r.localStore,s.targetId,!0))}async function xP(n,e){const t=be(n),r=t.Pu.get(e),s=t.Tu.get(r.targetId);t.isPrimaryClient&&s.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),bg(t.remoteStore,r.targetId))}async function TP(n,e,t){const r=Nx(n);try{const s=await(function(l,d){const f=be(l),p=He.now(),v=d.reduce(((S,N)=>S.add(N.key)),Re());let _,x;return f.persistence.runTransaction("Locally write mutations","readwrite",(S=>{let N=xn(),P=Re();return f.Os.getEntries(S,v).next((O=>{N=O,N.forEach(((K,Q)=>{Q.isValidDocument()||(P=P.add(K))}))})).next((()=>f.localDocuments.getOverlayedDocuments(S,N))).next((O=>{_=O;const K=[];for(const Q of d){const H=UR(Q,_.get(Q.key).overlayedDocument);H!=null&&K.push(new gi(Q.key,H,pI(H.value.mapValue),Qt.exists(!0)))}return f.mutationQueue.addMutationBatch(S,p,K,d)})).next((O=>{x=O;const K=O.applyToLocalDocumentSet(_,P);return f.documentOverlayCache.saveOverlays(S,O.batchId,K)}))})).then((()=>({batchId:x.batchId,changes:kI(_)})))})(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),(function(l,d,f){let p=l.Ru[l.currentUser.toKey()];p||(p=new at(Te)),p=p.insert(d,f),l.Ru[l.currentUser.toKey()]=p})(r,s.batchId,t),await Ju(r,s.changes),await Xu(r.remoteStore)}catch(s){const a=Ng(s,"Failed to persist write");t.reject(a)}}async function bx(n,e){const t=be(n);try{const r=await MC(t.localStore,e);e.targetChanges.forEach(((s,a)=>{const l=t.Eu.get(a);l&&(ve(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?l.lu=!0:s.modifiedDocuments.size>0?ve(l.lu,14607):s.removedDocuments.size>0&&(ve(l.lu,42227),l.lu=!1))})),await Ju(t,r,e)}catch(r){await _o(r)}}function c0(n,e,t){const r=be(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const s=[];r.Pu.forEach(((a,l)=>{const d=l.view.va(e);d.snapshot&&s.push(d.snapshot)})),(function(l,d){const f=be(l);f.onlineState=d;let p=!1;f.queries.forEach(((v,_)=>{for(const x of _.wa)x.va(d)&&(p=!0)})),p&&Og(f)})(r.eventManager,e),s.length&&r.hu.J_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function SP(n,e,t){const r=be(n);r.sharedClientState.updateQueryState(e,"rejected",t);const s=r.Eu.get(e),a=s&&s.key;if(a){let l=new at(ue.comparator);l=l.insert(a,ht.newNoDocument(a,we.min()));const d=Re().add(a),f=new Uh(we.min(),new Map,new at(Te),l,d);await bx(r,f),r.du=r.du.remove(a),r.Eu.delete(e),jg(r)}else await Cm(r.localStore,e,!1).then((()=>Dm(r,e,t))).catch(_o)}async function kP(n,e){const t=be(n),r=e.batch.batchId;try{const s=await LC(t.localStore,e);Rx(t,r,null),Ax(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await Ju(t,s)}catch(s){await _o(s)}}async function bP(n,e,t){const r=be(n);try{const s=await(function(l,d){const f=be(l);return f.persistence.runTransaction("Reject batch","readwrite-primary",(p=>{let v;return f.mutationQueue.lookupMutationBatch(p,d).next((_=>(ve(_!==null,37113),v=_.keys(),f.mutationQueue.removeMutationBatch(p,_)))).next((()=>f.mutationQueue.performConsistencyCheck(p))).next((()=>f.documentOverlayCache.removeOverlaysForBatchId(p,v,d))).next((()=>f.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(p,v))).next((()=>f.localDocuments.getDocuments(p,v)))}))})(r.localStore,e);Rx(r,e,t),Ax(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await Ju(r,s)}catch(s){await _o(s)}}function Ax(n,e){(n.Vu.get(e)||[]).forEach((t=>{t.resolve()})),n.Vu.delete(e)}function Rx(n,e,t){const r=be(n);let s=r.Ru[r.currentUser.toKey()];if(s){const a=s.get(e);a&&(t?a.reject(t):a.resolve(),s=s.remove(e)),r.Ru[r.currentUser.toKey()]=s}}function Dm(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Tu.get(e))n.Pu.delete(r),t&&n.hu.pu(r,t);n.Tu.delete(e),n.isPrimaryClient&&n.Au.zr(e).forEach((r=>{n.Au.containsKey(r)||Cx(n,r)}))}function Cx(n,e){n.Iu.delete(e.path.canonicalString());const t=n.du.get(e);t!==null&&(bg(n.remoteStore,t),n.du=n.du.remove(e),n.Eu.delete(t),jg(n))}function d0(n,e,t){for(const r of t)r instanceof Tx?(n.Au.addReference(r.key,e),AP(n,r)):r instanceof Sx?(ne(Mg,"Document no longer in limbo: "+r.key),n.Au.removeReference(r.key,e),n.Au.containsKey(r.key)||Cx(n,r.key)):me(19791,{yu:r})}function AP(n,e){const t=e.key,r=t.path.canonicalString();n.du.get(t)||n.Iu.has(r)||(ne(Mg,"New document in limbo: "+t),n.Iu.add(r),jg(n))}function jg(n){for(;n.Iu.size>0&&n.du.size<n.maxConcurrentLimboResolutions;){const e=n.Iu.values().next().value;n.Iu.delete(e);const t=new ue($e.fromString(e)),r=n.mu.next();n.Eu.set(r,new yP(t)),n.du=n.du.insert(t,r),vx(n.remoteStore,new si(Un(Gu(t.path)),r,"TargetPurposeLimboResolution",jn.ue))}}async function Ju(n,e,t){const r=be(n),s=[],a=[],l=[];r.Pu.isEmpty()||(r.Pu.forEach(((d,f)=>{l.push(r.gu(f,e,t).then((p=>{var v;if((p||t)&&r.isPrimaryClient){const _=p?!p.fromCache:(v=t==null?void 0:t.targetChanges.get(f.targetId))===null||v===void 0?void 0:v.current;r.sharedClientState.updateQueryState(f.targetId,_?"current":"not-current")}if(p){s.push(p);const _=Sg.Es(f.targetId,p);a.push(_)}})))})),await Promise.all(l),r.hu.J_(s),await(async function(f,p){const v=be(f);try{await v.persistence.runTransaction("notifyLocalViewChanges","readwrite",(_=>z.forEach(p,(x=>z.forEach(x.Is,(S=>v.persistence.referenceDelegate.addReference(_,x.targetId,S))).next((()=>z.forEach(x.ds,(S=>v.persistence.referenceDelegate.removeReference(_,x.targetId,S)))))))))}catch(_){if(!hs(_))throw _;ne(kg,"Failed to update sequence numbers: "+_)}for(const _ of p){const x=_.targetId;if(!_.fromCache){const S=v.Fs.get(x),N=S.snapshotVersion,P=S.withLastLimboFreeSnapshotVersion(N);v.Fs=v.Fs.insert(x,P)}}})(r.localStore,a))}async function RP(n,e){const t=be(n);if(!t.currentUser.isEqual(e)){ne(Mg,"User change. New user:",e.toKey());const r=await fx(t.localStore,e);t.currentUser=e,(function(a,l){a.Vu.forEach((d=>{d.forEach((f=>{f.reject(new oe(Y.CANCELLED,l))}))})),a.Vu.clear()})(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Ju(t,r.Bs)}}function CP(n,e){const t=be(n),r=t.Eu.get(e);if(r&&r.lu)return Re().add(r.key);{let s=Re();const a=t.Tu.get(e);if(!a)return s;for(const l of a){const d=t.Pu.get(l);s=s.unionWith(d.view.tu)}return s}}function Px(n){const e=be(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=bx.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=CP.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=SP.bind(null,e),e.hu.J_=fP.bind(null,e.eventManager),e.hu.pu=pP.bind(null,e.eventManager),e}function Nx(n){const e=be(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=kP.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=bP.bind(null,e),e}class ju{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=qh(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,t){return null}Fu(e,t){return null}vu(e){return hx(this.persistence,new dx,e.initialUser,this.serializer)}Du(e){return new xg($h.Vi,this.serializer)}bu(e){return new mx}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}ju.provider={build:()=>new ju};class PP extends ju{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,t){ve(this.persistence.referenceDelegate instanceof ch,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new ox(r,e.asyncQueue,t)}Du(e){const t=this.cacheSizeBytes!==void 0?Gt.withCacheSize(this.cacheSizeBytes):Gt.DEFAULT;return new xg((r=>ch.Vi(r,t)),this.serializer)}}class NP extends ju{constructor(e,t,r){super(),this.Mu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Mu.initialize(this,e),await Nx(this.Mu.syncEngine),await Xu(this.Mu.remoteStore),await this.persistence.ji((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}vu(e){return hx(this.persistence,new dx,e.initialUser,this.serializer)}Cu(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new ox(r,e.asyncQueue,t)}Fu(e,t){const r=new FA(t,this.persistence);return new jA(e.asyncQueue,r)}Du(e){const t=NC(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Gt.withCacheSize(this.cacheSizeBytes):Gt.DEFAULT;return new Tg(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,GC(),zd(),this.serializer,this.sharedClientState,!!this.forceOwnership)}bu(e){return new mx}}class hh{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>c0(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=RP.bind(null,this.syncEngine),await cP(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return(function(){return new hP})()}createDatastore(e){const t=qh(e.databaseInfo.databaseId),r=(function(a){return new WC(a)})(e.databaseInfo);return(function(a,l,d,f){return new XC(a,l,d,f)})(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return(function(r,s,a,l,d){return new ZC(r,s,a,l,d)})(this.localStore,this.datastore,e.asyncQueue,(t=>c0(this.syncEngine,t,0)),(function(){return i0.C()?new i0:new zC})())}createSyncEngine(e,t){return(function(s,a,l,d,f,p,v){const _=new vP(s,a,l,d,f,p);return v&&(_.fu=!0),_})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await(async function(s){const a=be(s);ne(ho,"RemoteStore shutting down."),a.Ia.add(5),await Yu(a),a.Ea.shutdown(),a.Aa.set("Unknown")})(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}hh.provider={build:()=>new hh};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fg{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):tn("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const us="FirestoreClient";class DP{constructor(e,t,r,s,a){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=s,this.user=Ut.UNAUTHENTICATED,this.clientId=rg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=a,this.authCredentials.start(r,(async l=>{ne(us,"Received user=",l.uid),await this.authCredentialListener(l),this.user=l})),this.appCheckCredentials.start(r,(l=>(ne(us,"Received new app check token=",l),this.appCheckCredentialListener(l,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Nr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=Ng(t,"Failed to shutdown persistence");e.reject(r)}})),e.promise}}async function Xp(n,e){n.asyncQueue.verifyOperationInProgress(),ne(us,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener((async s=>{r.isEqual(s)||(await fx(e.localStore,s),r=s)})),e.persistence.setDatabaseDeletedListener((()=>{Mr("Terminating Firestore due to IndexedDb database deletion"),n.terminate().then((()=>{ne("Terminating Firestore due to IndexedDb database deletion completed successfully")})).catch((s=>{Mr("Terminating Firestore due to IndexedDb database deletion failed",s)}))})),n._offlineComponents=e}async function h0(n,e){n.asyncQueue.verifyOperationInProgress();const t=await VP(n);ne(us,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener((r=>o0(e.remoteStore,r))),n.setAppCheckTokenChangeListener(((r,s)=>o0(e.remoteStore,s))),n._onlineComponents=e}async function VP(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){ne(us,"Using user provided OfflineComponentProvider");try{await Xp(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!(function(s){return s.name==="FirebaseError"?s.code===Y.FAILED_PRECONDITION||s.code===Y.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11})(t))throw t;Mr("Error using user provided cache. Falling back to memory cache: "+t),await Xp(n,new ju)}}else ne(us,"Using default OfflineComponentProvider"),await Xp(n,new PP(void 0));return n._offlineComponents}async function Dx(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(ne(us,"Using user provided OnlineComponentProvider"),await h0(n,n._uninitializedComponentsProvider._online)):(ne(us,"Using default OnlineComponentProvider"),await h0(n,new hh))),n._onlineComponents}function OP(n){return Dx(n).then((e=>e.syncEngine))}async function fh(n){const e=await Dx(n),t=e.eventManager;return t.onListen=_P.bind(null,e.syncEngine),t.onUnlisten=IP.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=wP.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=xP.bind(null,e.syncEngine),t}function LP(n,e,t={}){const r=new Nr;return n.asyncQueue.enqueueAndForget((async()=>(function(a,l,d,f,p){const v=new Fg({next:x=>{v.Ou(),l.enqueueAndForget((()=>Vg(a,_)));const S=x.docs.has(d);!S&&x.fromCache?p.reject(new oe(Y.UNAVAILABLE,"Failed to get document because the client is offline.")):S&&x.fromCache&&f&&f.source==="server"?p.reject(new oe(Y.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):p.resolve(x)},error:x=>p.reject(x)}),_=new Lg(Gu(d.path),v,{includeMetadataChanges:!0,ka:!0});return Dg(a,_)})(await fh(n),n.asyncQueue,e,t,r))),r.promise}function MP(n,e,t={}){const r=new Nr;return n.asyncQueue.enqueueAndForget((async()=>(function(a,l,d,f,p){const v=new Fg({next:x=>{v.Ou(),l.enqueueAndForget((()=>Vg(a,_))),x.fromCache&&f.source==="server"?p.reject(new oe(Y.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):p.resolve(x)},error:x=>p.reject(x)}),_=new Lg(d,v,{includeMetadataChanges:!0,ka:!0});return Dg(a,_)})(await fh(n),n.asyncQueue,e,t,r))),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vx(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f0=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ox="firestore.googleapis.com",p0=!0;class m0{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new oe(Y.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Ox,this.ssl=p0}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:p0;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=nx;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<mC)throw new oe(Y.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}DA("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Vx((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),(function(a){if(a.timeoutSeconds!==void 0){if(isNaN(a.timeoutSeconds))throw new oe(Y.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (must not be NaN)`);if(a.timeoutSeconds<5)throw new oe(Y.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (minimum allowed value is 5)`);if(a.timeoutSeconds>30)throw new oe(Y.INVALID_ARGUMENT,`invalid long polling timeout: ${a.timeoutSeconds} (maximum allowed value is 30)`)}})(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&(function(r,s){return r.timeoutSeconds===s.timeoutSeconds})(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Wh{constructor(e,t,r,s){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new m0({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new oe(Y.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new oe(Y.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new m0(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=(function(r){if(!r)return new TA;switch(r.type){case"firstParty":return new AA(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new oe(Y.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(t){const r=f0.get(t);r&&(ne("ComponentProvider","Removing Datastore"),f0.delete(t),r.terminate())})(this),Promise.resolve()}}function jP(n,e,t,r={}){var s;n=nn(n,Wh);const a=Ya(e),l=n._getSettings(),d=Object.assign(Object.assign({},l),{emulatorOptions:n._getEmulatorOptions()}),f=`${e}:${t}`;a&&(EE(`https://${f}`),IE("Firestore",!0)),l.host!==Ox&&l.host!==f&&Mr("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const p=Object.assign(Object.assign({},l),{host:f,ssl:a,emulatorOptions:r});if(!ss(p,d)&&(n._setSettings(p),r.mockUserToken)){let v,_;if(typeof r.mockUserToken=="string")v=r.mockUserToken,_=Ut.MOCK_USER;else{v=Z1(r.mockUserToken,(s=n._app)===null||s===void 0?void 0:s.options.projectId);const x=r.mockUserToken.sub||r.mockUserToken.user_id;if(!x)throw new oe(Y.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");_=new Ut(x)}n._authCredentials=new SA(new UE(v,_))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yi{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new yi(this.firestore,e,this._query)}}class ft{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new is(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ft(this.firestore,e,this._key)}toJSON(){return{type:ft._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(qu(t,ft._jsonSchema))return new ft(e,r||null,new ue($e.fromString(t.referencePath)))}}ft._jsonSchemaVersion="firestore/documentReference/1.0",ft._jsonSchema={type:_t("string",ft._jsonSchemaVersion),referencePath:_t("string")};class is extends yi{constructor(e,t,r){super(e,t,Gu(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ft(this.firestore,null,new ue(e))}withConverter(e){return new is(this.firestore,e,this._path)}}function kn(n,e,...t){if(n=Et(n),$E("collection","path",e),n instanceof Wh){const r=$e.fromString(e,...t);return sw(r),new is(n,null,r)}{if(!(n instanceof ft||n instanceof is))throw new oe(Y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child($e.fromString(e,...t));return sw(r),new is(n.firestore,null,r)}}function zn(n,e,...t){if(n=Et(n),arguments.length===1&&(e=rg.newId()),$E("doc","path",e),n instanceof Wh){const r=$e.fromString(e,...t);return iw(r),new ft(n,null,new ue(r))}{if(!(n instanceof ft||n instanceof is))throw new oe(Y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child($e.fromString(e,...t));return iw(r),new ft(n.firestore,n instanceof is?n.converter:null,new ue(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g0="AsyncQueue";class y0{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new gx(this,"async_queue_retry"),this.oc=()=>{const r=zd();r&&ne(g0,"Visibility state changed to "+r.visibilityState),this.F_.y_()},this._c=e;const t=zd();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const t=zd();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise((()=>{}));const t=new Nr;return this.uc((()=>this.Xu&&this.rc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Zu.push(e),this.cc())))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!hs(e))throw e;ne(g0,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_((()=>this.cc()))}}uc(e){const t=this._c.then((()=>(this.nc=!0,e().catch((r=>{throw this.tc=r,this.nc=!1,tn("INTERNAL UNHANDLED ERROR: ",v0(r)),r})).then((r=>(this.nc=!1,r))))));return this._c=t,t}enqueueAfterDelay(e,t,r){this.ac(),this.sc.indexOf(e)>-1&&(t=0);const s=Pg.createAndSchedule(this,e,t,r,(a=>this.lc(a)));return this.ec.push(s),s}ac(){this.tc&&me(47125,{hc:v0(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(const t of this.ec)if(t.timerId===e)return!0;return!1}Ic(e){return this.Pc().then((()=>{this.ec.sort(((t,r)=>t.targetTimeMs-r.targetTimeMs));for(const t of this.ec)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.Pc()}))}dc(e){this.sc.push(e)}lc(e){const t=this.ec.indexOf(e);this.ec.splice(t,1)}}function v0(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _0(n){return(function(t,r){if(typeof t!="object"||t===null)return!1;const s=t;for(const a of r)if(a in s&&typeof s[a]=="function")return!0;return!1})(n,["next","error","complete"])}class Fr extends Wh{constructor(e,t,r,s){super(e,t,r,s),this.type="firestore",this._queue=new y0,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new y0(e),this._firestoreClient=void 0,await e}}}function FP(n,e){const t=typeof n=="object"?n:tg(),r=typeof n=="string"?n:th,s=vo(t,"firestore").getImmediate({identifier:r});if(!s._initialized){const a=X1("firestore");a&&jP(s,...a)}return s}function Gh(n){if(n._terminated)throw new oe(Y.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||Lx(n),n._firestoreClient}function Lx(n){var e,t,r;const s=n._freezeSettings(),a=(function(d,f,p,v){return new pR(d,f,p,v.host,v.ssl,v.experimentalForceLongPolling,v.experimentalAutoDetectLongPolling,Vx(v.experimentalLongPollingOptions),v.useFetchStreams,v.isUsingEmulator)})(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,s);n._componentsProvider||!((t=s.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),n._firestoreClient=new DP(n._authCredentials,n._appCheckCredentials,n._queue,a,n._componentsProvider&&(function(d){const f=d==null?void 0:d._online.build();return{_offline:d==null?void 0:d._offline.build(f),_online:f}})(n._componentsProvider))}function UP(n,e){Mr("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return BP(n,hh.provider,{build:r=>new NP(r,t.cacheSizeBytes,void 0)}),Promise.resolve()}function BP(n,e,t){if((n=nn(n,Fr))._firestoreClient||n._terminated)throw new oe(Y.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new oe(Y.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},Lx(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mn{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Mn(It.fromBase64String(e))}catch(t){throw new oe(Y.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Mn(It.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:Mn._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(qu(e,Mn._jsonSchema))return Mn.fromBase64String(e.bytes)}}Mn._jsonSchemaVersion="firestore/bytes/1.0",Mn._jsonSchema={type:_t("string",Mn._jsonSchemaVersion),bytes:_t("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kh{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new oe(Y.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ct(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qh{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dr{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new oe(Y.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new oe(Y.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return Te(this._lat,e._lat)||Te(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Dr._jsonSchemaVersion}}static fromJSON(e){if(qu(e,Dr._jsonSchema))return new Dr(e.latitude,e.longitude)}}Dr._jsonSchemaVersion="firestore/geoPoint/1.0",Dr._jsonSchema={type:_t("string",Dr._jsonSchemaVersion),latitude:_t("number"),longitude:_t("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vr{constructor(e){this._values=(e||[]).map((t=>t))}toArray(){return this._values.map((e=>e))}isEqual(e){return(function(r,s){if(r.length!==s.length)return!1;for(let a=0;a<r.length;++a)if(r[a]!==s[a])return!1;return!0})(this._values,e._values)}toJSON(){return{type:Vr._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(qu(e,Vr._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((t=>typeof t=="number")))return new Vr(e.vectorValues);throw new oe(Y.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Vr._jsonSchemaVersion="firestore/vectorValue/1.0",Vr._jsonSchema={type:_t("string",Vr._jsonSchemaVersion),vectorValues:_t("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zP=/^__.*__$/;class $P{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new gi(e,this.data,this.fieldMask,t,this.fieldTransforms):new el(e,this.data,t,this.fieldTransforms)}}class Mx{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new gi(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function jx(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw me(40011,{Ec:n})}}class Ug{constructor(e,t,r,s,a,l){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=s,a===void 0&&this.Ac(),this.fieldTransforms=a||[],this.fieldMask=l||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new Ug(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Rc({path:r,mc:!1});return s.fc(e),s}gc(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),s=this.Rc({path:r,mc:!1});return s.Ac(),s}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return ph(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find((t=>e.isPrefixOf(t)))!==void 0||this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(jx(this.Ec)&&zP.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class qP{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||qh(e)}Dc(e,t,r,s=!1){return new Ug({Ec:e,methodName:t,bc:r,path:ct.emptyPath(),mc:!1,Sc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Yh(n){const e=n._freezeSettings(),t=qh(n._databaseId);return new qP(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Fx(n,e,t,r,s,a={}){const l=n.Dc(a.merge||a.mergeFields?2:0,e,t,s);zg("Data must be an object, but it was:",l,r);const d=Ux(r,l);let f,p;if(a.merge)f=new fn(l.fieldMask),p=l.fieldTransforms;else if(a.mergeFields){const v=[];for(const _ of a.mergeFields){const x=Vm(e,_,t);if(!l.contains(x))throw new oe(Y.INVALID_ARGUMENT,`Field '${x}' is specified in your field mask but missing from your input data.`);zx(v,x)||v.push(x)}f=new fn(v),p=l.fieldTransforms.filter((_=>f.covers(_.field)))}else f=null,p=l.fieldTransforms;return new $P(new Kt(d),f,p)}class Xh extends Qh{_toFieldTransform(e){if(e.Ec!==2)throw e.Ec===1?e.wc(`${this._methodName}() can only appear at the top level of your update data`):e.wc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Xh}}class Bg extends Qh{_toFieldTransform(e){return new DI(e.path,new Fa)}isEqual(e){return e instanceof Bg}}function HP(n,e,t,r){const s=n.Dc(1,e,t);zg("Data must be an object, but it was:",s,r);const a=[],l=Kt.empty();fs(r,((f,p)=>{const v=$g(e,f,t);p=Et(p);const _=s.gc(v);if(p instanceof Xh)a.push(v);else{const x=Zu(p,_);x!=null&&(a.push(v),l.set(v,x))}}));const d=new fn(a);return new Mx(l,d,s.fieldTransforms)}function WP(n,e,t,r,s,a){const l=n.Dc(1,e,t),d=[Vm(e,r,t)],f=[s];if(a.length%2!=0)throw new oe(Y.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let x=0;x<a.length;x+=2)d.push(Vm(e,a[x])),f.push(a[x+1]);const p=[],v=Kt.empty();for(let x=d.length-1;x>=0;--x)if(!zx(p,d[x])){const S=d[x];let N=f[x];N=Et(N);const P=l.gc(S);if(N instanceof Xh)p.push(S);else{const O=Zu(N,P);O!=null&&(p.push(S),v.set(S,O))}}const _=new fn(p);return new Mx(v,_,l.fieldTransforms)}function GP(n,e,t,r=!1){return Zu(t,n.Dc(r?4:3,e))}function Zu(n,e){if(Bx(n=Et(n)))return zg("Unsupported field value:",e,n),Ux(n,e);if(n instanceof Qh)return(function(r,s){if(!jx(s.Ec))throw s.wc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.wc(`${r._methodName}() is not currently supported inside arrays`);const a=r._toFieldTransform(s);a&&s.fieldTransforms.push(a)})(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return(function(r,s){const a=[];let l=0;for(const d of r){let f=Zu(d,s.yc(l));f==null&&(f={nullValue:"NULL_VALUE"}),a.push(f),l++}return{arrayValue:{values:a}}})(n,e)}return(function(r,s){if((r=Et(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return VR(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const a=He.fromDate(r);return{timestampValue:za(s.serializer,a)}}if(r instanceof He){const a=new He(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:za(s.serializer,a)}}if(r instanceof Dr)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Mn)return{bytesValue:UI(s.serializer,r._byteString)};if(r instanceof ft){const a=s.databaseId,l=r.firestore._databaseId;if(!l.isEqual(a))throw s.wc(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${a.projectId}/${a.database}`);return{referenceValue:_g(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Vr)return(function(l,d){return{mapValue:{fields:{[dg]:{stringValue:hg},[Oa]:{arrayValue:{values:l.toArray().map((p=>{if(typeof p!="number")throw d.wc("VectorValues must only contain numeric values.");return pg(d.serializer,p)}))}}}}}})(r,s);throw s.wc(`Unsupported field value: ${Ah(r)}`)})(n,e)}function Ux(n,e){const t={};return sI(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):fs(n,((r,s)=>{const a=Zu(s,e.Vc(r));a!=null&&(t[r]=a)})),{mapValue:{fields:t}}}function Bx(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof He||n instanceof Dr||n instanceof Mn||n instanceof ft||n instanceof Qh||n instanceof Vr)}function zg(n,e,t){if(!Bx(t)||!qE(t)){const r=Ah(t);throw r==="an object"?e.wc(n+" a custom object"):e.wc(n+" "+r)}}function Vm(n,e,t){if((e=Et(e))instanceof Kh)return e._internalPath;if(typeof e=="string")return $g(n,e);throw ph("Field path arguments must be of type string or ",n,!1,void 0,t)}const KP=new RegExp("[~\\*/\\[\\]]");function $g(n,e,t){if(e.search(KP)>=0)throw ph(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Kh(...e.split("."))._internalPath}catch{throw ph(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function ph(n,e,t,r,s){const a=r&&!r.isEmpty(),l=s!==void 0;let d=`Function ${e}() called with invalid data`;t&&(d+=" (via `toFirestore()`)"),d+=". ";let f="";return(a||l)&&(f+=" (found",a&&(f+=` in field ${r}`),l&&(f+=` in document ${s}`),f+=")"),new oe(Y.INVALID_ARGUMENT,d+n+f)}function zx(n,e){return n.some((t=>t.isEqual(e)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $x{constructor(e,t,r,s,a){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=s,this._converter=a}get id(){return this._key.path.lastSegment()}get ref(){return new ft(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new QP(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Jh("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class QP extends $x{data(){return super.data()}}function Jh(n,e){return typeof e=="string"?$g(n,e):e instanceof Kh?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qx(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new oe(Y.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class qg{}class Hg extends qg{}function pr(n,e,...t){let r=[];e instanceof qg&&r.push(e),r=r.concat(t),(function(a){const l=a.filter((f=>f instanceof Wg)).length,d=a.filter((f=>f instanceof Zh)).length;if(l>1||l>0&&d>0)throw new oe(Y.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")})(r);for(const s of r)n=s._apply(n);return n}class Zh extends Hg{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new Zh(e,t,r)}_apply(e){const t=this._parse(e);return Hx(e._query,t),new yi(e.firestore,e.converter,Im(e._query,t))}_parse(e){const t=Yh(e.firestore);return(function(a,l,d,f,p,v,_){let x;if(p.isKeyField()){if(v==="array-contains"||v==="array-contains-any")throw new oe(Y.INVALID_ARGUMENT,`Invalid Query. You can't perform '${v}' queries on documentId().`);if(v==="in"||v==="not-in"){E0(_,v);const N=[];for(const P of _)N.push(w0(f,a,P));x={arrayValue:{values:N}}}else x=w0(f,a,_)}else v!=="in"&&v!=="not-in"&&v!=="array-contains-any"||E0(_,v),x=GP(d,l,_,v==="in"||v==="not-in");return De.create(p,v,x)})(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function wt(n,e,t){const r=e,s=Jh("where",n);return Zh._create(s,r,t)}class Wg extends qg{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Wg(e,t)}_parse(e){const t=this._queryConstraints.map((r=>r._parse(e))).filter((r=>r.getFilters().length>0));return t.length===1?t[0]:We.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:((function(s,a){let l=s;const d=a.getFlattenedFilters();for(const f of d)Hx(l,f),l=Im(l,f)})(e._query,t),new yi(e.firestore,e.converter,Im(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Gg extends Hg{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Gg(e,t)}_apply(e){const t=(function(s,a,l){if(s.startAt!==null)throw new oe(Y.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new oe(Y.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Lu(a,l)})(e._query,this._field,this._direction);return new yi(e.firestore,e.converter,(function(s,a){const l=s.explicitOrderBy.concat([a]);return new Za(s.path,s.collectionGroup,l,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)})(e._query,t))}}function nl(n,e="asc"){const t=e,r=Jh("orderBy",n);return Gg._create(r,t)}class Kg extends Hg{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new Kg(e,t,r)}_apply(e){return new yi(e.firestore,e.converter,ih(e._query,this._limit,this._limitType))}}function YP(n){return VA("limit",n),Kg._create("limit",n,"F")}function w0(n,e,t){if(typeof(t=Et(t))=="string"){if(t==="")throw new oe(Y.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!II(e)&&t.indexOf("/")!==-1)throw new oe(Y.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child($e.fromString(t));if(!ue.isDocumentKey(r))throw new oe(Y.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Vu(n,new ue(r))}if(t instanceof ft)return Vu(n,t._key);throw new oe(Y.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Ah(t)}.`)}function E0(n,e){if(!Array.isArray(n)||n.length===0)throw new oe(Y.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Hx(n,e){const t=(function(s,a){for(const l of s)for(const d of l.getFlattenedFilters())if(a.indexOf(d.op)>=0)return d.op;return null})(n.filters,(function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}})(e.op));if(t!==null)throw t===e.op?new oe(Y.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new oe(Y.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class XP{convertValue(e,t="none"){switch(os(e)){case 0:return null;case 1:return e.booleanValue;case 2:return st(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(fi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw me(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return fs(e,((s,a)=>{r[s]=this.convertValue(a,t)})),r}convertVectorValue(e){var t,r,s;const a=(s=(r=(t=e.fields)===null||t===void 0?void 0:t[Oa].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map((l=>st(l.doubleValue)));return new Vr(a)}convertGeoPoint(e){return new Dr(st(e.latitude),st(e.longitude))}convertArray(e,t){return(e.values||[]).map((r=>this.convertValue(r,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const r=Vh(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Nu(e));default:return null}}convertTimestamp(e){const t=hi(e);return new He(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=$e.fromString(e);ve(YI(r),9688,{name:e});const s=new oo(r.get(1),r.get(3)),a=new ue(r.popFirst(5));return s.isEqual(t)||tn(`Document ${a} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wx(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}class hu{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class no extends $x{constructor(e,t,r,s,a,l){super(e,t,r,s,l),this._firestore=e,this._firestoreImpl=e,this.metadata=a}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new $d(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Jh("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new oe(Y.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=no._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?t:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t)}}no._jsonSchemaVersion="firestore/documentSnapshot/1.0",no._jsonSchema={type:_t("string",no._jsonSchemaVersion),bundleSource:_t("string","DocumentSnapshot"),bundleName:_t("string"),bundle:_t("string")};class $d extends no{data(e={}){return super.data(e)}}class ro{constructor(e,t,r,s){this._firestore=e,this._userDataWriter=t,this._snapshot=s,this.metadata=new hu(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach((r=>{e.call(t,new $d(this._firestore,this._userDataWriter,r.key,r,new hu(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new oe(Y.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=(function(s,a){if(s._snapshot.oldDocs.isEmpty()){let l=0;return s._snapshot.docChanges.map((d=>{const f=new $d(s._firestore,s._userDataWriter,d.doc.key,d.doc,new hu(s._snapshot.mutatedKeys.has(d.doc.key),s._snapshot.fromCache),s.query.converter);return d.doc,{type:"added",doc:f,oldIndex:-1,newIndex:l++}}))}{let l=s._snapshot.oldDocs;return s._snapshot.docChanges.filter((d=>a||d.type!==3)).map((d=>{const f=new $d(s._firestore,s._userDataWriter,d.doc.key,d.doc,new hu(s._snapshot.mutatedKeys.has(d.doc.key),s._snapshot.fromCache),s.query.converter);let p=-1,v=-1;return d.type!==0&&(p=l.indexOf(d.doc.key),l=l.delete(d.doc.key)),d.type!==1&&(l=l.add(d.doc),v=l.indexOf(d.doc.key)),{type:JP(d.type),doc:f,oldIndex:p,newIndex:v}}))}})(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new oe(Y.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ro._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=rg.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],r=[],s=[];return this.docs.forEach((a=>{a._document!==null&&(t.push(a._document),r.push(this._userDataWriter.convertObjectMap(a._document.data.value.mapValue.fields,"previous")),s.push(a.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function JP(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return me(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qa(n){n=nn(n,ft);const e=nn(n.firestore,Fr);return LP(Gh(e),n._key).then((t=>Yx(e,n,t)))}ro._jsonSchemaVersion="firestore/querySnapshot/1.0",ro._jsonSchema={type:_t("string",ro._jsonSchemaVersion),bundleSource:_t("string","QuerySnapshot"),bundleName:_t("string"),bundle:_t("string")};class Qg extends XP{constructor(e){super(),this.firestore=e}convertBytes(e){return new Mn(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ft(this.firestore,null,t)}}function vi(n){n=nn(n,yi);const e=nn(n.firestore,Fr),t=Gh(e),r=new Qg(e);return qx(n._query),MP(t,n._query).then((s=>new ro(e,r,n,s)))}function Yg(n,e,t){n=nn(n,ft);const r=nn(n.firestore,Fr),s=Wx(n.converter,e,t);return ef(r,[Fx(Yh(r),"setDoc",n._key,s,n.converter!==null,t).toMutation(n._key,Qt.none())])}function Gx(n,e,t,...r){n=nn(n,ft);const s=nn(n.firestore,Fr),a=Yh(s);let l;return l=typeof(e=Et(e))=="string"||e instanceof Kh?WP(a,"updateDoc",n._key,e,t,r):HP(a,"updateDoc",n._key,e),ef(s,[l.toMutation(n._key,Qt.exists(!0))])}function Xg(n){return ef(nn(n.firestore,Fr),[new Fh(n._key,Qt.none())])}function Kx(n,e){const t=nn(n.firestore,Fr),r=zn(n),s=Wx(n.converter,e);return ef(t,[Fx(Yh(n.firestore),"addDoc",r._key,s,n.converter!==null,{}).toMutation(r._key,Qt.exists(!1))]).then((()=>r))}function Qx(n,...e){var t,r,s;n=Et(n);let a={includeMetadataChanges:!1,source:"default"},l=0;typeof e[l]!="object"||_0(e[l])||(a=e[l++]);const d={includeMetadataChanges:a.includeMetadataChanges,source:a.source};if(_0(e[l])){const _=e[l];e[l]=(t=_.next)===null||t===void 0?void 0:t.bind(_),e[l+1]=(r=_.error)===null||r===void 0?void 0:r.bind(_),e[l+2]=(s=_.complete)===null||s===void 0?void 0:s.bind(_)}let f,p,v;if(n instanceof ft)p=nn(n.firestore,Fr),v=Gu(n._key.path),f={next:_=>{e[l]&&e[l](Yx(p,n,_))},error:e[l+1],complete:e[l+2]};else{const _=nn(n,yi);p=nn(_.firestore,Fr),v=_._query;const x=new Qg(p);f={next:S=>{e[l]&&e[l](new ro(p,x,_,S))},error:e[l+1],complete:e[l+2]},qx(n._query)}return(function(x,S,N,P){const O=new Fg(P),K=new Lg(S,O,N);return x.asyncQueue.enqueueAndForget((async()=>Dg(await fh(x),K))),()=>{O.Ou(),x.asyncQueue.enqueueAndForget((async()=>Vg(await fh(x),K)))}})(Gh(p),v,d,f)}function ef(n,e){return(function(r,s){const a=new Nr;return r.asyncQueue.enqueueAndForget((async()=>TP(await OP(r),s,a))),a.promise})(Gh(n),e)}function Yx(n,e,t){const r=t.docs.get(e._key),s=new Qg(n);return new no(n,s,e._key,r,new hu(t.hasPendingWrites,t.fromCache),e.converter)}function Fu(){return new Bg("serverTimestamp")}(function(e,t=!0){(function(s){Ja=s})(Xa),Lr(new dr("firestore",((r,{instanceIdentifier:s,options:a})=>{const l=r.getProvider("app").getImmediate(),d=new Fr(new kA(r.getProvider("auth-internal")),new RA(l,r.getProvider("app-check-internal")),(function(p,v){if(!Object.prototype.hasOwnProperty.apply(p.options,["projectId"]))throw new oe(Y.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new oo(p.options.projectId,v)})(l,s),l);return a=Object.assign({useFetchStreams:t},a),d._setSettings(a),d}),"PUBLIC").setMultipleInstances(!0)),Fn(Z_,ew,e),Fn(Z_,ew,"esm2017")})();var ZP="firebase",eN="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Fn(ZP,eN,"app");function Jg(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t}function Xx(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const tN=Xx,Jx=new yo("auth","Firebase",Xx());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mh=new bh("@firebase/auth");function nN(n,...e){mh.logLevel<=Ne.WARN&&mh.warn(`Auth (${Xa}): ${n}`,...e)}function qd(n,...e){mh.logLevel<=Ne.ERROR&&mh.error(`Auth (${Xa}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ur(n,...e){throw ey(n,...e)}function cr(n,...e){return ey(n,...e)}function Zg(n,e,t){const r=Object.assign(Object.assign({},tN()),{[e]:t});return new yo("auth","Firebase",r).create(e,{appName:n.name})}function io(n){return Zg(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function rN(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&Ur(n,"argument-error"),Zg(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function ey(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return Jx.create(n,...e)}function ke(n,e,...t){if(!n)throw ey(e,...t)}function oi(n){const e="INTERNAL ASSERTION FAILED: "+n;throw qd(e),new Error(e)}function pi(n,e){n||oi(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Om(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function iN(){return I0()==="http:"||I0()==="https:"}function I0(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sN(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(iN()||Jm()||"connection"in navigator)?navigator.onLine:!0}function oN(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ec{constructor(e,t){this.shortDelay=e,this.longDelay=t,pi(t>e,"Short delay should be less than long delay!"),this.isMobile=nb()||ib()}get(){return sN()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ty(n,e){pi(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zx{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;oi("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;oi("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;oi("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aN={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lN=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],uN=new ec(3e4,6e4);function ny(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function rl(n,e,t,r,s={}){return eT(n,s,async()=>{let a={},l={};r&&(e==="GET"?l=r:a={body:JSON.stringify(r)});const d=$u(Object.assign({key:n.config.apiKey},l)).slice(1),f=await n._getAdditionalHeaders();f["Content-Type"]="application/json",n.languageCode&&(f["X-Firebase-Locale"]=n.languageCode);const p=Object.assign({method:e,headers:f},a);return rb()||(p.referrerPolicy="no-referrer"),n.emulatorConfig&&Ya(n.emulatorConfig.host)&&(p.credentials="include"),Zx.fetch()(await tT(n,n.config.apiHost,t,d),p)})}async function eT(n,e,t){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},aN),e);try{const s=new dN(n),a=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const l=await a.json();if("needConfirmation"in l)throw Ad(n,"account-exists-with-different-credential",l);if(a.ok&&!("errorMessage"in l))return l;{const d=a.ok?l.errorMessage:l.error.message,[f,p]=d.split(" : ");if(f==="FEDERATED_USER_ID_ALREADY_LINKED")throw Ad(n,"credential-already-in-use",l);if(f==="EMAIL_EXISTS")throw Ad(n,"email-already-in-use",l);if(f==="USER_DISABLED")throw Ad(n,"user-disabled",l);const v=r[f]||f.toLowerCase().replace(/[_\s]+/g,"-");if(p)throw Zg(n,v,p);Ur(n,v)}}catch(s){if(s instanceof fr)throw s;Ur(n,"network-request-failed",{message:String(s)})}}async function cN(n,e,t,r,s={}){const a=await rl(n,e,t,r,s);return"mfaPendingCredential"in a&&Ur(n,"multi-factor-auth-required",{_serverResponse:a}),a}async function tT(n,e,t,r){const s=`${e}${t}?${r}`,a=n,l=a.config.emulator?ty(n.config,s):`${n.config.apiScheme}://${s}`;return lN.includes(t)&&(await a._persistenceManagerAvailable,a._getPersistenceType()==="COOKIE")?a._getPersistence()._getFinalTarget(l).toString():l}class dN{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(cr(this.auth,"network-request-failed")),uN.get())})}}function Ad(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const s=cr(n,e,r);return s.customData._tokenResponse=t,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hN(n,e){return rl(n,"POST","/v1/accounts:delete",e)}async function gh(n,e){return rl(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iu(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function fN(n,e=!1){const t=Et(n),r=await t.getIdToken(e),s=ry(r);ke(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const a=typeof s.firebase=="object"?s.firebase:void 0,l=a==null?void 0:a.sign_in_provider;return{claims:s,token:r,authTime:Iu(Jp(s.auth_time)),issuedAtTime:Iu(Jp(s.iat)),expirationTime:Iu(Jp(s.exp)),signInProvider:l||null,signInSecondFactor:(a==null?void 0:a.sign_in_second_factor)||null}}function Jp(n){return Number(n)*1e3}function ry(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return qd("JWT malformed, contained fewer than 3 sections"),null;try{const s=gE(t);return s?JSON.parse(s):(qd("Failed to decode base64 JWT payload"),null)}catch(s){return qd("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function x0(n){const e=ry(n);return ke(e,"internal-error"),ke(typeof e.exp<"u","internal-error"),ke(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Uu(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof fr&&pN(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function pN({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mN{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lm{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Iu(this.lastLoginAt),this.creationTime=Iu(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yh(n){var e;const t=n.auth,r=await n.getIdToken(),s=await Uu(n,gh(t,{idToken:r}));ke(s==null?void 0:s.users.length,t,"internal-error");const a=s.users[0];n._notifyReloadListener(a);const l=!((e=a.providerUserInfo)===null||e===void 0)&&e.length?nT(a.providerUserInfo):[],d=yN(n.providerData,l),f=n.isAnonymous,p=!(n.email&&a.passwordHash)&&!(d!=null&&d.length),v=f?p:!1,_={uid:a.localId,displayName:a.displayName||null,photoURL:a.photoUrl||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,tenantId:a.tenantId||null,providerData:d,metadata:new Lm(a.createdAt,a.lastLoginAt),isAnonymous:v};Object.assign(n,_)}async function gN(n){const e=Et(n);await yh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function yN(n,e){return[...n.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function nT(n){return n.map(e=>{var{providerId:t}=e,r=Jg(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function vN(n,e){const t=await eT(n,{},async()=>{const r=$u({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:a}=n.config,l=await tT(n,s,"/v1/token",`key=${a}`),d=await n._getAdditionalHeaders();d["Content-Type"]="application/x-www-form-urlencoded";const f={method:"POST",headers:d,body:r};return n.emulatorConfig&&Ya(n.emulatorConfig.host)&&(f.credentials="include"),Zx.fetch()(l,f)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function _N(n,e){return rl(n,"POST","/v2/accounts:revokeToken",ny(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ba{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ke(e.idToken,"internal-error"),ke(typeof e.idToken<"u","internal-error"),ke(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):x0(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){ke(e.length!==0,"internal-error");const t=x0(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(ke(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:s,expiresIn:a}=await vN(e,t);this.updateTokensAndExpiration(r,s,Number(a))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:s,expirationTime:a}=t,l=new ba;return r&&(ke(typeof r=="string","internal-error",{appName:e}),l.refreshToken=r),s&&(ke(typeof s=="string","internal-error",{appName:e}),l.accessToken=s),a&&(ke(typeof a=="number","internal-error",{appName:e}),l.expirationTime=a),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ba,this.toJSON())}_performRefresh(){return oi("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gi(n,e){ke(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class ur{constructor(e){var{uid:t,auth:r,stsTokenManager:s}=e,a=Jg(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new mN(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=a.displayName||null,this.email=a.email||null,this.emailVerified=a.emailVerified||!1,this.phoneNumber=a.phoneNumber||null,this.photoURL=a.photoURL||null,this.isAnonymous=a.isAnonymous||!1,this.tenantId=a.tenantId||null,this.providerData=a.providerData?[...a.providerData]:[],this.metadata=new Lm(a.createdAt||void 0,a.lastLoginAt||void 0)}async getIdToken(e){const t=await Uu(this,this.stsTokenManager.getToken(this.auth,e));return ke(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return fN(this,e)}reload(){return gN(this)}_assign(e){this!==e&&(ke(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new ur(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){ke(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await yh(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ar(this.auth.app))return Promise.reject(io(this.auth));const e=await this.getIdToken();return await Uu(this,hN(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,s,a,l,d,f,p,v;const _=(r=t.displayName)!==null&&r!==void 0?r:void 0,x=(s=t.email)!==null&&s!==void 0?s:void 0,S=(a=t.phoneNumber)!==null&&a!==void 0?a:void 0,N=(l=t.photoURL)!==null&&l!==void 0?l:void 0,P=(d=t.tenantId)!==null&&d!==void 0?d:void 0,O=(f=t._redirectEventId)!==null&&f!==void 0?f:void 0,K=(p=t.createdAt)!==null&&p!==void 0?p:void 0,Q=(v=t.lastLoginAt)!==null&&v!==void 0?v:void 0,{uid:H,emailVerified:se,isAnonymous:ce,providerData:re,stsTokenManager:C}=t;ke(H&&C,e,"internal-error");const k=ba.fromJSON(this.name,C);ke(typeof H=="string",e,"internal-error"),Gi(_,e.name),Gi(x,e.name),ke(typeof se=="boolean",e,"internal-error"),ke(typeof ce=="boolean",e,"internal-error"),Gi(S,e.name),Gi(N,e.name),Gi(P,e.name),Gi(O,e.name),Gi(K,e.name),Gi(Q,e.name);const A=new ur({uid:H,auth:e,email:x,emailVerified:se,displayName:_,isAnonymous:ce,photoURL:N,phoneNumber:S,tenantId:P,stsTokenManager:k,createdAt:K,lastLoginAt:Q});return re&&Array.isArray(re)&&(A.providerData=re.map(D=>Object.assign({},D))),O&&(A._redirectEventId=O),A}static async _fromIdTokenResponse(e,t,r=!1){const s=new ba;s.updateFromServerResponse(t);const a=new ur({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await yh(a),a}static async _fromGetAccountInfoResponse(e,t,r){const s=t.users[0];ke(s.localId!==void 0,"internal-error");const a=s.providerUserInfo!==void 0?nT(s.providerUserInfo):[],l=!(s.email&&s.passwordHash)&&!(a!=null&&a.length),d=new ba;d.updateFromIdToken(r);const f=new ur({uid:s.localId,auth:e,stsTokenManager:d,isAnonymous:l}),p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new Lm(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(a!=null&&a.length)};return Object.assign(f,p),f}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T0=new Map;function ai(n){pi(n instanceof Function,"Expected a class definition");let e=T0.get(n);return e?(pi(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,T0.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rT{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}rT.type="NONE";const S0=rT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hd(n,e,t){return`firebase:${n}:${e}:${t}`}class Aa{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:s,name:a}=this.auth;this.fullUserKey=Hd(this.userKey,s.apiKey,a),this.fullPersistenceKey=Hd("persistence",s.apiKey,a),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await gh(this.auth,{idToken:e}).catch(()=>{});return t?ur._fromGetAccountInfoResponse(this.auth,t,e):null}return ur._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new Aa(ai(S0),e,r);const s=(await Promise.all(t.map(async p=>{if(await p._isAvailable())return p}))).filter(p=>p);let a=s[0]||ai(S0);const l=Hd(r,e.config.apiKey,e.name);let d=null;for(const p of t)try{const v=await p._get(l);if(v){let _;if(typeof v=="string"){const x=await gh(e,{idToken:v}).catch(()=>{});if(!x)break;_=await ur._fromGetAccountInfoResponse(e,x,v)}else _=ur._fromJSON(e,v);p!==a&&(d=_),a=p;break}}catch{}const f=s.filter(p=>p._shouldAllowMigration);return!a._shouldAllowMigration||!f.length?new Aa(a,e,r):(a=f[0],d&&await a._set(l,d.toJSON()),await Promise.all(t.map(async p=>{if(p!==a)try{await p._remove(l)}catch{}})),new Aa(a,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k0(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(aT(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(iT(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(uT(e))return"Blackberry";if(cT(e))return"Webos";if(sT(e))return"Safari";if((e.includes("chrome/")||oT(e))&&!e.includes("edge/"))return"Chrome";if(lT(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function iT(n=At()){return/firefox\//i.test(n)}function sT(n=At()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function oT(n=At()){return/crios\//i.test(n)}function aT(n=At()){return/iemobile/i.test(n)}function lT(n=At()){return/android/i.test(n)}function uT(n=At()){return/blackberry/i.test(n)}function cT(n=At()){return/webos/i.test(n)}function iy(n=At()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function wN(n=At()){var e;return iy(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function EN(){return sb()&&document.documentMode===10}function dT(n=At()){return iy(n)||lT(n)||cT(n)||uT(n)||/windows phone/i.test(n)||aT(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hT(n,e=[]){let t;switch(n){case"Browser":t=k0(At());break;case"Worker":t=`${k0(At())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Xa}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IN{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=a=>new Promise((l,d)=>{try{const f=e(a);l(f)}catch(f){d(f)}});r.onAbort=t,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xN(n,e={}){return rl(n,"GET","/v2/passwordPolicy",ny(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TN=6;class SN{constructor(e){var t,r,s,a;const l=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=l.minPasswordLength)!==null&&t!==void 0?t:TN,l.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=l.maxPasswordLength),l.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=l.containsLowercaseCharacter),l.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=l.containsUppercaseCharacter),l.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=l.containsNumericCharacter),l.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=l.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(a=e.forceUpgradeOnSignin)!==null&&a!==void 0?a:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,s,a,l,d;const f={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,f),this.validatePasswordCharacterOptions(e,f),f.isValid&&(f.isValid=(t=f.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),f.isValid&&(f.isValid=(r=f.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),f.isValid&&(f.isValid=(s=f.containsLowercaseLetter)!==null&&s!==void 0?s:!0),f.isValid&&(f.isValid=(a=f.containsUppercaseLetter)!==null&&a!==void 0?a:!0),f.isValid&&(f.isValid=(l=f.containsNumericCharacter)!==null&&l!==void 0?l:!0),f.isValid&&(f.isValid=(d=f.containsNonAlphanumericCharacter)!==null&&d!==void 0?d:!0),f}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,s,a){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=a))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kN{constructor(e,t,r,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new b0(this),this.idTokenSubscription=new b0(this),this.beforeStateQueue=new IN(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Jx,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(a=>this._resolvePersistenceManagerAvailable=a)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ai(t)),this._initializationPromise=this.queue(async()=>{var r,s,a;if(!this._deleted&&(this.persistenceManager=await Aa.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((s=this._popupRedirectResolver)===null||s===void 0)&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((a=this.currentUser)===null||a===void 0?void 0:a.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await gh(this,{idToken:e}),r=await ur._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(ar(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(d=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(d,d))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,a=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,d=s==null?void 0:s._redirectEventId,f=await this.tryRedirectSignIn(e);(!l||l===d)&&(f!=null&&f.user)&&(s=f.user,a=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(a)try{await this.beforeStateQueue.runMiddleware(s)}catch(l){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return ke(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await yh(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=oN()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ar(this.app))return Promise.reject(io(this));const t=e?Et(e):null;return t&&ke(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&ke(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ar(this.app)?Promise.reject(io(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ar(this.app)?Promise.reject(io(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ai(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await xN(this),t=new SN(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new yo("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await _N(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&ai(e)||this._popupRedirectResolver;ke(t,this,"argument-error"),this.redirectPersistenceManager=await Aa.create(this,[ai(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,s){if(this._deleted)return()=>{};const a=typeof t=="function"?t:t.next.bind(t);let l=!1;const d=this._isInitialized?Promise.resolve():this._initializationPromise;if(ke(d,this,"internal-error"),d.then(()=>{l||a(this.currentUser)}),typeof t=="function"){const f=e.addObserver(t,r,s);return()=>{l=!0,f()}}else{const f=e.addObserver(t);return()=>{l=!0,f()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ke(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=hT(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(t["X-Firebase-AppCheck"]=s),t}async _getAppCheckToken(){var e;if(ar(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&nN(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function tf(n){return Et(n)}class b0{constructor(e){this.auth=e,this.observer=null,this.addObserver=cb(t=>this.observer=t)}get next(){return ke(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sy={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function bN(n){sy=n}function AN(n){return sy.loadJS(n)}function RN(){return sy.gapiScript}function CN(n){return`__${n}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PN(n,e){const t=vo(n,"auth");if(t.isInitialized()){const s=t.getImmediate(),a=t.getOptions();if(ss(a,e??{}))return s;Ur(s,"already-initialized")}return t.initialize({options:e})}function NN(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(ai);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function DN(n,e,t){const r=tf(n);ke(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,a=fT(e),{host:l,port:d}=VN(e),f=d===null?"":`:${d}`,p={url:`${a}//${l}${f}/`},v=Object.freeze({host:l,port:d,protocol:a.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){ke(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),ke(ss(p,r.config.emulator)&&ss(v,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=p,r.emulatorConfig=v,r.settings.appVerificationDisabledForTesting=!0,Ya(l)?(EE(`${a}//${l}${f}`),IE("Auth",!0)):ON()}function fT(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function VN(n){const e=fT(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const a=s[1];return{host:a,port:A0(r.substr(a.length+1))}}else{const[a,l]=r.split(":");return{host:a,port:A0(l)}}}function A0(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function ON(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pT{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return oi("not implemented")}_getIdTokenResponse(e){return oi("not implemented")}_linkToIdToken(e,t){return oi("not implemented")}_getReauthenticationResolver(e){return oi("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ra(n,e){return cN(n,"POST","/v1/accounts:signInWithIdp",ny(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LN="http://localhost";class fo extends pT{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new fo(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Ur("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=t,a=Jg(t,["providerId","signInMethod"]);if(!r||!s)return null;const l=new fo(r,s);return l.idToken=a.idToken||void 0,l.accessToken=a.accessToken||void 0,l.secret=a.secret,l.nonce=a.nonce,l.pendingToken=a.pendingToken||null,l}_getIdTokenResponse(e){const t=this.buildRequest();return Ra(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,Ra(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Ra(e,t)}buildRequest(){const e={requestUri:LN,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=$u(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oy{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tc extends oy{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yi extends tc{constructor(){super("facebook.com")}static credential(e){return fo._fromParams({providerId:Yi.PROVIDER_ID,signInMethod:Yi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Yi.credentialFromTaggedObject(e)}static credentialFromError(e){return Yi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Yi.credential(e.oauthAccessToken)}catch{return null}}}Yi.FACEBOOK_SIGN_IN_METHOD="facebook.com";Yi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lr extends tc{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return fo._fromParams({providerId:lr.PROVIDER_ID,signInMethod:lr.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return lr.credentialFromTaggedObject(e)}static credentialFromError(e){return lr.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return lr.credential(t,r)}catch{return null}}}lr.GOOGLE_SIGN_IN_METHOD="google.com";lr.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xi extends tc{constructor(){super("github.com")}static credential(e){return fo._fromParams({providerId:Xi.PROVIDER_ID,signInMethod:Xi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Xi.credentialFromTaggedObject(e)}static credentialFromError(e){return Xi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Xi.credential(e.oauthAccessToken)}catch{return null}}}Xi.GITHUB_SIGN_IN_METHOD="github.com";Xi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ji extends tc{constructor(){super("twitter.com")}static credential(e,t){return fo._fromParams({providerId:Ji.PROVIDER_ID,signInMethod:Ji.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ji.credentialFromTaggedObject(e)}static credentialFromError(e){return Ji.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return Ji.credential(t,r)}catch{return null}}}Ji.TWITTER_SIGN_IN_METHOD="twitter.com";Ji.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ha{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,s=!1){const a=await ur._fromIdTokenResponse(e,r,s),l=R0(r);return new Ha({user:a,providerId:l,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const s=R0(r);return new Ha({user:e,providerId:s,_tokenResponse:r,operationType:t})}}function R0(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vh extends fr{constructor(e,t,r,s){var a;super(t.code,t.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,vh.prototype),this.customData={appName:e.name,tenantId:(a=e.tenantId)!==null&&a!==void 0?a:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,s){return new vh(e,t,r,s)}}function mT(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(a=>{throw a.code==="auth/multi-factor-auth-required"?vh._fromErrorAndOperation(n,a,e,r):a})}async function MN(n,e,t=!1){const r=await Uu(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Ha._forOperation(n,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jN(n,e,t=!1){const{auth:r}=n;if(ar(r.app))return Promise.reject(io(r));const s="reauthenticate";try{const a=await Uu(n,mT(r,s,e,n),t);ke(a.idToken,r,"internal-error");const l=ry(a.idToken);ke(l,r,"internal-error");const{sub:d}=l;return ke(n.uid===d,r,"user-mismatch"),Ha._forOperation(n,s,a)}catch(a){throw(a==null?void 0:a.code)==="auth/user-not-found"&&Ur(r,"user-mismatch"),a}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function FN(n,e,t=!1){if(ar(n.app))return Promise.reject(io(n));const r="signIn",s=await mT(n,r,e),a=await Ha._fromIdTokenResponse(n,r,s);return t||await n._updateCurrentUser(a.user),a}function UN(n,e,t,r){return Et(n).onIdTokenChanged(e,t,r)}function BN(n,e,t){return Et(n).beforeAuthStateChanged(e,t)}function zN(n,e,t,r){return Et(n).onAuthStateChanged(e,t,r)}function $N(n){return Et(n).signOut()}const _h="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gT{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(_h,"1"),this.storage.removeItem(_h),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qN=1e3,HN=10;class yT extends gT{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=dT(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),s=this.localCache[t];r!==s&&e(t,s,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((l,d,f)=>{this.notifyListeners(l,f)});return}const r=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const l=this.storage.getItem(r);!t&&this.localCache[r]===l||this.notifyListeners(r,l)},a=this.storage.getItem(r);EN()&&a!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,HN):s()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},qN)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}yT.type="LOCAL";const WN=yT;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vT extends gT{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}vT.type="SESSION";const _T=vT;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GN(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const r=new nf(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:s,data:a}=t.data,l=this.handlersMap[s];if(!(l!=null&&l.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const d=Array.from(l).map(async p=>p(t.origin,a)),f=await GN(d);t.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:f})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}nf.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ay(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KN{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let a,l;return new Promise((d,f)=>{const p=ay("",20);s.port1.start();const v=setTimeout(()=>{f(new Error("unsupported_event"))},r);l={messageChannel:s,onMessage(_){const x=_;if(x.data.eventId===p)switch(x.data.status){case"ack":clearTimeout(v),a=setTimeout(()=>{f(new Error("timeout"))},3e3);break;case"done":clearTimeout(a),d(x.data.response);break;default:clearTimeout(v),clearTimeout(a),f(new Error("invalid_response"));break}}},this.handlers.add(l),s.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:e,eventId:p,data:t},[s.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Or(){return window}function QN(n){Or().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wT(){return typeof Or().WorkerGlobalScope<"u"&&typeof Or().importScripts=="function"}async function YN(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function XN(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function JN(){return wT()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ET="firebaseLocalStorageDb",ZN=1,wh="firebaseLocalStorage",IT="fbase_key";class nc{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function rf(n,e){return n.transaction([wh],e?"readwrite":"readonly").objectStore(wh)}function eD(){const n=indexedDB.deleteDatabase(ET);return new nc(n).toPromise()}function Mm(){const n=indexedDB.open(ET,ZN);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(wh,{keyPath:IT})}catch(s){t(s)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(wh)?e(r):(r.close(),await eD(),e(await Mm()))})})}async function C0(n,e,t){const r=rf(n,!0).put({[IT]:e,value:t});return new nc(r).toPromise()}async function tD(n,e){const t=rf(n,!1).get(e),r=await new nc(t).toPromise();return r===void 0?null:r.value}function P0(n,e){const t=rf(n,!0).delete(e);return new nc(t).toPromise()}const nD=800,rD=3;class xT{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Mm(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>rD)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return wT()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=nf._getInstance(JN()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await YN(),!this.activeServiceWorker)return;this.sender=new KN(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((t=r[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||XN()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Mm();return await C0(e,_h,"1"),await P0(e,_h),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>C0(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>tD(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>P0(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const a=rf(s,!1).getAll();return new nc(a).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:a}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(a)&&(this.notifyListeners(s,a),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),nD)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}xT.type="LOCAL";const iD=xT;new ec(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TT(n,e){return e?ai(e):(ke(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ly extends pT{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ra(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Ra(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Ra(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function sD(n){return FN(n.auth,new ly(n),n.bypassAuthState)}function oD(n){const{auth:e,user:t}=n;return ke(t,e,"internal-error"),jN(t,new ly(n),n.bypassAuthState)}async function aD(n){const{auth:e,user:t}=n;return ke(t,e,"internal-error"),MN(t,new ly(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ST{constructor(e,t,r,s,a=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=a,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:s,tenantId:a,error:l,type:d}=e;if(l){this.reject(l);return}const f={auth:this.auth,requestUri:t,sessionId:r,tenantId:a||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(d)(f))}catch(p){this.reject(p)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return sD;case"linkViaPopup":case"linkViaRedirect":return aD;case"reauthViaPopup":case"reauthViaRedirect":return oD;default:Ur(this.auth,"internal-error")}}resolve(e){pi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){pi(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lD=new ec(2e3,1e4);async function kT(n,e,t){if(ar(n.app))return Promise.reject(cr(n,"operation-not-supported-in-this-environment"));const r=tf(n);rN(n,e,oy);const s=TT(r,t);return new Xs(r,"signInViaPopup",e,s).executeNotNull()}class Xs extends ST{constructor(e,t,r,s,a){super(e,t,s,a),this.provider=r,this.authWindow=null,this.pollId=null,Xs.currentPopupAction&&Xs.currentPopupAction.cancel(),Xs.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ke(e,this.auth,"internal-error"),e}async onExecution(){pi(this.filter.length===1,"Popup operations only handle one event");const e=ay();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(cr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(cr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Xs.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if(!((r=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(cr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,lD.get())};e()}}Xs.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uD="pendingRedirect",Wd=new Map;class cD extends ST{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Wd.get(this.auth._key());if(!e){try{const r=await dD(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Wd.set(this.auth._key(),e)}return this.bypassAuthState||Wd.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function dD(n,e){const t=pD(e),r=fD(n);if(!await r._isAvailable())return!1;const s=await r._get(t)==="true";return await r._remove(t),s}function hD(n,e){Wd.set(n._key(),e)}function fD(n){return ai(n._redirectPersistence)}function pD(n){return Hd(uD,n.config.apiKey,n.name)}async function mD(n,e,t=!1){if(ar(n.app))return Promise.reject(io(n));const r=tf(n),s=TT(r,e),l=await new cD(r,s,t).execute();return l&&!t&&(delete l.user._redirectEventId,await r._persistUserIfCurrent(l.user),await r._setRedirectUser(null,e)),l}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gD=600*1e3;class yD{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!vD(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!bT(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(cr(this.auth,s))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=gD&&this.cachedEventUids.clear(),this.cachedEventUids.has(N0(e))}saveEventToCache(e){this.cachedEventUids.add(N0(e)),this.lastProcessedEventTime=Date.now()}}function N0(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function bT({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function vD(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return bT(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _D(n,e={}){return rl(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wD=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,ED=/^https?/;async function ID(n){if(n.config.emulator)return;const{authorizedDomains:e}=await _D(n);for(const t of e)try{if(xD(t))return}catch{}Ur(n,"unauthorized-domain")}function xD(n){const e=Om(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const l=new URL(n);return l.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&l.hostname===r}if(!ED.test(t))return!1;if(wD.test(n))return r===n;const s=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TD=new ec(3e4,6e4);function D0(){const n=Or().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function SD(n){return new Promise((e,t)=>{var r,s,a;function l(){D0(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{D0(),t(cr(n,"network-request-failed"))},timeout:TD.get()})}if(!((s=(r=Or().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((a=Or().gapi)===null||a===void 0)&&a.load)l();else{const d=CN("iframefcb");return Or()[d]=()=>{gapi.load?l():t(cr(n,"network-request-failed"))},AN(`${RN()}?onload=${d}`).catch(f=>t(f))}}).catch(e=>{throw Gd=null,e})}let Gd=null;function kD(n){return Gd=Gd||SD(n),Gd}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bD=new ec(5e3,15e3),AD="__/auth/iframe",RD="emulator/auth/iframe",CD={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},PD=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function ND(n){const e=n.config;ke(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?ty(e,RD):`https://${n.config.authDomain}/${AD}`,r={apiKey:e.apiKey,appName:n.name,v:Xa},s=PD.get(n.config.apiHost);s&&(r.eid=s);const a=n._getFrameworks();return a.length&&(r.fw=a.join(",")),`${t}?${$u(r).slice(1)}`}async function DD(n){const e=await kD(n),t=Or().gapi;return ke(t,n,"internal-error"),e.open({where:document.body,url:ND(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:CD,dontclear:!0},r=>new Promise(async(s,a)=>{await r.restyle({setHideOnLeave:!1});const l=cr(n,"network-request-failed"),d=Or().setTimeout(()=>{a(l)},bD.get());function f(){Or().clearTimeout(d),s(r)}r.ping(f).then(f,()=>{a(l)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VD={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},OD=500,LD=600,MD="_blank",jD="http://localhost";class V0{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function FD(n,e,t,r=OD,s=LD){const a=Math.max((window.screen.availHeight-s)/2,0).toString(),l=Math.max((window.screen.availWidth-r)/2,0).toString();let d="";const f=Object.assign(Object.assign({},VD),{width:r.toString(),height:s.toString(),top:a,left:l}),p=At().toLowerCase();t&&(d=oT(p)?MD:t),iT(p)&&(e=e||jD,f.scrollbars="yes");const v=Object.entries(f).reduce((x,[S,N])=>`${x}${S}=${N},`,"");if(wN(p)&&d!=="_self")return UD(e||"",d),new V0(null);const _=window.open(e||"",d,v);ke(_,n,"popup-blocked");try{_.focus()}catch{}return new V0(_)}function UD(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BD="__/auth/handler",zD="emulator/auth/handler",$D=encodeURIComponent("fac");async function O0(n,e,t,r,s,a){ke(n.config.authDomain,n,"auth-domain-config-required"),ke(n.config.apiKey,n,"invalid-api-key");const l={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Xa,eventId:s};if(e instanceof oy){e.setDefaultLanguage(n.languageCode),l.providerId=e.providerId||"",ub(e.getCustomParameters())||(l.customParameters=JSON.stringify(e.getCustomParameters()));for(const[v,_]of Object.entries({}))l[v]=_}if(e instanceof tc){const v=e.getScopes().filter(_=>_!=="");v.length>0&&(l.scopes=v.join(","))}n.tenantId&&(l.tid=n.tenantId);const d=l;for(const v of Object.keys(d))d[v]===void 0&&delete d[v];const f=await n._getAppCheckToken(),p=f?`#${$D}=${encodeURIComponent(f)}`:"";return`${qD(n)}?${$u(d).slice(1)}${p}`}function qD({config:n}){return n.emulator?ty(n,zD):`https://${n.authDomain}/${BD}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zp="webStorageSupport";class HD{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=_T,this._completeRedirectFn=mD,this._overrideRedirectResult=hD}async _openPopup(e,t,r,s){var a;pi((a=this.eventManagers[e._key()])===null||a===void 0?void 0:a.manager,"_initialize() not called before _openPopup()");const l=await O0(e,t,r,Om(),s);return FD(e,l,ay())}async _openRedirect(e,t,r,s){await this._originValidation(e);const a=await O0(e,t,r,Om(),s);return QN(a),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:a}=this.eventManagers[t];return s?Promise.resolve(s):(pi(a,"If manager is not set, promise should be"),a)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await DD(e),r=new yD(e);return t.register("authEvent",s=>(ke(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Zp,{type:Zp},s=>{var a;const l=(a=s==null?void 0:s[0])===null||a===void 0?void 0:a[Zp];l!==void 0&&t(!!l),Ur(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=ID(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return dT()||sT()||iy()}}const WD=HD;var L0="@firebase/auth",M0="1.10.8";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GD{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ke(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KD(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function QD(n){Lr(new dr("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),a=e.getProvider("app-check-internal"),{apiKey:l,authDomain:d}=r.options;ke(l&&!l.includes(":"),"invalid-api-key",{appName:r.name});const f={apiKey:l,authDomain:d,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:hT(n)},p=new kN(r,s,a,f);return NN(p,t),p},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Lr(new dr("auth-internal",e=>{const t=tf(e.getProvider("auth").getImmediate());return(r=>new GD(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Fn(L0,M0,KD(n)),Fn(L0,M0,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YD=300,XD=wE("authIdTokenMaxAge")||YD;let j0=null;const JD=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>XD)return;const s=t==null?void 0:t.token;j0!==s&&(j0=s,await fetch(n,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function ZD(n=tg()){const e=vo(n,"auth");if(e.isInitialized())return e.getImmediate();const t=PN(n,{popupRedirectResolver:WD,persistence:[iD,WN,_T]}),r=wE("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const a=new URL(r,location.origin);if(location.origin===a.origin){const l=JD(a.toString());BN(t,l,()=>l(t.currentUser)),UN(t,d=>l(d))}}const s=vE("auth");return s&&DN(t,`http://${s}`),t}function e2(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}bN({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=s=>{const a=cr("internal-error");a.customData=s,t(a)},r.type="text/javascript",r.charset="UTF-8",e2().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});QD("Browser");const AT="@firebase/installations",uy="0.6.18";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RT=1e4,CT=`w:${uy}`,PT="FIS_v2",t2="https://firebaseinstallations.googleapis.com/v1",n2=3600*1e3,r2="installations",i2="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s2={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},po=new yo(r2,i2,s2);function NT(n){return n instanceof fr&&n.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DT({projectId:n}){return`${t2}/projects/${n}/installations`}function VT(n){return{token:n.token,requestStatus:2,expiresIn:a2(n.expiresIn),creationTime:Date.now()}}async function OT(n,e){const r=(await e.json()).error;return po.create("request-failed",{requestName:n,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function LT({apiKey:n}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":n})}function o2(n,{refreshToken:e}){const t=LT(n);return t.append("Authorization",l2(e)),t}async function MT(n){const e=await n();return e.status>=500&&e.status<600?n():e}function a2(n){return Number(n.replace("s","000"))}function l2(n){return`${PT} ${n}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function u2({appConfig:n,heartbeatServiceProvider:e},{fid:t}){const r=DT(n),s=LT(n),a=e.getImmediate({optional:!0});if(a){const p=await a.getHeartbeatsHeader();p&&s.append("x-firebase-client",p)}const l={fid:t,authVersion:PT,appId:n.appId,sdkVersion:CT},d={method:"POST",headers:s,body:JSON.stringify(l)},f=await MT(()=>fetch(r,d));if(f.ok){const p=await f.json();return{fid:p.fid||t,registrationStatus:2,refreshToken:p.refreshToken,authToken:VT(p.authToken)}}else throw await OT("Create Installation",f)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jT(n){return new Promise(e=>{setTimeout(e,n)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c2(n){return btoa(String.fromCharCode(...n)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d2=/^[cdef][\w-]{21}$/,jm="";function h2(){try{const n=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(n),n[0]=112+n[0]%16;const t=f2(n);return d2.test(t)?t:jm}catch{return jm}}function f2(n){return c2(n).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sf(n){return`${n.appName}!${n.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FT=new Map;function UT(n,e){const t=sf(n);BT(t,e),p2(t,e)}function BT(n,e){const t=FT.get(n);if(t)for(const r of t)r(e)}function p2(n,e){const t=m2();t&&t.postMessage({key:n,fid:e}),g2()}let Js=null;function m2(){return!Js&&"BroadcastChannel"in self&&(Js=new BroadcastChannel("[Firebase] FID Change"),Js.onmessage=n=>{BT(n.data.key,n.data.fid)}),Js}function g2(){FT.size===0&&Js&&(Js.close(),Js=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y2="firebase-installations-database",v2=1,mo="firebase-installations-store";let em=null;function cy(){return em||(em=RE(y2,v2,{upgrade:(n,e)=>{switch(e){case 0:n.createObjectStore(mo)}}})),em}async function Eh(n,e){const t=sf(n),s=(await cy()).transaction(mo,"readwrite"),a=s.objectStore(mo),l=await a.get(t);return await a.put(e,t),await s.done,(!l||l.fid!==e.fid)&&UT(n,e.fid),e}async function zT(n){const e=sf(n),r=(await cy()).transaction(mo,"readwrite");await r.objectStore(mo).delete(e),await r.done}async function of(n,e){const t=sf(n),s=(await cy()).transaction(mo,"readwrite"),a=s.objectStore(mo),l=await a.get(t),d=e(l);return d===void 0?await a.delete(t):await a.put(d,t),await s.done,d&&(!l||l.fid!==d.fid)&&UT(n,d.fid),d}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dy(n){let e;const t=await of(n.appConfig,r=>{const s=_2(r),a=w2(n,s);return e=a.registrationPromise,a.installationEntry});return t.fid===jm?{installationEntry:await e}:{installationEntry:t,registrationPromise:e}}function _2(n){const e=n||{fid:h2(),registrationStatus:0};return $T(e)}function w2(n,e){if(e.registrationStatus===0){if(!navigator.onLine){const s=Promise.reject(po.create("app-offline"));return{installationEntry:e,registrationPromise:s}}const t={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=E2(n,t);return{installationEntry:t,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:I2(n)}:{installationEntry:e}}async function E2(n,e){try{const t=await u2(n,e);return Eh(n.appConfig,t)}catch(t){throw NT(t)&&t.customData.serverCode===409?await zT(n.appConfig):await Eh(n.appConfig,{fid:e.fid,registrationStatus:0}),t}}async function I2(n){let e=await F0(n.appConfig);for(;e.registrationStatus===1;)await jT(100),e=await F0(n.appConfig);if(e.registrationStatus===0){const{installationEntry:t,registrationPromise:r}=await dy(n);return r||t}return e}function F0(n){return of(n,e=>{if(!e)throw po.create("installation-not-found");return $T(e)})}function $T(n){return x2(n)?{fid:n.fid,registrationStatus:0}:n}function x2(n){return n.registrationStatus===1&&n.registrationTime+RT<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function T2({appConfig:n,heartbeatServiceProvider:e},t){const r=S2(n,t),s=o2(n,t),a=e.getImmediate({optional:!0});if(a){const p=await a.getHeartbeatsHeader();p&&s.append("x-firebase-client",p)}const l={installation:{sdkVersion:CT,appId:n.appId}},d={method:"POST",headers:s,body:JSON.stringify(l)},f=await MT(()=>fetch(r,d));if(f.ok){const p=await f.json();return VT(p)}else throw await OT("Generate Auth Token",f)}function S2(n,{fid:e}){return`${DT(n)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hy(n,e=!1){let t;const r=await of(n.appConfig,a=>{if(!qT(a))throw po.create("not-registered");const l=a.authToken;if(!e&&A2(l))return a;if(l.requestStatus===1)return t=k2(n,e),a;{if(!navigator.onLine)throw po.create("app-offline");const d=C2(a);return t=b2(n,d),d}});return t?await t:r.authToken}async function k2(n,e){let t=await U0(n.appConfig);for(;t.authToken.requestStatus===1;)await jT(100),t=await U0(n.appConfig);const r=t.authToken;return r.requestStatus===0?hy(n,e):r}function U0(n){return of(n,e=>{if(!qT(e))throw po.create("not-registered");const t=e.authToken;return P2(t)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function b2(n,e){try{const t=await T2(n,e),r=Object.assign(Object.assign({},e),{authToken:t});return await Eh(n.appConfig,r),t}catch(t){if(NT(t)&&(t.customData.serverCode===401||t.customData.serverCode===404))await zT(n.appConfig);else{const r=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await Eh(n.appConfig,r)}throw t}}function qT(n){return n!==void 0&&n.registrationStatus===2}function A2(n){return n.requestStatus===2&&!R2(n)}function R2(n){const e=Date.now();return e<n.creationTime||n.creationTime+n.expiresIn<e+n2}function C2(n){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},n),{authToken:e})}function P2(n){return n.requestStatus===1&&n.requestTime+RT<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function N2(n){const e=n,{installationEntry:t,registrationPromise:r}=await dy(e);return r?r.catch(console.error):hy(e).catch(console.error),t.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function D2(n,e=!1){const t=n;return await V2(t),(await hy(t,e)).token}async function V2(n){const{registrationPromise:e}=await dy(n);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O2(n){if(!n||!n.options)throw tm("App Configuration");if(!n.name)throw tm("App Name");const e=["projectId","apiKey","appId"];for(const t of e)if(!n.options[t])throw tm(t);return{appName:n.name,projectId:n.options.projectId,apiKey:n.options.apiKey,appId:n.options.appId}}function tm(n){return po.create("missing-app-config-values",{valueName:n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HT="installations",L2="installations-internal",M2=n=>{const e=n.getProvider("app").getImmediate(),t=O2(e),r=vo(e,"heartbeat");return{app:e,appConfig:t,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},j2=n=>{const e=n.getProvider("app").getImmediate(),t=vo(e,HT).getImmediate();return{getId:()=>N2(t),getToken:s=>D2(t,s)}};function F2(){Lr(new dr(HT,M2,"PUBLIC")),Lr(new dr(L2,j2,"PRIVATE"))}F2();Fn(AT,uy);Fn(AT,uy,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ih="analytics",U2="firebase_id",B2="origin",z2=60*1e3,$2="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",fy="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pn=new bh("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q2={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},Tn=new yo("analytics","Analytics",q2);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H2(n){if(!n.startsWith(fy)){const e=Tn.create("invalid-gtag-resource",{gtagURL:n});return pn.warn(e.message),""}return n}function WT(n){return Promise.all(n.map(e=>e.catch(t=>t)))}function W2(n,e){let t;return window.trustedTypes&&(t=window.trustedTypes.createPolicy(n,e)),t}function G2(n,e){const t=W2("firebase-js-sdk-policy",{createScriptURL:H2}),r=document.createElement("script"),s=`${fy}?l=${n}&id=${e}`;r.src=t?t==null?void 0:t.createScriptURL(s):s,r.async=!0,document.head.appendChild(r)}function K2(n){let e=[];return Array.isArray(window[n])?e=window[n]:window[n]=e,e}async function Q2(n,e,t,r,s,a){const l=r[s];try{if(l)await e[l];else{const f=(await WT(t)).find(p=>p.measurementId===s);f&&await e[f.appId]}}catch(d){pn.error(d)}n("config",s,a)}async function Y2(n,e,t,r,s){try{let a=[];if(s&&s.send_to){let l=s.send_to;Array.isArray(l)||(l=[l]);const d=await WT(t);for(const f of l){const p=d.find(_=>_.measurementId===f),v=p&&e[p.appId];if(v)a.push(v);else{a=[];break}}}a.length===0&&(a=Object.values(e)),await Promise.all(a),n("event",r,s||{})}catch(a){pn.error(a)}}function X2(n,e,t,r){async function s(a,...l){try{if(a==="event"){const[d,f]=l;await Y2(n,e,t,d,f)}else if(a==="config"){const[d,f]=l;await Q2(n,e,t,r,d,f)}else if(a==="consent"){const[d,f]=l;n("consent",d,f)}else if(a==="get"){const[d,f,p]=l;n("get",d,f,p)}else if(a==="set"){const[d]=l;n("set",d)}else n(a,...l)}catch(d){pn.error(d)}}return s}function J2(n,e,t,r,s){let a=function(...l){window[r].push(arguments)};return window[s]&&typeof window[s]=="function"&&(a=window[s]),window[s]=X2(a,n,e,t),{gtagCore:a,wrappedGtag:window[s]}}function Z2(n){const e=window.document.getElementsByTagName("script");for(const t of Object.values(e))if(t.src&&t.src.includes(fy)&&t.src.includes(n))return t;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eV=30,tV=1e3;class nV{constructor(e={},t=tV){this.throttleMetadata=e,this.intervalMillis=t}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,t){this.throttleMetadata[e]=t}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const GT=new nV;function rV(n){return new Headers({Accept:"application/json","x-goog-api-key":n})}async function iV(n){var e;const{appId:t,apiKey:r}=n,s={method:"GET",headers:rV(r)},a=$2.replace("{app-id}",t),l=await fetch(a,s);if(l.status!==200&&l.status!==304){let d="";try{const f=await l.json();!((e=f.error)===null||e===void 0)&&e.message&&(d=f.error.message)}catch{}throw Tn.create("config-fetch-failed",{httpStatus:l.status,responseMessage:d})}return l.json()}async function sV(n,e=GT,t){const{appId:r,apiKey:s,measurementId:a}=n.options;if(!r)throw Tn.create("no-app-id");if(!s){if(a)return{measurementId:a,appId:r};throw Tn.create("no-api-key")}const l=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},d=new lV;return setTimeout(async()=>{d.abort()},z2),KT({appId:r,apiKey:s,measurementId:a},l,d,e)}async function KT(n,{throttleEndTimeMillis:e,backoffCount:t},r,s=GT){var a;const{appId:l,measurementId:d}=n;try{await oV(r,e)}catch(f){if(d)return pn.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${d} provided in the "measurementId" field in the local Firebase config. [${f==null?void 0:f.message}]`),{appId:l,measurementId:d};throw f}try{const f=await iV(n);return s.deleteThrottleMetadata(l),f}catch(f){const p=f;if(!aV(p)){if(s.deleteThrottleMetadata(l),d)return pn.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${d} provided in the "measurementId" field in the local Firebase config. [${p==null?void 0:p.message}]`),{appId:l,measurementId:d};throw f}const v=Number((a=p==null?void 0:p.customData)===null||a===void 0?void 0:a.httpStatus)===503?$_(t,s.intervalMillis,eV):$_(t,s.intervalMillis),_={throttleEndTimeMillis:Date.now()+v,backoffCount:t+1};return s.setThrottleMetadata(l,_),pn.debug(`Calling attemptFetch again in ${v} millis`),KT(n,_,r,s)}}function oV(n,e){return new Promise((t,r)=>{const s=Math.max(e-Date.now(),0),a=setTimeout(t,s);n.addEventListener(()=>{clearTimeout(a),r(Tn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function aV(n){if(!(n instanceof fr)||!n.customData)return!1;const e=Number(n.customData.httpStatus);return e===429||e===500||e===503||e===504}class lV{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function uV(n,e,t,r,s){if(s&&s.global){n("event",t,r);return}else{const a=await e,l=Object.assign(Object.assign({},r),{send_to:a});n("event",t,l)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cV(){if(kh())try{await Zm()}catch(n){return pn.warn(Tn.create("indexeddb-unavailable",{errorInfo:n==null?void 0:n.toString()}).message),!1}else return pn.warn(Tn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function dV(n,e,t,r,s,a,l){var d;const f=sV(n);f.then(S=>{t[S.measurementId]=S.appId,n.options.measurementId&&S.measurementId!==n.options.measurementId&&pn.warn(`The measurement ID in the local Firebase config (${n.options.measurementId}) does not match the measurement ID fetched from the server (${S.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(S=>pn.error(S)),e.push(f);const p=cV().then(S=>{if(S)return r.getId()}),[v,_]=await Promise.all([f,p]);Z2(a)||G2(a,v.measurementId),s("js",new Date);const x=(d=l==null?void 0:l.config)!==null&&d!==void 0?d:{};return x[B2]="firebase",x.update=!0,_!=null&&(x[U2]=_),s("config",v.measurementId,x),v.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hV{constructor(e){this.app=e}_delete(){return delete xu[this.app.options.appId],Promise.resolve()}}let xu={},B0=[];const z0={};let nm="dataLayer",fV="gtag",$0,QT,q0=!1;function pV(){const n=[];if(Jm()&&n.push("This is a browser extension environment."),kE()||n.push("Cookies are not available."),n.length>0){const e=n.map((r,s)=>`(${s+1}) ${r}`).join(" "),t=Tn.create("invalid-analytics-context",{errorInfo:e});pn.warn(t.message)}}function mV(n,e,t){pV();const r=n.options.appId;if(!r)throw Tn.create("no-app-id");if(!n.options.apiKey)if(n.options.measurementId)pn.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${n.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw Tn.create("no-api-key");if(xu[r]!=null)throw Tn.create("already-exists",{id:r});if(!q0){K2(nm);const{wrappedGtag:a,gtagCore:l}=J2(xu,B0,z0,nm,fV);QT=a,$0=l,q0=!0}return xu[r]=dV(n,B0,z0,e,$0,nm,t),new hV(n)}function gV(n=tg()){n=Et(n);const e=vo(n,Ih);return e.isInitialized()?e.getImmediate():yV(n)}function yV(n,e={}){const t=vo(n,Ih);if(t.isInitialized()){const s=t.getImmediate();if(ss(e,t.getOptions()))return s;throw Tn.create("already-initialized")}return t.initialize({options:e})}async function vV(){if(Jm()||!kE()||!kh())return!1;try{return await Zm()}catch{return!1}}function _V(n,e,t,r){n=Et(n),uV(QT,xu[n.app.options.appId],e,t,r).catch(s=>pn.error(s))}const H0="@firebase/analytics",W0="0.10.17";function wV(){Lr(new dr(Ih,(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("installations-internal").getImmediate();return mV(r,s,t)},"PUBLIC")),Lr(new dr("analytics-internal",n,"PRIVATE")),Fn(H0,W0),Fn(H0,W0,"esm2017");function n(e){try{const t=e.getProvider(Ih).getImmediate();return{logEvent:(r,s,a)=>_V(t,r,s,a)}}catch(t){throw Tn.create("interop-component-reg-failed",{reason:t})}}}wV();const EV={apiKey:"AIzaSyD2bnfNTNjJ4XyVFlM_1PzvGMmnc69VqX8",authDomain:"habit-tracker-pwa-e5a97.firebaseapp.com",projectId:"habit-tracker-pwa-e5a97",storageBucket:"habit-tracker-pwa-e5a97.firebasestorage.app",messagingSenderId:"600484609036",appId:"1:600484609036:web:0650ca5337d57f1b02c229",measurementId:"G-M990KPRLXC"},py=CE(EV);vV().then(n=>{n&&gV(py)});const af=ZD(py),nt=FP(py);UP(nt).catch(n=>{n.code=="failed-precondition"?console.warn("Persistence failed: Multiple tabs open"):n.code=="unimplemented"&&console.warn("Persistence failed: Browser not supported")});const il="habits";async function IV(n,e){try{const t=kn(nt,il);return{id:(await Kx(t,{...e,userId:n,currentStreak:0,createdAt:Fu(),updatedAt:Fu()})).id,...e,userId:n,currentStreak:0}}catch(t){throw console.error("Error creating habit:",t),t}}async function xV(n){try{const e=kn(nt,il),t=pr(e,wt("userId","==",n),nl("createdAt","desc"));return(await vi(t)).docs.map(s=>({id:s.id,...s.data()}))}catch(e){throw console.error("Error getting habits:",e),e}}async function Rd(n,e){try{const t=zn(nt,il,n);return await Gx(t,{...e,updatedAt:Fu()}),{id:n,...e}}catch(t){throw console.error("Error updating habit:",t),t}}async function TV(n){try{const e=zn(nt,il,n);return await Xg(e),n}catch(e){throw console.error("Error deleting habit:",e),e}}function SV(n,e){const t=kn(nt,il),r=pr(t,wt("userId","==",n),nl("createdAt","desc"));return Qx(r,s=>{const a=s.docs.map(l=>({id:l.id,...l.data()}));e(a)},s=>{console.error("Error in habits subscription:",s)})}async function kV(n){try{const e=kn(nt,il),t=pr(e,wt("userId","==",n),wt("isPublic","==",!0),nl("createdAt","desc"));return(await vi(t)).docs.map(s=>({id:s.id,...s.data()}))}catch(e){throw console.error("Error getting user public habits:",e),e}}function br(n){const e=new Date(n),t=e.getFullYear(),r=String(e.getMonth()+1).padStart(2,"0"),s=String(e.getDate()).padStart(2,"0");return`${t}-${r}-${s}`}function G0(n=new Date){const e=new Date(n);e.setDate(e.getDate()-e.getDay()),e.setHours(0,0,0,0);const t=new Date(e);return t.setDate(t.getDate()+6),t.setHours(23,59,59,999),{start:e,end:t}}const sl="completions";async function Fm(n,e,t,r=!0){try{const s=kn(nt,sl);return{id:(await Kx(s,{habitId:n,userId:e,date:t,value:r,type:"completion",timestamp:Fu()})).id,habitId:n,userId:e,date:t,value:r}}catch(s){throw console.error("Error adding completion:",s),s}}async function YT(n,e,t){try{const r=kn(nt,sl),s=pr(r,wt("habitId","==",n),wt("userId","==",e),wt("date","==",t)),l=(await vi(s)).docs.map(d=>Xg(d.ref));return await Promise.all(l),{habitId:n,userId:e,date:t}}catch(r){throw console.error("Error removing completion:",r),r}}async function bV(n,e,t,r=!0){try{const s=kn(nt,sl),a=pr(s,wt("habitId","==",n),wt("userId","==",e),wt("date","==",t));return(await vi(a)).empty?await Fm(n,e,t,r):(await YT(n,e,t),null)}catch(s){throw console.error("Error toggling completion:",s),s}}async function AV(n,e,t,r){try{if(r<=0)return await YT(n,e,t),null;const s=kn(nt,sl),a=pr(s,wt("habitId","==",n),wt("userId","==",e),wt("date","==",t)),l=await vi(a);if(l.empty)return await Fm(n,e,t,r);{const d=l.docs[0].ref;return await Xg(d),await Fm(n,e,t,r)}}catch(s){throw console.error("Error updating completion value:",s),s}}async function K0(n,e){try{const t=kn(nt,sl),r=pr(t,wt("userId","==",n),wt("date","==",e));return(await vi(r)).docs.map(a=>({id:a.id,...a.data()}))}catch(t){throw console.error("Error getting completions:",t),t}}async function RV(n,e,t){try{const r=kn(nt,sl),s=pr(r,wt("userId","==",n),wt("date",">=",e),wt("date","<=",t));return(await vi(s)).docs.map(l=>({id:l.id,...l.data()}))}catch(r){throw console.error("Error getting completions range:",r),r}}const my="weeklyStats",XT="users";function rc(n=new Date){const e=new Date(n);e.setHours(0,0,0,0),e.setDate(e.getDate()+3-(e.getDay()+6)%7);const t=new Date(e.getFullYear(),0,4),r=Math.ceil(((e.getTime()-t.getTime())/864e5+t.getDay()+1)/7);return`${e.getFullYear()}-W${String(r).padStart(2,"0")}`}async function CV(n,e,t){try{const r=rc(),s=e>0?Math.round(t/e*100):0,a=zn(nt,my,`${r}_${n}`);return await Yg(a,{weekId:r,userId:n,totalScheduled:e,totalCompleted:t,percentage:s,lastUpdated:new Date().toISOString()},{merge:!0}),{weekId:r,userId:n,percentage:s}}catch(r){throw console.error("Error updating weekly stats:",r),r}}async function PV(n=null){try{const e=n||rc(),t=kn(nt,my),r=pr(t,wt("weekId","==",e),nl("percentage","desc")),a=(await vi(r)).docs.map(d=>({id:d.id,...d.data()}));return await Promise.all(a.map(async(d,f)=>{try{const p=zn(nt,XT,d.userId),v=await qa(p),_=v.exists()?v.data():{};return{...d,rank:f+1,displayName:_.displayName||"Anonymous",photoURL:_.photoURL||null,email:_.email||null}}catch{return{...d,rank:f+1,displayName:"Anonymous",photoURL:null}}}))}catch(e){throw console.error("Error getting leaderboard:",e),e}}async function NV(n,e=null){try{const t=await PV(e);return t.find(s=>s.userId===n)||{rank:t.length+1,percentage:0}}catch(t){return console.error("Error getting user rank:",t),{rank:0,percentage:0}}}function DV(){const n=new Date;return n.setDate(n.getDate()-7),rc(n)}function VV(n,e){const t=n||rc(),r=kn(nt,my),s=pr(r,wt("weekId","==",t),nl("percentage","desc"));return Qx(s,async a=>{const l=a.docs.map(f=>({id:f.id,...f.data()})),d=await Promise.all(l.map(async(f,p)=>{try{const v=zn(nt,XT,f.userId),_=await qa(v),x=_.exists()?_.data():{};return{...f,rank:p+1,displayName:x.displayName||"Anonymous",photoURL:x.photoURL||null}}catch{return{...f,rank:p+1,displayName:"Anonymous",photoURL:null}}}));e(d)},a=>{console.error("Error in leaderboard subscription:",a)})}const Um="gcal_token",OV=3e3*1e3;function LV(n){const e={token:n,expiry:Date.now()+OV};localStorage.setItem(Um,JSON.stringify(e))}function JT(){const n=localStorage.getItem(Um);if(!n)return null;const e=JSON.parse(n);return Date.now()>e.expiry?(localStorage.removeItem(Um),null):e.token}async function Q0(n,e){const t=JT();if(t)try{await gy(n,t,e)}catch(r){console.warn("Auto-sync failed:",r.message)}}async function MV(n){const e=JT();if(!(!e||!n))try{const t=`https://www.googleapis.com/calendar/v3/calendars/primary/events/${n}`;await fetch(t,{method:"DELETE",headers:{Authorization:`Bearer ${e}`}})}catch(t){console.warn("Failed to delete calendar event:",t.message)}}async function jV(n,e){console.log("Starting Calendar Sync...");const t=new lr;t.addScope("https://www.googleapis.com/auth/calendar.events");let r;try{t.setCustomParameters({prompt:"consent"});const d=await kT(af,t);if(r=lr.credentialFromResult(d).accessToken,!r)throw new Error("No access token returned");LV(r)}catch(d){throw console.error("Calendar Auth Error:",d),new Error("Failed to authorize Google Calendar access")}let s=0,a=0;const l=[];for(const d of n)try{await gy(d,r,e),s++}catch(f){console.error(`Failed to sync habit: ${d.title}`,f),a++,l.push(`${d.title}: ${f.message}`)}return{success:s,failed:a,errors:l}}async function gy(n,e,t){var p;const r=FV(n),s=!!n.googleEventId,a=s?"PATCH":"POST",l=s?`https://www.googleapis.com/calendar/v3/calendars/primary/events/${n.googleEventId}`:"https://www.googleapis.com/calendar/v3/calendars/primary/events",d=await fetch(l,{method:a,headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},body:JSON.stringify(r)});if(!d.ok){if(d.status===404&&s){console.warn("Event not found, cleaning up ID and creating new one...");const _={...n,googleEventId:null};return gy(_,e)}const v=await d.json();throw new Error(((p=v.error)==null?void 0:p.message)||"Calendar API Error")}const f=await d.json();if(!n.googleEventId||n.googleEventId!==f.id){const v=zn(nt,"habits",n.id);await Gx(v,{googleEventId:f.id})}}function FV(n){var s;const e=Intl.DateTimeFormat().resolvedOptions().timeZone;let t=[];if(n.frequency==="daily")t=["RRULE:FREQ=DAILY"];else if(n.frequency==="weekly")t=["RRULE:FREQ=WEEKLY"];else if(n.frequency==="custom"&&((s=n.customDays)==null?void 0:s.length)>0){const a=["SU","MO","TU","WE","TH","FR","SA"],l=n.customDays.map(d=>a[d]).filter(Boolean).join(",");l&&(t=[`RRULE:FREQ=WEEKLY;BYDAY=${l}`])}if(!!n.reminderTime){const l=`${new Date().toISOString().split("T")[0]}T${n.reminderTime}:00`,d=new Date(l),f=new Date(d.getTime()+60*6e4);return{summary:` ${n.title}`,description:`Track your habit: ${n.title} in the Habit Tracker App!`,start:{dateTime:d.toISOString(),timeZone:e},end:{dateTime:f.toISOString(),timeZone:e},recurrence:t.length>0?t:void 0,reminders:{useDefault:!1,overrides:[{method:"popup",minutes:10},{method:"popup",minutes:0}]},colorId:"10"}}else{const a=new Date().toISOString().split("T")[0];return{summary:` ${n.title}`,description:`Track your habit: ${n.title} in the Habit Tracker App! (All-day habit)`,start:{date:a},end:{date:a},recurrence:t.length>0?t:void 0,reminders:{useDefault:!1,overrides:[{method:"popup",minutes:540}]},colorId:"10"}}}const cs=Xm((n,e)=>({habits:[],completions:{},isLoading:!1,error:null,setHabits:t=>n({habits:t}),setLoading:t=>n({isLoading:t}),setError:t=>n({error:t}),addHabit:async(t,r)=>{const s="temp_"+Date.now(),a={id:s,...r,userId:t,currentStreak:0,createdAt:new Date,updatedAt:new Date,isTemp:!0};return n(l=>({habits:[a,...l.habits],isLoading:!1})),IV(t,r).then(l=>{n(d=>({habits:d.habits.map(f=>f.id===s?l:f)})),Q0(l,t).then(d=>{d||n({needsCalendarReauth:!0})})}).catch(l=>{console.error("Background create failed:",l),n(d=>({error:"Failed to sync new habit. It may disappear on reload.",habits:d.habits.map(f=>f.id===s?{...f,syncError:!0}:f)}))}),a},updateHabit:async(t,r)=>{var a;const s=(a=e().habits.find(l=>l.id===t))==null?void 0:a.userId;n(l=>({habits:l.habits.map(d=>d.id===t?{...d,...r}:d)}));try{await Rd(t,r);const l=e().habits.find(d=>d.id===t);l&&s&&Q0(l,s)}catch(l){console.error("Error in updateHabit:",l),n({error:l.message})}},deleteHabit:async t=>{var s;const r=(s=e().habits.find(a=>a.id===t))==null?void 0:s.googleEventId;n(a=>({habits:a.habits.filter(l=>l.id!==t)}));try{await TV(t),r&&MV(r)}catch(a){console.error("Error in deleteHabit:",a)}},loadHabits:async t=>{n({isLoading:!0,error:null});try{const r=await xV(t);return n({habits:r,isLoading:!1}),r}catch(r){throw console.error("Error in loadHabits:",r),n({error:r.message,isLoading:!1,habits:[]}),r}},checkStreaks:async t=>{const{habits:r}=e();if(r.length===0)return;const s=new Date,a=new Date(s);a.setDate(a.getDate()-1);const l=br(a);let d={};try{(await K0(t,l)).forEach(p=>{d[p.habitId]=p})}catch(f){console.warn("Failed to fetch yesterday's completions for streak check",f);return}r.forEach(f=>{if(f.currentStreak>0){let p=!1;if(f.frequency==="daily"){const v=d[f.id];let _=!1;v&&(f.completionType==="numerical"?_=(v.value||0)>=(f.targetValue||1):_=!0),_||(p=!0)}f.frequency==="one-time"&&(p=!0),p&&(console.log(`Resetting streak for habit ${f.title} (Missed yesterday)`),n(v=>({habits:v.habits.map(_=>_.id===f.id?{..._,currentStreak:0}:_)})),Rd(f.id,{currentStreak:0}).catch(console.error))}})},subscribeToHabits:t=>(e().habits.length===0&&n({isLoading:!0}),SV(t,r=>{n({habits:r,isLoading:!1})})),setCompletions:(t,r)=>n(s=>({completions:{...s.completions,[t]:r}})),loadCompletionsForWeek:async t=>{try{const{start:r,end:s}=G0(new Date),a=br(s),l=br(r),d=await RV(t,l,a),f={};return d.forEach(p=>{f[p.date]||(f[p.date]=[]),f[p.date].push(p)}),n(p=>({completions:{...p.completions,...f}})),f}catch(r){return console.error("Error loading completions:",r),{}}},loadCompletionsForDate:async(t,r)=>{try{const s=await K0(t,r);return n(a=>({completions:{...a.completions,[r]:s}})),s}catch(s){return console.error("Error loading completions:",s),[]}},toggleCompletion:async(t,r,s)=>{const{completions:a,habits:l}=e(),d=a[s]||[],f=l.find(S=>S.id===t),p=br(new Date);if(s>p){console.warn("Cannot mark future habits as done");return}if(s<p){console.warn("Cannot modify past habits");return}const _=!d.find(S=>S.habitId===t);let x;if(_?x=[...d,{habitId:t,userId:r,date:s,value:!0,isOptimistic:!0}]:x=d.filter(S=>S.habitId!==t),n(S=>({completions:{...S.completions,[s]:x}})),f){let S=f.currentStreak;_?S=(f.currentStreak||0)+1:S=Math.max(0,(f.currentStreak||0)-1),n(N=>({habits:N.habits.map(P=>P.id===t?{...P,currentStreak:S,lastCompletedDate:_?s:P.lastCompletedDate}:P)})),Rd(t,{currentStreak:S,lastCompletedDate:_?s:f.lastCompletedDate||null}).catch(N=>console.error("Background streak update failed:",N))}try{const{start:S,end:N}=G0(new Date);let P=0,O=0;const K=new Date(S),Q=e().completions;for(;K<=N;){const H=br(K),se=e().getTodaysHabits(K);P+=se.length;const ce=Q[H]||[];O+=ce.length,K.setDate(K.getDate()+1)}CV(r,P,O).catch(H=>console.error("Background leaderboard update failed:",H))}catch(S){console.error("Error updating weekly stats:",S)}try{await bV(t,r,s,_)}catch(S){throw console.error("Error toggling completion in Firestore:",S),S}},updateHabitProgress:async(t,r,s,a)=>{const{completions:l,habits:d}=e(),f=l[s]||[],p=d.find(P=>P.id===t),v=br(new Date);if(s>v)return;if(s<v){console.warn("Cannot modify past habits");return}const _=f.find(P=>P.habitId===t),x=_&&(_.value||0)>=(p.targetValue||1),S=a>=(p.targetValue||1);let N;if(a>0?_?N=f.map(P=>P.habitId===t?{...P,value:a}:P):N=[...f,{habitId:t,userId:r,date:s,value:a,isOptimistic:!0}]:N=f.filter(P=>P.habitId!==t),n(P=>({completions:{...P.completions,[s]:N}})),p&&x!==S){let P=p.currentStreak||0;S?P=P+1:P=Math.max(0,P-1),n(O=>({habits:O.habits.map(K=>K.id===t?{...K,currentStreak:P,lastCompletedDate:S?s:K.lastCompletedDate}:K)})),Rd(t,{currentStreak:P,lastCompletedDate:S?s:p.lastCompletedDate||null}).catch(O=>console.error("Background streak update failed:",O))}try{await AV(t,r,s,a)}catch(P){console.error("Error updating progress:",P)}},isHabitCompleted:(t,r)=>{const{completions:s,habits:a}=e(),d=(s[r]||[]).find(p=>p.habitId===t),f=a.find(p=>p.id===t);return d?(f==null?void 0:f.completionType)==="numerical"&&f.targetValue?(d.value||0)>=f.targetValue:!0:!1},getHabitValue:(t,r)=>{const{completions:s}=e(),l=(s[r]||[]).find(d=>d.habitId===t);return(l==null?void 0:l.value)||0},getTodaysHabits:(t=null)=>{const{habits:r}=e(),s=t?new Date(t):new Date,a=s.getDay();return r.filter(l=>{var d,f;if(l.frequency==="daily")return!0;if(l.frequency==="custom"&&l.customDays)return l.customDays.includes(a);if(l.frequency==="one-time"){const p=br(s);return l.targetDate===p}return l.frequency==="weekly"?(((f=(d=l.createdAt)==null?void 0:d.toDate)==null?void 0:f.call(d))||new Date(l.createdAt)).getDay()===a:!1})},getStatsForDate:t=>{const{completions:r,habits:s}=e(),a=e().getTodaysHabits(t),l=typeof t=="string"?t:br(t),d=r[l]||[],f=a.reduce((_,x)=>{const S=d.find(N=>N.habitId===x.id);if(!S)return _;if(x.completionType==="numerical"&&x.targetValue){if((S.value||0)>=x.targetValue)return _+1}else return _+1;return _},0),p=a.length,v=p>0?Math.round(f/p*100):0;return{completed:f,total:p,percentage:v}},clearAll:()=>n({habits:[],completions:{},isLoading:!1,error:null})}));async function UV(){return"Notification"in window?Notification.permission==="granted"?!0:Notification.permission!=="denied"?await Notification.requestPermission()==="granted":!1:(console.warn("This browser does not support desktop notification"),!1)}async function ZT(n,e,t="/pwa-192x192.png"){if(Notification.permission==="granted")try{await(await navigator.serviceWorker.ready).showNotification(n,{body:e,icon:t,badge:"/pwa-192x192.png",vibrate:[100,50,100],tag:n,data:{url:"/"}})}catch(r){console.warn("SW notification failed, falling back to constructor",r);const s=new Notification(n,{body:e,icon:t,badge:"/pwa-192x192.png",vibrate:[100,50,100],tag:n});s.onclick=function(a){a.preventDefault(),window.focus(),s.close()}}}function Y0(){BV(),zV()}function BV(){const n=JSON.parse(localStorage.getItem("habitParams"))||{},{notificationsEnabled:e,reminderTime:t}=n;if(!e||!t)return;const r=new Date,s=localStorage.getItem("lastReminderDate"),a=r.toDateString();if(s===a)return;const[l,d]=t.split(":").map(Number),f=new Date;f.setHours(l,d,0,0),r>=f&&(ZT("Time to check your habits!","Don't forget to log your progress for today."),localStorage.setItem("lastReminderDate",a))}function zV(){const n=new Date,e=cs.getState(),t=e.getTodaysHabits?e.getTodaysHabits(n):[],r=n.toISOString().split("T")[0],s=JSON.parse(localStorage.getItem("notifiedHabits"))||{};let l=[...s[r]||[]],d=!1;t.forEach(f=>{if(!f.hasReminder||!f.reminderTime||f.isCompleted||l.includes(f.id))return;const[p,v]=f.reminderTime.split(":").map(Number),_=new Date;_.setHours(p,v,0,0);const x=new Date(_.getTime()-10*6e4);n>=x&&n<_&&(ZT(`Upcoming Habit: ${f.title}`,`Your habit is scheduled for ${f.reminderTime}. Get ready!`),l.push(f.id),d=!0)}),d&&localStorage.setItem("notifiedHabits",JSON.stringify({...s,[r]:l}))}const eS="users";async function $V(n,e){try{const t=zn(nt,eS,n);return await Yg(t,e,{merge:!0}),!0}catch(t){throw console.error("Error updating user settings:",t),t}}async function tS(n){try{const e=zn(nt,eS,n),t=await qa(e);return t.exists()?{id:t.id,...t.data()}:null}catch(e){throw console.error("Error getting user profile:",e),e}}const qV=new lr;async function HV(){try{const e=(await kT(af,qV)).user,t=zn(nt,"users",e.uid);return(await qa(t)).exists()||await Yg(t,{displayName:e.displayName,email:e.email,photoURL:e.photoURL,createdAt:Fu()}),e}catch(n){throw console.error("Error signing in with Google:",n),n}}async function WV(){try{await $N(af)}catch(n){throw console.error("Error signing out:",n),n}}function Eo({size:n="md",className:e=""}){const t={sm:"h-4 w-4",md:"h-6 w-6",lg:"h-10 w-10"};return w.jsxs("svg",{className:`animate-spin text-primary ${t[n]} ${e}`,fill:"none",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[w.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),w.jsx("path",{className:"opacity-75",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",fill:"currentColor"})]})}const GV={primary:"bg-primary text-text-light-primary shadow-[0_4px_14px_rgba(19,236,91,0.3)] hover:shadow-[0_4px_20px_rgba(19,236,91,0.4)]",secondary:"bg-transparent text-text-light-primary dark:text-text-dark-primary border border-border-light dark:border-border-dark hover:bg-gray-100 dark:hover:bg-gray-800",danger:"bg-transparent text-danger hover:bg-danger/10",google:"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50 shadow-sm"},KV={sm:"h-10 px-4 text-sm",md:"h-12 px-6 text-base",lg:"h-14 px-8 text-base"};function ui({children:n,variant:e="primary",size:t="md",fullWidth:r=!1,isLoading:s=!1,disabled:a=!1,icon:l,className:d="",...f}){return w.jsx("button",{className:`
        flex items-center justify-center gap-2.5 rounded-xl font-bold
        transition-all duration-200 ease-out
        disabled:opacity-50 disabled:cursor-not-allowed
        ${GV[e]}
        ${KV[t]}
        ${r?"w-full":""}
        ${d}
      `,disabled:a||s,...f,children:s?w.jsx(Eo,{size:"sm"}):w.jsxs(w.Fragment,{children:[l&&w.jsx("span",{className:"material-symbols-outlined text-xl",children:l}),n]})})}function QV(){const[n,e]=U.useState(!1),[t,r]=U.useState(null),s=qn(),{isAuthenticated:a}=go();U.useEffect(()=>{a&&s("/dashboard",{replace:!0})},[a,s]);const l=async()=>{e(!0),r(null);try{await HV(),s("/dashboard")}catch(f){console.error("Sign in error:",f),r("Failed to sign in. Please try again.")}finally{e(!1)}},d=[{icon:"local_fire_department",title:"Track Streaks",description:"Never miss a day and watch your streaks grow."},{icon:"leaderboard",title:"Join Leaderboards",description:"Compete weekly and celebrate wins."},{icon:"share",title:"Share Progress",description:"Share your journey or keep it private."}];return a?null:w.jsx("div",{className:"relative flex h-auto min-h-screen w-full flex-col bg-background-light dark:bg-background-dark font-display overflow-x-hidden",children:w.jsxs("div",{className:"flex flex-col grow justify-between",children:[w.jsxs("div",{className:"flex flex-col",children:[w.jsx("div",{className:"p-4",children:w.jsx("div",{className:"w-full bg-center bg-no-repeat bg-cover flex flex-col justify-end overflow-hidden rounded-xl min-h-80",style:{backgroundImage:`linear-gradient(135deg, 
                  rgba(19, 236, 91, 0.3) 0%, 
                  rgba(16, 34, 22, 0.5) 50%, 
                  rgba(19, 236, 91, 0.2) 100%),
                  url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 400 300'%3E%3Cdefs%3E%3ClinearGradient id='grad' x1='0%25' y1='0%25' x2='100%25' y2='100%25'%3E%3Cstop offset='0%25' style='stop-color:%2313ec5b;stop-opacity:0.3'/%3E%3Cstop offset='100%25' style='stop-color:%23102216;stop-opacity:0.8'/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect fill='url(%23grad)' width='400' height='300'/%3E%3Ccircle cx='100' cy='150' r='60' fill='%2313ec5b' opacity='0.2'/%3E%3Ccircle cx='300' cy='100' r='80' fill='%2313ec5b' opacity='0.15'/%3E%3Ccircle cx='250' cy='220' r='50' fill='%2313ec5b' opacity='0.25'/%3E%3C/svg%3E")`},children:w.jsx("div",{className:"p-6 flex items-center justify-center",children:w.jsx("span",{className:"material-symbols-outlined text-primary text-6xl",children:"eco"})})})}),w.jsx("h1",{className:"text-text-light-primary dark:text-gray-100 tracking-tight text-[32px] font-bold leading-tight px-4 text-center pb-3 pt-6",children:"Build Better Habits, Together."}),w.jsx("p",{className:"text-gray-700 dark:text-gray-300 text-base font-normal leading-normal pb-3 pt-1 px-4 text-center",children:"Track your progress, compete with friends, and stay motivated every day."}),w.jsx("div",{className:"flex overflow-x-auto no-scrollbar",children:w.jsx("div",{className:"flex items-stretch p-4 gap-4 w-full",children:d.map(f=>w.jsxs("div",{className:"flex h-full flex-1 flex-col items-center gap-2 text-center rounded-lg min-w-32 pt-4",children:[w.jsx("div",{className:"flex items-center justify-center bg-primary/20 dark:bg-primary/30 h-14 w-14 rounded-full",children:w.jsx("span",{className:"material-symbols-outlined text-primary text-3xl",children:f.icon})}),w.jsxs("div",{children:[w.jsx("p",{className:"text-text-light-primary dark:text-gray-100 text-base font-medium leading-normal",children:f.title}),w.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-sm font-normal leading-normal",children:f.description})]})]},f.title))})}),w.jsxs("div",{className:"flex w-full flex-row items-center justify-center gap-3 py-5",children:[w.jsx("div",{className:"h-2 w-2 rounded-full bg-primary"}),w.jsx("div",{className:"h-2 w-2 rounded-full bg-gray-300 dark:bg-gray-600"}),w.jsx("div",{className:"h-2 w-2 rounded-full bg-gray-300 dark:bg-gray-600"})]})]}),w.jsxs("div",{className:"p-4 flex flex-col gap-4",children:[t&&w.jsx("p",{className:"text-danger text-sm text-center",children:t}),w.jsx("button",{onClick:l,disabled:n,className:"flex h-12 w-full items-center justify-center gap-2.5 rounded-lg bg-primary px-6 text-base font-bold text-gray-900 dark:text-black disabled:opacity-50 transition-all hover:shadow-lg",children:n?w.jsx("span",{className:"animate-spin",children:""}):w.jsxs(w.Fragment,{children:[w.jsxs("svg",{"aria-hidden":"true",className:"h-6 w-6",fill:"none",height:"24",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24",width:"24",xmlns:"http://www.w3.org/2000/svg",children:[w.jsx("path",{d:"M22.56 12.25C22.56 11.45 22.49 10.68 22.36 9.92H12V14.3H18.05C17.78 15.68 17.06 16.85 15.96 17.65V20.12H19.64C21.55 18.35 22.56 15.54 22.56 12.25Z",fill:"#4285F4"}),w.jsx("path",{d:"M12 23C14.97 23 17.52 22.02 19.64 20.12L15.96 17.65C14.99 18.31 13.62 18.72 12 18.72C9.09 18.72 6.6 16.83 5.75 14.15H1.97V16.7C3.86 20.48 7.64 23 12 23Z",fill:"#34A853"}),w.jsx("path",{d:"M5.75 14.15C5.55 13.59 5.45 12.98 5.45 12.35C5.45 11.72 5.55 11.11 5.75 10.55V7.98H1.97C1.22 9.38 0.77 10.83 0.77 12.35C0.77 13.87 1.22 15.32 1.97 16.7L5.75 14.15Z",fill:"#FBBC05"}),w.jsx("path",{d:"M12 5.98C13.72 5.98 15.14 6.58 16.22 7.59L19.71 4.1C17.52 2.19 14.97 1 12 1C7.64 1 3.86 3.52 1.97 7.98L5.75 10.55C6.6 7.87 9.09 5.98 12 5.98Z",fill:"#EA4335"})]}),"Continue with Google"]})})]})]})})}const YV=[{path:"/dashboard",icon:"home",label:"Dashboard"},{path:"/leaderboard",icon:"leaderboard",label:"Leaderboard"},{path:"/feed",icon:"feed",label:"Feed"},{path:"/settings",icon:"settings",label:"Settings"}];function ol(){return w.jsx("nav",{className:"fixed bottom-0 left-0 right-0 h-20 bg-content-light/80 dark:bg-content-dark/80 backdrop-blur-lg border-t border-border-light dark:border-border-dark z-20",children:w.jsx("div",{className:"flex justify-around items-center h-full max-w-md mx-auto",children:YV.map(n=>w.jsx(hE,{to:n.path,className:({isActive:e})=>`flex flex-col items-center justify-center gap-1 transition-colors ${e?"text-primary":"text-text-light-secondary dark:text-text-dark-secondary"}`,children:({isActive:e})=>w.jsxs(w.Fragment,{children:[w.jsx("span",{className:`material-symbols-outlined ${e?"filled":""}`,style:e?{fontVariationSettings:"'FILL' 1, 'wght' 400"}:{},children:n.icon}),w.jsx("span",{className:`text-xs ${e?"font-bold":""}`,children:n.label})]})},n.path))})})}const XV=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];function JV({selectedDate:n,onDateSelect:e,completionsByDate:t={}}){const r=new Date;r.setHours(0,0,0,0);const s=U.useMemo(()=>{const v=[],_=new Date(r),x=r.getDay(),S=x===0?6:x-1;_.setDate(r.getDate()-S);for(let N=0;N<7;N++){const P=new Date(_);P.setDate(_.getDate()+N),v.push(P)}return v},[]),a=v=>v.toDateString()===r.toDateString(),l=v=>n?v.toDateString()===new Date(n).toDateString():a(v),d=v=>v.toISOString().split("T")[0],f=v=>{const _=d(v);return t[_]&&t[_].length>0},p=v=>v<r&&!a(v);return w.jsx("div",{className:"flex overflow-x-auto no-scrollbar pt-2 pb-4 px-4",children:w.jsx("div",{className:"flex space-x-3",children:s.map(v=>{const _=l(v),x=f(v),S=p(v);return w.jsxs("button",{onClick:()=>e==null?void 0:e(v),className:`
                flex flex-col items-center justify-center w-14 h-24 rounded-xl flex-shrink-0 transition-all
                ${_?"bg-primary":"bg-content-light dark:bg-content-dark border border-border-light dark:border-border-dark"}
              `,children:[w.jsx("p",{className:`text-sm font-medium ${_?"text-text-light-primary":"text-text-light-secondary dark:text-text-dark-secondary"}`,children:XV[(v.getDay()+6)%7]}),w.jsx("p",{className:`text-lg font-bold mt-1 ${_?"text-text-light-primary":"text-text-light-primary dark:text-text-dark-primary"}`,children:v.getDate()}),w.jsx("div",{className:`w-2 h-2 rounded-full mt-2 ${_?"bg-text-light-primary":x?"bg-primary":S?"bg-text-light-secondary/30 dark:bg-text-dark-secondary/30":"bg-text-light-secondary dark:bg-text-dark-secondary/50"}`})]},v.toISOString())})})})}function ZV({streak:n,size:e="md"}){if(!n||n===0)return null;const t={sm:"text-xs",md:"text-sm",lg:"text-base"};return w.jsxs("span",{className:`text-text-light-secondary dark:text-text-dark-secondary ${t[e]}`,children:[" ",n," ",n===1?"day":"days"]})}function nS({habit:n,isCompleted:e,onToggle:t,currentValue:r,onUpdateProgress:s,showCheckbox:a=!0,disabled:l=!1}){const d=qn(),f=()=>{d(`/habit/${n.id}`)},p=v=>{v.stopPropagation(),!l&&t(n.id)};return w.jsxs("div",{className:`flex items-center gap-x-4 p-4 rounded-lg bg-content-light dark:bg-content-dark cursor-pointer transition-colors ${l?"opacity-70 cursor-not-allowed":"hover:bg-gray-50 dark:hover:bg-gray-800/50"}`,onClick:l?void 0:f,children:[w.jsx("div",{className:"flex-grow",children:w.jsxs("p",{className:"text-text-light-primary dark:text-text-dark-primary text-base font-normal leading-normal",children:[n.title," ",n.currentStreak>0&&w.jsx(ZV,{streak:n.currentStreak})]})}),w.jsx("span",{className:"material-symbols-outlined text-text-light-secondary dark:text-text-dark-secondary text-base",children:n.isPublic?"public":"lock"}),a&&(n.completionType==="numerical"?w.jsxs("div",{className:"flex items-center gap-2",onClick:v=>v.stopPropagation(),children:[w.jsx("button",{onClick:()=>!l&&s(n.id,Math.max(0,(r||0)-1)),disabled:l||(r||0)<=0,className:`size-8 rounded-full bg-gray-100 dark:bg-gray-800 flex items-center justify-center text-gray-600 dark:text-gray-400 hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors ${l?"opacity-50 cursor-not-allowed":""}`,children:w.jsx("span",{className:"material-symbols-outlined text-lg",children:"remove"})}),w.jsxs("div",{className:"flex flex-col items-center min-w-[60px]",children:[w.jsx("span",{className:"text-sm font-bold text-gray-900 dark:text-white",children:r||0}),w.jsxs("span",{className:"text-[10px] text-gray-500 uppercase",children:["/ ",n.targetValue," ",n.unit]})]}),w.jsx("button",{onClick:()=>!l&&s(n.id,(r||0)+1),disabled:l,className:`size-8 rounded-full bg-primary/10 flex items-center justify-center text-primary hover:bg-primary/20 transition-colors ${l?"opacity-50 cursor-not-allowed":""}`,children:w.jsx("span",{className:"material-symbols-outlined text-lg",children:"add"})})]}):w.jsx("input",{type:"checkbox",checked:e,onChange:p,onClick:v=>v.stopPropagation(),disabled:l,className:`h-6 w-6 rounded-md border-border-light dark:border-border-dark border-2 bg-transparent text-primary checked:bg-primary checked:border-primary focus:ring-0 focus:ring-offset-0 focus:border-border-light dark:focus:border-border-dark focus:outline-none ${l?"cursor-not-allowed opacity-50":"cursor-pointer"}`}))]})}function eO(){var Ze;const n=qn(),{user:e}=go(),{habits:t,completions:r,isLoading:s,getTodaysHabits:a,getStatsForDate:l,isHabitCompleted:d,toggleCompletion:f,updateHabitProgress:p,getHabitValue:v,loadCompletionsForDate:_,subscribeToHabits:x,checkStreaks:S}=cs(),[N,P]=U.useState(new Date),K=br(new Date),Q=br(N),H=Q===K,se=Q>K,ce=Q<K,re=a(N),{completed:C,total:k,percentage:A}=l(Q);U.useEffect(()=>{e!=null&&e.uid&&_(e.uid,Q)},[Q,e==null?void 0:e.uid,_]),U.useEffect(()=>{if(e!=null&&e.uid){const ee=x(e.uid);return()=>ee()}},[e==null?void 0:e.uid,x]),U.useEffect(()=>{e!=null&&e.uid&&t.length>0&&S(e.uid)},[e==null?void 0:e.uid,t.length>0]);const D=()=>{const ee=new Date().getHours();return ee<12?"Good Morning":ee<18?"Good Afternoon":"Good Evening"},L=((Ze=e==null?void 0:e.displayName)==null?void 0:Ze.split(" ")[0])||"there",j=async ee=>{if(e!=null&&e.uid)try{await f(ee,e.uid,Q)}catch(Fe){console.error("Error toggling completion:",Fe)}},R=async(ee,Fe)=>{if(e!=null&&e.uid)try{await p(ee,e.uid,Q,Fe)}catch(le){console.error("Error updating progress:",le)}},Ke=ee=>{P(ee)};return w.jsxs("div",{className:"relative flex h-auto min-h-screen w-full flex-col overflow-x-hidden",children:[w.jsxs("div",{className:"flex-grow pb-40",children:[w.jsxs("div",{className:"md:min-h-[50vh] md:flex md:flex-col md:justify-center md:bg-gray-50/50 md:dark:bg-gray-900/50",children:[w.jsxs("div",{className:"flex items-center bg-background-light dark:bg-background-dark md:bg-transparent p-4 pb-2 justify-between sticky top-0 z-10 md:static",children:[w.jsxs("div",{className:"flex items-center gap-3",children:[w.jsx("div",{className:"flex size-12 shrink-0 items-center justify-center",children:e!=null&&e.photoURL?w.jsx("img",{src:e.photoURL,alt:"Profile",className:"rounded-full size-10 object-cover",referrerPolicy:"no-referrer"}):w.jsx("div",{className:"rounded-full size-10 bg-primary/20 flex items-center justify-center",children:w.jsx("span",{className:"material-symbols-outlined text-primary",children:"person"})})}),w.jsxs("h2",{className:"text-text-light-primary dark:text-text-dark-primary text-lg font-bold leading-tight tracking-[-0.015em] flex-1",children:[D(),", ",L,"!"]})]}),w.jsx("div",{className:"flex w-12 items-center justify-end",children:w.jsx("button",{className:"flex max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-12 bg-transparent text-text-light-primary dark:text-text-dark-primary gap-2 text-base font-bold leading-normal tracking-[0.015em] min-w-0 p-0",children:w.jsx("span",{className:"material-symbols-outlined",children:"calendar_today"})})})]}),w.jsxs("div",{className:"flex flex-col gap-3 p-4",children:[w.jsxs("div",{className:"flex gap-6 justify-between items-center",children:[w.jsxs("p",{className:"text-text-light-primary dark:text-text-dark-primary text-base font-medium leading-normal",children:[H?"You've completed":"Completed"," ",C," of ",k," habits",H?" today":"","!"]}),w.jsxs("p",{className:"text-text-light-secondary dark:text-text-dark-secondary text-sm font-normal leading-normal",children:[A,"%"]})]}),w.jsx("div",{className:"rounded-full bg-border-light dark:bg-border-dark/50",children:w.jsx("div",{className:"h-2 rounded-full bg-primary transition-all duration-500 ease-out",style:{width:`${A}%`}})}),w.jsx("p",{className:"text-text-light-secondary dark:text-text-dark-secondary text-sm font-normal leading-normal",children:A>=100?" All done!":A>0?"Keep it up!":k===0?"No habits scheduled":"Start completing your habits!"})]}),w.jsx(JV,{selectedDate:N,onDateSelect:Ke,completionsByDate:r})]}),w.jsx("h3",{className:"text-text-light-primary dark:text-text-dark-primary text-lg font-bold leading-tight tracking-[-0.015em] px-4 pb-2 pt-2",children:H?"Today's Habits":`Habits for ${N.toLocaleDateString("en-US",{weekday:"long"})}`}),w.jsx("div",{className:"px-4 flex flex-col gap-2",children:s?w.jsx("div",{className:"flex justify-center py-12",children:w.jsx(Eo,{})}):re.length===0?w.jsxs("div",{className:"text-center py-12",children:[w.jsx("span",{className:"material-symbols-outlined text-4xl text-gray-400 mb-2 block",children:"checklist"}),w.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:t.length===0?"No habits yet":"No habits scheduled for this day"}),t.length===0&&w.jsx("button",{onClick:()=>n("/new-habit"),className:"text-primary font-medium hover:underline",children:"Create your first habit"})]}):re.map(ee=>w.jsx(nS,{habit:ee,isCompleted:d(ee.id,Q),currentValue:v(ee.id,Q),onToggle:j,onUpdateProgress:R,disabled:se||ce},ee.id))})]}),w.jsx("div",{className:"fixed bottom-24 right-4 z-20",children:w.jsx("button",{onClick:()=>n("/new-habit"),className:"flex items-center justify-center size-14 cursor-pointer overflow-hidden rounded-full bg-primary text-text-light-primary shadow-lg hover:shadow-xl transition-shadow animate-pulse-glow",children:w.jsx("span",{className:"material-symbols-outlined text-3xl",children:"add"})})}),w.jsx(ol,{})]})}function Rr({label:n,id:e,error:t,className:r="",...s}){return w.jsxs("div",{className:"flex flex-col",children:[n&&w.jsx("label",{htmlFor:e,className:"text-base font-medium leading-normal pb-2 text-gray-800 dark:text-gray-400 uppercase tracking-wide",children:n}),w.jsx("input",{id:e,className:`
          form-input flex w-full min-w-0 flex-1 resize-none overflow-hidden 
          rounded-lg border border-gray-200 dark:border-gray-700 
          bg-white dark:bg-gray-800 
          h-14 p-4 
          text-base font-normal leading-normal 
          text-text-light-primary dark:text-white 
          placeholder:text-gray-400 dark:placeholder:text-gray-500 
          focus:border-primary focus:ring-primary/50 focus:ring-2 focus:outline-none
          transition-colors
          ${t?"border-danger focus:border-danger focus:ring-danger/50":""}
          ${r}
        `,...s}),t&&w.jsx("p",{className:"mt-1 text-sm text-danger",children:t})]})}function Wa({checked:n,onChange:e,label:t,description:r}){return w.jsxs("div",{className:"flex flex-col",children:[w.jsxs("div",{className:"flex items-center justify-between",children:[t&&w.jsx("h3",{className:"text-base font-medium leading-tight tracking-[-0.015em] text-gray-800 dark:text-gray-400 uppercase",children:t}),w.jsxs("label",{className:"relative inline-flex cursor-pointer items-center",children:[w.jsx("input",{type:"checkbox",checked:n,onChange:s=>e(s.target.checked),className:"peer sr-only"}),w.jsx("div",{className:"peer h-6 w-11 rounded-full bg-gray-200 dark:bg-gray-700 after:absolute after:top-[2px] after:left-[2px] after:h-5 after:w-5 after:rounded-full after:border after:border-gray-300 dark:after:border-gray-600 after:bg-white after:transition-all peer-checked:bg-primary peer-checked:after:translate-x-full peer-checked:after:border-white"})]})]}),r&&w.jsx("p",{className:"pt-2 text-sm text-gray-500 dark:text-gray-400",children:r})]})}const tO=[{key:1,label:"M",name:"Monday"},{key:2,label:"T",name:"Tuesday"},{key:3,label:"W",name:"Wednesday"},{key:4,label:"T",name:"Thursday"},{key:5,label:"F",name:"Friday"},{key:6,label:"S",name:"Saturday"},{key:0,label:"S",name:"Sunday"}];function rS({isOpen:n,onClose:e,selectedDays:t=[],onSave:r}){const[s,a]=U.useState(t),l=f=>{a(p=>p.includes(f)?p.filter(v=>v!==f):[...p,f])},d=()=>{r(s),e()};return n?w.jsx("div",{className:"fixed inset-0 z-50 flex items-end bg-black/50 backdrop-blur-sm animate-fade-in",children:w.jsxs("div",{className:"flex h-auto w-full flex-col rounded-t-xl bg-background-light dark:bg-gray-800 animate-slide-up",children:[w.jsxs("div",{className:"relative flex items-center justify-center border-b border-gray-200 p-4 dark:border-gray-700",children:[w.jsx("h2",{className:"text-lg font-bold text-text-light-primary dark:text-text-dark-primary",children:"Select Days"}),w.jsx("button",{onClick:e,className:"absolute right-4 top-1/2 -translate-y-1/2",children:w.jsx("span",{className:"material-symbols-outlined !text-2xl text-gray-500 dark:text-gray-400",children:"close"})})]}),w.jsxs("div",{className:"p-4",children:[w.jsx("p",{className:"mb-4 text-center text-sm text-gray-500 dark:text-gray-400",children:"Choose the specific days of the week you want to track this habit."}),w.jsx("div",{className:"flex justify-center gap-2",children:tO.map(f=>{const p=s.includes(f.key);return w.jsx("button",{onClick:()=>l(f.key),className:`
                    relative flex h-12 w-12 cursor-pointer flex-col items-center justify-center rounded-full border transition-all
                    ${p?"border-primary bg-primary text-black":"border-gray-200 dark:border-gray-600 bg-white dark:bg-gray-800 text-text-light-primary dark:text-text-dark-primary hover:border-primary/50"}
                  `,title:f.name,children:w.jsx("span",{className:"font-bold",children:f.label})},f.key)})})]}),w.jsx("div",{className:"p-4 pt-2 pb-6",children:w.jsx(ui,{fullWidth:!0,onClick:d,disabled:s.length===0,children:"Save"})})]})}):null}const nO=[{value:"checkbox",icon:"check_box",label:"Checkbox"},{value:"numerical",icon:"pin",label:"Numerical"}];function rO(){const n=qn(),{user:e}=go(),{addHabit:t}=cs(),[r,s]=U.useState(""),[a,l]=U.useState("daily"),[d,f]=U.useState([]),[p,v]=U.useState("checkbox"),[_,x]=U.useState(""),[S,N]=U.useState(""),[P,O]=U.useState(new Date().toISOString().split("T")[0]),[K,Q]=U.useState(""),[H,se]=U.useState(!1),[ce,re]=U.useState(!1),[C,k]=U.useState(!1),[A,D]=U.useState(!1),[L,j]=U.useState(null),R=r.trim().length>0&&(p==="checkbox"||_>0&&S.trim().length>0)&&(a!=="one-time"||P),Ke=ee=>{l(ee),ee==="custom"&&k(!0)},Ze=async()=>{if(!(!R||A||!(e!=null&&e.uid))){D(!0),j(null);try{const ee={title:r.trim(),description:"",frequency:a,customDays:a==="custom"?d:[],targetDate:a==="one-time"?P:null,reminderTime:K||null,hasReminder:H&&!!K,completionType:p,targetValue:p==="numerical"?Number(_):null,unit:p==="numerical"?S.trim():null,isPublic:!ce};await t(e.uid,ee),n("/dashboard")}catch(ee){console.error("Failed to create habit:",ee),j("Failed to create habit. Please try again.")}finally{D(!1)}}};return w.jsxs("div",{className:"relative flex h-auto min-h-screen w-full flex-col bg-background-light dark:bg-background-dark overflow-x-hidden",children:[w.jsxs("header",{className:"flex items-center p-4",children:[w.jsx("button",{onClick:()=>n(-1),className:"flex size-12 shrink-0 items-center justify-start text-text-light-primary dark:text-gray-200",children:w.jsx("span",{className:"material-symbols-outlined !text-2xl",children:"arrow_back_ios_new"})}),w.jsx("h1",{className:"flex-1 text-center text-lg font-bold leading-tight tracking-[-0.015em] text-text-light-primary dark:text-gray-200",children:"New Habit"}),w.jsx("div",{className:"flex w-12 items-center justify-end",children:w.jsx("button",{onClick:Ze,disabled:!R||A,className:`text-base font-bold leading-normal tracking-[0.015em] shrink-0 ${R&&!A?"text-primary":"text-primary/50 dark:text-primary/70"}`,children:"Save"})})]}),w.jsxs("main",{className:"flex flex-col gap-6 px-4 pt-4 pb-6",children:[L&&w.jsx("div",{className:"p-3 rounded-lg bg-danger/10 text-danger text-sm",children:L}),w.jsx(Rr,{label:"Name",id:"habitName",placeholder:"e.g., Read for 15 minutes",value:r,onChange:ee=>s(ee.target.value)}),w.jsxs("div",{className:"flex flex-col",children:[w.jsx("h3",{className:"text-base font-medium leading-tight tracking-[-0.015em] pb-2 text-gray-800 dark:text-gray-400 uppercase",children:"Frequency"}),w.jsx("div",{className:"flex h-12 flex-1 items-center justify-center rounded-lg bg-gray-200/60 dark:bg-gray-800 p-1",children:[{value:"daily",label:"Daily"},{value:"weekly",label:"Weekly"},{value:"one-time",label:"One Time"},{value:"custom",label:"More"}].map(ee=>w.jsxs("label",{className:`
                  flex h-full flex-1 cursor-pointer items-center justify-center overflow-hidden rounded-md px-1 
                  text-xs font-medium leading-normal transition-all
                  ${a===ee.value?"bg-white dark:bg-gray-900 text-text-light-primary dark:text-white shadow-sm":"text-gray-600 dark:text-gray-400"}
                `,children:[w.jsxs("span",{className:"flex items-center gap-1",children:[ee.label,ee.value==="custom"&&w.jsx("span",{className:"material-symbols-outlined !text-base",children:"expand_more"})]}),w.jsx("input",{type:"radio",name:"frequency",value:ee.value,checked:a===ee.value,onChange:()=>Ke(ee.value),className:"invisible w-0"})]},ee.value))}),a==="one-time"&&w.jsx("div",{className:"mt-3 animation-slide-down",children:w.jsx(Rr,{label:"Valid only on",type:"date",value:P,onChange:ee=>O(ee.target.value),min:new Date().toISOString().split("T")[0]})}),a==="custom"&&d.length>0&&w.jsxs("button",{onClick:()=>k(!0),className:"mt-2 text-sm text-primary hover:underline text-left",children:[d.length," days selected - tap to edit"]}),a==="custom"&&d.length===0&&w.jsx("button",{onClick:()=>k(!0),className:"mt-2 text-sm text-gray-500 hover:text-primary text-left",children:"Click to select days"})]}),w.jsxs("div",{className:"flex flex-col gap-2",children:[w.jsx("h3",{className:"text-base font-medium leading-tight tracking-[-0.015em] text-gray-800 dark:text-gray-400 uppercase",children:"Schedule"}),w.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[w.jsx(Rr,{label:"Time (Optional)",type:"time",value:K,onChange:ee=>{Q(ee.target.value),ee.target.value&&!H&&se(!0)}}),w.jsx("div",{className:"flex items-end pb-2",children:w.jsx(Wa,{label:"Remind 10m before",checked:H,onChange:se,disabled:!K})})]}),H&&!K&&w.jsx("p",{className:"text-xs text-danger",children:"Please set a time to enable reminders."})]}),w.jsxs("div",{className:"flex flex-col",children:[w.jsx("h3",{className:"text-base font-medium leading-tight tracking-[-0.015em] pb-2 text-gray-800 dark:text-gray-400 uppercase",children:"How will you track it?"}),w.jsx("div",{className:"grid grid-cols-2 gap-3 mb-4",children:nO.map(ee=>w.jsxs("label",{className:`
                  flex cursor-pointer flex-col items-center justify-center gap-2 rounded-lg border-2 p-4 py-6 text-center transition-all
                  ${p===ee.value?"border-primary bg-primary/10 dark:bg-primary/20 text-primary":"border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300"}
                `,children:[w.jsx("span",{className:"material-symbols-outlined !text-3xl",children:ee.icon}),w.jsx("span",{className:"font-medium",children:ee.label}),w.jsx("input",{type:"radio",name:"tracking_type",value:ee.value,checked:p===ee.value,onChange:()=>v(ee.value),className:"invisible w-0"})]},ee.value))}),p==="numerical"&&w.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4 animation-slide-down",children:[w.jsx(Rr,{label:"Target Goal",type:"number",placeholder:"e.g. 5",value:_,onChange:ee=>x(ee.target.value),min:"1"}),w.jsx(Rr,{label:"Unit",type:"text",placeholder:"e.g. cups",value:S,onChange:ee=>N(ee.target.value)})]})]}),w.jsx(Wa,{label:"Make it private?",description:"Private habits will not appear on the community feed or your profile.",checked:ce,onChange:re})]}),w.jsx("footer",{className:"mt-auto px-4 pb-6 pt-4",children:w.jsx(ui,{fullWidth:!0,onClick:Ze,isLoading:A,disabled:!R,children:"Add Habit"})}),w.jsx(rS,{isOpen:C,onClose:()=>k(!1),selectedDays:d,onSave:f})]})}const iO=[{value:"daily",label:"Daily"},{value:"weekly",label:"Weekly"},{value:"one-time",label:"One Time"},{value:"custom",label:"More"}],sO=[{value:"checkbox",icon:"check_box",label:"Checkbox"},{value:"numerical",icon:"pin",label:"Numerical"}];function oO(){const{habitId:n}=Wm(),e=qn(),{habits:t,updateHabit:r}=cs(),s=t.find(ee=>ee.id===n),[a,l]=U.useState(""),[d,f]=U.useState("daily"),[p,v]=U.useState([]),[_,x]=U.useState("checkbox"),[S,N]=U.useState(""),[P,O]=U.useState(""),[K,Q]=U.useState(new Date().toISOString().split("T")[0]),[H,se]=U.useState(""),[ce,re]=U.useState(!1),[C,k]=U.useState(!1),[A,D]=U.useState(!1),[L,j]=U.useState(!1);if(U.useEffect(()=>{s&&(l(s.title||""),f(s.frequency||"daily"),v(s.customDays||[]),x(s.completionType||"checkbox"),N(s.targetValue||""),O(s.unit||""),Q(s.targetDate||new Date().toISOString().split("T")[0]),se(s.reminderTime||""),re(s.hasReminder||!1),k(!s.isPublic))},[s]),!s)return w.jsx("div",{className:"min-h-screen bg-background-light dark:bg-background-dark flex items-center justify-center",children:w.jsxs("div",{className:"text-center",children:[w.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"Habit not found"}),w.jsx(ui,{onClick:()=>e("/dashboard"),children:"Back to Dashboard"})]})});const R=a.trim().length>0&&(_==="checkbox"||S>0&&P.trim().length>0)&&(d!=="one-time"||K),Ke=ee=>{f(ee),ee==="custom"&&D(!0)},Ze=async()=>{if(!(!R||L)){j(!0);try{await r(n,{title:a.trim(),frequency:d,customDays:d==="custom"?p:[],targetDate:d==="one-time"?K:null,reminderTime:H||null,hasReminder:ce&&!!H,completionType:_,targetValue:_==="numerical"?Number(S):null,unit:_==="numerical"?P.trim():null,isPublic:!C}),e(`/habit/${n}`)}catch(ee){console.error("Failed to update habit:",ee)}finally{j(!1)}}};return w.jsxs("div",{className:"relative flex h-auto min-h-screen w-full flex-col bg-background-light dark:bg-background-dark overflow-x-hidden",children:[w.jsxs("header",{className:"flex items-center p-4",children:[w.jsx("button",{onClick:()=>e("/dashboard"),className:"flex size-12 shrink-0 items-center justify-start text-text-light-primary dark:text-gray-200",children:w.jsx("span",{className:"material-symbols-outlined !text-2xl",children:"arrow_back_ios_new"})}),w.jsx("h1",{className:"flex-1 text-center text-lg font-bold leading-tight tracking-[-0.015em] text-text-light-primary dark:text-gray-200",children:"Edit Habit"}),w.jsx("div",{className:"flex w-12 items-center justify-end",children:w.jsx("button",{onClick:Ze,disabled:!R||L,className:`text-base font-bold leading-normal tracking-[0.015em] shrink-0 ${R&&!L?"text-primary":"text-primary/50 dark:text-primary/70"}`,children:"Save"})})]}),w.jsxs("main",{className:"flex flex-col gap-6 px-4 pt-4 pb-6",children:[w.jsx(Rr,{label:"Name",id:"habitName",placeholder:"e.g., Read for 15 minutes",value:a,onChange:ee=>l(ee.target.value)}),w.jsxs("div",{className:"flex flex-col",children:[w.jsx("h3",{className:"text-base font-medium leading-tight tracking-[-0.015em] pb-2 text-gray-800 dark:text-gray-400 uppercase",children:"Frequency"}),w.jsx("div",{className:"flex h-12 flex-1 items-center justify-center rounded-lg bg-gray-200/60 dark:bg-gray-800 p-1",children:iO.map(ee=>w.jsxs("label",{className:`
                  flex h-full flex-1 cursor-pointer items-center justify-center overflow-hidden rounded-md px-1 
                  text-xs font-medium leading-normal transition-all
                  ${d===ee.value?"bg-white dark:bg-gray-900 text-text-light-primary dark:text-white shadow-sm":"text-gray-600 dark:text-gray-400"}
                `,children:[w.jsxs("span",{className:"flex items-center gap-1",children:[ee.label,ee.value==="custom"&&w.jsx("span",{className:"material-symbols-outlined !text-base",children:"expand_more"})]}),w.jsx("input",{type:"radio",name:"frequency",value:ee.value,checked:d===ee.value,onChange:()=>Ke(ee.value),className:"invisible w-0"})]},ee.value))}),d==="one-time"&&w.jsx("div",{className:"mt-3 animation-slide-down",children:w.jsx(Rr,{label:"Valid only on",type:"date",value:K,onChange:ee=>Q(ee.target.value),min:new Date().toISOString().split("T")[0]})}),d==="custom"&&p.length>0&&w.jsxs("button",{onClick:()=>D(!0),className:"mt-2 text-sm text-primary hover:underline text-left",children:[p.length," days selected - tap to edit"]}),d==="custom"&&p.length===0&&w.jsx("button",{onClick:()=>D(!0),className:"mt-2 text-sm text-gray-500 hover:text-primary text-left",children:"Click to select days"})]}),w.jsxs("div",{className:"flex flex-col gap-2",children:[w.jsx("h3",{className:"text-base font-medium leading-tight tracking-[-0.015em] text-gray-800 dark:text-gray-400 uppercase",children:"Schedule"}),w.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[w.jsx(Rr,{label:"Time (Optional)",type:"time",value:H,onChange:ee=>{se(ee.target.value),ee.target.value&&!ce&&re(!0)}}),w.jsx("div",{className:"flex items-end pb-2",children:w.jsx(Wa,{label:"Remind 10m before",checked:ce,onChange:re,disabled:!H})})]}),ce&&!H&&w.jsx("p",{className:"text-xs text-danger",children:"Please set a time to enable reminders."})]}),w.jsxs("div",{className:"flex flex-col",children:[w.jsx("h3",{className:"text-base font-medium leading-tight tracking-[-0.015em] pb-2 text-gray-800 dark:text-gray-400 uppercase",children:"How will you track it?"}),w.jsx("div",{className:"grid grid-cols-2 gap-3 mb-4",children:sO.map(ee=>w.jsxs("label",{className:`
                  flex cursor-pointer flex-col items-center justify-center gap-2 rounded-lg border-2 p-4 py-6 text-center transition-all
                  ${_===ee.value?"border-primary bg-primary/10 dark:bg-primary/20 text-primary":"border-gray-200 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300"}
                `,children:[w.jsx("span",{className:"material-symbols-outlined !text-3xl",children:ee.icon}),w.jsx("span",{className:"font-medium",children:ee.label}),w.jsx("input",{type:"radio",name:"tracking_type",value:ee.value,checked:_===ee.value,onChange:()=>x(ee.value),className:"invisible w-0"})]},ee.value))}),_==="numerical"&&w.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4 animation-slide-down",children:[w.jsx(Rr,{label:"Target Goal",type:"number",placeholder:"e.g. 5",value:S,onChange:ee=>N(ee.target.value),min:"1"}),w.jsx(Rr,{label:"Unit",type:"text",placeholder:"e.g. cups",value:P,onChange:ee=>O(ee.target.value)})]})]}),w.jsx(Wa,{label:"Make it private?",description:"Private habits will not appear on the community feed or your profile.",checked:C,onChange:k})]}),w.jsx("footer",{className:"mt-auto px-4 pb-6 pt-4",children:w.jsx(ui,{fullWidth:!0,onClick:Ze,isLoading:L,disabled:!R,children:"Save Changes"})}),w.jsx(rS,{isOpen:A,onClose:()=>D(!1),selectedDays:p,onSave:v})]})}const aO={daily:"Daily",weekly:"Weekly",custom:"Custom Days"},lO={checkbox:"Check-off",numerical:"Numerical"},uO=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];function cO(){const{habitId:n}=Wm(),e=qn(),{habits:t,deleteHabit:r,isLoading:s}=cs(),a=t.find(p=>p.id===n),l=async()=>{if(window.confirm("Are you sure you want to delete this habit? This action cannot be undone."))try{await r(n),e("/dashboard")}catch(p){console.error("Error deleting habit:",p),alert("Failed to delete habit. Please try again.")}};if(s)return w.jsx("div",{className:"min-h-screen bg-background-light dark:bg-background-dark flex items-center justify-center",children:w.jsx(Eo,{size:"lg"})});if(!a)return w.jsx("div",{className:"min-h-screen bg-background-light dark:bg-background-dark flex items-center justify-center",children:w.jsxs("div",{className:"text-center",children:[w.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"Habit not found"}),w.jsx(ui,{onClick:()=>e("/dashboard"),children:"Back to Dashboard"})]})});const d=()=>{var p;return a.frequency!=="custom"||!((p=a.customDays)!=null&&p.length)?null:a.customDays.map(v=>uO[v]).join(", ")},f=[{icon:"event_repeat",label:"Frequency",value:a.frequency==="custom"?d():aO[a.frequency]||a.frequency},{icon:"task_alt",label:"Completion Type",value:lO[a.completionType]||a.completionType||"Check-off"},{icon:a.isPublic?"public":"lock",label:"Visibility",value:a.isPublic?"Public":"Private"}];return w.jsxs("div",{className:"relative flex h-auto min-h-screen w-full flex-col overflow-x-hidden font-display bg-background-light dark:bg-background-dark",children:[w.jsxs("div",{className:"flex-grow pb-28",children:[w.jsxs("header",{className:"flex items-center bg-background-light dark:bg-background-dark p-4 justify-between sticky top-0 z-10 border-b border-border-light dark:border-border-dark",children:[w.jsx("div",{className:"flex w-12 items-center justify-start",children:w.jsx("button",{onClick:()=>e(-1),className:"flex max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-12 bg-transparent text-text-light-primary dark:text-text-dark-primary gap-2 text-base font-bold leading-normal tracking-[0.015em] min-w-0 p-0",children:w.jsx("span",{className:"material-symbols-outlined",children:"arrow_back_ios_new"})})}),w.jsx("h1",{className:"text-text-light-primary dark:text-text-dark-primary text-lg font-bold leading-tight tracking-[-0.015em] text-center",children:"Habit Details"}),w.jsx("div",{className:"flex w-12 items-center justify-end",children:w.jsx("button",{className:"flex max-w-[480px] cursor-pointer items-center justify-center overflow-hidden rounded-lg h-12 bg-transparent text-text-light-primary dark:text-text-dark-primary gap-2 text-base font-bold leading-normal tracking-[0.015em] min-w-0 p-0",children:w.jsx("span",{className:"material-symbols-outlined",children:"more_vert"})})})]}),w.jsxs("main",{className:"p-4",children:[w.jsxs("div",{className:"bg-content-light dark:bg-content-dark rounded-xl p-6 flex flex-col items-center",children:[w.jsx("h2",{className:"text-2xl font-bold text-text-light-primary dark:text-text-dark-primary text-center",children:a.title}),(a.currentStreak||0)>0&&w.jsxs("div",{className:"mt-4 py-2 px-4 rounded-full bg-primary/20 text-primary flex items-center gap-2",children:[w.jsx("span",{className:"material-symbols-outlined text-base",style:{fontVariationSettings:"'FILL' 1, 'wght' 700"},children:"local_fire_department"}),w.jsxs("p",{className:"font-bold text-sm",children:["Current Streak: ",a.currentStreak," ",a.currentStreak===1?"day":"days"]})]})]}),w.jsx("div",{className:"mt-4 grid grid-cols-1 gap-4",children:f.map(p=>w.jsxs("div",{className:"bg-content-light dark:bg-content-dark rounded-xl p-4 flex items-center gap-4",children:[w.jsx("div",{className:"flex items-center justify-center size-10 rounded-lg bg-primary/20 text-primary",children:w.jsx("span",{className:"material-symbols-outlined",children:p.icon})}),w.jsxs("div",{children:[w.jsx("p",{className:"text-sm text-text-light-secondary dark:text-text-dark-secondary",children:p.label}),w.jsx("p",{className:"text-base font-medium text-text-light-primary dark:text-text-dark-primary",children:p.value})]})]},p.label))}),w.jsxs("div",{className:"mt-8 flex flex-col gap-3",children:[w.jsx(ui,{fullWidth:!0,icon:"edit",onClick:()=>e(`/edit-habit/${a.id}`),children:"Edit Habit"}),w.jsx(ui,{fullWidth:!0,variant:"danger",icon:"delete",onClick:l,children:"Delete Habit"})]})]})]}),w.jsx(ol,{})]})}function dO(){const n=qn(),{user:e}=go(),[t,r]=U.useState("thisWeek"),[s,a]=U.useState([]),[l,d]=U.useState({rank:0,percentage:0}),[f,p]=U.useState(!0);U.useEffect(()=>{let N=()=>{};p(!0);try{const P=t==="thisWeek"?rc():DV();N=VV(P,O=>{if(a(O),e!=null&&e.uid){const K=O.find(Q=>Q.userId===e.uid);d(K?{rank:K.rank,percentage:K.percentage}:{rank:O.length+1,percentage:0})}p(!1)})}catch(P){console.error("Error in leaderboard subscription:",P),p(!1)}return()=>{N&&N()}},[t,e==null?void 0:e.uid]);const v=s.slice(0,3),_=s,x=N=>{switch(N){case 1:return"border-yellow-400";case 2:return"border-slate-300";case 3:return"border-amber-600";default:return"border-gray-300"}},S=N=>{switch(N){case 1:return"bg-yellow-400 text-yellow-900";case 2:return"bg-slate-300 text-slate-700";case 3:return"bg-amber-600 text-amber-100";default:return"bg-gray-300 text-gray-700"}};return w.jsxs("div",{className:"relative flex h-auto min-h-screen w-full flex-col overflow-x-hidden bg-background-light dark:bg-background-dark font-display text-slate-800 dark:text-slate-200",children:[w.jsxs("div",{className:"flex items-center p-4 pb-2 bg-background-light dark:bg-background-dark sticky top-0 z-10",children:[w.jsx("button",{onClick:()=>n(-1),className:"flex size-12 shrink-0 items-center justify-start",children:w.jsx("span",{className:"material-symbols-outlined",children:"arrow_back_ios_new"})}),w.jsx("h2",{className:"flex-1 text-center text-lg font-bold leading-tight tracking-[-0.015em]",children:"Weekly Leaderboard"}),w.jsx("div",{className:"flex w-12 items-center justify-end",children:w.jsx("button",{className:"flex h-12 cursor-pointer items-center justify-center gap-2 overflow-hidden rounded-lg bg-transparent min-w-0 p-0 text-base font-bold leading-normal tracking-[0.015em]",children:w.jsx("span",{className:"material-symbols-outlined",children:"ios_share"})})})]}),w.jsx("div",{className:"flex px-4 py-3",children:w.jsxs("div",{className:"flex h-10 flex-1 items-center justify-center rounded-lg bg-black/5 dark:bg-white/5 p-1",children:[w.jsxs("label",{className:`flex h-full grow cursor-pointer items-center justify-center overflow-hidden rounded-lg px-2 text-sm font-medium leading-normal transition-all ${t==="thisWeek"?"bg-background-light dark:bg-background-dark text-slate-900 dark:text-slate-100 shadow-sm":"text-slate-500 dark:text-slate-400"}`,children:[w.jsx("span",{className:"truncate",children:"This Week"}),w.jsx("input",{type:"radio",name:"time-period",value:"thisWeek",checked:t==="thisWeek",onChange:()=>r("thisWeek"),className:"invisible w-0"})]}),w.jsxs("label",{className:`flex h-full grow cursor-pointer items-center justify-center overflow-hidden rounded-lg px-2 text-sm font-medium leading-normal transition-all ${t==="lastWeek"?"bg-background-light dark:bg-background-dark text-slate-900 dark:text-slate-100 shadow-sm":"text-slate-500 dark:text-slate-400"}`,children:[w.jsx("span",{className:"truncate",children:"Last Week"}),w.jsx("input",{type:"radio",name:"time-period",value:"lastWeek",checked:t==="lastWeek",onChange:()=>r("lastWeek"),className:"invisible w-0"})]})]})}),f?w.jsx("div",{className:"flex-1 flex items-center justify-center py-12",children:w.jsx(Eo,{size:"lg"})}):s.length===0?w.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center py-12 px-4",children:[w.jsx("span",{className:"material-symbols-outlined text-5xl text-gray-400 mb-4",children:"leaderboard"}),w.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center",children:"No leaderboard data yet."}),w.jsx("p",{className:"text-gray-400 dark:text-gray-500 text-sm text-center mt-2",children:"Complete habits to appear on the leaderboard!"})]}):w.jsxs(w.Fragment,{children:[w.jsxs("div",{className:"flex items-end justify-center gap-4 px-4 py-6",children:[v[1]&&w.jsxs("div",{className:"flex flex-col items-center gap-2 cursor-pointer transition-transform active:scale-95",onClick:()=>n(`/profile/${v[1].userId}`),children:[w.jsxs("div",{className:"relative",children:[v[1].photoURL?w.jsx("img",{src:v[1].photoURL,alt:v[1].displayName,className:`aspect-square w-16 rounded-full bg-cover bg-center border-2 ${x(2)} object-cover`,referrerPolicy:"no-referrer"}):w.jsx("div",{className:`aspect-square w-16 rounded-full border-2 ${x(2)} bg-primary/20 flex items-center justify-center`,children:w.jsx("span",{className:"material-symbols-outlined text-primary text-2xl",children:"person"})}),w.jsx("div",{className:`absolute -bottom-2 left-1/2 -translate-x-1/2 flex h-6 w-6 items-center justify-center rounded-full ${S(2)} text-sm font-bold`,children:"2"})]}),w.jsx("p",{className:"text-sm font-bold",children:v[1].displayName}),w.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:[v[1].percentage,"%"]})]}),v[0]&&w.jsxs("div",{className:"flex flex-col items-center gap-2 cursor-pointer transition-transform active:scale-95",onClick:()=>n(`/profile/${v[0].userId}`),children:[w.jsxs("div",{className:"relative",children:[v[0].photoURL?w.jsx("img",{src:v[0].photoURL,alt:v[0].displayName,className:`aspect-square w-24 rounded-full bg-cover bg-center border-4 ${x(1)} object-cover`,referrerPolicy:"no-referrer"}):w.jsx("div",{className:`aspect-square w-24 rounded-full border-4 ${x(1)} bg-primary/20 flex items-center justify-center`,children:w.jsx("span",{className:"material-symbols-outlined text-primary text-3xl",children:"person"})}),w.jsx("div",{className:`absolute -bottom-2 left-1/2 -translate-x-1/2 flex h-8 w-8 items-center justify-center rounded-full ${S(1)} text-base font-bold`,children:"1"})]}),w.jsx("p",{className:"text-base font-bold",children:v[0].displayName}),w.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400",children:[v[0].percentage,"%"]})]}),v[2]&&w.jsxs("div",{className:"flex flex-col items-center gap-2 cursor-pointer transition-transform active:scale-95",onClick:()=>n(`/profile/${v[2].userId}`),children:[w.jsxs("div",{className:"relative",children:[v[2].photoURL?w.jsx("img",{src:v[2].photoURL,alt:v[2].displayName,className:`aspect-square w-16 rounded-full bg-cover bg-center border-2 ${x(3)} object-cover`,referrerPolicy:"no-referrer"}):w.jsx("div",{className:`aspect-square w-16 rounded-full border-2 ${x(3)} bg-primary/20 flex items-center justify-center`,children:w.jsx("span",{className:"material-symbols-outlined text-primary text-2xl",children:"person"})}),w.jsx("div",{className:`absolute -bottom-2 left-1/2 -translate-x-1/2 flex h-6 w-6 items-center justify-center rounded-full ${S(3)} text-sm font-bold`,children:"3"})]}),w.jsx("p",{className:"text-sm font-bold",children:v[2].displayName}),w.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:[v[2].percentage,"%"]})]})]}),e&&w.jsx("div",{className:"p-4",children:w.jsxs("div",{className:"flex items-center justify-between gap-4 rounded-xl bg-primary/20 dark:bg-primary/30 p-4 border border-primary",children:[w.jsxs("div",{className:"flex items-center gap-4",children:[w.jsx("p",{className:"text-lg font-bold w-6 text-center",children:l.rank||"-"}),e.photoURL?w.jsx("img",{src:e.photoURL,alt:"Your avatar",className:"w-12 h-12 rounded-full object-cover flex-shrink-0",referrerPolicy:"no-referrer"}):w.jsx("div",{className:"w-12 h-12 rounded-full bg-primary/30 flex items-center justify-center flex-shrink-0",children:w.jsx("span",{className:"material-symbols-outlined text-primary",children:"person"})}),w.jsxs("div",{className:"flex flex-col",children:[w.jsx("p",{className:"text-base font-bold leading-tight",children:"You"}),w.jsxs("p",{className:"text-sm font-normal leading-normal text-slate-600 dark:text-slate-300",children:[l.percentage||0,"% complete"]})]})]}),w.jsx("span",{className:"material-symbols-outlined text-primary",children:"workspace_premium"})]})}),w.jsx("div",{className:"flex flex-col gap-2 px-4 pb-24",children:_.map(N=>w.jsxs("div",{onClick:()=>n(`/profile/${N.userId}`),className:`flex items-center gap-4 rounded-xl p-3 shadow-sm cursor-pointer transition-colors hover:bg-black/5 dark:hover:bg-white/5 ${N.userId===(e==null?void 0:e.uid)?"bg-primary/10 dark:bg-primary/20 border border-primary/50":"bg-white dark:bg-background-dark"}`,children:[w.jsx("p",{className:"w-6 text-center font-semibold text-slate-500 dark:text-slate-400",children:N.rank}),N.photoURL?w.jsx("img",{src:N.photoURL,alt:N.displayName,className:"h-10 w-10 flex-shrink-0 rounded-full object-cover",referrerPolicy:"no-referrer"}):w.jsx("div",{className:"h-10 w-10 flex-shrink-0 rounded-full bg-primary/20 flex items-center justify-center",children:w.jsx("span",{className:"material-symbols-outlined text-primary text-xl",children:"person"})}),w.jsxs("div",{className:"flex-grow",children:[w.jsx("p",{className:"font-bold",children:N.displayName}),w.jsx("div",{className:"mt-1 h-1.5 w-full rounded-full bg-slate-200 dark:bg-slate-700",children:w.jsx("div",{className:"h-1.5 rounded-full bg-primary transition-all",style:{width:`${N.percentage}%`}})})]}),w.jsxs("p",{className:"font-bold text-sm",children:[N.percentage,"%"]})]},N.id))})]}),w.jsx(ol,{})]})}function hO(){const{userId:n}=Wm(),e=qn(),[t,r]=U.useState(null),[s,a]=U.useState([]),[l,d]=U.useState(null),[f,p]=U.useState(!0);return U.useEffect(()=>{(async()=>{if(n){p(!0);try{const[_,x,S]=await Promise.all([tS(n),kV(n),NV(n)]);r(_),a(x),d(S)}catch(_){console.error("Failed to load user profile",_)}finally{p(!1)}}})()},[n]),f?w.jsx("div",{className:"flex h-screen items-center justify-center bg-background-light dark:bg-background-dark",children:w.jsx(Eo,{})}):t?w.jsxs("div",{className:"relative flex h-auto min-h-screen w-full flex-col bg-background-light dark:bg-background-dark pb-24 font-display",children:[w.jsxs("header",{className:"flex items-center p-4 sticky top-0 bg-background-light dark:bg-background-dark z-10 transition-shadow",children:[w.jsx("button",{onClick:()=>e(-1),className:"flex size-12 shrink-0 items-center justify-start text-text-light-primary dark:text-gray-200",children:w.jsx("span",{className:"material-symbols-outlined !text-2xl",children:"arrow_back_ios_new"})}),w.jsx("h1",{className:"flex-1 text-center text-lg font-bold leading-tight tracking-[-0.015em] text-text-light-primary dark:text-gray-200",children:"Profile"}),w.jsx("div",{className:"w-12"})]}),w.jsxs("div",{className:"flex flex-col items-center p-6 gap-4",children:[w.jsx("div",{className:"size-24 rounded-full overflow-hidden border-4 border-primary/20",children:t.photoURL?w.jsx("img",{src:t.photoURL,alt:t.displayName,className:"size-full object-cover",referrerPolicy:"no-referrer"}):w.jsx("div",{className:"size-full bg-primary/20 flex items-center justify-center",children:w.jsx("span",{className:"material-symbols-outlined text-4xl text-primary",children:"person"})})}),w.jsxs("div",{className:"text-center",children:[w.jsx("h2",{className:"text-xl font-bold text-text-light-primary dark:text-white",children:t.displayName||"Anonymous User"}),l&&w.jsxs("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-1",children:["Current Rank: #",l.rank,"  ",l.percentage,"% Completion"]})]})]}),w.jsxs("div",{className:"px-4 flex flex-col gap-4 mt-2",children:[w.jsx("h3",{className:"text-lg font-bold text-text-light-primary dark:text-white",children:"Public Habits"}),s.length===0?w.jsx("div",{className:"text-center py-8 text-gray-500",children:"No public habits shared."}):w.jsx("div",{className:"flex flex-col gap-3",children:s.map(v=>w.jsx(nS,{habit:v,isCompleted:!1,disabled:!0,showCheckbox:!1},v.id))})]}),w.jsx(ol,{})]}):w.jsxs("div",{className:"flex h-screen flex-col items-center justify-center bg-background-light dark:bg-background-dark text-text-light-primary dark:text-white gap-4",children:[w.jsx("p",{children:"User not found"}),w.jsx("button",{onClick:()=>e(-1),className:"text-primary hover:underline",children:"Go Back"})]})}function fO(n,e){let t;try{t=n()}catch{return}return{getItem:s=>{var a;const l=f=>f===null?null:JSON.parse(f,void 0),d=(a=t.getItem(s))!=null?a:null;return d instanceof Promise?d.then(l):l(d)},setItem:(s,a)=>t.setItem(s,JSON.stringify(a,void 0)),removeItem:s=>t.removeItem(s)}}const Bm=n=>e=>{try{const t=n(e);return t instanceof Promise?t:{then(r){return Bm(r)(t)},catch(r){return this}}}catch(t){return{then(r){return this},catch(r){return Bm(r)(t)}}}},pO=(n,e)=>(t,r,s)=>{let a={storage:fO(()=>localStorage),partialize:P=>P,version:0,merge:(P,O)=>({...O,...P}),...e},l=!1;const d=new Set,f=new Set;let p=a.storage;if(!p)return n((...P)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),t(...P)},r,s);const v=()=>{const P=a.partialize({...r()});return p.setItem(a.name,{state:P,version:a.version})},_=s.setState;s.setState=(P,O)=>(_(P,O),v());const x=n((...P)=>(t(...P),v()),r,s);s.getInitialState=()=>x;let S;const N=()=>{var P,O;if(!p)return;l=!1,d.forEach(Q=>{var H;return Q((H=r())!=null?H:x)});const K=((O=a.onRehydrateStorage)==null?void 0:O.call(a,(P=r())!=null?P:x))||void 0;return Bm(p.getItem.bind(p))(a.name).then(Q=>{if(Q)if(typeof Q.version=="number"&&Q.version!==a.version){if(a.migrate){const H=a.migrate(Q.state,Q.version);return H instanceof Promise?H.then(se=>[!0,se]):[!0,H]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,Q.state];return[!1,void 0]}).then(Q=>{var H;const[se,ce]=Q;if(S=a.merge(ce,(H=r())!=null?H:x),t(S,!0),se)return v()}).then(()=>{K==null||K(S,void 0),S=r(),l=!0,f.forEach(Q=>Q(S))}).catch(Q=>{K==null||K(void 0,Q)})};return s.persist={setOptions:P=>{a={...a,...P},P.storage&&(p=P.storage)},clearStorage:()=>{p==null||p.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>N(),hasHydrated:()=>l,onHydrate:P=>(d.add(P),()=>{d.delete(P)}),onFinishHydration:P=>(f.add(P),()=>{f.delete(P)})},a.skipHydration||N(),S||x},mO=pO,gO="completions",yO="habits",vO="users";async function _O(n=50){try{const e=kn(nt,gO),t=pr(e,nl("timestamp","desc"),YP(n*2)),s=(await vi(t)).docs.map(d=>({id:d.id,...d.data()})),a=[],l=new Set;for(const d of s){if(a.length>=n)break;if(!l.has(`${d.habitId}_${d.date}`))try{const f=zn(nt,yO,d.habitId),p=await qa(f);if(!p.exists())continue;const v=p.data();if(!v.isPublic)continue;const _=zn(nt,vO,d.userId),x=await qa(_),S=x.exists()?x.data():{},N=d.type||"completion",P=N==="streak_lost"?d.streakLength||0:v.currentStreak||0;a.push({id:d.id,habitId:d.habitId,habitTitle:v.title,userId:d.userId,username:S.displayName||"Anonymous",photoURL:S.photoURL||null,streak:P,timestamp:d.timestamp,date:d.date,type:N}),l.add(`${d.habitId}_${d.date}_${N}`)}catch(f){console.error("Error processing completion:",f);continue}}return a}catch(e){throw console.error("Error getting public feed:",e),e}}function wO(n){if(!n)return"";const e=n.toDate?n.toDate():new Date(n),r=new Date().getTime()-e.getTime(),s=Math.floor(r/6e4),a=Math.floor(r/36e5),l=Math.floor(r/864e5);return s<1?"just now":s<60?`${s}m ago`:a<24?`${a}h ago`:l<7?`${l}d ago`:e.toLocaleDateString()}const EO=Xm(mO((n,e)=>({posts:[],lastUpdated:null,isLoading:!1,error:null,lastDoc:null,fetchFeed:async(t=!1)=>{const{lastUpdated:r,isLoading:s}=e(),a=Date.now();if(!s){n({isLoading:!0,error:null});try{const d=(await _O(20)).map(f=>{var p,v,_;return{...f,timestamp:((_=(v=(p=f.timestamp)==null?void 0:p.toDate)==null?void 0:v.call(p))==null?void 0:_.toISOString())||f.timestamp}});n({posts:d,lastUpdated:a,isLoading:!1})}catch(l){console.error("Error fetching feed:",l),n({error:l.message,isLoading:!1})}}}}),{name:"feed-storage",partialize:n=>({posts:n.posts,lastUpdated:n.lastUpdated})}));function IO(){const n=qn(),{posts:e,isLoading:t,fetchFeed:r}=EO();return U.useEffect(()=>{r()},[]),w.jsxs("div",{className:"relative flex h-auto min-h-screen w-full flex-col overflow-x-hidden bg-background-light dark:bg-background-dark font-display",children:[w.jsxs("header",{className:"sticky top-0 z-10 flex items-center justify-between border-b border-gray-200/80 bg-background-light/80 p-4 pb-3 backdrop-blur-sm dark:border-gray-800/80 dark:bg-background-dark/80",children:[w.jsx("button",{onClick:()=>n(-1),className:"flex size-12 shrink-0 items-center justify-start",children:w.jsx("span",{className:"material-symbols-outlined text-text-light-primary dark:text-text-dark-primary",children:"arrow_back_ios_new"})}),w.jsx("h1",{className:"flex-1 text-center text-lg font-bold leading-tight tracking-[-0.015em] text-text-light-primary dark:text-text-dark-primary",children:"Progress Feed"}),w.jsx("div",{className:"flex w-12 items-center justify-end",children:w.jsx("button",{className:"flex h-12 cursor-pointer items-center justify-center gap-2 overflow-hidden rounded-lg bg-transparent text-base font-bold leading-normal tracking-[0.015em] text-text-light-primary dark:text-text-dark-primary",children:w.jsx("span",{className:"material-symbols-outlined",children:"search"})})})]}),w.jsx("main",{className:"flex-grow pb-24",children:t&&e.length===0?w.jsx("div",{className:"flex justify-center py-12",children:w.jsx(Eo,{size:"lg"})}):e.length===0?w.jsxs("div",{className:"flex flex-col items-center justify-center py-12 px-4",children:[w.jsx("span",{className:"material-symbols-outlined text-5xl text-gray-400 mb-4",children:"feed"}),w.jsx("p",{className:"text-gray-500 dark:text-gray-400 text-center",children:"No public activity yet."}),w.jsx("p",{className:"text-gray-400 dark:text-gray-500 text-sm text-center mt-2",children:"Complete public habits to appear in the feed!"})]}):e.map(s=>w.jsx("div",{className:"border-b border-gray-200/80 p-4 dark:border-gray-800/80",children:w.jsxs("div",{className:"flex items-start gap-3",children:[s.photoURL?w.jsx("img",{className:"h-10 w-10 rounded-full object-cover flex-shrink-0",alt:`${s.username}'s avatar`,src:s.photoURL,referrerPolicy:"no-referrer"}):w.jsx("div",{className:"h-10 w-10 rounded-full bg-primary/20 flex items-center justify-center flex-shrink-0",children:w.jsx("span",{className:"material-symbols-outlined text-primary text-xl",children:"person"})}),w.jsxs("div",{className:"flex flex-1 flex-col gap-2",children:[w.jsxs("div",{className:"flex items-center gap-2",children:[w.jsx("p",{className:"font-bold text-text-light-primary dark:text-text-dark-primary",children:s.username}),w.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[" ",wO(s.timestamp)]})]}),s.type==="streak_lost"?w.jsxs("div",{className:"flex flex-col gap-1",children:[w.jsxs("p",{className:"text-base text-gray-700 dark:text-gray-300",children:["Lost a ",w.jsxs("span",{className:"font-bold text-red-500",children:[s.streak," day streak"]})," on ",s.habitTitle]}),w.jsxs("div",{className:"flex items-center gap-1 text-red-500 text-sm",children:[w.jsx("span",{className:"material-symbols-outlined text-[18px]",children:"heart_broken"}),w.jsx("span",{className:"font-medium",children:"Ouch! Don't give up!"})]})]}):w.jsxs(w.Fragment,{children:[w.jsxs("p",{className:"text-base text-text-light-primary dark:text-text-dark-primary",children:["Completed: ",s.habitTitle]}),s.streak>0&&w.jsx("div",{className:"mt-2 flex items-center",children:w.jsxs("div",{className:"flex items-center gap-1 rounded-full bg-primary/20 px-3 py-1 text-sm font-medium",children:[w.jsx("span",{className:"material-symbols-outlined !text-[18px] !font-bold text-primary",children:"local_fire_department"}),w.jsx("span",{className:"font-bold text-text-light-primary dark:text-text-dark-primary",children:s.streak})]})})]})]})]})},s.id))}),w.jsx(ol,{})]})}function xO(){const n=qn(),{user:e,clearUser:t}=go(),{habits:r,clearAll:s}=cs(),[a,l]=U.useState(document.documentElement.classList.contains("dark")),[d,f]=U.useState(!1),[p,v]=U.useState(!1),_=async()=>{var re;if(!(!e||p)){v(!0);try{const C=await jV(r,e.uid);let k=`Sync Complete!
 ${C.success} habits synced
 ${C.failed} failed`;C.failed>0&&((re=C.errors)==null?void 0:re.length)>0&&(k+=`

Errors:
${C.errors.slice(0,3).join(`
`)}`),alert(k)}catch(C){console.error(C),alert("Sync failed: "+C.message)}finally{v(!1)}}},[x,S]=U.useState(()=>(JSON.parse(localStorage.getItem("habitParams"))||{}).notificationsEnabled||!1),[N,P]=U.useState(()=>(JSON.parse(localStorage.getItem("habitParams"))||{}).reminderTime||"09:00"),O=async re=>{const k={...JSON.parse(localStorage.getItem("habitParams"))||{},...re};if(localStorage.setItem("habitParams",JSON.stringify(k)),e!=null&&e.uid)try{await $V(e.uid,{settings:k})}catch(A){console.error("Failed to sync settings to cloud:",A)}},K=re=>{l(re),re?(document.documentElement.classList.add("dark"),localStorage.setItem("theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("theme","light"))},Q=async re=>{re?await UV()?(S(!0),O({notificationsEnabled:!0})):(S(!1),alert("Notification permission denied. Please enable it in your browser settings.")):(S(!1),O({notificationsEnabled:!1}))},H=re=>{const C=re.target.value;P(C),O({reminderTime:C})},se=async()=>{f(!0);try{await WV(),t(),s(),n("/")}catch(re){console.error("Logout error:",re),alert("Failed to sign out. Please try again.")}finally{f(!1)}},ce={totalHabits:r.length,publicHabits:r.filter(re=>re.isPublic).length,privateHabits:r.filter(re=>!re.isPublic).length,totalStreak:r.reduce((re,C)=>re+(C.currentStreak||0),0)};return w.jsxs("div",{className:"relative flex h-auto min-h-screen w-full flex-col overflow-x-hidden bg-background-light dark:bg-background-dark font-display",children:[w.jsxs("div",{className:"flex-grow pb-28",children:[w.jsxs("header",{className:"flex items-center bg-background-light dark:bg-background-dark p-4 pb-2 sticky top-0 z-10",children:[w.jsx("button",{onClick:()=>n(-1),className:"flex size-12 shrink-0 items-center justify-start text-text-light-primary dark:text-text-dark-primary",children:w.jsx("span",{className:"material-symbols-outlined",children:"arrow_back_ios_new"})}),w.jsx("h1",{className:"flex-1 text-center text-lg font-bold leading-tight tracking-[-0.015em] text-text-light-primary dark:text-text-dark-primary",children:"Settings"}),w.jsx("div",{className:"w-12"})]}),w.jsxs("main",{className:"p-4 flex flex-col gap-6",children:[w.jsx("section",{className:"bg-content-light dark:bg-content-dark rounded-xl p-4",children:w.jsxs("div",{className:"flex items-center gap-4",children:[e!=null&&e.photoURL?w.jsx("img",{src:e.photoURL,alt:"Profile",className:"w-16 h-16 rounded-full object-cover",referrerPolicy:"no-referrer"}):w.jsx("div",{className:"w-16 h-16 rounded-full bg-primary/20 flex items-center justify-center",children:w.jsx("span",{className:"material-symbols-outlined text-primary text-3xl",children:"person"})}),w.jsxs("div",{children:[w.jsx("h2",{className:"text-lg font-bold text-text-light-primary dark:text-text-dark-primary",children:(e==null?void 0:e.displayName)||"User"}),w.jsx("p",{className:"text-sm text-text-light-secondary dark:text-text-dark-secondary",children:e==null?void 0:e.email})]})]})}),w.jsxs("section",{className:"bg-content-light dark:bg-content-dark rounded-xl p-4",children:[w.jsx("h3",{className:"text-sm font-medium text-text-light-secondary dark:text-text-dark-secondary uppercase mb-4",children:"Your Stats"}),w.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[w.jsxs("div",{className:"text-center p-3 bg-primary/10 dark:bg-primary/20 rounded-lg",children:[w.jsx("p",{className:"text-2xl font-bold text-primary",children:ce.totalHabits}),w.jsx("p",{className:"text-xs text-text-light-secondary dark:text-text-dark-secondary",children:"Total Habits"})]}),w.jsxs("div",{className:"text-center p-3 bg-primary/10 dark:bg-primary/20 rounded-lg",children:[w.jsxs("p",{className:"text-2xl font-bold text-primary",children:[" ",ce.totalStreak]}),w.jsx("p",{className:"text-xs text-text-light-secondary dark:text-text-dark-secondary",children:"Total Streak Days"})]}),w.jsxs("div",{className:"text-center",children:[w.jsx("p",{className:"text-xl font-bold text-primary",children:ce.publicHabits}),w.jsx("p",{className:"text-xs text-text-light-secondary dark:text-text-dark-secondary",children:"Public"})]}),w.jsxs("div",{className:"text-center",children:[w.jsx("p",{className:"text-xl font-bold text-primary",children:ce.privateHabits}),w.jsx("p",{className:"text-xs text-text-light-secondary dark:text-text-dark-secondary",children:"Private"})]})]})]}),w.jsxs("section",{className:"bg-content-light dark:bg-content-dark rounded-xl p-4",children:[w.jsx("h3",{className:"text-sm font-medium text-text-light-secondary dark:text-text-dark-secondary uppercase mb-4",children:"Preferences"}),w.jsx(Wa,{label:"Dark Mode",checked:a,onChange:K}),w.jsx("div",{className:"my-4 h-px bg-border-light dark:bg-border-dark/50"}),w.jsxs("div",{className:"flex flex-col gap-4",children:[w.jsx(Wa,{label:"Daily Reminders",checked:x,onChange:Q}),x&&w.jsxs("div",{className:"flex items-center justify-between animation-slide-down",children:[w.jsx("span",{className:"text-text-light-primary dark:text-text-dark-primary",children:"Reminder Time"}),w.jsx("input",{type:"time",value:N,onChange:H,className:"bg-gray-100 dark:bg-gray-800 border-none rounded-lg p-2 text-text-light-primary dark:text-white focus:ring-2 focus:ring-primary"})]})]}),w.jsxs("section",{className:"bg-content-light dark:bg-content-dark rounded-xl p-4",children:[w.jsx("h3",{className:"text-sm font-medium text-text-light-secondary dark:text-text-dark-secondary uppercase mb-4",children:"Integrations"}),w.jsx("div",{className:"flex items-center justify-center",children:w.jsx(ui,{fullWidth:!0,variant:"secondary",onClick:_,isLoading:p,icon:"calendar_month",children:"Sync to Google Calendar"})}),w.jsx("p",{className:"text-xs text-text-light-secondary dark:text-text-dark-secondary mt-2 text-center",children:"Creates recurring events for your habits."})]})]}),w.jsxs("section",{className:"bg-content-light dark:bg-content-dark rounded-xl p-4",children:[w.jsx("h3",{className:"text-sm font-medium text-text-light-secondary dark:text-text-dark-secondary uppercase mb-4",children:"About"}),w.jsxs("div",{className:"space-y-3",children:[w.jsxs("div",{className:"flex justify-between",children:[w.jsx("span",{className:"text-text-light-primary dark:text-text-dark-primary",children:"Version"}),w.jsx("span",{className:"text-text-light-secondary dark:text-text-dark-secondary",children:"1.9.0"})]}),w.jsxs("div",{className:"flex justify-between",children:[w.jsx("span",{className:"text-text-light-primary dark:text-text-dark-primary",children:"Build"}),w.jsx("span",{className:"text-text-light-secondary dark:text-text-dark-secondary",children:"PWA"})]})]})]}),w.jsx(ui,{fullWidth:!0,variant:"danger",onClick:se,isLoading:d,icon:"logout",children:"Sign Out"})]})]}),w.jsx(ol,{})]})}function Ki({children:n}){const{isAuthenticated:e,isLoading:t}=go();return U.useEffect(()=>{try{Y0()}catch(s){console.error("Notification check failed",s)}const r=setInterval(()=>{try{Y0()}catch(s){console.error("Notification interval failed",s)}},6e4);return()=>clearInterval(r)},[]),t?w.jsx("div",{className:"min-h-screen bg-background-light dark:bg-background-dark flex items-center justify-center",children:w.jsx(Eo,{size:"lg"})}):e?n:w.jsx(a1,{to:"/",replace:!0})}function TO(){const{user:n,setUser:e,setLoading:t}=go(),{loadHabits:r,loadCompletionsForDate:s,subscribeToHabits:a,clearAll:l}=cs();return U.useEffect(()=>{let d=null;const f=zN(af,async p=>{if(p){e({uid:p.uid,displayName:p.displayName,email:p.email,photoURL:p.photoURL});try{const v=await tS(p.uid);v!=null&&v.settings&&localStorage.setItem("habitParams",JSON.stringify(v.settings));const{loadCompletionsForWeek:_,subscribeToHabits:x}=cs.getState();await _(p.uid),d=x(p.uid)}catch(v){console.error("Error loading user data:",v)}}else e(null),l(),d&&(d(),d=null);t(!1)});return()=>{f(),d&&d()}},[e,t,r,s,a,l]),U.useEffect(()=>{localStorage.getItem("theme")==="dark"&&document.documentElement.classList.add("dark")},[]),w.jsx(N1,{basename:"/habit-tracker-pwa/",children:w.jsx("div",{className:"min-h-screen bg-background-light dark:bg-background-dark font-display",children:w.jsxs(u1,{children:[w.jsx(kr,{path:"/",element:w.jsx(QV,{})}),w.jsx(kr,{path:"/dashboard",element:w.jsx(Ki,{children:w.jsx(eO,{})})}),w.jsx(kr,{path:"/new-habit",element:w.jsx(Ki,{children:w.jsx(rO,{})})}),w.jsx(kr,{path:"/edit-habit/:habitId",element:w.jsx(Ki,{children:w.jsx(oO,{})})}),w.jsx(kr,{path:"/habit/:habitId",element:w.jsx(Ki,{children:w.jsx(cO,{})})}),w.jsx(kr,{path:"/leaderboard",element:w.jsx(Ki,{children:w.jsx(dO,{})})}),w.jsx(kr,{path:"/profile/:userId",element:w.jsx(Ki,{children:w.jsx(hO,{})})}),w.jsx(kr,{path:"/feed",element:w.jsx(Ki,{children:w.jsx(IO,{})})}),w.jsx(kr,{path:"/settings",element:w.jsx(Ki,{children:w.jsx(xO,{})})})]})})})}class SO extends Sa.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){console.error("Uncaught error:",e,t),this.setState({errorInfo:t})}render(){return this.state.hasError?w.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center p-4 bg-gray-50 text-gray-900",children:[w.jsx("h1",{className:"text-2xl font-bold mb-4 text-red-600",children:"Something went wrong"}),w.jsx("p",{className:"mb-4 text-gray-700",children:"The application encountered an error."}),w.jsxs("div",{className:"bg-gray-100 p-4 rounded overflow-auto max-w-full text-left font-mono text-sm border border-gray-300",children:[w.jsx("p",{className:"font-bold text-red-500 mb-2",children:this.state.error&&this.state.error.toString()}),w.jsx("pre",{className:"text-xs text-gray-500 whitespace-pre-wrap",children:this.state.errorInfo&&this.state.errorInfo.componentStack})]}),w.jsx("button",{onClick:()=>window.location.reload(),className:"mt-6 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Reload Application"})]}):this.props.children}}const kO=["habits-storage","auth-storage"];kO.forEach(n=>{localStorage.getItem(n)&&(localStorage.removeItem(n),console.log(`[Init] Cleared old localStorage: ${n}`))});gk.createRoot(document.getElementById("root")).render(w.jsx(Sa.StrictMode,{children:w.jsx(SO,{children:w.jsx(TO,{})})}));
